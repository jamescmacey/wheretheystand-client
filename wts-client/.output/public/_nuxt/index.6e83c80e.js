import{m as D,p as I,A as P,a as A,b as s,e as a,w as _,f as l,l as o,F as w,r as T,c as i,i as u,t as h,H,h as F,o as t,M as N,x as V,j as E}from"./entry.7914bd7a.js";import{_ as R}from"./PageHeader.99192d26.js";import{a as B,_ as O}from"./VoteSummary.28fb9772.js";import{_ as j}from"./PartyCard.51ce6cf3.js";import{_ as W}from"./PersonCard.ece8ff2a.js";import{_ as z}from"./PersonList.d82277da.js";import{f as Q,p as X}from"./index.145ce648.js";import{f as G}from"./index.dcb4ea67.js";import{p as J}from"./index.58aab3e7.js";import"./ColourDot.e1aba6a4.js";import"./index.b85c6916.js";const K=D("votes",{state(){return{items:[]}},getters:{byID:n=>c=>n.items.find(y=>y.id.toString()===c)},actions:{async fetch(n){if(!this.byID(n)){var c=this;await I(P+"votes/"+n+"/",{onResponse({request:y,response:p,options:m}){c.items.push(p._data)},onResponseError({request:y,response:p,options:m}){useNotificationsStore().postResponseError(p)},onRequestError({request:y,options:p,error:m}){useNotificationsStore().addToast("Error fetching resource (request)",m)}},"$rQCkRLmMXR")}}}}),U={name:"Vote",setup(){return{votesStore:K()}},created(){this.votesStore.fetch(this.$route.params.id)},methods:{formatDate(n){return Q(X(n,"yyyy-MM-dd",new Date),"d MMMM yyyy")}},data(){return{listMode:"vote",sortFunction:function(n,c){if(n.person&&c.person)return n.person.last_name.toLowerCase()<c.person.last_name.toLowerCase()?-1:n.person.last_name.toLowerCase()==c.person.last_name.toLowerCase()?0:1;if(n.person&&!c.person)return 1;if(c.person&&!n.person)return-1;if(!n.person&&!c.person)return n.contribution>c.contribution?-1:n.contribution<c.contribution?1:n.party.display_name.toLowerCase()<c.party.display_name.toLowerCase()?-1:n.party.display_name.toLowerCase()==c.party.display_name.toLowerCase()?0:1}}},computed:{vote(){return this.votesStore.byID(this.$route.params.id)},readingOrdinal(){return this.vote.reading+{1:"st reading",2:"nd reading",3:"rd reading"}[this.vote.reading]},ayes(){return this.vote.positions.filter(n=>{if(n.position=="y")return!0}).sort(this.sortFunction)},noes(){return this.vote.positions.filter(n=>{if(n.position=="n")return!0}).sort(this.sortFunction)},abstentions(){return this.vote.positions.filter(n=>{if(n.position=="a")return!0}).sort(this.sortFunction)},absences(){return this.vote.positions.filter(n=>{if(n.position=="x")return!0}).sort(this.sortFunction)},relativeDate(){return G(J(this.vote.last_retrieved))+" ago"}}},Y={key:0,id:"vote-view"},Z={class:"container mt-3"},$=l("h4",null,"Summary",-1),ee={class:"row"},te={class:"col-12"},se={key:0},oe={key:1},ne=l("br",null,null,-1),re=l("h5",{class:"mt-3"},"Vote type",-1),ae={key:2},ce=l("strong",null,"Personal vote: ",-1),le={key:3},ie=l("strong",null,"Split-party vote: ",-1),ue={key:4},_e=l("strong",null,"Party vote: ",-1),de=l("hr",null,null,-1),he={class:"row"},ye={class:"col-12 col-xl-6"},pe={class:"col-12 col-xl-6 text-xl-end"},me={key:0},ve={key:0,class:"mt-3"},fe={key:1,class:"row"},ke={key:0},ge={key:2,class:"mt-3"},xe={key:3,class:"row"},be={key:0},we={key:4,class:"mt-3"},Te={key:5,class:"row"},Le={key:0},Se={key:6,class:"mt-3"},Ce={key:7,class:"row"},Me={key:0},qe={key:1},De={key:0},Ie={key:0,class:"mt-3"},Pe={key:1,class:"mt-3"},Ae={key:3,class:"mt-3"},He={key:5,class:"mt-3"},Fe={class:"col-12"},Ne={class:"text-muted"},Ve={key:0},Ee={key:1},Re={key:2};function Be(n,c,y,p,m,e){const v=N,S=H,C=R,M=B,k=V,q=E,L=O,f=F,g=j,x=W,b=z;return e.vote?(t(),s("div",Y,[a(S,null,{default:_(()=>[a(v,{name:"twitter:title",content:e.vote.name+" - WhereTheyStand"},null,8,["content"]),e.vote.question_text?(t(),i(v,{key:0,name:"twitter:description",content:e.vote.question_text},null,8,["content"])):o("",!0),e.vote.question_text?(t(),i(v,{key:1,name:"description",content:e.vote.question_text},null,8,["content"])):o("",!0),a(v,{property:"og:title",content:e.vote.name+" - WhereTheyStand"},null,8,["content"]),e.vote.question_text?(t(),i(v,{key:2,property:"og:description",content:e.vote.question_text},null,8,["content"])):o("",!0)]),_:1}),a(C,{pageTitle:e.vote.bill.name,pageSubtitle:e.readingOrdinal,pageDate:e.vote.vote_date,backLink:"/bills/"+e.vote.bill.id,backText:e.vote.bill.name},null,8,["pageTitle","pageSubtitle","pageDate","backLink","backText"]),l("div",Z,[a(M,{vote:e.vote,countsOnly:!0},null,8,["vote"]),$,l("div",ee,[l("div",te,[a(f,null,{default:_(()=>[e.vote.question_text?(t(),s("span",se,h(e.vote.question_text),1)):o("",!0),e.vote.outcome_text?(t(),s("strong",oe,[ne,a(k,{icon:["fas","arrow-right"]}),u(" "+h(e.vote.outcome_text),1)])):o("",!0),re,e.vote.type=="personal"?(t(),s("span",ae,[a(k,{icon:["fas","person"]}),u(),ce,u(" MPs' votes were cast and recorded individually. ")])):o("",!0),e.vote.type=="party"&&e.vote.contains_split_votes?(t(),s("span",le,[a(k,{icon:["fas","people-group"]}),u(),ie,u(" The vote was conducted as a party vote, but one or more parties opted to split their vote across multiple positions. The position of each MP within those parties is recorded individually. ")])):o("",!0),e.vote.type=="party"&&!e.vote.contains_split_votes?(t(),s("span",ue,[a(k,{icon:["fas","people-group"]}),u(),_e,u(" Parties cast one vote on behalf of all their MPs. ")])):o("",!0),de,l("div",he,[l("div",ye,[a(q,{link:"https://www.parliament.nz/en/pb/hansard-debates/rhr/document/"+e.vote.document_id},{default:_(()=>[u(" View Hansard record")]),_:1},8,["link"])]),l("div",pe,[a(L,{class:"ms-xl-2 me-xl-0",resourceType:"vote",fileType:"xlsx",resourceId:e.vote.id},null,8,["resourceId"]),a(L,{class:"ms-xl-2 me-xl-0",resourceType:"vote",fileType:"csv",resourceId:e.vote.id},null,8,["resourceId"]),a(L,{class:"ms-xl-2 me-xl-0",resourceType:"vote",fileType:"json",resourceId:e.vote.id},null,8,["resourceId"])])])]),_:1})])]),e.vote.type=="party"?(t(),s("div",me,[e.ayes.length>0?(t(),s("h5",ve,"Ayes")):o("",!0),e.ayes.length>0?(t(),s("div",fe,[(t(!0),s(w,null,T(e.ayes,(r,d)=>(t(),s("div",{key:d,class:"col-12 col-md-6 col-lg-4 col-xl-3"},[r.person?(t(),i(x,{key:1,person:r.person},null,8,["person"])):(t(),i(g,{key:0,party:r.party},{default:_(()=>[u(h(r.contribution)+" vote",1),r.contribution!=1?(t(),s("span",ke,"s")):o("",!0)]),_:2},1032,["party"]))]))),128))])):o("",!0),e.noes.length>0?(t(),s("h5",ge,"Noes")):o("",!0),e.noes.length>0?(t(),s("div",xe,[(t(!0),s(w,null,T(e.noes,(r,d)=>(t(),s("div",{key:d,class:"col-12 col-md-6 col-lg-4 col-xl-3"},[r.person?(t(),i(x,{key:1,person:r.person},null,8,["person"])):(t(),i(g,{key:0,party:r.party},{default:_(()=>[u(h(r.contribution)+" vote",1),r.contribution!=1?(t(),s("span",be,"s")):o("",!0)]),_:2},1032,["party"]))]))),128))])):o("",!0),e.abstentions.length>0?(t(),s("h5",we,"Abstentions")):o("",!0),e.abstentions.length>0?(t(),s("div",Te,[(t(!0),s(w,null,T(e.abstentions,(r,d)=>(t(),s("div",{key:d,class:"col-12 col-md-6 col-lg-4 col-xl-3"},[r.person?(t(),i(x,{key:1,person:r.person},null,8,["person"])):(t(),i(g,{key:0,party:r.party},{default:_(()=>[u(h(r.contribution)+" vote",1),r.contribution!=1?(t(),s("span",Le,"s")):o("",!0)]),_:2},1032,["party"]))]))),128))])):o("",!0),e.absences.length>0?(t(),s("h5",Se,"Absences")):o("",!0),e.absences.length>0?(t(),s("div",Ce,[(t(!0),s(w,null,T(e.absences,(r,d)=>(t(),s("div",{key:d,class:"col-12 col-md-6 col-lg-4 col-xl-3"},[r.person?(t(),i(x,{key:1,person:r.person},null,8,["person"])):(t(),i(g,{key:0,party:r.party},{default:_(()=>[u(h(r.contribution)+" vote",1),r.contribution!=1?(t(),s("span",Me,"s")):o("",!0)]),_:2},1032,["party"]))]))),128))])):o("",!0)])):(t(),s("div",qe,[m.listMode=="vote"?(t(),s("div",De,[e.ayes.length>0?(t(),s("h5",Ie,"Ayes")):o("",!0),a(f,{class:"col-12"},{default:_(()=>[a(b,{positions:e.ayes},null,8,["positions"])]),_:1}),e.noes.length>0?(t(),s("h5",Pe,"Noes")):o("",!0),e.noes.length>0?(t(),i(f,{key:2,class:"col-12"},{default:_(()=>[a(b,{positions:e.noes},null,8,["positions"])]),_:1})):o("",!0),e.abstentions.length>0?(t(),s("h5",Ae,"Abstentions")):o("",!0),e.abstentions.length>0?(t(),i(f,{key:4,class:"col-12"},{default:_(()=>[a(b,{positions:e.abstentions},null,8,["positions"])]),_:1})):o("",!0),e.absences.length>0?(t(),s("h5",He,"Absences")):o("",!0),e.absences.length>0?(t(),i(f,{key:6,class:"col-12"},{default:_(()=>[a(b,{positions:e.absences},null,8,["positions"])]),_:1})):o("",!0)])):o("",!0)])),l("div",Fe,[l("p",Ne,[u("Last updated from Hansard "+h(e.relativeDate)+". ",1),e.vote.hansard_status.toLowerCase()=="final"?(t(),s("span",Ve,"The Hansard record that contains this vote is final.")):e.vote.hansard_status.toLowerCase()=="draft"?(t(),s("span",Ee,"The Hansard record that contains this vote is in a draft state. Details of the vote are subject to change and the original Hansard will be checked regularly for updates.")):e.vote.hansard_status.toLowerCase()=="corrected"?(t(),s("span",Re,"The Hansard record that contains this vote is in the 'corrected' stage of publication, but it is not yet final. Minor changes are still possible.")):o("",!0)])])])])):o("",!0)}const Ze=A(U,[["render",Be]]);export{Ze as default};

function Sv(t,e){const n=Object.create(null),i=t.split(",");for(let l=0;l<i.length;l++)n[i[l]]=!0;return e?l=>!!n[l.toLowerCase()]:l=>!!n[l]}const sP="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",lP=Sv(sP);function Pk(t){return!!t||t===""}function hu(t){if(En(t)){const e={};for(let n=0;n<t.length;n++){const i=t[n],l=Hi(i)?dP(i):hu(i);if(l)for(const d in l)e[d]=l[d]}return e}else{if(Hi(t))return t;if(Pi(t))return t}}const cP=/;(?![^(]*\))/g,uP=/:(.+)/;function dP(t){const e={};return t.split(cP).forEach(n=>{if(n){const i=n.split(uP);i.length>1&&(e[i[0].trim()]=i[1].trim())}}),e}function ts(t){let e="";if(Hi(t))e=t;else if(En(t))for(let n=0;n<t.length;n++){const i=ts(t[n]);i&&(e+=i+" ")}else if(Pi(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}function hP(t){if(!t)return null;let{class:e,style:n}=t;return e&&!Hi(e)&&(t.class=ts(e)),n&&(t.style=hu(n)),t}function fP(t,e){if(t.length!==e.length)return!1;let n=!0;for(let i=0;n&&i<t.length;i++)n=Am(t[i],e[i]);return n}function Am(t,e){if(t===e)return!0;let n=S3(t),i=S3(e);if(n||i)return n&&i?t.getTime()===e.getTime():!1;if(n=sm(t),i=sm(e),n||i)return t===e;if(n=En(t),i=En(e),n||i)return n&&i?fP(t,e):!1;if(n=Pi(t),i=Pi(e),n||i){if(!n||!i)return!1;const l=Object.keys(t).length,d=Object.keys(e).length;if(l!==d)return!1;for(const f in t){const o=t.hasOwnProperty(f),y=e.hasOwnProperty(f);if(o&&!y||!o&&y||!Am(t[f],e[f]))return!1}}return String(t)===String(e)}function Mv(t,e){return t.findIndex(n=>Am(n,e))}const Mi=t=>Hi(t)?t:t==null?"":En(t)||Pi(t)&&(t.toString===zk||!Vn(t.toString))?JSON.stringify(t,Lk,2):String(t),Lk=(t,e)=>e&&e.__v_isRef?Lk(t,e.value):Hh(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((n,[i,l])=>(n[`${i} =>`]=l,n),{})}:pf(e)?{[`Set(${e.size})`]:[...e.values()]}:Pi(e)&&!En(e)&&!Ok(e)?String(e):e,Xr={},qh=[],Ns=()=>{},pP=()=>!1,mP=/^on[^a-z]/,Im=t=>mP.test(t),Av=t=>t.startsWith("onUpdate:"),Mo=Object.assign,Iv=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},gP=Object.prototype.hasOwnProperty,pr=(t,e)=>gP.call(t,e),En=Array.isArray,Hh=t=>Pm(t)==="[object Map]",pf=t=>Pm(t)==="[object Set]",S3=t=>Pm(t)==="[object Date]",Vn=t=>typeof t=="function",Hi=t=>typeof t=="string",sm=t=>typeof t=="symbol",Pi=t=>t!==null&&typeof t=="object",Pv=t=>Pi(t)&&Vn(t.then)&&Vn(t.catch),zk=Object.prototype.toString,Pm=t=>zk.call(t),_P=t=>Pm(t).slice(8,-1),Ok=t=>Pm(t)==="[object Object]",Lv=t=>Hi(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,Vp=Sv(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),O_=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))},yP=/-(\w)/g,bl=O_(t=>t.replace(yP,(e,n)=>n?n.toUpperCase():"")),bP=/\B([A-Z])/g,mf=O_(t=>t.replace(bP,"-$1").toLowerCase()),D_=O_(t=>t.charAt(0).toUpperCase()+t.slice(1)),P1=O_(t=>t?`on${D_(t)}`:""),lm=(t,e)=>!Object.is(t,e),Wh=(t,e)=>{for(let n=0;n<t.length;n++)t[n](e)},t_=(t,e,n)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value:n})},tf=t=>{const e=parseFloat(t);return isNaN(e)?t:e};let M3;const vP=()=>M3||(M3=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof global!="undefined"?global:{});let hl;class Dk{constructor(e=!1){this.active=!0,this.effects=[],this.cleanups=[],!e&&hl&&(this.parent=hl,this.index=(hl.scopes||(hl.scopes=[])).push(this)-1)}run(e){if(this.active){const n=hl;try{return hl=this,e()}finally{hl=n}}}on(){hl=this}off(){hl=this.parent}stop(e){if(this.active){let n,i;for(n=0,i=this.effects.length;n<i;n++)this.effects[n].stop();for(n=0,i=this.cleanups.length;n<i;n++)this.cleanups[n]();if(this.scopes)for(n=0,i=this.scopes.length;n<i;n++)this.scopes[n].stop(!0);if(this.parent&&!e){const l=this.parent.scopes.pop();l&&l!==this&&(this.parent.scopes[this.index]=l,l.index=this.index)}this.active=!1}}}function Rk(t){return new Dk(t)}function xP(t,e=hl){e&&e.active&&e.effects.push(t)}const zv=t=>{const e=new Set(t);return e.w=0,e.n=0,e},Bk=t=>(t.w&yu)>0,Fk=t=>(t.n&yu)>0,wP=({deps:t})=>{if(t.length)for(let e=0;e<t.length;e++)t[e].w|=yu},EP=t=>{const{deps:e}=t;if(e.length){let n=0;for(let i=0;i<e.length;i++){const l=e[i];Bk(l)&&!Fk(l)?l.delete(t):e[n++]=l,l.w&=~yu,l.n&=~yu}e.length=n}},Eb=new WeakMap;let zp=0,yu=1;const Tb=30;let Ds;const Ad=Symbol(""),kb=Symbol("");class Ov{constructor(e,n=null,i){this.fn=e,this.scheduler=n,this.active=!0,this.deps=[],this.parent=void 0,xP(this,i)}run(){if(!this.active)return this.fn();let e=Ds,n=fu;for(;e;){if(e===this)return;e=e.parent}try{return this.parent=Ds,Ds=this,fu=!0,yu=1<<++zp,zp<=Tb?wP(this):A3(this),this.fn()}finally{zp<=Tb&&EP(this),yu=1<<--zp,Ds=this.parent,fu=n,this.parent=void 0,this.deferStop&&this.stop()}}stop(){Ds===this?this.deferStop=!0:this.active&&(A3(this),this.onStop&&this.onStop(),this.active=!1)}}function A3(t){const{deps:e}=t;if(e.length){for(let n=0;n<e.length;n++)e[n].delete(t);e.length=0}}let fu=!0;const Nk=[];function gf(){Nk.push(fu),fu=!1}function _f(){const t=Nk.pop();fu=t===void 0?!0:t}function Ra(t,e,n){if(fu&&Ds){let i=Eb.get(t);i||Eb.set(t,i=new Map);let l=i.get(n);l||i.set(n,l=zv()),jk(l)}}function jk(t,e){let n=!1;zp<=Tb?Fk(t)||(t.n|=yu,n=!Bk(t)):n=!t.has(Ds),n&&(t.add(Ds),Ds.deps.push(t))}function sc(t,e,n,i,l,d){const f=Eb.get(t);if(!f)return;let o=[];if(e==="clear")o=[...f.values()];else if(n==="length"&&En(t))f.forEach((y,E)=>{(E==="length"||E>=i)&&o.push(y)});else switch(n!==void 0&&o.push(f.get(n)),e){case"add":En(t)?Lv(n)&&o.push(f.get("length")):(o.push(f.get(Ad)),Hh(t)&&o.push(f.get(kb)));break;case"delete":En(t)||(o.push(f.get(Ad)),Hh(t)&&o.push(f.get(kb)));break;case"set":Hh(t)&&o.push(f.get(Ad));break}if(o.length===1)o[0]&&Cb(o[0]);else{const y=[];for(const E of o)E&&y.push(...E);Cb(zv(y))}}function Cb(t,e){const n=En(t)?t:[...t];for(const i of n)i.computed&&I3(i);for(const i of n)i.computed||I3(i)}function I3(t,e){(t!==Ds||t.allowRecurse)&&(t.scheduler?t.scheduler():t.run())}const TP=Sv("__proto__,__v_isRef,__isVue"),Uk=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(sm)),kP=Dv(),CP=Dv(!1,!0),SP=Dv(!0),P3=MP();function MP(){const t={};return["includes","indexOf","lastIndexOf"].forEach(e=>{t[e]=function(...n){const i=kr(this);for(let d=0,f=this.length;d<f;d++)Ra(i,"get",d+"");const l=i[e](...n);return l===-1||l===!1?i[e](...n.map(kr)):l}}),["push","pop","shift","unshift","splice"].forEach(e=>{t[e]=function(...n){gf();const i=kr(this)[e].apply(this,n);return _f(),i}}),t}function Dv(t=!1,e=!1){return function(i,l,d){if(l==="__v_isReactive")return!t;if(l==="__v_isReadonly")return t;if(l==="__v_isShallow")return e;if(l==="__v_raw"&&d===(t?e?GP:Hk:e?qk:Gk).get(i))return i;const f=En(i);if(!t&&f&&pr(P3,l))return Reflect.get(P3,l,d);const o=Reflect.get(i,l,d);return(sm(l)?Uk.has(l):TP(l))||(t||Ra(i,"get",l),e)?o:yi(o)?f&&Lv(l)?o:o.value:Pi(o)?t?Wk(o):ya(o):o}}const AP=$k(),IP=$k(!0);function $k(t=!1){return function(n,i,l,d){let f=n[i];if(cm(f)&&yi(f)&&!yi(l))return!1;if(!t&&!cm(l)&&(Sb(l)||(l=kr(l),f=kr(f)),!En(n)&&yi(f)&&!yi(l)))return f.value=l,!0;const o=En(n)&&Lv(i)?Number(i)<n.length:pr(n,i),y=Reflect.set(n,i,l,d);return n===kr(d)&&(o?lm(l,f)&&sc(n,"set",i,l):sc(n,"add",i,l)),y}}function PP(t,e){const n=pr(t,e);t[e];const i=Reflect.deleteProperty(t,e);return i&&n&&sc(t,"delete",e,void 0),i}function LP(t,e){const n=Reflect.has(t,e);return(!sm(e)||!Uk.has(e))&&Ra(t,"has",e),n}function zP(t){return Ra(t,"iterate",En(t)?"length":Ad),Reflect.ownKeys(t)}const Vk={get:kP,set:AP,deleteProperty:PP,has:LP,ownKeys:zP},OP={get:SP,set(t,e){return!0},deleteProperty(t,e){return!0}},DP=Mo({},Vk,{get:CP,set:IP}),Rv=t=>t,R_=t=>Reflect.getPrototypeOf(t);function e0(t,e,n=!1,i=!1){t=t.__v_raw;const l=kr(t),d=kr(e);n||(e!==d&&Ra(l,"get",e),Ra(l,"get",d));const{has:f}=R_(l),o=i?Rv:n?Nv:um;if(f.call(l,e))return o(t.get(e));if(f.call(l,d))return o(t.get(d));t!==l&&t.get(e)}function n0(t,e=!1){const n=this.__v_raw,i=kr(n),l=kr(t);return e||(t!==l&&Ra(i,"has",t),Ra(i,"has",l)),t===l?n.has(t):n.has(t)||n.has(l)}function r0(t,e=!1){return t=t.__v_raw,!e&&Ra(kr(t),"iterate",Ad),Reflect.get(t,"size",t)}function L3(t){t=kr(t);const e=kr(this);return R_(e).has.call(e,t)||(e.add(t),sc(e,"add",t,t)),this}function z3(t,e){e=kr(e);const n=kr(this),{has:i,get:l}=R_(n);let d=i.call(n,t);d||(t=kr(t),d=i.call(n,t));const f=l.call(n,t);return n.set(t,e),d?lm(e,f)&&sc(n,"set",t,e):sc(n,"add",t,e),this}function O3(t){const e=kr(this),{has:n,get:i}=R_(e);let l=n.call(e,t);l||(t=kr(t),l=n.call(e,t)),i&&i.call(e,t);const d=e.delete(t);return l&&sc(e,"delete",t,void 0),d}function D3(){const t=kr(this),e=t.size!==0,n=t.clear();return e&&sc(t,"clear",void 0,void 0),n}function i0(t,e){return function(i,l){const d=this,f=d.__v_raw,o=kr(f),y=e?Rv:t?Nv:um;return!t&&Ra(o,"iterate",Ad),f.forEach((E,C)=>i.call(l,y(E),y(C),d))}}function o0(t,e,n){return function(...i){const l=this.__v_raw,d=kr(l),f=Hh(d),o=t==="entries"||t===Symbol.iterator&&f,y=t==="keys"&&f,E=l[t](...i),C=n?Rv:e?Nv:um;return!e&&Ra(d,"iterate",y?kb:Ad),{next(){const{value:A,done:P}=E.next();return P?{value:A,done:P}:{value:o?[C(A[0]),C(A[1])]:C(A),done:P}},[Symbol.iterator](){return this}}}}function Yc(t){return function(...e){return t==="delete"?!1:this}}function RP(){const t={get(d){return e0(this,d)},get size(){return r0(this)},has:n0,add:L3,set:z3,delete:O3,clear:D3,forEach:i0(!1,!1)},e={get(d){return e0(this,d,!1,!0)},get size(){return r0(this)},has:n0,add:L3,set:z3,delete:O3,clear:D3,forEach:i0(!1,!0)},n={get(d){return e0(this,d,!0)},get size(){return r0(this,!0)},has(d){return n0.call(this,d,!0)},add:Yc("add"),set:Yc("set"),delete:Yc("delete"),clear:Yc("clear"),forEach:i0(!0,!1)},i={get(d){return e0(this,d,!0,!0)},get size(){return r0(this,!0)},has(d){return n0.call(this,d,!0)},add:Yc("add"),set:Yc("set"),delete:Yc("delete"),clear:Yc("clear"),forEach:i0(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(d=>{t[d]=o0(d,!1,!1),n[d]=o0(d,!0,!1),e[d]=o0(d,!1,!0),i[d]=o0(d,!0,!0)}),[t,n,e,i]}const[BP,FP,NP,jP]=RP();function Bv(t,e){const n=e?t?jP:NP:t?FP:BP;return(i,l,d)=>l==="__v_isReactive"?!t:l==="__v_isReadonly"?t:l==="__v_raw"?i:Reflect.get(pr(n,l)&&l in i?n:i,l,d)}const UP={get:Bv(!1,!1)},$P={get:Bv(!1,!0)},VP={get:Bv(!0,!1)},Gk=new WeakMap,qk=new WeakMap,Hk=new WeakMap,GP=new WeakMap;function qP(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function HP(t){return t.__v_skip||!Object.isExtensible(t)?0:qP(_P(t))}function ya(t){return cm(t)?t:Fv(t,!1,Vk,UP,Gk)}function WP(t){return Fv(t,!1,DP,$P,qk)}function Wk(t){return Fv(t,!0,OP,VP,Hk)}function Fv(t,e,n,i,l){if(!Pi(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const d=l.get(t);if(d)return d;const f=HP(t);if(f===0)return t;const o=new Proxy(t,f===2?i:n);return l.set(t,o),o}function pu(t){return cm(t)?pu(t.__v_raw):!!(t&&t.__v_isReactive)}function cm(t){return!!(t&&t.__v_isReadonly)}function Sb(t){return!!(t&&t.__v_isShallow)}function Zk(t){return pu(t)||cm(t)}function kr(t){const e=t&&t.__v_raw;return e?kr(e):t}function Od(t){return t_(t,"__v_skip",!0),t}const um=t=>Pi(t)?ya(t):t,Nv=t=>Pi(t)?Wk(t):t;function Xk(t){fu&&Ds&&(t=kr(t),jk(t.dep||(t.dep=zv())))}function Yk(t,e){t=kr(t),t.dep&&Cb(t.dep)}function yi(t){return!!(t&&t.__v_isRef===!0)}function so(t){return Kk(t,!1)}function e_(t){return Kk(t,!0)}function Kk(t,e){return yi(t)?t:new ZP(t,e)}class ZP{constructor(e,n){this.__v_isShallow=n,this.dep=void 0,this.__v_isRef=!0,this._rawValue=n?e:kr(e),this._value=n?e:um(e)}get value(){return Xk(this),this._value}set value(e){e=this.__v_isShallow?e:kr(e),lm(e,this._rawValue)&&(this._rawValue=e,this._value=this.__v_isShallow?e:um(e),Yk(this))}}function Zh(t){return yi(t)?t.value:t}const XP={get:(t,e,n)=>Zh(Reflect.get(t,e,n)),set:(t,e,n,i)=>{const l=t[e];return yi(l)&&!yi(n)?(l.value=n,!0):Reflect.set(t,e,n,i)}};function Jk(t){return pu(t)?t:new Proxy(t,XP)}function jv(t){const e=En(t)?new Array(t.length):{};for(const n in t)e[n]=Uv(t,n);return e}class YP{constructor(e,n,i){this._object=e,this._key=n,this._defaultValue=i,this.__v_isRef=!0}get value(){const e=this._object[this._key];return e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}}function Uv(t,e,n){const i=t[e];return yi(i)?i:new YP(t,e,n)}class KP{constructor(e,n,i,l){this._setter=n,this.dep=void 0,this.__v_isRef=!0,this._dirty=!0,this.effect=new Ov(e,()=>{this._dirty||(this._dirty=!0,Yk(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!l,this.__v_isReadonly=i}get value(){const e=kr(this);return Xk(e),(e._dirty||!e._cacheable)&&(e._dirty=!1,e._value=e.effect.run()),e._value}set value(e){this._setter(e)}}function JP(t,e,n=!1){let i,l;const d=Vn(t);return d?(i=t,l=Ns):(i=t.get,l=t.set),new KP(i,l,d||!l,n)}function mu(t,e,n,i){let l;try{l=i?t(...i):t()}catch(d){Lm(d,e,n)}return l}function as(t,e,n,i){if(Vn(t)){const d=mu(t,e,n,i);return d&&Pv(d)&&d.catch(f=>{Lm(f,e,n)}),d}const l=[];for(let d=0;d<t.length;d++)l.push(as(t[d],e,n,i));return l}function Lm(t,e,n,i=!0){const l=e?e.vnode:null;if(e){let d=e.parent;const f=e.proxy,o=n;for(;d;){const E=d.ec;if(E){for(let C=0;C<E.length;C++)if(E[C](t,f,o)===!1)return}d=d.parent}const y=e.appContext.config.errorHandler;if(y){mu(y,null,10,[t,f,o]);return}}QP(t,n,l,i)}function QP(t,e,n,i=!0){console.error(t)}let n_=!1,Mb=!1;const Da=[];let nc=0;const Gp=[];let Op=null,jh=0;const qp=[];let au=null,Uh=0;const Qk=Promise.resolve();let $v=null,Ab=null;function B_(t){const e=$v||Qk;return t?e.then(this?t.bind(this):t):e}function tL(t){let e=nc+1,n=Da.length;for(;e<n;){const i=e+n>>>1;dm(Da[i])<t?e=i+1:n=i}return e}function t4(t){(!Da.length||!Da.includes(t,n_&&t.allowRecurse?nc+1:nc))&&t!==Ab&&(t.id==null?Da.push(t):Da.splice(tL(t.id),0,t),e4())}function e4(){!n_&&!Mb&&(Mb=!0,$v=Qk.then(i4))}function eL(t){const e=Da.indexOf(t);e>nc&&Da.splice(e,1)}function n4(t,e,n,i){En(t)?n.push(...t):(!e||!e.includes(t,t.allowRecurse?i+1:i))&&n.push(t),e4()}function nL(t){n4(t,Op,Gp,jh)}function r4(t){n4(t,au,qp,Uh)}function F_(t,e=null){if(Gp.length){for(Ab=e,Op=[...new Set(Gp)],Gp.length=0,jh=0;jh<Op.length;jh++)Op[jh]();Op=null,jh=0,Ab=null,F_(t,e)}}function r_(t){if(F_(),qp.length){const e=[...new Set(qp)];if(qp.length=0,au){au.push(...e);return}for(au=e,au.sort((n,i)=>dm(n)-dm(i)),Uh=0;Uh<au.length;Uh++)au[Uh]();au=null,Uh=0}}const dm=t=>t.id==null?1/0:t.id;function i4(t){Mb=!1,n_=!0,F_(t),Da.sort((n,i)=>dm(n)-dm(i));const e=Ns;try{for(nc=0;nc<Da.length;nc++){const n=Da[nc];n&&n.active!==!1&&mu(n,null,14)}}finally{nc=0,Da.length=0,r_(),n_=!1,$v=null,(Da.length||Gp.length||qp.length)&&i4(t)}}function rL(t,e,...n){if(t.isUnmounted)return;const i=t.vnode.props||Xr;let l=n;const d=e.startsWith("update:"),f=d&&e.slice(7);if(f&&f in i){const C=`${f==="modelValue"?"model":f}Modifiers`,{number:A,trim:P}=i[C]||Xr;P&&(l=n.map(B=>B.trim())),A&&(l=n.map(tf))}let o,y=i[o=P1(e)]||i[o=P1(bl(e))];!y&&d&&(y=i[o=P1(mf(e))]),y&&as(y,t,6,l);const E=i[o+"Once"];if(E){if(!t.emitted)t.emitted={};else if(t.emitted[o])return;t.emitted[o]=!0,as(E,t,6,l)}}function o4(t,e,n=!1){const i=e.emitsCache,l=i.get(t);if(l!==void 0)return l;const d=t.emits;let f={},o=!1;if(!Vn(t)){const y=E=>{const C=o4(E,e,!0);C&&(o=!0,Mo(f,C))};!n&&e.mixins.length&&e.mixins.forEach(y),t.extends&&y(t.extends),t.mixins&&t.mixins.forEach(y)}return!d&&!o?(i.set(t,null),null):(En(d)?d.forEach(y=>f[y]=null):Mo(f,d),i.set(t,f),f)}function N_(t,e){return!t||!Im(e)?!1:(e=e.slice(2).replace(/Once$/,""),pr(t,e[0].toLowerCase()+e.slice(1))||pr(t,mf(e))||pr(t,e))}let jo=null,j_=null;function i_(t){const e=jo;return jo=t,j_=t&&t.type.__scopeId||null,e}function zm(t){j_=t}function Om(){j_=null}function Zr(t,e=jo,n){if(!e||t._n)return t;const i=(...l)=>{i._d&&Z3(-1);const d=i_(e),f=t(...l);return i_(d),i._d&&Z3(1),f};return i._n=!0,i._c=!0,i._d=!0,i}function L1(t){const{type:e,vnode:n,proxy:i,withProxy:l,props:d,propsOptions:[f],slots:o,attrs:y,emit:E,render:C,renderCache:A,data:P,setupState:B,ctx:j,inheritAttrs:Z}=t;let W,H;const V=i_(t);try{if(n.shapeFlag&4){const ft=l||i;W=ns(C.call(ft,ft,A,d,B,P,j)),H=y}else{const ft=e;W=ns(ft.length>1?ft(d,{attrs:y,slots:o,emit:E}):ft(d,null)),H=e.props?y:oL(y)}}catch(ft){Wp.length=0,Lm(ft,t,1),W=ln(ra)}let tt=W;if(H&&Z!==!1){const ft=Object.keys(H),{shapeFlag:et}=tt;ft.length&&et&7&&(f&&ft.some(Av)&&(H=aL(H,f)),tt=lc(tt,H))}return n.dirs&&(tt=lc(tt),tt.dirs=tt.dirs?tt.dirs.concat(n.dirs):n.dirs),n.transition&&(tt.transition=n.transition),W=tt,i_(V),W}function iL(t){let e;for(let n=0;n<t.length;n++){const i=t[n];if(nf(i)){if(i.type!==ra||i.children==="v-if"){if(e)return;e=i}}else return}return e}const oL=t=>{let e;for(const n in t)(n==="class"||n==="style"||Im(n))&&((e||(e={}))[n]=t[n]);return e},aL=(t,e)=>{const n={};for(const i in t)(!Av(i)||!(i.slice(9)in e))&&(n[i]=t[i]);return n};function sL(t,e,n){const{props:i,children:l,component:d}=t,{props:f,children:o,patchFlag:y}=e,E=d.emitsOptions;if(e.dirs||e.transition)return!0;if(n&&y>=0){if(y&1024)return!0;if(y&16)return i?R3(i,f,E):!!f;if(y&8){const C=e.dynamicProps;for(let A=0;A<C.length;A++){const P=C[A];if(f[P]!==i[P]&&!N_(E,P))return!0}}}else return(l||o)&&(!o||!o.$stable)?!0:i===f?!1:i?f?R3(i,f,E):!0:!!f;return!1}function R3(t,e,n){const i=Object.keys(e);if(i.length!==Object.keys(t).length)return!0;for(let l=0;l<i.length;l++){const d=i[l];if(e[d]!==t[d]&&!N_(n,d))return!0}return!1}function Vv({vnode:t,parent:e},n){for(;e&&e.subTree===t;)(t=e.vnode).el=n,e=e.parent}const a4=t=>t.__isSuspense,lL={name:"Suspense",__isSuspense:!0,process(t,e,n,i,l,d,f,o,y,E){t==null?cL(e,n,i,l,d,f,o,y,E):uL(t,e,n,i,l,f,o,y,E)},hydrate:dL,create:Gv,normalize:hL},s4=lL;function hm(t,e){const n=t.props&&t.props[e];Vn(n)&&n()}function cL(t,e,n,i,l,d,f,o,y){const{p:E,o:{createElement:C}}=y,A=C("div"),P=t.suspense=Gv(t,l,i,e,A,n,d,f,o,y);E(null,P.pendingBranch=t.ssContent,A,null,i,P,d,f),P.deps>0?(hm(t,"onPending"),hm(t,"onFallback"),E(null,t.ssFallback,e,n,i,null,d,f),Xh(P,t.ssFallback)):P.resolve()}function uL(t,e,n,i,l,d,f,o,{p:y,um:E,o:{createElement:C}}){const A=e.suspense=t.suspense;A.vnode=e,e.el=t.el;const P=e.ssContent,B=e.ssFallback,{activeBranch:j,pendingBranch:Z,isInFallback:W,isHydrating:H}=A;if(Z)A.pendingBranch=P,ml(P,Z)?(y(Z,P,A.hiddenContainer,null,l,A,d,f,o),A.deps<=0?A.resolve():W&&(y(j,B,n,i,l,null,d,f,o),Xh(A,B))):(A.pendingId++,H?(A.isHydrating=!1,A.activeBranch=Z):E(Z,l,A),A.deps=0,A.effects.length=0,A.hiddenContainer=C("div"),W?(y(null,P,A.hiddenContainer,null,l,A,d,f,o),A.deps<=0?A.resolve():(y(j,B,n,i,l,null,d,f,o),Xh(A,B))):j&&ml(P,j)?(y(j,P,n,i,l,A,d,f,o),A.resolve(!0)):(y(null,P,A.hiddenContainer,null,l,A,d,f,o),A.deps<=0&&A.resolve()));else if(j&&ml(P,j))y(j,P,n,i,l,A,d,f,o),Xh(A,P);else if(hm(e,"onPending"),A.pendingBranch=P,A.pendingId++,y(null,P,A.hiddenContainer,null,l,A,d,f,o),A.deps<=0)A.resolve();else{const{timeout:V,pendingId:tt}=A;V>0?setTimeout(()=>{A.pendingId===tt&&A.fallback(B)},V):V===0&&A.fallback(B)}}function Gv(t,e,n,i,l,d,f,o,y,E,C=!1){const{p:A,m:P,um:B,n:j,o:{parentNode:Z,remove:W}}=E,H=tf(t.props&&t.props.timeout),V={vnode:t,parent:e,parentComponent:n,isSVG:f,container:i,hiddenContainer:l,anchor:d,deps:0,pendingId:0,timeout:typeof H=="number"?H:-1,activeBranch:null,pendingBranch:null,isInFallback:!0,isHydrating:C,isUnmounted:!1,effects:[],resolve(tt=!1){const{vnode:ft,activeBranch:et,pendingBranch:Pt,pendingId:Rt,effects:zt,parentComponent:jt,container:oe}=V;if(V.isHydrating)V.isHydrating=!1;else if(!tt){const Ue=et&&Pt.transition&&Pt.transition.mode==="out-in";Ue&&(et.transition.afterLeave=()=>{Rt===V.pendingId&&P(Pt,oe,Ae,0)});let{anchor:Ae}=V;et&&(Ae=j(et),B(et,jt,V,!0)),Ue||P(Pt,oe,Ae,0)}Xh(V,Pt),V.pendingBranch=null,V.isInFallback=!1;let ge=V.parent,ce=!1;for(;ge;){if(ge.pendingBranch){ge.effects.push(...zt),ce=!0;break}ge=ge.parent}ce||r4(zt),V.effects=[],hm(ft,"onResolve")},fallback(tt){if(!V.pendingBranch)return;const{vnode:ft,activeBranch:et,parentComponent:Pt,container:Rt,isSVG:zt}=V;hm(ft,"onFallback");const jt=j(et),oe=()=>{!V.isInFallback||(A(null,tt,Rt,jt,Pt,null,zt,o,y),Xh(V,tt))},ge=tt.transition&&tt.transition.mode==="out-in";ge&&(et.transition.afterLeave=oe),V.isInFallback=!0,B(et,Pt,null,!0),ge||oe()},move(tt,ft,et){V.activeBranch&&P(V.activeBranch,tt,ft,et),V.container=tt},next(){return V.activeBranch&&j(V.activeBranch)},registerDep(tt,ft){const et=!!V.pendingBranch;et&&V.deps++;const Pt=tt.vnode.el;tt.asyncDep.catch(Rt=>{Lm(Rt,tt,0)}).then(Rt=>{if(tt.isUnmounted||V.isUnmounted||V.pendingId!==tt.suspenseId)return;tt.asyncResolved=!0;const{vnode:zt}=tt;Bb(tt,Rt,!1),Pt&&(zt.el=Pt);const jt=!Pt&&tt.subTree.el;ft(tt,zt,Z(Pt||tt.subTree.el),Pt?null:j(tt.subTree),V,f,y),jt&&W(jt),Vv(tt,zt.el),et&&--V.deps===0&&V.resolve()})},unmount(tt,ft){V.isUnmounted=!0,V.activeBranch&&B(V.activeBranch,n,tt,ft),V.pendingBranch&&B(V.pendingBranch,n,tt,ft)}};return V}function dL(t,e,n,i,l,d,f,o,y){const E=e.suspense=Gv(e,i,n,t.parentNode,document.createElement("div"),null,l,d,f,o,!0),C=y(t,E.pendingBranch=e.ssContent,n,E,d,f);return E.deps===0&&E.resolve(),C}function hL(t){const{shapeFlag:e,children:n}=t,i=e&32;t.ssContent=B3(i?n.default:n),t.ssFallback=i?B3(n.fallback):ln(ra)}function B3(t){let e;if(Vn(t)){const n=ef&&t._c;n&&(t._d=!1,wn()),t=t(),n&&(t._d=!0,e=os,A4())}return En(t)&&(t=iL(t)),t=ns(t),e&&!t.dynamicChildren&&(t.dynamicChildren=e.filter(n=>n!==t)),t}function l4(t,e){e&&e.pendingBranch?En(t)?e.effects.push(...t):e.effects.push(t):r4(t)}function Xh(t,e){t.activeBranch=e;const{vnode:n,parentComponent:i}=t,l=n.el=e.el;i&&i.subTree===n&&(i.vnode.el=l,Vv(i,l))}function na(t,e){if(yo){let n=yo.provides;const i=yo.parent&&yo.parent.provides;i===n&&(n=yo.provides=Object.create(i)),n[t]=e}}function Pr(t,e,n=!1){const i=yo||jo;if(i){const l=i.parent==null?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides;if(l&&t in l)return l[t];if(arguments.length>1)return n&&Vn(e)?e.call(i.proxy):e}}function F3(t,e){return qv(t,null,e)}const N3={};function $r(t,e,n){return qv(t,e,n)}function qv(t,e,{immediate:n,deep:i,flush:l,onTrack:d,onTrigger:f}=Xr){const o=yo;let y,E=!1,C=!1;if(yi(t)?(y=()=>t.value,E=Sb(t)):pu(t)?(y=()=>t,i=!0):En(t)?(C=!0,E=t.some(H=>pu(H)||Sb(H)),y=()=>t.map(H=>{if(yi(H))return H.value;if(pu(H))return Sd(H);if(Vn(H))return mu(H,o,2)})):Vn(t)?e?y=()=>mu(t,o,2):y=()=>{if(!(o&&o.isUnmounted))return A&&A(),as(t,o,3,[P])}:y=Ns,e&&i){const H=y;y=()=>Sd(H())}let A,P=H=>{A=W.onStop=()=>{mu(H,o,4)}};if(pm)return P=Ns,e?n&&as(e,o,3,[y(),C?[]:void 0,P]):y(),Ns;let B=C?[]:N3;const j=()=>{if(!!W.active)if(e){const H=W.run();(i||E||(C?H.some((V,tt)=>lm(V,B[tt])):lm(H,B)))&&(A&&A(),as(e,o,3,[H,B===N3?void 0:B,P]),B=H)}else W.run()};j.allowRecurse=!!e;let Z;l==="sync"?Z=j:l==="post"?Z=()=>So(j,o&&o.suspense):Z=()=>nL(j);const W=new Ov(y,Z);return e?n?j():B=W.run():l==="post"?So(W.run.bind(W),o&&o.suspense):W.run(),()=>{W.stop(),o&&o.scope&&Iv(o.scope.effects,W)}}function fL(t,e,n){const i=this.proxy,l=Hi(t)?t.includes(".")?c4(i,t):()=>i[t]:t.bind(i,i);let d;Vn(e)?d=e:(d=e.handler,n=e);const f=yo;bu(this);const o=qv(l,d.bind(i),n);return f?bu(f):gu(),o}function c4(t,e){const n=e.split(".");return()=>{let i=t;for(let l=0;l<n.length&&i;l++)i=i[n[l]];return i}}function Sd(t,e){if(!Pi(t)||t.__v_skip||(e=e||new Set,e.has(t)))return t;if(e.add(t),yi(t))Sd(t.value,e);else if(En(t))for(let n=0;n<t.length;n++)Sd(t[n],e);else if(pf(t)||Hh(t))t.forEach(n=>{Sd(n,e)});else if(Ok(t))for(const n in t)Sd(t[n],e);return t}function pL(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return ji(()=>{t.isMounted=!0}),Dm(()=>{t.isUnmounting=!0}),t}const Ka=[Function,Array],mL={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Ka,onEnter:Ka,onAfterEnter:Ka,onEnterCancelled:Ka,onBeforeLeave:Ka,onLeave:Ka,onAfterLeave:Ka,onLeaveCancelled:Ka,onBeforeAppear:Ka,onAppear:Ka,onAfterAppear:Ka,onAppearCancelled:Ka},setup(t,{slots:e}){const n=qo(),i=pL();let l;return()=>{const d=e.default&&h4(e.default(),!0);if(!d||!d.length)return;let f=d[0];if(d.length>1){for(const Z of d)if(Z.type!==ra){f=Z;break}}const o=kr(t),{mode:y}=o;if(i.isLeaving)return z1(f);const E=j3(f);if(!E)return z1(f);const C=Ib(E,o,i,n);o_(E,C);const A=n.subTree,P=A&&j3(A);let B=!1;const{getTransitionKey:j}=E.type;if(j){const Z=j();l===void 0?l=Z:Z!==l&&(l=Z,B=!0)}if(P&&P.type!==ra&&(!ml(E,P)||B)){const Z=Ib(P,o,i,n);if(o_(P,Z),y==="out-in")return i.isLeaving=!0,Z.afterLeave=()=>{i.isLeaving=!1,n.update()},z1(f);y==="in-out"&&E.type!==ra&&(Z.delayLeave=(W,H,V)=>{const tt=d4(i,P);tt[String(P.key)]=P,W._leaveCb=()=>{H(),W._leaveCb=void 0,delete C.delayedLeave},C.delayedLeave=V})}return f}}},u4=mL;function d4(t,e){const{leavingVNodes:n}=t;let i=n.get(e.type);return i||(i=Object.create(null),n.set(e.type,i)),i}function Ib(t,e,n,i){const{appear:l,mode:d,persisted:f=!1,onBeforeEnter:o,onEnter:y,onAfterEnter:E,onEnterCancelled:C,onBeforeLeave:A,onLeave:P,onAfterLeave:B,onLeaveCancelled:j,onBeforeAppear:Z,onAppear:W,onAfterAppear:H,onAppearCancelled:V}=e,tt=String(t.key),ft=d4(n,t),et=(zt,jt)=>{zt&&as(zt,i,9,jt)},Pt=(zt,jt)=>{const oe=jt[1];et(zt,jt),En(zt)?zt.every(ge=>ge.length<=1)&&oe():zt.length<=1&&oe()},Rt={mode:d,persisted:f,beforeEnter(zt){let jt=o;if(!n.isMounted)if(l)jt=Z||o;else return;zt._leaveCb&&zt._leaveCb(!0);const oe=ft[tt];oe&&ml(t,oe)&&oe.el._leaveCb&&oe.el._leaveCb(),et(jt,[zt])},enter(zt){let jt=y,oe=E,ge=C;if(!n.isMounted)if(l)jt=W||y,oe=H||E,ge=V||C;else return;let ce=!1;const Ue=zt._enterCb=Ae=>{ce||(ce=!0,Ae?et(ge,[zt]):et(oe,[zt]),Rt.delayedLeave&&Rt.delayedLeave(),zt._enterCb=void 0)};jt?Pt(jt,[zt,Ue]):Ue()},leave(zt,jt){const oe=String(t.key);if(zt._enterCb&&zt._enterCb(!0),n.isUnmounting)return jt();et(A,[zt]);let ge=!1;const ce=zt._leaveCb=Ue=>{ge||(ge=!0,jt(),Ue?et(j,[zt]):et(B,[zt]),zt._leaveCb=void 0,ft[oe]===t&&delete ft[oe])};ft[oe]=t,P?Pt(P,[zt,ce]):ce()},clone(zt){return Ib(zt,e,n,i)}};return Rt}function z1(t){if(U_(t))return t=lc(t),t.children=null,t}function j3(t){return U_(t)?t.children?t.children[0]:void 0:t}function o_(t,e){t.shapeFlag&6&&t.component?o_(t.component.subTree,e):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function h4(t,e=!1,n){let i=[],l=0;for(let d=0;d<t.length;d++){let f=t[d];const o=n==null?f.key:String(n)+String(f.key!=null?f.key:d);f.type===No?(f.patchFlag&128&&l++,i=i.concat(h4(f.children,e,o))):(e||f.type!==ra)&&i.push(o!=null?lc(f,{key:o}):f)}if(l>1)for(let d=0;d<i.length;d++)i[d].patchFlag=-2;return i}function gr(t){return Vn(t)?{setup:t,name:t.name}:t}const Id=t=>!!t.type.__asyncLoader,U_=t=>t.type.__isKeepAlive,gL={name:"KeepAlive",__isKeepAlive:!0,props:{include:[String,RegExp,Array],exclude:[String,RegExp,Array],max:[String,Number]},setup(t,{slots:e}){const n=qo(),i=n.ctx;if(!i.renderer)return()=>{const V=e.default&&e.default();return V&&V.length===1?V[0]:V};const l=new Map,d=new Set;let f=null;const o=n.suspense,{renderer:{p:y,m:E,um:C,o:{createElement:A}}}=i,P=A("div");i.activate=(V,tt,ft,et,Pt)=>{const Rt=V.component;E(V,tt,ft,0,o),y(Rt.vnode,V,tt,ft,Rt,o,et,V.slotScopeIds,Pt),So(()=>{Rt.isDeactivated=!1,Rt.a&&Wh(Rt.a);const zt=V.props&&V.props.onVnodeMounted;zt&&ga(zt,Rt.parent,V)},o)},i.deactivate=V=>{const tt=V.component;E(V,P,null,1,o),So(()=>{tt.da&&Wh(tt.da);const ft=V.props&&V.props.onVnodeUnmounted;ft&&ga(ft,tt.parent,V),tt.isDeactivated=!0},o)};function B(V){O1(V),C(V,n,o,!0)}function j(V){l.forEach((tt,ft)=>{const et=Fb(tt.type);et&&(!V||!V(et))&&Z(ft)})}function Z(V){const tt=l.get(V);!f||tt.type!==f.type?B(tt):f&&O1(f),l.delete(V),d.delete(V)}$r(()=>[t.include,t.exclude],([V,tt])=>{V&&j(ft=>Dp(V,ft)),tt&&j(ft=>!Dp(tt,ft))},{flush:"post",deep:!0});let W=null;const H=()=>{W!=null&&l.set(W,D1(n.subTree))};return ji(H),m4(H),Dm(()=>{l.forEach(V=>{const{subTree:tt,suspense:ft}=n,et=D1(tt);if(V.type===et.type){O1(et);const Pt=et.component.da;Pt&&So(Pt,ft);return}B(V)})}),()=>{if(W=null,!e.default)return null;const V=e.default(),tt=V[0];if(V.length>1)return f=null,V;if(!nf(tt)||!(tt.shapeFlag&4)&&!(tt.shapeFlag&128))return f=null,tt;let ft=D1(tt);const et=ft.type,Pt=Fb(Id(ft)?ft.type.__asyncResolved||{}:et),{include:Rt,exclude:zt,max:jt}=t;if(Rt&&(!Pt||!Dp(Rt,Pt))||zt&&Pt&&Dp(zt,Pt))return f=ft,tt;const oe=ft.key==null?et:ft.key,ge=l.get(oe);return ft.el&&(ft=lc(ft),tt.shapeFlag&128&&(tt.ssContent=ft)),W=oe,ge?(ft.el=ge.el,ft.component=ge.component,ft.transition&&o_(ft,ft.transition),ft.shapeFlag|=512,d.delete(oe),d.add(oe)):(d.add(oe),jt&&d.size>parseInt(jt,10)&&Z(d.values().next().value)),ft.shapeFlag|=256,f=ft,a4(tt.type)?tt:ft}}},_L=gL;function Dp(t,e){return En(t)?t.some(n=>Dp(n,e)):Hi(t)?t.split(",").includes(e):t.test?t.test(e):!1}function yL(t,e){f4(t,"a",e)}function bL(t,e){f4(t,"da",e)}function f4(t,e,n=yo){const i=t.__wdc||(t.__wdc=()=>{let l=n;for(;l;){if(l.isDeactivated)return;l=l.parent}return t()});if($_(e,i,n),n){let l=n.parent;for(;l&&l.parent;)U_(l.parent.vnode)&&vL(i,e,n,l),l=l.parent}}function vL(t,e,n,i){const l=$_(e,t,i,!0);Ni(()=>{Iv(i[e],l)},n)}function O1(t){let e=t.shapeFlag;e&256&&(e-=256),e&512&&(e-=512),t.shapeFlag=e}function D1(t){return t.shapeFlag&128?t.ssContent:t}function $_(t,e,n=yo,i=!1){if(n){const l=n[t]||(n[t]=[]),d=e.__weh||(e.__weh=(...f)=>{if(n.isUnmounted)return;gf(),bu(n);const o=as(e,n,t,f);return gu(),_f(),o});return i?l.unshift(d):l.push(d),d}}const hc=t=>(e,n=yo)=>(!pm||t==="sp")&&$_(t,e,n),p4=hc("bm"),ji=hc("m"),xL=hc("bu"),m4=hc("u"),Dm=hc("bum"),Ni=hc("um"),wL=hc("sp"),EL=hc("rtg"),TL=hc("rtc");function Pb(t,e=yo){$_("ec",t,e)}function Lb(t,e){const n=jo;if(n===null)return t;const i=G_(n)||n.proxy,l=t.dirs||(t.dirs=[]);for(let d=0;d<e.length;d++){let[f,o,y,E=Xr]=e[d];Vn(f)&&(f={mounted:f,updated:f}),f.deep&&Sd(o),l.push({dir:f,instance:i,value:o,oldValue:void 0,arg:y,modifiers:E})}return t}function pl(t,e,n,i){const l=t.dirs,d=e&&e.dirs;for(let f=0;f<l.length;f++){const o=l[f];d&&(o.oldValue=d[f].value);let y=o.dir[i];y&&(gf(),as(y,n,8,[t.el,o,t,e]),_f())}}const g4="components";function ea(t,e){return CL(g4,t,!0,e)||t}const kL=Symbol();function CL(t,e,n=!0,i=!1){const l=jo||yo;if(l){const d=l.type;if(t===g4){const o=Fb(d,!1);if(o&&(o===e||o===bl(e)||o===D_(bl(e))))return d}const f=U3(l[t]||d[t],e)||U3(l.appContext[t],e);return!f&&i?d:f}}function U3(t,e){return t&&(t[e]||t[bl(e)]||t[D_(bl(e))])}function _4(t,e,n,i){let l;const d=n&&n[i];if(En(t)||Hi(t)){l=new Array(t.length);for(let f=0,o=t.length;f<o;f++)l[f]=e(t[f],f,void 0,d&&d[f])}else if(typeof t=="number"){l=new Array(t);for(let f=0;f<t;f++)l[f]=e(f+1,f,void 0,d&&d[f])}else if(Pi(t))if(t[Symbol.iterator])l=Array.from(t,(f,o)=>e(f,o,void 0,d&&d[o]));else{const f=Object.keys(t);l=new Array(f.length);for(let o=0,y=f.length;o<y;o++){const E=f[o];l[o]=e(t[E],E,o,d&&d[o])}}else l=[];return n&&(n[i]=l),l}function Ao(t,e,n={},i,l){if(jo.isCE||jo.parent&&Id(jo.parent)&&jo.parent.isCE)return ln("slot",e==="default"?null:{name:e},i&&i());let d=t[e];d&&d._c&&(d._d=!1),wn();const f=d&&y4(d(n)),o=_l(No,{key:n.key||`_${e}`},f||(i?i():[]),f&&t._===1?64:-2);return!l&&o.scopeId&&(o.slotScopeIds=[o.scopeId+"-s"]),d&&d._c&&(d._d=!0),o}function y4(t){return t.some(e=>nf(e)?!(e.type===ra||e.type===No&&!y4(e.children)):!0)?t:null}const zb=t=>t?O4(t)?G_(t)||t.proxy:zb(t.parent):null,a_=Mo(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>zb(t.parent),$root:t=>zb(t.root),$emit:t=>t.emit,$options:t=>v4(t),$forceUpdate:t=>t.f||(t.f=()=>t4(t.update)),$nextTick:t=>t.n||(t.n=B_.bind(t.proxy)),$watch:t=>fL.bind(t)}),SL={get({_:t},e){const{ctx:n,setupState:i,data:l,props:d,accessCache:f,type:o,appContext:y}=t;let E;if(e[0]!=="$"){const B=f[e];if(B!==void 0)switch(B){case 1:return i[e];case 2:return l[e];case 4:return n[e];case 3:return d[e]}else{if(i!==Xr&&pr(i,e))return f[e]=1,i[e];if(l!==Xr&&pr(l,e))return f[e]=2,l[e];if((E=t.propsOptions[0])&&pr(E,e))return f[e]=3,d[e];if(n!==Xr&&pr(n,e))return f[e]=4,n[e];Ob&&(f[e]=0)}}const C=a_[e];let A,P;if(C)return e==="$attrs"&&Ra(t,"get",e),C(t);if((A=o.__cssModules)&&(A=A[e]))return A;if(n!==Xr&&pr(n,e))return f[e]=4,n[e];if(P=y.config.globalProperties,pr(P,e))return P[e]},set({_:t},e,n){const{data:i,setupState:l,ctx:d}=t;return l!==Xr&&pr(l,e)?(l[e]=n,!0):i!==Xr&&pr(i,e)?(i[e]=n,!0):pr(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(d[e]=n,!0)},has({_:{data:t,setupState:e,accessCache:n,ctx:i,appContext:l,propsOptions:d}},f){let o;return!!n[f]||t!==Xr&&pr(t,f)||e!==Xr&&pr(e,f)||(o=d[0])&&pr(o,f)||pr(i,f)||pr(a_,f)||pr(l.config.globalProperties,f)},defineProperty(t,e,n){return n.get!=null?t._.accessCache[e]=0:pr(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}};let Ob=!0;function ML(t){const e=v4(t),n=t.proxy,i=t.ctx;Ob=!1,e.beforeCreate&&$3(e.beforeCreate,t,"bc");const{data:l,computed:d,methods:f,watch:o,provide:y,inject:E,created:C,beforeMount:A,mounted:P,beforeUpdate:B,updated:j,activated:Z,deactivated:W,beforeDestroy:H,beforeUnmount:V,destroyed:tt,unmounted:ft,render:et,renderTracked:Pt,renderTriggered:Rt,errorCaptured:zt,serverPrefetch:jt,expose:oe,inheritAttrs:ge,components:ce,directives:Ue,filters:Ae}=e;if(E&&AL(E,i,null,t.appContext.config.unwrapInjectedRef),f)for(const gn in f){const _n=f[gn];Vn(_n)&&(i[gn]=_n.bind(n))}if(l){const gn=l.call(n,n);Pi(gn)&&(t.data=ya(gn))}if(Ob=!0,d)for(const gn in d){const _n=d[gn],Gn=Vn(_n)?_n.bind(n,n):Vn(_n.get)?_n.get.bind(n,n):Ns,Jn=!Vn(_n)&&Vn(_n.set)?_n.set.bind(n):Ns,Wn=mr({get:Gn,set:Jn});Object.defineProperty(i,gn,{enumerable:!0,configurable:!0,get:()=>Wn.value,set:ur=>Wn.value=ur})}if(o)for(const gn in o)b4(o[gn],i,n,gn);if(y){const gn=Vn(y)?y.call(n):y;Reflect.ownKeys(gn).forEach(_n=>{na(_n,gn[_n])})}C&&$3(C,t,"c");function Ze(gn,_n){En(_n)?_n.forEach(Gn=>gn(Gn.bind(n))):_n&&gn(_n.bind(n))}if(Ze(p4,A),Ze(ji,P),Ze(xL,B),Ze(m4,j),Ze(yL,Z),Ze(bL,W),Ze(Pb,zt),Ze(TL,Pt),Ze(EL,Rt),Ze(Dm,V),Ze(Ni,ft),Ze(wL,jt),En(oe))if(oe.length){const gn=t.exposed||(t.exposed={});oe.forEach(_n=>{Object.defineProperty(gn,_n,{get:()=>n[_n],set:Gn=>n[_n]=Gn})})}else t.exposed||(t.exposed={});et&&t.render===Ns&&(t.render=et),ge!=null&&(t.inheritAttrs=ge),ce&&(t.components=ce),Ue&&(t.directives=Ue)}function AL(t,e,n=Ns,i=!1){En(t)&&(t=Db(t));for(const l in t){const d=t[l];let f;Pi(d)?"default"in d?f=Pr(d.from||l,d.default,!0):f=Pr(d.from||l):f=Pr(d),yi(f)&&i?Object.defineProperty(e,l,{enumerable:!0,configurable:!0,get:()=>f.value,set:o=>f.value=o}):e[l]=f}}function $3(t,e,n){as(En(t)?t.map(i=>i.bind(e.proxy)):t.bind(e.proxy),e,n)}function b4(t,e,n,i){const l=i.includes(".")?c4(n,i):()=>n[i];if(Hi(t)){const d=e[t];Vn(d)&&$r(l,d)}else if(Vn(t))$r(l,t.bind(n));else if(Pi(t))if(En(t))t.forEach(d=>b4(d,e,n,i));else{const d=Vn(t.handler)?t.handler.bind(n):e[t.handler];Vn(d)&&$r(l,d,t)}}function v4(t){const e=t.type,{mixins:n,extends:i}=e,{mixins:l,optionsCache:d,config:{optionMergeStrategies:f}}=t.appContext,o=d.get(e);let y;return o?y=o:!l.length&&!n&&!i?y=e:(y={},l.length&&l.forEach(E=>s_(y,E,f,!0)),s_(y,e,f)),d.set(e,y),y}function s_(t,e,n,i=!1){const{mixins:l,extends:d}=e;d&&s_(t,d,n,!0),l&&l.forEach(f=>s_(t,f,n,!0));for(const f in e)if(!(i&&f==="expose")){const o=IL[f]||n&&n[f];t[f]=o?o(t[f],e[f]):e[f]}return t}const IL={data:V3,props:bd,emits:bd,methods:bd,computed:bd,beforeCreate:ta,created:ta,beforeMount:ta,mounted:ta,beforeUpdate:ta,updated:ta,beforeDestroy:ta,beforeUnmount:ta,destroyed:ta,unmounted:ta,activated:ta,deactivated:ta,errorCaptured:ta,serverPrefetch:ta,components:bd,directives:bd,watch:LL,provide:V3,inject:PL};function V3(t,e){return e?t?function(){return Mo(Vn(t)?t.call(this,this):t,Vn(e)?e.call(this,this):e)}:e:t}function PL(t,e){return bd(Db(t),Db(e))}function Db(t){if(En(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function ta(t,e){return t?[...new Set([].concat(t,e))]:e}function bd(t,e){return t?Mo(Mo(Object.create(null),t),e):e}function LL(t,e){if(!t)return e;if(!e)return t;const n=Mo(Object.create(null),t);for(const i in e)n[i]=ta(t[i],e[i]);return n}function zL(t,e,n,i=!1){const l={},d={};t_(d,V_,1),t.propsDefaults=Object.create(null),x4(t,e,l,d);for(const f in t.propsOptions[0])f in l||(l[f]=void 0);n?t.props=i?l:WP(l):t.type.props?t.props=l:t.props=d,t.attrs=d}function OL(t,e,n,i){const{props:l,attrs:d,vnode:{patchFlag:f}}=t,o=kr(l),[y]=t.propsOptions;let E=!1;if((i||f>0)&&!(f&16)){if(f&8){const C=t.vnode.dynamicProps;for(let A=0;A<C.length;A++){let P=C[A];if(N_(t.emitsOptions,P))continue;const B=e[P];if(y)if(pr(d,P))B!==d[P]&&(d[P]=B,E=!0);else{const j=bl(P);l[j]=Rb(y,o,j,B,t,!1)}else B!==d[P]&&(d[P]=B,E=!0)}}}else{x4(t,e,l,d)&&(E=!0);let C;for(const A in o)(!e||!pr(e,A)&&((C=mf(A))===A||!pr(e,C)))&&(y?n&&(n[A]!==void 0||n[C]!==void 0)&&(l[A]=Rb(y,o,A,void 0,t,!0)):delete l[A]);if(d!==o)for(const A in d)(!e||!pr(e,A)&&!0)&&(delete d[A],E=!0)}E&&sc(t,"set","$attrs")}function x4(t,e,n,i){const[l,d]=t.propsOptions;let f=!1,o;if(e)for(let y in e){if(Vp(y))continue;const E=e[y];let C;l&&pr(l,C=bl(y))?!d||!d.includes(C)?n[C]=E:(o||(o={}))[C]=E:N_(t.emitsOptions,y)||(!(y in i)||E!==i[y])&&(i[y]=E,f=!0)}if(d){const y=kr(n),E=o||Xr;for(let C=0;C<d.length;C++){const A=d[C];n[A]=Rb(l,y,A,E[A],t,!pr(E,A))}}return f}function Rb(t,e,n,i,l,d){const f=t[n];if(f!=null){const o=pr(f,"default");if(o&&i===void 0){const y=f.default;if(f.type!==Function&&Vn(y)){const{propsDefaults:E}=l;n in E?i=E[n]:(bu(l),i=E[n]=y.call(null,e),gu())}else i=y}f[0]&&(d&&!o?i=!1:f[1]&&(i===""||i===mf(n))&&(i=!0))}return i}function w4(t,e,n=!1){const i=e.propsCache,l=i.get(t);if(l)return l;const d=t.props,f={},o=[];let y=!1;if(!Vn(t)){const C=A=>{y=!0;const[P,B]=w4(A,e,!0);Mo(f,P),B&&o.push(...B)};!n&&e.mixins.length&&e.mixins.forEach(C),t.extends&&C(t.extends),t.mixins&&t.mixins.forEach(C)}if(!d&&!y)return i.set(t,qh),qh;if(En(d))for(let C=0;C<d.length;C++){const A=bl(d[C]);G3(A)&&(f[A]=Xr)}else if(d)for(const C in d){const A=bl(C);if(G3(A)){const P=d[C],B=f[A]=En(P)||Vn(P)?{type:P}:P;if(B){const j=W3(Boolean,B.type),Z=W3(String,B.type);B[0]=j>-1,B[1]=Z<0||j<Z,(j>-1||pr(B,"default"))&&o.push(A)}}}const E=[f,o];return i.set(t,E),E}function G3(t){return t[0]!=="$"}function q3(t){const e=t&&t.toString().match(/^\s*function (\w+)/);return e?e[1]:t===null?"null":""}function H3(t,e){return q3(t)===q3(e)}function W3(t,e){return En(e)?e.findIndex(n=>H3(n,t)):Vn(e)&&H3(e,t)?0:-1}const E4=t=>t[0]==="_"||t==="$stable",Hv=t=>En(t)?t.map(ns):[ns(t)],DL=(t,e,n)=>{if(e._n)return e;const i=Zr((...l)=>Hv(e(...l)),n);return i._c=!1,i},T4=(t,e,n)=>{const i=t._ctx;for(const l in t){if(E4(l))continue;const d=t[l];if(Vn(d))e[l]=DL(l,d,i);else if(d!=null){const f=Hv(d);e[l]=()=>f}}},k4=(t,e)=>{const n=Hv(e);t.slots.default=()=>n},RL=(t,e)=>{if(t.vnode.shapeFlag&32){const n=e._;n?(t.slots=kr(e),t_(e,"_",n)):T4(e,t.slots={})}else t.slots={},e&&k4(t,e);t_(t.slots,V_,1)},BL=(t,e,n)=>{const{vnode:i,slots:l}=t;let d=!0,f=Xr;if(i.shapeFlag&32){const o=e._;o?n&&o===1?d=!1:(Mo(l,e),!n&&o===1&&delete l._):(d=!e.$stable,T4(e,l)),f=e}else e&&(k4(t,e),f={default:1});if(d)for(const o in l)!E4(o)&&!(o in f)&&delete l[o]};function C4(){return{app:null,config:{isNativeTag:pP,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let FL=0;function NL(t,e){return function(i,l=null){Vn(i)||(i=Object.assign({},i)),l!=null&&!Pi(l)&&(l=null);const d=C4(),f=new Set;let o=!1;const y=d.app={_uid:FL++,_component:i,_props:l,_container:null,_context:d,_instance:null,version:ez,get config(){return d.config},set config(E){},use(E,...C){return f.has(E)||(E&&Vn(E.install)?(f.add(E),E.install(y,...C)):Vn(E)&&(f.add(E),E(y,...C))),y},mixin(E){return d.mixins.includes(E)||d.mixins.push(E),y},component(E,C){return C?(d.components[E]=C,y):d.components[E]},directive(E,C){return C?(d.directives[E]=C,y):d.directives[E]},mount(E,C,A){if(!o){const P=ln(i,l);return P.appContext=d,C&&e?e(P,E):t(P,E,A),o=!0,y._container=E,E.__vue_app__=y,G_(P.component)||P.component.proxy}},unmount(){o&&(t(null,y._container),delete y._container.__vue_app__)},provide(E,C){return d.provides[E]=C,y}};return y}}function l_(t,e,n,i,l=!1){if(En(t)){t.forEach((P,B)=>l_(P,e&&(En(e)?e[B]:e),n,i,l));return}if(Id(i)&&!l)return;const d=i.shapeFlag&4?G_(i.component)||i.component.proxy:i.el,f=l?null:d,{i:o,r:y}=t,E=e&&e.r,C=o.refs===Xr?o.refs={}:o.refs,A=o.setupState;if(E!=null&&E!==y&&(Hi(E)?(C[E]=null,pr(A,E)&&(A[E]=null)):yi(E)&&(E.value=null)),Vn(y))mu(y,o,12,[f,C]);else{const P=Hi(y),B=yi(y);if(P||B){const j=()=>{if(t.f){const Z=P?C[y]:y.value;l?En(Z)&&Iv(Z,d):En(Z)?Z.includes(d)||Z.push(d):P?(C[y]=[d],pr(A,y)&&(A[y]=C[y])):(y.value=[d],t.k&&(C[t.k]=y.value))}else P?(C[y]=f,pr(A,y)&&(A[y]=f)):B&&(y.value=f,t.k&&(C[t.k]=f))};f?(j.id=-1,So(j,n)):j()}}}let Kc=!1;const a0=t=>/svg/.test(t.namespaceURI)&&t.tagName!=="foreignObject",s0=t=>t.nodeType===8;function jL(t){const{mt:e,p:n,o:{patchProp:i,createText:l,nextSibling:d,parentNode:f,remove:o,insert:y,createComment:E}}=t,C=(H,V)=>{if(!V.hasChildNodes()){n(null,H,V),r_(),V._vnode=H;return}Kc=!1,A(V.firstChild,H,null,null,null),r_(),V._vnode=H,Kc&&console.error("Hydration completed but contains mismatches.")},A=(H,V,tt,ft,et,Pt=!1)=>{const Rt=s0(H)&&H.data==="[",zt=()=>Z(H,V,tt,ft,et,Rt),{type:jt,ref:oe,shapeFlag:ge,patchFlag:ce}=V,Ue=H.nodeType;V.el=H,ce===-2&&(Pt=!1,V.dynamicChildren=null);let Ae=null;switch(jt){case fm:Ue!==3?V.children===""?(y(V.el=l(""),f(H),H),Ae=H):Ae=zt():(H.data!==V.children&&(Kc=!0,H.data=V.children),Ae=d(H));break;case ra:Ue!==8||Rt?Ae=zt():Ae=d(H);break;case Hp:if(Ue!==1&&Ue!==3)Ae=zt();else{Ae=H;const se=!V.children.length;for(let Ze=0;Ze<V.staticCount;Ze++)se&&(V.children+=Ae.nodeType===1?Ae.outerHTML:Ae.data),Ze===V.staticCount-1&&(V.anchor=Ae),Ae=d(Ae);return Ae}break;case No:Rt?Ae=j(H,V,tt,ft,et,Pt):Ae=zt();break;default:if(ge&1)Ue!==1||V.type.toLowerCase()!==H.tagName.toLowerCase()?Ae=zt():Ae=P(H,V,tt,ft,et,Pt);else if(ge&6){V.slotScopeIds=et;const se=f(H);if(e(V,se,null,tt,ft,a0(se),Pt),Ae=Rt?W(H):d(H),Ae&&s0(Ae)&&Ae.data==="teleport end"&&(Ae=d(Ae)),Id(V)){let Ze;Rt?(Ze=ln(No),Ze.anchor=Ae?Ae.previousSibling:se.lastChild):Ze=H.nodeType===3?Yr(""):ln("div"),Ze.el=H,V.component.subTree=Ze}}else ge&64?Ue!==8?Ae=zt():Ae=V.type.hydrate(H,V,tt,ft,et,Pt,t,B):ge&128&&(Ae=V.type.hydrate(H,V,tt,ft,a0(f(H)),et,Pt,t,A))}return oe!=null&&l_(oe,null,ft,V),Ae},P=(H,V,tt,ft,et,Pt)=>{Pt=Pt||!!V.dynamicChildren;const{type:Rt,props:zt,patchFlag:jt,shapeFlag:oe,dirs:ge}=V,ce=Rt==="input"&&ge||Rt==="option";if(ce||jt!==-1){if(ge&&pl(V,null,tt,"created"),zt)if(ce||!Pt||jt&48)for(const Ae in zt)(ce&&Ae.endsWith("value")||Im(Ae)&&!Vp(Ae))&&i(H,Ae,null,zt[Ae],!1,void 0,tt);else zt.onClick&&i(H,"onClick",null,zt.onClick,!1,void 0,tt);let Ue;if((Ue=zt&&zt.onVnodeBeforeMount)&&ga(Ue,tt,V),ge&&pl(V,null,tt,"beforeMount"),((Ue=zt&&zt.onVnodeMounted)||ge)&&l4(()=>{Ue&&ga(Ue,tt,V),ge&&pl(V,null,tt,"mounted")},ft),oe&16&&!(zt&&(zt.innerHTML||zt.textContent))){let Ae=B(H.firstChild,V,H,tt,ft,et,Pt);for(;Ae;){Kc=!0;const se=Ae;Ae=Ae.nextSibling,o(se)}}else oe&8&&H.textContent!==V.children&&(Kc=!0,H.textContent=V.children)}return H.nextSibling},B=(H,V,tt,ft,et,Pt,Rt)=>{Rt=Rt||!!V.dynamicChildren;const zt=V.children,jt=zt.length;for(let oe=0;oe<jt;oe++){const ge=Rt?zt[oe]:zt[oe]=ns(zt[oe]);if(H)H=A(H,ge,ft,et,Pt,Rt);else{if(ge.type===fm&&!ge.children)continue;Kc=!0,n(null,ge,tt,null,ft,et,a0(tt),Pt)}}return H},j=(H,V,tt,ft,et,Pt)=>{const{slotScopeIds:Rt}=V;Rt&&(et=et?et.concat(Rt):Rt);const zt=f(H),jt=B(d(H),V,zt,tt,ft,et,Pt);return jt&&s0(jt)&&jt.data==="]"?d(V.anchor=jt):(Kc=!0,y(V.anchor=E("]"),zt,jt),jt)},Z=(H,V,tt,ft,et,Pt)=>{if(Kc=!0,V.el=null,Pt){const jt=W(H);for(;;){const oe=d(H);if(oe&&oe!==jt)o(oe);else break}}const Rt=d(H),zt=f(H);return o(H),n(null,V,zt,Rt,tt,ft,a0(zt),et),Rt},W=H=>{let V=0;for(;H;)if(H=d(H),H&&s0(H)&&(H.data==="["&&V++,H.data==="]")){if(V===0)return d(H);V--}return H};return[C,A]}const So=l4;function UL(t){return S4(t)}function $L(t){return S4(t,jL)}function S4(t,e){const n=vP();n.__VUE__=!0;const{insert:i,remove:l,patchProp:d,createElement:f,createText:o,createComment:y,setText:E,setElementText:C,parentNode:A,nextSibling:P,setScopeId:B=Ns,cloneNode:j,insertStaticContent:Z}=t,W=(bt,vt,Jt,fe=null,be=null,Ie=null,Ge=!1,Me=null,ze=!!vt.dynamicChildren)=>{if(bt===vt)return;bt&&!ml(bt,vt)&&(fe=Te(bt),Zn(bt,be,Ie,!0),bt=null),vt.patchFlag===-2&&(ze=!1,vt.dynamicChildren=null);const{type:ve,ref:Ye,shapeFlag:Ke}=vt;switch(ve){case fm:H(bt,vt,Jt,fe);break;case ra:V(bt,vt,Jt,fe);break;case Hp:bt==null&&tt(vt,Jt,fe,Ge);break;case No:Ue(bt,vt,Jt,fe,be,Ie,Ge,Me,ze);break;default:Ke&1?Pt(bt,vt,Jt,fe,be,Ie,Ge,Me,ze):Ke&6?Ae(bt,vt,Jt,fe,be,Ie,Ge,Me,ze):(Ke&64||Ke&128)&&ve.process(bt,vt,Jt,fe,be,Ie,Ge,Me,ze,Bn)}Ye!=null&&be&&l_(Ye,bt&&bt.ref,Ie,vt||bt,!vt)},H=(bt,vt,Jt,fe)=>{if(bt==null)i(vt.el=o(vt.children),Jt,fe);else{const be=vt.el=bt.el;vt.children!==bt.children&&E(be,vt.children)}},V=(bt,vt,Jt,fe)=>{bt==null?i(vt.el=y(vt.children||""),Jt,fe):vt.el=bt.el},tt=(bt,vt,Jt,fe)=>{[bt.el,bt.anchor]=Z(bt.children,vt,Jt,fe,bt.el,bt.anchor)},ft=({el:bt,anchor:vt},Jt,fe)=>{let be;for(;bt&&bt!==vt;)be=P(bt),i(bt,Jt,fe),bt=be;i(vt,Jt,fe)},et=({el:bt,anchor:vt})=>{let Jt;for(;bt&&bt!==vt;)Jt=P(bt),l(bt),bt=Jt;l(vt)},Pt=(bt,vt,Jt,fe,be,Ie,Ge,Me,ze)=>{Ge=Ge||vt.type==="svg",bt==null?Rt(vt,Jt,fe,be,Ie,Ge,Me,ze):oe(bt,vt,be,Ie,Ge,Me,ze)},Rt=(bt,vt,Jt,fe,be,Ie,Ge,Me)=>{let ze,ve;const{type:Ye,props:Ke,shapeFlag:on,transition:vn,patchFlag:Mn,dirs:Xn}=bt;if(bt.el&&j!==void 0&&Mn===-1)ze=bt.el=j(bt.el);else{if(ze=bt.el=f(bt.type,Ie,Ke&&Ke.is,Ke),on&8?C(ze,bt.children):on&16&&jt(bt.children,ze,null,fe,be,Ie&&Ye!=="foreignObject",Ge,Me),Xn&&pl(bt,null,fe,"created"),Ke){for(const nr in Ke)nr!=="value"&&!Vp(nr)&&d(ze,nr,null,Ke[nr],Ie,bt.children,fe,be,Ce);"value"in Ke&&d(ze,"value",null,Ke.value),(ve=Ke.onVnodeBeforeMount)&&ga(ve,fe,bt)}zt(ze,bt,bt.scopeId,Ge,fe)}Xn&&pl(bt,null,fe,"beforeMount");const Yn=(!be||be&&!be.pendingBranch)&&vn&&!vn.persisted;Yn&&vn.beforeEnter(ze),i(ze,vt,Jt),((ve=Ke&&Ke.onVnodeMounted)||Yn||Xn)&&So(()=>{ve&&ga(ve,fe,bt),Yn&&vn.enter(ze),Xn&&pl(bt,null,fe,"mounted")},be)},zt=(bt,vt,Jt,fe,be)=>{if(Jt&&B(bt,Jt),fe)for(let Ie=0;Ie<fe.length;Ie++)B(bt,fe[Ie]);if(be){let Ie=be.subTree;if(vt===Ie){const Ge=be.vnode;zt(bt,Ge,Ge.scopeId,Ge.slotScopeIds,be.parent)}}},jt=(bt,vt,Jt,fe,be,Ie,Ge,Me,ze=0)=>{for(let ve=ze;ve<bt.length;ve++){const Ye=bt[ve]=Me?su(bt[ve]):ns(bt[ve]);W(null,Ye,vt,Jt,fe,be,Ie,Ge,Me)}},oe=(bt,vt,Jt,fe,be,Ie,Ge)=>{const Me=vt.el=bt.el;let{patchFlag:ze,dynamicChildren:ve,dirs:Ye}=vt;ze|=bt.patchFlag&16;const Ke=bt.props||Xr,on=vt.props||Xr;let vn;Jt&&fd(Jt,!1),(vn=on.onVnodeBeforeUpdate)&&ga(vn,Jt,vt,bt),Ye&&pl(vt,bt,Jt,"beforeUpdate"),Jt&&fd(Jt,!0);const Mn=be&&vt.type!=="foreignObject";if(ve?ge(bt.dynamicChildren,ve,Me,Jt,fe,Mn,Ie):Ge||Gn(bt,vt,Me,null,Jt,fe,Mn,Ie,!1),ze>0){if(ze&16)ce(Me,vt,Ke,on,Jt,fe,be);else if(ze&2&&Ke.class!==on.class&&d(Me,"class",null,on.class,be),ze&4&&d(Me,"style",Ke.style,on.style,be),ze&8){const Xn=vt.dynamicProps;for(let Yn=0;Yn<Xn.length;Yn++){const nr=Xn[Yn],Rr=Ke[nr],Io=on[nr];(Io!==Rr||nr==="value")&&d(Me,nr,Rr,Io,be,bt.children,Jt,fe,Ce)}}ze&1&&bt.children!==vt.children&&C(Me,vt.children)}else!Ge&&ve==null&&ce(Me,vt,Ke,on,Jt,fe,be);((vn=on.onVnodeUpdated)||Ye)&&So(()=>{vn&&ga(vn,Jt,vt,bt),Ye&&pl(vt,bt,Jt,"updated")},fe)},ge=(bt,vt,Jt,fe,be,Ie,Ge)=>{for(let Me=0;Me<vt.length;Me++){const ze=bt[Me],ve=vt[Me],Ye=ze.el&&(ze.type===No||!ml(ze,ve)||ze.shapeFlag&70)?A(ze.el):Jt;W(ze,ve,Ye,null,fe,be,Ie,Ge,!0)}},ce=(bt,vt,Jt,fe,be,Ie,Ge)=>{if(Jt!==fe){for(const Me in fe){if(Vp(Me))continue;const ze=fe[Me],ve=Jt[Me];ze!==ve&&Me!=="value"&&d(bt,Me,ve,ze,Ge,vt.children,be,Ie,Ce)}if(Jt!==Xr)for(const Me in Jt)!Vp(Me)&&!(Me in fe)&&d(bt,Me,Jt[Me],null,Ge,vt.children,be,Ie,Ce);"value"in fe&&d(bt,"value",Jt.value,fe.value)}},Ue=(bt,vt,Jt,fe,be,Ie,Ge,Me,ze)=>{const ve=vt.el=bt?bt.el:o(""),Ye=vt.anchor=bt?bt.anchor:o("");let{patchFlag:Ke,dynamicChildren:on,slotScopeIds:vn}=vt;vn&&(Me=Me?Me.concat(vn):vn),bt==null?(i(ve,Jt,fe),i(Ye,Jt,fe),jt(vt.children,Jt,Ye,be,Ie,Ge,Me,ze)):Ke>0&&Ke&64&&on&&bt.dynamicChildren?(ge(bt.dynamicChildren,on,Jt,be,Ie,Ge,Me),(vt.key!=null||be&&vt===be.subTree)&&M4(bt,vt,!0)):Gn(bt,vt,Jt,Ye,be,Ie,Ge,Me,ze)},Ae=(bt,vt,Jt,fe,be,Ie,Ge,Me,ze)=>{vt.slotScopeIds=Me,bt==null?vt.shapeFlag&512?be.ctx.activate(vt,Jt,fe,Ge,ze):se(vt,Jt,fe,be,Ie,Ge,ze):Ze(bt,vt,ze)},se=(bt,vt,Jt,fe,be,Ie,Ge)=>{const Me=bt.component=XL(bt,fe,be);if(U_(bt)&&(Me.ctx.renderer=Bn),YL(Me),Me.asyncDep){if(be&&be.registerDep(Me,gn),!bt.el){const ze=Me.subTree=ln(ra);V(null,ze,vt,Jt)}return}gn(Me,bt,vt,Jt,be,Ie,Ge)},Ze=(bt,vt,Jt)=>{const fe=vt.component=bt.component;if(sL(bt,vt,Jt))if(fe.asyncDep&&!fe.asyncResolved){_n(fe,vt,Jt);return}else fe.next=vt,eL(fe.update),fe.update();else vt.el=bt.el,fe.vnode=vt},gn=(bt,vt,Jt,fe,be,Ie,Ge)=>{const Me=()=>{if(bt.isMounted){let{next:Ye,bu:Ke,u:on,parent:vn,vnode:Mn}=bt,Xn=Ye,Yn;fd(bt,!1),Ye?(Ye.el=Mn.el,_n(bt,Ye,Ge)):Ye=Mn,Ke&&Wh(Ke),(Yn=Ye.props&&Ye.props.onVnodeBeforeUpdate)&&ga(Yn,vn,Ye,Mn),fd(bt,!0);const nr=L1(bt),Rr=bt.subTree;bt.subTree=nr,W(Rr,nr,A(Rr.el),Te(Rr),bt,be,Ie),Ye.el=nr.el,Xn===null&&Vv(bt,nr.el),on&&So(on,be),(Yn=Ye.props&&Ye.props.onVnodeUpdated)&&So(()=>ga(Yn,vn,Ye,Mn),be)}else{let Ye;const{el:Ke,props:on}=vt,{bm:vn,m:Mn,parent:Xn}=bt,Yn=Id(vt);if(fd(bt,!1),vn&&Wh(vn),!Yn&&(Ye=on&&on.onVnodeBeforeMount)&&ga(Ye,Xn,vt),fd(bt,!0),Ke&&Qe){const nr=()=>{bt.subTree=L1(bt),Qe(Ke,bt.subTree,bt,be,null)};Yn?vt.type.__asyncLoader().then(()=>!bt.isUnmounted&&nr()):nr()}else{const nr=bt.subTree=L1(bt);W(null,nr,Jt,fe,bt,be,Ie),vt.el=nr.el}if(Mn&&So(Mn,be),!Yn&&(Ye=on&&on.onVnodeMounted)){const nr=vt;So(()=>ga(Ye,Xn,nr),be)}(vt.shapeFlag&256||Xn&&Id(Xn.vnode)&&Xn.vnode.shapeFlag&256)&&bt.a&&So(bt.a,be),bt.isMounted=!0,vt=Jt=fe=null}},ze=bt.effect=new Ov(Me,()=>t4(ve),bt.scope),ve=bt.update=()=>ze.run();ve.id=bt.uid,fd(bt,!0),ve()},_n=(bt,vt,Jt)=>{vt.component=bt;const fe=bt.vnode.props;bt.vnode=vt,bt.next=null,OL(bt,vt.props,fe,Jt),BL(bt,vt.children,Jt),gf(),F_(void 0,bt.update),_f()},Gn=(bt,vt,Jt,fe,be,Ie,Ge,Me,ze=!1)=>{const ve=bt&&bt.children,Ye=bt?bt.shapeFlag:0,Ke=vt.children,{patchFlag:on,shapeFlag:vn}=vt;if(on>0){if(on&128){Wn(ve,Ke,Jt,fe,be,Ie,Ge,Me,ze);return}else if(on&256){Jn(ve,Ke,Jt,fe,be,Ie,Ge,Me,ze);return}}vn&8?(Ye&16&&Ce(ve,be,Ie),Ke!==ve&&C(Jt,Ke)):Ye&16?vn&16?Wn(ve,Ke,Jt,fe,be,Ie,Ge,Me,ze):Ce(ve,be,Ie,!0):(Ye&8&&C(Jt,""),vn&16&&jt(Ke,Jt,fe,be,Ie,Ge,Me,ze))},Jn=(bt,vt,Jt,fe,be,Ie,Ge,Me,ze)=>{bt=bt||qh,vt=vt||qh;const ve=bt.length,Ye=vt.length,Ke=Math.min(ve,Ye);let on;for(on=0;on<Ke;on++){const vn=vt[on]=ze?su(vt[on]):ns(vt[on]);W(bt[on],vn,Jt,null,be,Ie,Ge,Me,ze)}ve>Ye?Ce(bt,be,Ie,!0,!1,Ke):jt(vt,Jt,fe,be,Ie,Ge,Me,ze,Ke)},Wn=(bt,vt,Jt,fe,be,Ie,Ge,Me,ze)=>{let ve=0;const Ye=vt.length;let Ke=bt.length-1,on=Ye-1;for(;ve<=Ke&&ve<=on;){const vn=bt[ve],Mn=vt[ve]=ze?su(vt[ve]):ns(vt[ve]);if(ml(vn,Mn))W(vn,Mn,Jt,null,be,Ie,Ge,Me,ze);else break;ve++}for(;ve<=Ke&&ve<=on;){const vn=bt[Ke],Mn=vt[on]=ze?su(vt[on]):ns(vt[on]);if(ml(vn,Mn))W(vn,Mn,Jt,null,be,Ie,Ge,Me,ze);else break;Ke--,on--}if(ve>Ke){if(ve<=on){const vn=on+1,Mn=vn<Ye?vt[vn].el:fe;for(;ve<=on;)W(null,vt[ve]=ze?su(vt[ve]):ns(vt[ve]),Jt,Mn,be,Ie,Ge,Me,ze),ve++}}else if(ve>on)for(;ve<=Ke;)Zn(bt[ve],be,Ie,!0),ve++;else{const vn=ve,Mn=ve,Xn=new Map;for(ve=Mn;ve<=on;ve++){const ni=vt[ve]=ze?su(vt[ve]):ns(vt[ve]);ni.key!=null&&Xn.set(ni.key,ve)}let Yn,nr=0;const Rr=on-Mn+1;let Io=!1,Ui=0;const Zi=new Array(Rr);for(ve=0;ve<Rr;ve++)Zi[ve]=0;for(ve=vn;ve<=Ke;ve++){const ni=bt[ve];if(nr>=Rr){Zn(ni,be,Ie,!0);continue}let di;if(ni.key!=null)di=Xn.get(ni.key);else for(Yn=Mn;Yn<=on;Yn++)if(Zi[Yn-Mn]===0&&ml(ni,vt[Yn])){di=Yn;break}di===void 0?Zn(ni,be,Ie,!0):(Zi[di-Mn]=ve+1,di>=Ui?Ui=di:Io=!0,W(ni,vt[di],Jt,null,be,Ie,Ge,Me,ze),nr++)}const xo=Io?VL(Zi):qh;for(Yn=xo.length-1,ve=Rr-1;ve>=0;ve--){const ni=Mn+ve,di=vt[ni],hi=ni+1<Ye?vt[ni+1].el:fe;Zi[ve]===0?W(null,di,Jt,hi,be,Ie,Ge,Me,ze):Io&&(Yn<0||ve!==xo[Yn]?ur(di,Jt,hi,2):Yn--)}}},ur=(bt,vt,Jt,fe,be=null)=>{const{el:Ie,type:Ge,transition:Me,children:ze,shapeFlag:ve}=bt;if(ve&6){ur(bt.component.subTree,vt,Jt,fe);return}if(ve&128){bt.suspense.move(vt,Jt,fe);return}if(ve&64){Ge.move(bt,vt,Jt,Bn);return}if(Ge===No){i(Ie,vt,Jt);for(let Ke=0;Ke<ze.length;Ke++)ur(ze[Ke],vt,Jt,fe);i(bt.anchor,vt,Jt);return}if(Ge===Hp){ft(bt,vt,Jt);return}if(fe!==2&&ve&1&&Me)if(fe===0)Me.beforeEnter(Ie),i(Ie,vt,Jt),So(()=>Me.enter(Ie),be);else{const{leave:Ke,delayLeave:on,afterLeave:vn}=Me,Mn=()=>i(Ie,vt,Jt),Xn=()=>{Ke(Ie,()=>{Mn(),vn&&vn()})};on?on(Ie,Mn,Xn):Xn()}else i(Ie,vt,Jt)},Zn=(bt,vt,Jt,fe=!1,be=!1)=>{const{type:Ie,props:Ge,ref:Me,children:ze,dynamicChildren:ve,shapeFlag:Ye,patchFlag:Ke,dirs:on}=bt;if(Me!=null&&l_(Me,null,Jt,bt,!0),Ye&256){vt.ctx.deactivate(bt);return}const vn=Ye&1&&on,Mn=!Id(bt);let Xn;if(Mn&&(Xn=Ge&&Ge.onVnodeBeforeUnmount)&&ga(Xn,vt,bt),Ye&6)He(bt.component,Jt,fe);else{if(Ye&128){bt.suspense.unmount(Jt,fe);return}vn&&pl(bt,null,vt,"beforeUnmount"),Ye&64?bt.type.remove(bt,vt,Jt,be,Bn,fe):ve&&(Ie!==No||Ke>0&&Ke&64)?Ce(ve,vt,Jt,!1,!0):(Ie===No&&Ke&384||!be&&Ye&16)&&Ce(ze,vt,Jt),fe&&_r(bt)}(Mn&&(Xn=Ge&&Ge.onVnodeUnmounted)||vn)&&So(()=>{Xn&&ga(Xn,vt,bt),vn&&pl(bt,null,vt,"unmounted")},Jt)},_r=bt=>{const{type:vt,el:Jt,anchor:fe,transition:be}=bt;if(vt===No){he(Jt,fe);return}if(vt===Hp){et(bt);return}const Ie=()=>{l(Jt),be&&!be.persisted&&be.afterLeave&&be.afterLeave()};if(bt.shapeFlag&1&&be&&!be.persisted){const{leave:Ge,delayLeave:Me}=be,ze=()=>Ge(Jt,Ie);Me?Me(bt.el,Ie,ze):ze()}else Ie()},he=(bt,vt)=>{let Jt;for(;bt!==vt;)Jt=P(bt),l(bt),bt=Jt;l(vt)},He=(bt,vt,Jt)=>{const{bum:fe,scope:be,update:Ie,subTree:Ge,um:Me}=bt;fe&&Wh(fe),be.stop(),Ie&&(Ie.active=!1,Zn(Ge,bt,vt,Jt)),Me&&So(Me,vt),So(()=>{bt.isUnmounted=!0},vt),vt&&vt.pendingBranch&&!vt.isUnmounted&&bt.asyncDep&&!bt.asyncResolved&&bt.suspenseId===vt.pendingId&&(vt.deps--,vt.deps===0&&vt.resolve())},Ce=(bt,vt,Jt,fe=!1,be=!1,Ie=0)=>{for(let Ge=Ie;Ge<bt.length;Ge++)Zn(bt[Ge],vt,Jt,fe,be)},Te=bt=>bt.shapeFlag&6?Te(bt.component.subTree):bt.shapeFlag&128?bt.suspense.next():P(bt.anchor||bt.el),Qn=(bt,vt,Jt)=>{bt==null?vt._vnode&&Zn(vt._vnode,null,null,!0):W(vt._vnode||null,bt,vt,null,null,null,Jt),r_(),vt._vnode=bt},Bn={p:W,um:Zn,m:ur,r:_r,mt:se,mc:jt,pc:Gn,pbc:ge,n:Te,o:t};let Ln,Qe;return e&&([Ln,Qe]=e(Bn)),{render:Qn,hydrate:Ln,createApp:NL(Qn,Ln)}}function fd({effect:t,update:e},n){t.allowRecurse=e.allowRecurse=n}function M4(t,e,n=!1){const i=t.children,l=e.children;if(En(i)&&En(l))for(let d=0;d<i.length;d++){const f=i[d];let o=l[d];o.shapeFlag&1&&!o.dynamicChildren&&((o.patchFlag<=0||o.patchFlag===32)&&(o=l[d]=su(l[d]),o.el=f.el),n||M4(f,o))}}function VL(t){const e=t.slice(),n=[0];let i,l,d,f,o;const y=t.length;for(i=0;i<y;i++){const E=t[i];if(E!==0){if(l=n[n.length-1],t[l]<E){e[i]=l,n.push(i);continue}for(d=0,f=n.length-1;d<f;)o=d+f>>1,t[n[o]]<E?d=o+1:f=o;E<t[n[d]]&&(d>0&&(e[i]=n[d-1]),n[d]=i)}}for(d=n.length,f=n[d-1];d-- >0;)n[d]=f,f=e[f];return n}const GL=t=>t.__isTeleport,No=Symbol(void 0),fm=Symbol(void 0),ra=Symbol(void 0),Hp=Symbol(void 0),Wp=[];let os=null;function wn(t=!1){Wp.push(os=t?null:[])}function A4(){Wp.pop(),os=Wp[Wp.length-1]||null}let ef=1;function Z3(t){ef+=t}function I4(t){return t.dynamicChildren=ef>0?os||qh:null,A4(),ef>0&&os&&os.push(t),t}function $n(t,e,n,i,l,d){return I4(Ee(t,e,n,i,l,d,!0))}function _l(t,e,n,i,l){return I4(ln(t,e,n,i,l,!0))}function nf(t){return t?t.__v_isVNode===!0:!1}function ml(t,e){return t.type===e.type&&t.key===e.key}const V_="__vInternal",P4=({key:t})=>t!=null?t:null,H0=({ref:t,ref_key:e,ref_for:n})=>t!=null?Hi(t)||yi(t)||Vn(t)?{i:jo,r:t,k:e,f:!!n}:t:null;function Ee(t,e=null,n=null,i=0,l=null,d=t===No?0:1,f=!1,o=!1){const y={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&P4(e),ref:e&&H0(e),scopeId:j_,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:d,patchFlag:i,dynamicProps:l,dynamicChildren:null,appContext:null};return o?(Wv(y,n),d&128&&t.normalize(y)):n&&(y.shapeFlag|=Hi(n)?8:16),ef>0&&!f&&os&&(y.patchFlag>0||d&6)&&y.patchFlag!==32&&os.push(y),y}const ln=qL;function qL(t,e=null,n=null,i=0,l=null,d=!1){if((!t||t===kL)&&(t=ra),nf(t)){const o=lc(t,e,!0);return n&&Wv(o,n),ef>0&&!d&&os&&(o.shapeFlag&6?os[os.indexOf(t)]=o:os.push(o)),o.patchFlag|=-2,o}if(tz(t)&&(t=t.__vccOpts),e){e=L4(e);let{class:o,style:y}=e;o&&!Hi(o)&&(e.class=ts(o)),Pi(y)&&(Zk(y)&&!En(y)&&(y=Mo({},y)),e.style=hu(y))}const f=Hi(t)?1:a4(t)?128:GL(t)?64:Pi(t)?4:Vn(t)?2:0;return Ee(t,e,n,i,l,f,d,!0)}function L4(t){return t?Zk(t)||V_ in t?Mo({},t):t:null}function lc(t,e,n=!1){const{props:i,ref:l,patchFlag:d,children:f}=t,o=e?HL(i||{},e):i;return{__v_isVNode:!0,__v_skip:!0,type:t.type,props:o,key:o&&P4(o),ref:e&&e.ref?n&&l?En(l)?l.concat(H0(e)):[l,H0(e)]:H0(e):l,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:f,target:t.target,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==No?d===-1?16:d|16:d,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:t.transition,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&lc(t.ssContent),ssFallback:t.ssFallback&&lc(t.ssFallback),el:t.el,anchor:t.anchor}}function Yr(t=" ",e=0){return ln(fm,null,t,e)}function z4(t,e){const n=ln(Hp,null,t);return n.staticCount=e,n}function es(t="",e=!1){return e?(wn(),_l(ra,null,t)):ln(ra,null,t)}function ns(t){return t==null||typeof t=="boolean"?ln(ra):En(t)?ln(No,null,t.slice()):typeof t=="object"?su(t):ln(fm,null,String(t))}function su(t){return t.el===null||t.memo?t:lc(t)}function Wv(t,e){let n=0;const{shapeFlag:i}=t;if(e==null)e=null;else if(En(e))n=16;else if(typeof e=="object")if(i&65){const l=e.default;l&&(l._c&&(l._d=!1),Wv(t,l()),l._c&&(l._d=!0));return}else{n=32;const l=e._;!l&&!(V_ in e)?e._ctx=jo:l===3&&jo&&(jo.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else Vn(e)?(e={default:e,_ctx:jo},n=32):(e=String(e),i&64?(n=16,e=[Yr(e)]):n=8);t.children=e,t.shapeFlag|=n}function HL(...t){const e={};for(let n=0;n<t.length;n++){const i=t[n];for(const l in i)if(l==="class")e.class!==i.class&&(e.class=ts([e.class,i.class]));else if(l==="style")e.style=hu([e.style,i.style]);else if(Im(l)){const d=e[l],f=i[l];f&&d!==f&&!(En(d)&&d.includes(f))&&(e[l]=d?[].concat(d,f):f)}else l!==""&&(e[l]=i[l])}return e}function ga(t,e,n,i=null){as(t,e,7,[n,i])}const WL=C4();let ZL=0;function XL(t,e,n){const i=t.type,l=(e?e.appContext:t.appContext)||WL,d={uid:ZL++,vnode:t,type:i,parent:e,appContext:l,root:null,next:null,subTree:null,effect:null,update:null,scope:new Dk(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(l.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:w4(i,l),emitsOptions:o4(i,l),emit:null,emitted:null,propsDefaults:Xr,inheritAttrs:i.inheritAttrs,ctx:Xr,data:Xr,props:Xr,attrs:Xr,slots:Xr,refs:Xr,setupState:Xr,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return d.ctx={_:d},d.root=e?e.root:d,d.emit=rL.bind(null,d),t.ce&&t.ce(d),d}let yo=null;const qo=()=>yo||jo,bu=t=>{yo=t,t.scope.on()},gu=()=>{yo&&yo.scope.off(),yo=null};function O4(t){return t.vnode.shapeFlag&4}let pm=!1;function YL(t,e=!1){pm=e;const{props:n,children:i}=t.vnode,l=O4(t);zL(t,n,l,e),RL(t,i);const d=l?KL(t,e):void 0;return pm=!1,d}function KL(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=Od(new Proxy(t.ctx,SL));const{setup:i}=n;if(i){const l=t.setupContext=i.length>1?QL(t):null;bu(t),gf();const d=mu(i,t,0,[t.props,l]);if(_f(),gu(),Pv(d)){if(d.then(gu,gu),e)return d.then(f=>{Bb(t,f,e)}).catch(f=>{Lm(f,t,0)});t.asyncDep=d}else Bb(t,d,e)}else D4(t,e)}function Bb(t,e,n){Vn(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:Pi(e)&&(t.setupState=Jk(e)),D4(t,n)}let X3;function D4(t,e,n){const i=t.type;if(!t.render){if(!e&&X3&&!i.render){const l=i.template;if(l){const{isCustomElement:d,compilerOptions:f}=t.appContext.config,{delimiters:o,compilerOptions:y}=i,E=Mo(Mo({isCustomElement:d,delimiters:o},f),y);i.render=X3(l,E)}}t.render=i.render||Ns}bu(t),gf(),ML(t),_f(),gu()}function JL(t){return new Proxy(t.attrs,{get(e,n){return Ra(t,"get","$attrs"),e[n]}})}function QL(t){const e=i=>{t.exposed=i||{}};let n;return{get attrs(){return n||(n=JL(t))},slots:t.slots,emit:t.emit,expose:e}}function G_(t){if(t.exposed)return t.exposeProxy||(t.exposeProxy=new Proxy(Jk(Od(t.exposed)),{get(e,n){if(n in e)return e[n];if(n in a_)return a_[n](t)}}))}function Fb(t,e=!0){return Vn(t)?t.displayName||t.name:t.name||e&&t.__name}function tz(t){return Vn(t)&&"__vccOpts"in t}const mr=(t,e)=>JP(t,e,pm);function _et(t){const e=qo();let n=t();return gu(),Pv(n)&&(n=n.catch(i=>{throw bu(e),i})),[n,()=>bu(e)]}function Uo(t,e,n){const i=arguments.length;return i===2?Pi(e)&&!En(e)?nf(e)?ln(t,null,[e]):ln(t,e):ln(t,null,e):(i>3?n=Array.prototype.slice.call(arguments,2):i===3&&nf(n)&&(n=[n]),ln(t,e,n))}const ez="3.2.37",nz="http://www.w3.org/2000/svg",kd=typeof document!="undefined"?document:null,Y3=kd&&kd.createElement("template"),rz={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,i)=>{const l=e?kd.createElementNS(nz,t):kd.createElement(t,n?{is:n}:void 0);return t==="select"&&i&&i.multiple!=null&&l.setAttribute("multiple",i.multiple),l},createText:t=>kd.createTextNode(t),createComment:t=>kd.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>kd.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},cloneNode(t){const e=t.cloneNode(!0);return"_value"in t&&(e._value=t._value),e},insertStaticContent(t,e,n,i,l,d){const f=n?n.previousSibling:e.lastChild;if(l&&(l===d||l.nextSibling))for(;e.insertBefore(l.cloneNode(!0),n),!(l===d||!(l=l.nextSibling)););else{Y3.innerHTML=i?`<svg>${t}</svg>`:t;const o=Y3.content;if(i){const y=o.firstChild;for(;y.firstChild;)o.appendChild(y.firstChild);o.removeChild(y)}e.insertBefore(o,n)}return[f?f.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}};function iz(t,e,n){const i=t._vtc;i&&(e=(e?[e,...i]:[...i]).join(" ")),e==null?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}function oz(t,e,n){const i=t.style,l=Hi(n);if(n&&!l){for(const d in n)Nb(i,d,n[d]);if(e&&!Hi(e))for(const d in e)n[d]==null&&Nb(i,d,"")}else{const d=i.display;l?e!==n&&(i.cssText=n):e&&t.removeAttribute("style"),"_vod"in t&&(i.display=d)}}const K3=/\s*!important$/;function Nb(t,e,n){if(En(n))n.forEach(i=>Nb(t,e,i));else if(n==null&&(n=""),e.startsWith("--"))t.setProperty(e,n);else{const i=az(t,e);K3.test(n)?t.setProperty(mf(i),n.replace(K3,""),"important"):t[i]=n}}const J3=["Webkit","Moz","ms"],R1={};function az(t,e){const n=R1[e];if(n)return n;let i=bl(e);if(i!=="filter"&&i in t)return R1[e]=i;i=D_(i);for(let l=0;l<J3.length;l++){const d=J3[l]+i;if(d in t)return R1[e]=d}return e}const Q3="http://www.w3.org/1999/xlink";function sz(t,e,n,i,l){if(i&&e.startsWith("xlink:"))n==null?t.removeAttributeNS(Q3,e.slice(6,e.length)):t.setAttributeNS(Q3,e,n);else{const d=lP(e);n==null||d&&!Pk(n)?t.removeAttribute(e):t.setAttribute(e,d?"":n)}}function lz(t,e,n,i,l,d,f){if(e==="innerHTML"||e==="textContent"){i&&f(i,l,d),t[e]=n==null?"":n;return}if(e==="value"&&t.tagName!=="PROGRESS"&&!t.tagName.includes("-")){t._value=n;const y=n==null?"":n;(t.value!==y||t.tagName==="OPTION")&&(t.value=y),n==null&&t.removeAttribute(e);return}let o=!1;if(n===""||n==null){const y=typeof t[e];y==="boolean"?n=Pk(n):n==null&&y==="string"?(n="",o=!0):y==="number"&&(n=0,o=!0)}try{t[e]=n}catch{}o&&t.removeAttribute(e)}const[R4,cz]=(()=>{let t=Date.now,e=!1;if(typeof window!="undefined"){Date.now()>document.createEvent("Event").timeStamp&&(t=performance.now.bind(performance));const n=navigator.userAgent.match(/firefox\/(\d+)/i);e=!!(n&&Number(n[1])<=53)}return[t,e]})();let jb=0;const uz=Promise.resolve(),dz=()=>{jb=0},hz=()=>jb||(uz.then(dz),jb=R4());function cu(t,e,n,i){t.addEventListener(e,n,i)}function fz(t,e,n,i){t.removeEventListener(e,n,i)}function pz(t,e,n,i,l=null){const d=t._vei||(t._vei={}),f=d[e];if(i&&f)f.value=i;else{const[o,y]=mz(e);if(i){const E=d[e]=gz(i,l);cu(t,o,E,y)}else f&&(fz(t,o,f,y),d[e]=void 0)}}const t5=/(?:Once|Passive|Capture)$/;function mz(t){let e;if(t5.test(t)){e={};let n;for(;n=t.match(t5);)t=t.slice(0,t.length-n[0].length),e[n[0].toLowerCase()]=!0}return[mf(t.slice(2)),e]}function gz(t,e){const n=i=>{const l=i.timeStamp||R4();(cz||l>=n.attached-1)&&as(_z(i,n.value),e,5,[i])};return n.value=t,n.attached=hz(),n}function _z(t,e){if(En(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map(i=>l=>!l._stopped&&i&&i(l))}else return e}const e5=/^on[a-z]/,yz=(t,e,n,i,l=!1,d,f,o,y)=>{e==="class"?iz(t,i,l):e==="style"?oz(t,n,i):Im(e)?Av(e)||pz(t,e,n,i,f):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):bz(t,e,i,l))?lz(t,e,i,d,f,o,y):(e==="true-value"?t._trueValue=i:e==="false-value"&&(t._falseValue=i),sz(t,e,i,l))};function bz(t,e,n,i){return i?!!(e==="innerHTML"||e==="textContent"||e in t&&e5.test(e)&&Vn(n)):e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA"||e5.test(e)&&Hi(n)?!1:e in t}const Jc="transition",bp="animation",Zv=(t,{slots:e})=>Uo(u4,vz(t),e);Zv.displayName="Transition";const B4={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};Zv.props=Mo({},u4.props,B4);const pd=(t,e=[])=>{En(t)?t.forEach(n=>n(...e)):t&&t(...e)},n5=t=>t?En(t)?t.some(e=>e.length>1):t.length>1:!1;function vz(t){const e={};for(const ce in t)ce in B4||(e[ce]=t[ce]);if(t.css===!1)return e;const{name:n="v",type:i,duration:l,enterFromClass:d=`${n}-enter-from`,enterActiveClass:f=`${n}-enter-active`,enterToClass:o=`${n}-enter-to`,appearFromClass:y=d,appearActiveClass:E=f,appearToClass:C=o,leaveFromClass:A=`${n}-leave-from`,leaveActiveClass:P=`${n}-leave-active`,leaveToClass:B=`${n}-leave-to`}=t,j=xz(l),Z=j&&j[0],W=j&&j[1],{onBeforeEnter:H,onEnter:V,onEnterCancelled:tt,onLeave:ft,onLeaveCancelled:et,onBeforeAppear:Pt=H,onAppear:Rt=V,onAppearCancelled:zt=tt}=e,jt=(ce,Ue,Ae)=>{md(ce,Ue?C:o),md(ce,Ue?E:f),Ae&&Ae()},oe=(ce,Ue)=>{ce._isLeaving=!1,md(ce,A),md(ce,B),md(ce,P),Ue&&Ue()},ge=ce=>(Ue,Ae)=>{const se=ce?Rt:V,Ze=()=>jt(Ue,ce,Ae);pd(se,[Ue,Ze]),r5(()=>{md(Ue,ce?y:d),Qc(Ue,ce?C:o),n5(se)||i5(Ue,i,Z,Ze)})};return Mo(e,{onBeforeEnter(ce){pd(H,[ce]),Qc(ce,d),Qc(ce,f)},onBeforeAppear(ce){pd(Pt,[ce]),Qc(ce,y),Qc(ce,E)},onEnter:ge(!1),onAppear:ge(!0),onLeave(ce,Ue){ce._isLeaving=!0;const Ae=()=>oe(ce,Ue);Qc(ce,A),Tz(),Qc(ce,P),r5(()=>{!ce._isLeaving||(md(ce,A),Qc(ce,B),n5(ft)||i5(ce,i,W,Ae))}),pd(ft,[ce,Ae])},onEnterCancelled(ce){jt(ce,!1),pd(tt,[ce])},onAppearCancelled(ce){jt(ce,!0),pd(zt,[ce])},onLeaveCancelled(ce){oe(ce),pd(et,[ce])}})}function xz(t){if(t==null)return null;if(Pi(t))return[B1(t.enter),B1(t.leave)];{const e=B1(t);return[e,e]}}function B1(t){return tf(t)}function Qc(t,e){e.split(/\s+/).forEach(n=>n&&t.classList.add(n)),(t._vtc||(t._vtc=new Set)).add(e)}function md(t,e){e.split(/\s+/).forEach(i=>i&&t.classList.remove(i));const{_vtc:n}=t;n&&(n.delete(e),n.size||(t._vtc=void 0))}function r5(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let wz=0;function i5(t,e,n,i){const l=t._endId=++wz,d=()=>{l===t._endId&&i()};if(n)return setTimeout(d,n);const{type:f,timeout:o,propCount:y}=Ez(t,e);if(!f)return i();const E=f+"end";let C=0;const A=()=>{t.removeEventListener(E,P),d()},P=B=>{B.target===t&&++C>=y&&A()};setTimeout(()=>{C<y&&A()},o+1),t.addEventListener(E,P)}function Ez(t,e){const n=window.getComputedStyle(t),i=j=>(n[j]||"").split(", "),l=i(Jc+"Delay"),d=i(Jc+"Duration"),f=o5(l,d),o=i(bp+"Delay"),y=i(bp+"Duration"),E=o5(o,y);let C=null,A=0,P=0;e===Jc?f>0&&(C=Jc,A=f,P=d.length):e===bp?E>0&&(C=bp,A=E,P=y.length):(A=Math.max(f,E),C=A>0?f>E?Jc:bp:null,P=C?C===Jc?d.length:y.length:0);const B=C===Jc&&/\b(transform|all)(,|$)/.test(n[Jc+"Property"]);return{type:C,timeout:A,propCount:P,hasTransform:B}}function o5(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max(...e.map((n,i)=>a5(n)+a5(t[i])))}function a5(t){return Number(t.slice(0,-1).replace(",","."))*1e3}function Tz(){return document.body.offsetHeight}const rf=t=>{const e=t.props["onUpdate:modelValue"]||!1;return En(e)?n=>Wh(e,n):e};function kz(t){t.target.composing=!0}function s5(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const yet={created(t,{modifiers:{lazy:e,trim:n,number:i}},l){t._assign=rf(l);const d=i||l.props&&l.props.type==="number";cu(t,e?"change":"input",f=>{if(f.target.composing)return;let o=t.value;n&&(o=o.trim()),d&&(o=tf(o)),t._assign(o)}),n&&cu(t,"change",()=>{t.value=t.value.trim()}),e||(cu(t,"compositionstart",kz),cu(t,"compositionend",s5),cu(t,"change",s5))},mounted(t,{value:e}){t.value=e==null?"":e},beforeUpdate(t,{value:e,modifiers:{lazy:n,trim:i,number:l}},d){if(t._assign=rf(d),t.composing||document.activeElement===t&&t.type!=="range"&&(n||i&&t.value.trim()===e||(l||t.type==="number")&&tf(t.value)===e))return;const f=e==null?"":e;t.value!==f&&(t.value=f)}},bet={deep:!0,created(t,e,n){t._assign=rf(n),cu(t,"change",()=>{const i=t._modelValue,l=mm(t),d=t.checked,f=t._assign;if(En(i)){const o=Mv(i,l),y=o!==-1;if(d&&!y)f(i.concat(l));else if(!d&&y){const E=[...i];E.splice(o,1),f(E)}}else if(pf(i)){const o=new Set(i);d?o.add(l):o.delete(l),f(o)}else f(F4(t,d))})},mounted:l5,beforeUpdate(t,e,n){t._assign=rf(n),l5(t,e,n)}};function l5(t,{value:e,oldValue:n},i){t._modelValue=e,En(e)?t.checked=Mv(e,i.props.value)>-1:pf(e)?t.checked=e.has(i.props.value):e!==n&&(t.checked=Am(e,F4(t,!0)))}const c5={deep:!0,created(t,{value:e,modifiers:{number:n}},i){const l=pf(e);cu(t,"change",()=>{const d=Array.prototype.filter.call(t.options,f=>f.selected).map(f=>n?tf(mm(f)):mm(f));t._assign(t.multiple?l?new Set(d):d:d[0])}),t._assign=rf(i)},mounted(t,{value:e}){u5(t,e)},beforeUpdate(t,e,n){t._assign=rf(n)},updated(t,{value:e}){u5(t,e)}};function u5(t,e){const n=t.multiple;if(!(n&&!En(e)&&!pf(e))){for(let i=0,l=t.options.length;i<l;i++){const d=t.options[i],f=mm(d);if(n)En(e)?d.selected=Mv(e,f)>-1:d.selected=e.has(f);else if(Am(mm(d),e)){t.selectedIndex!==i&&(t.selectedIndex=i);return}}!n&&t.selectedIndex!==-1&&(t.selectedIndex=-1)}}function mm(t){return"_value"in t?t._value:t.value}function F4(t,e){const n=e?"_trueValue":"_falseValue";return n in t?t[n]:e}const Cz=["ctrl","shift","alt","meta"],Sz={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,e)=>Cz.some(n=>t[`${n}Key`]&&!e.includes(n))},vet=(t,e)=>(n,...i)=>{for(let l=0;l<e.length;l++){const d=Sz[e[l]];if(d&&d(n,e))return}return t(n,...i)},Mz={beforeMount(t,{value:e},{transition:n}){t._vod=t.style.display==="none"?"":t.style.display,n&&e?n.beforeEnter(t):vp(t,e)},mounted(t,{value:e},{transition:n}){n&&e&&n.enter(t)},updated(t,{value:e,oldValue:n},{transition:i}){!e!=!n&&(i?e?(i.beforeEnter(t),vp(t,!0),i.enter(t)):i.leave(t,()=>{vp(t,!1)}):vp(t,e))},beforeUnmount(t,{value:e}){vp(t,e)}};function vp(t,e){t.style.display=e?t._vod:"none"}const N4=Mo({patchProp:yz},rz);let Zp,d5=!1;function Az(){return Zp||(Zp=UL(N4))}function Iz(){return Zp=d5?Zp:$L(N4),d5=!0,Zp}const Pz=(...t)=>{const e=Az().createApp(...t),{mount:n}=e;return e.mount=i=>{const l=j4(i);if(!l)return;const d=e._component;!Vn(d)&&!d.render&&!d.template&&(d.template=l.innerHTML),l.innerHTML="";const f=n(l,!1,l instanceof SVGElement);return l instanceof Element&&(l.removeAttribute("v-cloak"),l.setAttribute("data-v-app","")),f},e},Lz=(...t)=>{const e=Iz().createApp(...t),{mount:n}=e;return e.mount=i=>{const l=j4(i);if(l)return n(l,!0,l instanceof SVGElement)},e};function j4(t){return Hi(t)?document.querySelector(t):t}const zz=/"(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])"\s*:/,Oz=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,Dz=/^["{[]|^-?[0-9][0-9.]{0,14}$/;function Rz(t,e){if(!(t==="__proto__"||t==="constructor"))return e}function Bz(t){if(typeof t!="string")return t;const e=t.toLowerCase();if(e==="true")return!0;if(e==="false")return!1;if(e==="null")return null;if(e==="nan")return NaN;if(e==="infinity")return 1/0;if(e!=="undefined"){if(!Dz.test(t))return t;try{return zz.test(t)||Oz.test(t)?JSON.parse(t,Rz):JSON.parse(t)}catch{return t}}}const Fz=/#/g,Nz=/&/g,jz=/=/g,U4=/\+/g,Uz=/%5B/gi,$z=/%5D/gi,Vz=/%5E/gi,Gz=/%60/gi,qz=/%7B/gi,Hz=/%7C/gi,Wz=/%7D/gi,Zz=/%20/gi;function Xz(t){return encodeURI(""+t).replace(Hz,"|").replace(Uz,"[").replace($z,"]")}function Ub(t){return Xz(t).replace(U4,"%2B").replace(Zz,"+").replace(Fz,"%23").replace(Nz,"%26").replace(Gz,"`").replace(qz,"{").replace(Wz,"}").replace(Vz,"^")}function F1(t){return Ub(t).replace(jz,"%3D")}function $4(t=""){try{return decodeURIComponent(""+t)}catch{return""+t}}function Yz(t){return $4(t.replace(U4," "))}function Kz(t=""){const e={};t[0]==="?"&&(t=t.substr(1));for(const n of t.split("&")){const i=n.match(/([^=]+)=?(.*)/)||[];if(i.length<2)continue;const l=$4(i[1]);if(l==="__proto__"||l==="constructor")continue;const d=Yz(i[2]||"");e[l]?Array.isArray(e[l])?e[l].push(d):e[l]=[e[l],d]:e[l]=d}return e}function Jz(t,e){return(typeof e=="number"||typeof e=="boolean")&&(e=String(e)),e?Array.isArray(e)?e.map(n=>`${F1(t)}=${Ub(n)}`).join("&"):`${F1(t)}=${Ub(e)}`:F1(t)}function Qz(t){return Object.keys(t).map(e=>Jz(e,t[e])).join("&")}const tO=/^\w+:(\/\/)?/,eO=/^\/\/[^/]+/;function V4(t,e=!1){return tO.test(t)||e&&eO.test(t)}const nO=/\/$|\/\?/;function $b(t="",e=!1){return e?nO.test(t):t.endsWith("/")}function G4(t="",e=!1){if(!e)return($b(t)?t.slice(0,-1):t)||"/";if(!$b(t,!0))return t||"/";const[n,...i]=t.split("?");return(n.slice(0,-1)||"/")+(i.length?`?${i.join("?")}`:"")}function rO(t="",e=!1){if(!e)return t.endsWith("/")?t:t+"/";if($b(t,!0))return t||"/";const[n,...i]=t.split("?");return n+"/"+(i.length?`?${i.join("?")}`:"")}function iO(t=""){return t.startsWith("/")}function oO(t=""){return(iO(t)?t.substr(1):t)||"/"}function aO(t,e){if(q4(e))return t;const n=G4(e);return t.startsWith(n)?t:Xv(n,t)}function h5(t,e){if(q4(e))return t;const n=G4(e);return t.startsWith(n)?t.substr(n.length)||"/":t}function sO(t,e){const n=H4(t),i={...Kz(n.search),...e};return n.search=Qz(i),cO(n)}function q4(t){return!t||t==="/"}function lO(t){return t&&t!=="/"}function Xv(t,...e){let n=t||"";for(const i of e.filter(lO))n=n?rO(n)+oO(i):i;return n}function H4(t="",e){if(!V4(t,!0))return e?H4(e+t):f5(t);const[n="",i,l=""]=(t.replace(/\\/g,"/").match(/([^:/]+:)?\/\/([^/@]+@)?(.*)/)||[]).splice(1),[d="",f=""]=(l.match(/([^/?#]*)(.*)?/)||[]).splice(1),{pathname:o,search:y,hash:E}=f5(f);return{protocol:n,auth:i?i.substr(0,i.length-1):"",host:d,pathname:o,search:y,hash:E}}function f5(t=""){const[e="",n="",i=""]=(t.match(/([^#?]*)(\?[^#]*)?(#.*)?/)||[]).splice(1);return{pathname:e,search:n,hash:i}}function cO(t){const e=t.pathname+(t.search?(t.search.startsWith("?")?"":"?")+t.search:"")+t.hash;return t.protocol?t.protocol+"//"+(t.auth?t.auth+"@":"")+t.host+e:e}class uO extends Error{constructor(){super(...arguments),this.name="FetchError"}}function dO(t,e,n){let i="";t&&n&&(i=`${n.status} ${n.statusText} (${t.toString()})`),e&&(i=`${e.message} (${i})`);const l=new uO(i);return Object.defineProperty(l,"request",{get(){return t}}),Object.defineProperty(l,"response",{get(){return n}}),Object.defineProperty(l,"data",{get(){return n&&n._data}}),l}const hO=new Set(Object.freeze(["PATCH","POST","PUT","DELETE"]));function p5(t="GET"){return hO.has(t.toUpperCase())}function fO(t){if(t===void 0)return!1;const e=typeof t;return e==="string"||e==="number"||e==="boolean"||e===null?!0:e!=="object"?!1:Array.isArray(t)?!0:t.constructor&&t.constructor.name==="Object"||typeof t.toJSON=="function"}const pO=new Set(["image/svg","application/xml","application/xhtml","application/html"]),mO=/^application\/(?:[\w!#$%&*`\-.^~]*\+)?json(;.+)?$/i;function gO(t=""){if(!t)return"json";const e=t.split(";").shift();return mO.test(e)?"json":pO.has(e)||e.startsWith("text/")?"text":"blob"}const _O=new Set([408,409,425,429,500,502,503,504]);function W4(t){const{fetch:e,Headers:n}=t;function i(f){if(f.options.retry!==!1){const y=typeof f.options.retry=="number"?f.options.retry:p5(f.options.method)?0:1,E=f.response&&f.response.status||500;if(y>0&&_O.has(E))return l(f.request,{...f.options,retry:y-1})}const o=dO(f.request,f.error,f.response);throw Error.captureStackTrace&&Error.captureStackTrace(o,l),o}const l=async function(o,y={}){const E={request:o,options:{...t.defaults,...y},response:void 0,error:void 0};E.options.onRequest&&await E.options.onRequest(E),typeof E.request=="string"&&(E.options.baseURL&&(E.request=aO(E.request,E.options.baseURL)),E.options.params&&(E.request=sO(E.request,E.options.params)),E.options.body&&p5(E.options.method)&&fO(E.options.body)&&(E.options.body=typeof E.options.body=="string"?E.options.body:JSON.stringify(E.options.body),E.options.headers=new n(E.options.headers),E.options.headers.has("content-type")||E.options.headers.set("content-type","application/json"),E.options.headers.has("accept")||E.options.headers.set("accept","application/json"))),E.response=await e(E.request,E.options).catch(async A=>(E.error=A,E.options.onRequestError&&await E.options.onRequestError(E),i(E)));const C=(E.options.parseResponse?"json":E.options.responseType)||gO(E.response.headers.get("content-type")||"");if(C==="json"){const A=await E.response.text(),P=E.options.parseResponse||Bz;E.response._data=P(A)}else E.response._data=await E.response[C]();return E.options.onResponse&&await E.options.onResponse(E),E.response.ok||E.options.onResponseError&&await E.options.onResponseError(E),E.response.ok?E.response:i(E)},d=function(o,y){return l(o,y).then(E=>E._data)};return d.raw=l,d.create=(f={})=>W4({...t,defaults:{...t.defaults,...f}}),d}const Z4=function(){if(typeof globalThis!="undefined")return globalThis;if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof global!="undefined")return global;throw new Error("unable to locate global object")}(),yO=Z4.fetch||(()=>Promise.reject(new Error("[ohmyfetch] global.fetch is not supported!"))),bO=Z4.Headers,vO=W4({fetch:yO,Headers:bO}),xO=()=>{var t;return((t=window==null?void 0:window.__NUXT__)==null?void 0:t.config)||{}},c_=xO().app,wO=()=>c_.baseURL,EO=()=>c_.buildAssetsDir,TO=(...t)=>Xv(kO(),EO(),...t),kO=(...t)=>{const e=c_.cdnURL||c_.baseURL;return t.length?Xv(e,...t):e};function Vb(t,e={},n){for(const i in t){const l=t[i],d=n?`${n}:${i}`:i;typeof l=="object"&&l!==null?Vb(l,e,d):typeof l=="function"&&(e[d]=l)}return e}function CO(t,e){return t.reduce((n,i)=>n.then(()=>i.apply(void 0,e)),Promise.resolve(null))}function SO(t,e){return Promise.all(t.map(n=>n.apply(void 0,e)))}class MO{constructor(){this._hooks={},this._deprecatedHooks={},this.hook=this.hook.bind(this),this.callHook=this.callHook.bind(this),this.callHookWith=this.callHookWith.bind(this)}hook(e,n){if(!e||typeof n!="function")return()=>{};const i=e;let l;for(;this._deprecatedHooks[e];){const d=this._deprecatedHooks[e];typeof d=="string"?l={to:d}:l=d,e=l.to}return l&&(l.message?console.warn(l.message):console.warn(`${i} hook has been deprecated`+(l.to?`, please use ${l.to}`:""))),this._hooks[e]=this._hooks[e]||[],this._hooks[e].push(n),()=>{n&&(this.removeHook(e,n),n=null)}}hookOnce(e,n){let i,l=(...d)=>(i(),i=null,l=null,n(...d));return i=this.hook(e,l),i}removeHook(e,n){if(this._hooks[e]){const i=this._hooks[e].indexOf(n);i!==-1&&this._hooks[e].splice(i,1),this._hooks[e].length===0&&delete this._hooks[e]}}deprecateHook(e,n){this._deprecatedHooks[e]=n}deprecateHooks(e){Object.assign(this._deprecatedHooks,e)}addHooks(e){const n=Vb(e),i=Object.keys(n).map(l=>this.hook(l,n[l]));return()=>{i.splice(0,i.length).forEach(l=>l())}}removeHooks(e){const n=Vb(e);for(const i in n)this.removeHook(i,n[i])}callHook(e,...n){return CO(this._hooks[e]||[],n)}callHookParallel(e,...n){return SO(this._hooks[e]||[],n)}callHookWith(e,n,...i){return e(this._hooks[n]||[],i)}}function AO(){return new MO}function IO(){let t=null,e=!1;const n=i=>{if(t&&t!==i)throw new Error("Context conflict")};return{use:()=>t,set:(i,l)=>{l||n(i),t=i,e=!0},unset:()=>{t=null,e=!1},call:(i,l)=>{n(i),t=i;try{return l()}finally{e||(t=null)}},async callAsync(i,l){t=i;const d=()=>{t=i},f=()=>t===i?d:void 0;_5.add(f);try{const o=l();return e||(t=null),await o}finally{_5.delete(f)}}}}function PO(){const t={};return{get(e){return t[e]||(t[e]=IO()),t[e],t[e]}}}const u_=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof global!="undefined"?global:typeof window!="undefined"?window:{},m5="__unctx__",LO=u_[m5]||(u_[m5]=PO()),zO=t=>LO.get(t),g5="__unctx_async_handlers__",_5=u_[g5]||(u_[g5]=new Set);function Rp(t,e={}){const n=function(){};n.prototype.name=t;const i={};return new Proxy(n,{get(l,d){return d==="caller"?null:d==="__createMock__"?Rp:d in e?e[d]:i[d]=i[d]||Rp(`${t}.${d.toString()}`)},apply(l,d,f){return Rp(`${t}()`)},construct(l,d,f){return Rp(`[${t}]`)},enumerate(l){return[]}})}var OO=Rp("mock");function l0(t){return console.warn(t),OO}const DO=new Set(["store","spa","fetchCounters"]),RO=new Set(["isHMR","base","payload","from","next","error","redirect","redirected","enablePreview","$preview","beforeNuxtRender","beforeSerialize"]),BO=new Set(["req","res","ssrContext"]),FO=["route","params","query"],y5={isClient:!0,isServer:!1,isDev:!1,isStatic:void 0,target:"server",modern:!1},NO=t=>{t._legacyContext=new Proxy(t,{get(e,n){if(DO.has(n))return l0(`Accessing ${n} is not supported in Nuxt 3.`);if(RO.has(n))return l0(`Accessing ${n} is not yet supported in Nuxt 3.`);if(FO.includes(n)){if(!("$router"in t))return l0("vue-router is not being used in this project.");switch(n){case"route":return e.$router.currentRoute.value;case"params":case"query":return e.$router.currentRoute.value[n]}}if(n==="$config"||n==="env")return K4();if(n in y5)return y5[n];if(!BO.has(n))return n==="ssrContext"?e._legacyContext:e.ssrContext&&n in e.ssrContext?e.ssrContext[n]:n==="nuxt"?e.payload:n==="nuxtState"?e.payload.data:n in t.vueApp?t.vueApp[n]:n in t?t[n]:l0(`Accessing ${n} is not supported in Nuxt3.`)}}),t.hook("app:created",()=>{const e=new Proxy(t.vueApp,{get(n,i){return["$root","constructor"].includes(i)?e:n[i]||t[i]}});window[`$${t.globalName}`]=e})},X4=zO("nuxt-app"),Y4="__nuxt_plugin";function jO(t){const e={provide:void 0,globalName:"nuxt",payload:ya({data:{},state:{},_errors:{},...window.__NUXT__}),isHydrating:!0,_asyncDataPromises:{},...t};e.hooks=AO(),e.hook=e.hooks.hook,e.callHook=e.hooks.callHook,e.provide=(l,d)=>{const f="$"+l;c0(e,f,d),c0(e.vueApp.config.globalProperties,f,d)},c0(e.vueApp,"$nuxt",e),c0(e.vueApp.config.globalProperties,"$nuxt",e),e.ssrContext&&(e.ssrContext.nuxt=e);const n=ya(e.payload.config),i=new Proxy(n,{get(l,d){var f;return d==="public"?l.public:(f=l[d])!=null?f:l.public[d]},set(l,d,f){return d==="public"||d==="app"?!1:(l[d]=f,l.public[d]=f,!0)}});return e.provide("config",i),e}async function UO(t,e){if(typeof e!="function")return;const{provide:n}=await Cd(t,e,[t])||{};if(n&&typeof n=="object")for(const i in n)t.provide(i,n[i])}async function $O(t,e){for(const n of e)await UO(t,n)}function VO(t){let e=!1;const n=t.map(i=>typeof i!="function"?()=>{}:GO(i)?(e=!0,l=>i(l._legacyContext,l.provide)):i);return e&&n.unshift(NO),n}function yf(t){return t[Y4]=!0,t}function GO(t){return!t[Y4]}function Cd(t,e,n){const i=()=>n?e(...n):e();return X4.set(t),i()}function ss(){const t=qo();if(!t){const e=X4.use();if(!e)throw new Error("nuxt instance unavailable");return e}return t.appContext.app.$nuxt}function K4(){return ss().$config}function c0(t,e,n){Object.defineProperty(t,e,{get:()=>n})}/*!
  * vue-router v4.0.16
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */const J4=typeof Symbol=="function"&&typeof Symbol.toStringTag=="symbol",bf=t=>J4?Symbol(t):"_vr_"+t,qO=bf("rvlm"),b5=bf("rvd"),Yv=bf("r"),Kv=bf("rl"),Gb=bf("rvl"),$h=typeof window!="undefined";function HO(t){return t.__esModule||J4&&t[Symbol.toStringTag]==="Module"}const Wr=Object.assign;function N1(t,e){const n={};for(const i in e){const l=e[i];n[i]=Array.isArray(l)?l.map(t):t(l)}return n}const Xp=()=>{},WO=/\/$/,ZO=t=>t.replace(WO,"");function j1(t,e,n="/"){let i,l={},d="",f="";const o=e.indexOf("?"),y=e.indexOf("#",o>-1?o:0);return o>-1&&(i=e.slice(0,o),d=e.slice(o+1,y>-1?y:e.length),l=t(d)),y>-1&&(i=i||e.slice(0,y),f=e.slice(y,e.length)),i=JO(i!=null?i:e,n),{fullPath:i+(d&&"?")+d+f,path:i,query:l,hash:f}}function XO(t,e){const n=e.query?t(e.query):"";return e.path+(n&&"?")+n+(e.hash||"")}function v5(t,e){return!e||!t.toLowerCase().startsWith(e.toLowerCase())?t:t.slice(e.length)||"/"}function YO(t,e,n){const i=e.matched.length-1,l=n.matched.length-1;return i>-1&&i===l&&of(e.matched[i],n.matched[l])&&Q4(e.params,n.params)&&t(e.query)===t(n.query)&&e.hash===n.hash}function of(t,e){return(t.aliasOf||t)===(e.aliasOf||e)}function Q4(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(!KO(t[n],e[n]))return!1;return!0}function KO(t,e){return Array.isArray(t)?x5(t,e):Array.isArray(e)?x5(e,t):t===e}function x5(t,e){return Array.isArray(e)?t.length===e.length&&t.every((n,i)=>n===e[i]):t.length===1&&t[0]===e}function JO(t,e){if(t.startsWith("/"))return t;if(!t)return e;const n=e.split("/"),i=t.split("/");let l=n.length-1,d,f;for(d=0;d<i.length;d++)if(f=i[d],!(l===1||f==="."))if(f==="..")l--;else break;return n.slice(0,l).join("/")+"/"+i.slice(d-(d===i.length?1:0)).join("/")}var gm;(function(t){t.pop="pop",t.push="push"})(gm||(gm={}));var Yp;(function(t){t.back="back",t.forward="forward",t.unknown=""})(Yp||(Yp={}));function QO(t){if(!t)if($h){const e=document.querySelector("base");t=e&&e.getAttribute("href")||"/",t=t.replace(/^\w+:\/\/[^\/]+/,"")}else t="/";return t[0]!=="/"&&t[0]!=="#"&&(t="/"+t),ZO(t)}const tD=/^[^#]+#/;function eD(t,e){return t.replace(tD,"#")+e}function nD(t,e){const n=document.documentElement.getBoundingClientRect(),i=t.getBoundingClientRect();return{behavior:e.behavior,left:i.left-n.left-(e.left||0),top:i.top-n.top-(e.top||0)}}const q_=()=>({left:window.pageXOffset,top:window.pageYOffset});function rD(t){let e;if("el"in t){const n=t.el,i=typeof n=="string"&&n.startsWith("#"),l=typeof n=="string"?i?document.getElementById(n.slice(1)):document.querySelector(n):n;if(!l)return;e=nD(l,t)}else e=t;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.pageXOffset,e.top!=null?e.top:window.pageYOffset)}function w5(t,e){return(history.state?history.state.position-e:-1)+t}const qb=new Map;function iD(t,e){qb.set(t,e)}function oD(t){const e=qb.get(t);return qb.delete(t),e}let aD=()=>location.protocol+"//"+location.host;function tC(t,e){const{pathname:n,search:i,hash:l}=e,d=t.indexOf("#");if(d>-1){let o=l.includes(t.slice(d))?t.slice(d).length:1,y=l.slice(o);return y[0]!=="/"&&(y="/"+y),v5(y,"")}return v5(n,t)+i+l}function sD(t,e,n,i){let l=[],d=[],f=null;const o=({state:P})=>{const B=tC(t,location),j=n.value,Z=e.value;let W=0;if(P){if(n.value=B,e.value=P,f&&f===j){f=null;return}W=Z?P.position-Z.position:0}else i(B);l.forEach(H=>{H(n.value,j,{delta:W,type:gm.pop,direction:W?W>0?Yp.forward:Yp.back:Yp.unknown})})};function y(){f=n.value}function E(P){l.push(P);const B=()=>{const j=l.indexOf(P);j>-1&&l.splice(j,1)};return d.push(B),B}function C(){const{history:P}=window;!P.state||P.replaceState(Wr({},P.state,{scroll:q_()}),"")}function A(){for(const P of d)P();d=[],window.removeEventListener("popstate",o),window.removeEventListener("beforeunload",C)}return window.addEventListener("popstate",o),window.addEventListener("beforeunload",C),{pauseListeners:y,listen:E,destroy:A}}function E5(t,e,n,i=!1,l=!1){return{back:t,current:e,forward:n,replaced:i,position:window.history.length,scroll:l?q_():null}}function lD(t){const{history:e,location:n}=window,i={value:tC(t,n)},l={value:e.state};l.value||d(i.value,{back:null,current:i.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function d(y,E,C){const A=t.indexOf("#"),P=A>-1?(n.host&&document.querySelector("base")?t:t.slice(A))+y:aD()+t+y;try{e[C?"replaceState":"pushState"](E,"",P),l.value=E}catch(B){console.error(B),n[C?"replace":"assign"](P)}}function f(y,E){const C=Wr({},e.state,E5(l.value.back,y,l.value.forward,!0),E,{position:l.value.position});d(y,C,!0),i.value=y}function o(y,E){const C=Wr({},l.value,e.state,{forward:y,scroll:q_()});d(C.current,C,!0);const A=Wr({},E5(i.value,y,null),{position:C.position+1},E);d(y,A,!1),i.value=y}return{location:i,state:l,push:o,replace:f}}function cD(t){t=QO(t);const e=lD(t),n=sD(t,e.state,e.location,e.replace);function i(d,f=!0){f||n.pauseListeners(),history.go(d)}const l=Wr({location:"",base:t,go:i,createHref:eD.bind(null,t)},e,n);return Object.defineProperty(l,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(l,"state",{enumerable:!0,get:()=>e.state.value}),l}function uD(t){return typeof t=="string"||t&&typeof t=="object"}function eC(t){return typeof t=="string"||typeof t=="symbol"}const tu={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},nC=bf("nf");var T5;(function(t){t[t.aborted=4]="aborted",t[t.cancelled=8]="cancelled",t[t.duplicated=16]="duplicated"})(T5||(T5={}));function af(t,e){return Wr(new Error,{type:t,[nC]:!0},e)}function eu(t,e){return t instanceof Error&&nC in t&&(e==null||!!(t.type&e))}const k5="[^/]+?",dD={sensitive:!1,strict:!1,start:!0,end:!0},hD=/[.+*?^${}()[\]/\\]/g;function fD(t,e){const n=Wr({},dD,e),i=[];let l=n.start?"^":"";const d=[];for(const E of t){const C=E.length?[]:[90];n.strict&&!E.length&&(l+="/");for(let A=0;A<E.length;A++){const P=E[A];let B=40+(n.sensitive?.25:0);if(P.type===0)A||(l+="/"),l+=P.value.replace(hD,"\\$&"),B+=40;else if(P.type===1){const{value:j,repeatable:Z,optional:W,regexp:H}=P;d.push({name:j,repeatable:Z,optional:W});const V=H||k5;if(V!==k5){B+=10;try{new RegExp(`(${V})`)}catch(ft){throw new Error(`Invalid custom RegExp for param "${j}" (${V}): `+ft.message)}}let tt=Z?`((?:${V})(?:/(?:${V}))*)`:`(${V})`;A||(tt=W&&E.length<2?`(?:/${tt})`:"/"+tt),W&&(tt+="?"),l+=tt,B+=20,W&&(B+=-8),Z&&(B+=-20),V===".*"&&(B+=-50)}C.push(B)}i.push(C)}if(n.strict&&n.end){const E=i.length-1;i[E][i[E].length-1]+=.7000000000000001}n.strict||(l+="/?"),n.end?l+="$":n.strict&&(l+="(?:/|$)");const f=new RegExp(l,n.sensitive?"":"i");function o(E){const C=E.match(f),A={};if(!C)return null;for(let P=1;P<C.length;P++){const B=C[P]||"",j=d[P-1];A[j.name]=B&&j.repeatable?B.split("/"):B}return A}function y(E){let C="",A=!1;for(const P of t){(!A||!C.endsWith("/"))&&(C+="/"),A=!1;for(const B of P)if(B.type===0)C+=B.value;else if(B.type===1){const{value:j,repeatable:Z,optional:W}=B,H=j in E?E[j]:"";if(Array.isArray(H)&&!Z)throw new Error(`Provided param "${j}" is an array but it is not repeatable (* or + modifiers)`);const V=Array.isArray(H)?H.join("/"):H;if(!V)if(W)P.length<2&&t.length>1&&(C.endsWith("/")?C=C.slice(0,-1):A=!0);else throw new Error(`Missing required param "${j}"`);C+=V}}return C}return{re:f,score:i,keys:d,parse:o,stringify:y}}function pD(t,e){let n=0;for(;n<t.length&&n<e.length;){const i=e[n]-t[n];if(i)return i;n++}return t.length<e.length?t.length===1&&t[0]===40+40?-1:1:t.length>e.length?e.length===1&&e[0]===40+40?1:-1:0}function mD(t,e){let n=0;const i=t.score,l=e.score;for(;n<i.length&&n<l.length;){const d=pD(i[n],l[n]);if(d)return d;n++}if(Math.abs(l.length-i.length)===1){if(C5(i))return 1;if(C5(l))return-1}return l.length-i.length}function C5(t){const e=t[t.length-1];return t.length>0&&e[e.length-1]<0}const gD={type:0,value:""},_D=/[a-zA-Z0-9_]/;function yD(t){if(!t)return[[]];if(t==="/")return[[gD]];if(!t.startsWith("/"))throw new Error(`Invalid path "${t}"`);function e(B){throw new Error(`ERR (${n})/"${E}": ${B}`)}let n=0,i=n;const l=[];let d;function f(){d&&l.push(d),d=[]}let o=0,y,E="",C="";function A(){!E||(n===0?d.push({type:0,value:E}):n===1||n===2||n===3?(d.length>1&&(y==="*"||y==="+")&&e(`A repeatable param (${E}) must be alone in its segment. eg: '/:ids+.`),d.push({type:1,value:E,regexp:C,repeatable:y==="*"||y==="+",optional:y==="*"||y==="?"})):e("Invalid state to consume buffer"),E="")}function P(){E+=y}for(;o<t.length;){if(y=t[o++],y==="\\"&&n!==2){i=n,n=4;continue}switch(n){case 0:y==="/"?(E&&A(),f()):y===":"?(A(),n=1):P();break;case 4:P(),n=i;break;case 1:y==="("?n=2:_D.test(y)?P():(A(),n=0,y!=="*"&&y!=="?"&&y!=="+"&&o--);break;case 2:y===")"?C[C.length-1]=="\\"?C=C.slice(0,-1)+y:n=3:C+=y;break;case 3:A(),n=0,y!=="*"&&y!=="?"&&y!=="+"&&o--,C="";break;default:e("Unknown state");break}}return n===2&&e(`Unfinished custom RegExp for param "${E}"`),A(),f(),l}function bD(t,e,n){const i=fD(yD(t.path),n),l=Wr(i,{record:t,parent:e,children:[],alias:[]});return e&&!l.record.aliasOf==!e.record.aliasOf&&e.children.push(l),l}function vD(t,e){const n=[],i=new Map;e=M5({strict:!1,end:!0,sensitive:!1},e);function l(C){return i.get(C)}function d(C,A,P){const B=!P,j=wD(C);j.aliasOf=P&&P.record;const Z=M5(e,C),W=[j];if("alias"in C){const tt=typeof C.alias=="string"?[C.alias]:C.alias;for(const ft of tt)W.push(Wr({},j,{components:P?P.record.components:j.components,path:ft,aliasOf:P?P.record:j}))}let H,V;for(const tt of W){const{path:ft}=tt;if(A&&ft[0]!=="/"){const et=A.record.path,Pt=et[et.length-1]==="/"?"":"/";tt.path=A.record.path+(ft&&Pt+ft)}if(H=bD(tt,A,Z),P?P.alias.push(H):(V=V||H,V!==H&&V.alias.push(H),B&&C.name&&!S5(H)&&f(C.name)),"children"in j){const et=j.children;for(let Pt=0;Pt<et.length;Pt++)d(et[Pt],H,P&&P.children[Pt])}P=P||H,y(H)}return V?()=>{f(V)}:Xp}function f(C){if(eC(C)){const A=i.get(C);A&&(i.delete(C),n.splice(n.indexOf(A),1),A.children.forEach(f),A.alias.forEach(f))}else{const A=n.indexOf(C);A>-1&&(n.splice(A,1),C.record.name&&i.delete(C.record.name),C.children.forEach(f),C.alias.forEach(f))}}function o(){return n}function y(C){let A=0;for(;A<n.length&&mD(C,n[A])>=0&&(C.record.path!==n[A].record.path||!rC(C,n[A]));)A++;n.splice(A,0,C),C.record.name&&!S5(C)&&i.set(C.record.name,C)}function E(C,A){let P,B={},j,Z;if("name"in C&&C.name){if(P=i.get(C.name),!P)throw af(1,{location:C});Z=P.record.name,B=Wr(xD(A.params,P.keys.filter(V=>!V.optional).map(V=>V.name)),C.params),j=P.stringify(B)}else if("path"in C)j=C.path,P=n.find(V=>V.re.test(j)),P&&(B=P.parse(j),Z=P.record.name);else{if(P=A.name?i.get(A.name):n.find(V=>V.re.test(A.path)),!P)throw af(1,{location:C,currentLocation:A});Z=P.record.name,B=Wr({},A.params,C.params),j=P.stringify(B)}const W=[];let H=P;for(;H;)W.unshift(H.record),H=H.parent;return{name:Z,path:j,params:B,matched:W,meta:TD(W)}}return t.forEach(C=>d(C)),{addRoute:d,resolve:E,removeRoute:f,getRoutes:o,getRecordMatcher:l}}function xD(t,e){const n={};for(const i of e)i in t&&(n[i]=t[i]);return n}function wD(t){return{path:t.path,redirect:t.redirect,name:t.name,meta:t.meta||{},aliasOf:void 0,beforeEnter:t.beforeEnter,props:ED(t),children:t.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in t?t.components||{}:{default:t.component}}}function ED(t){const e={},n=t.props||!1;if("component"in t)e.default=n;else for(const i in t.components)e[i]=typeof n=="boolean"?n:n[i];return e}function S5(t){for(;t;){if(t.record.aliasOf)return!0;t=t.parent}return!1}function TD(t){return t.reduce((e,n)=>Wr(e,n.meta),{})}function M5(t,e){const n={};for(const i in t)n[i]=i in e?e[i]:t[i];return n}function rC(t,e){return e.children.some(n=>n===t||rC(t,n))}const iC=/#/g,kD=/&/g,CD=/\//g,SD=/=/g,MD=/\?/g,oC=/\+/g,AD=/%5B/g,ID=/%5D/g,aC=/%5E/g,PD=/%60/g,sC=/%7B/g,LD=/%7C/g,lC=/%7D/g,zD=/%20/g;function Jv(t){return encodeURI(""+t).replace(LD,"|").replace(AD,"[").replace(ID,"]")}function OD(t){return Jv(t).replace(sC,"{").replace(lC,"}").replace(aC,"^")}function Hb(t){return Jv(t).replace(oC,"%2B").replace(zD,"+").replace(iC,"%23").replace(kD,"%26").replace(PD,"`").replace(sC,"{").replace(lC,"}").replace(aC,"^")}function DD(t){return Hb(t).replace(SD,"%3D")}function RD(t){return Jv(t).replace(iC,"%23").replace(MD,"%3F")}function BD(t){return t==null?"":RD(t).replace(CD,"%2F")}function d_(t){try{return decodeURIComponent(""+t)}catch{}return""+t}function FD(t){const e={};if(t===""||t==="?")return e;const i=(t[0]==="?"?t.slice(1):t).split("&");for(let l=0;l<i.length;++l){const d=i[l].replace(oC," "),f=d.indexOf("="),o=d_(f<0?d:d.slice(0,f)),y=f<0?null:d_(d.slice(f+1));if(o in e){let E=e[o];Array.isArray(E)||(E=e[o]=[E]),E.push(y)}else e[o]=y}return e}function A5(t){let e="";for(let n in t){const i=t[n];if(n=DD(n),i==null){i!==void 0&&(e+=(e.length?"&":"")+n);continue}(Array.isArray(i)?i.map(d=>d&&Hb(d)):[i&&Hb(i)]).forEach(d=>{d!==void 0&&(e+=(e.length?"&":"")+n,d!=null&&(e+="="+d))})}return e}function ND(t){const e={};for(const n in t){const i=t[n];i!==void 0&&(e[n]=Array.isArray(i)?i.map(l=>l==null?null:""+l):i==null?i:""+i)}return e}function xp(){let t=[];function e(i){return t.push(i),()=>{const l=t.indexOf(i);l>-1&&t.splice(l,1)}}function n(){t=[]}return{add:e,list:()=>t,reset:n}}function lu(t,e,n,i,l){const d=i&&(i.enterCallbacks[l]=i.enterCallbacks[l]||[]);return()=>new Promise((f,o)=>{const y=A=>{A===!1?o(af(4,{from:n,to:e})):A instanceof Error?o(A):uD(A)?o(af(2,{from:e,to:A})):(d&&i.enterCallbacks[l]===d&&typeof A=="function"&&d.push(A),f())},E=t.call(i&&i.instances[l],e,n,y);let C=Promise.resolve(E);t.length<3&&(C=C.then(y)),C.catch(A=>o(A))})}function U1(t,e,n,i){const l=[];for(const d of t)for(const f in d.components){let o=d.components[f];if(!(e!=="beforeRouteEnter"&&!d.instances[f]))if(jD(o)){const E=(o.__vccOpts||o)[e];E&&l.push(lu(E,n,i,d,f))}else{let y=o();l.push(()=>y.then(E=>{if(!E)return Promise.reject(new Error(`Couldn't resolve component "${f}" at "${d.path}"`));const C=HO(E)?E.default:E;d.components[f]=C;const P=(C.__vccOpts||C)[e];return P&&lu(P,n,i,d,f)()}))}}return l}function jD(t){return typeof t=="object"||"displayName"in t||"props"in t||"__vccOpts"in t}function I5(t){const e=Pr(Yv),n=Pr(Kv),i=mr(()=>e.resolve(Zh(t.to))),l=mr(()=>{const{matched:y}=i.value,{length:E}=y,C=y[E-1],A=n.matched;if(!C||!A.length)return-1;const P=A.findIndex(of.bind(null,C));if(P>-1)return P;const B=P5(y[E-2]);return E>1&&P5(C)===B&&A[A.length-1].path!==B?A.findIndex(of.bind(null,y[E-2])):P}),d=mr(()=>l.value>-1&&GD(n.params,i.value.params)),f=mr(()=>l.value>-1&&l.value===n.matched.length-1&&Q4(n.params,i.value.params));function o(y={}){return VD(y)?e[Zh(t.replace)?"replace":"push"](Zh(t.to)).catch(Xp):Promise.resolve()}return{route:i,href:mr(()=>i.value.href),isActive:d,isExactActive:f,navigate:o}}const UD=gr({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:I5,setup(t,{slots:e}){const n=ya(I5(t)),{options:i}=Pr(Yv),l=mr(()=>({[L5(t.activeClass,i.linkActiveClass,"router-link-active")]:n.isActive,[L5(t.exactActiveClass,i.linkExactActiveClass,"router-link-exact-active")]:n.isExactActive}));return()=>{const d=e.default&&e.default(n);return t.custom?d:Uo("a",{"aria-current":n.isExactActive?t.ariaCurrentValue:null,href:n.href,onClick:n.navigate,class:l.value},d)}}}),$D=UD;function VD(t){if(!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)&&!t.defaultPrevented&&!(t.button!==void 0&&t.button!==0)){if(t.currentTarget&&t.currentTarget.getAttribute){const e=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return t.preventDefault&&t.preventDefault(),!0}}function GD(t,e){for(const n in e){const i=e[n],l=t[n];if(typeof i=="string"){if(i!==l)return!1}else if(!Array.isArray(l)||l.length!==i.length||i.some((d,f)=>d!==l[f]))return!1}return!0}function P5(t){return t?t.aliasOf?t.aliasOf.path:t.path:""}const L5=(t,e,n)=>t!=null?t:e!=null?e:n,qD=gr({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(t,{attrs:e,slots:n}){const i=Pr(Gb),l=mr(()=>t.route||i.value),d=Pr(b5,0),f=mr(()=>l.value.matched[d]);na(b5,d+1),na(qO,f),na(Gb,l);const o=so();return $r(()=>[o.value,f.value,t.name],([y,E,C],[A,P,B])=>{E&&(E.instances[C]=y,P&&P!==E&&y&&y===A&&(E.leaveGuards.size||(E.leaveGuards=P.leaveGuards),E.updateGuards.size||(E.updateGuards=P.updateGuards))),y&&E&&(!P||!of(E,P)||!A)&&(E.enterCallbacks[C]||[]).forEach(j=>j(y))},{flush:"post"}),()=>{const y=l.value,E=f.value,C=E&&E.components[t.name],A=t.name;if(!C)return z5(n.default,{Component:C,route:y});const P=E.props[t.name],B=P?P===!0?y.params:typeof P=="function"?P(y):P:null,Z=Uo(C,Wr({},B,e,{onVnodeUnmounted:W=>{W.component.isUnmounted&&(E.instances[A]=null)},ref:o}));return z5(n.default,{Component:Z,route:y})||Z}}});function z5(t,e){if(!t)return null;const n=t(e);return n.length===1?n[0]:n}const cC=qD;function HD(t){const e=vD(t.routes,t),n=t.parseQuery||FD,i=t.stringifyQuery||A5,l=t.history,d=xp(),f=xp(),o=xp(),y=e_(tu);let E=tu;$h&&t.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const C=N1.bind(null,he=>""+he),A=N1.bind(null,BD),P=N1.bind(null,d_);function B(he,He){let Ce,Te;return eC(he)?(Ce=e.getRecordMatcher(he),Te=He):Te=he,e.addRoute(Te,Ce)}function j(he){const He=e.getRecordMatcher(he);He&&e.removeRoute(He)}function Z(){return e.getRoutes().map(he=>he.record)}function W(he){return!!e.getRecordMatcher(he)}function H(he,He){if(He=Wr({},He||y.value),typeof he=="string"){const Qe=j1(n,he,He.path),bt=e.resolve({path:Qe.path},He),vt=l.createHref(Qe.fullPath);return Wr(Qe,bt,{params:P(bt.params),hash:d_(Qe.hash),redirectedFrom:void 0,href:vt})}let Ce;if("path"in he)Ce=Wr({},he,{path:j1(n,he.path,He.path).path});else{const Qe=Wr({},he.params);for(const bt in Qe)Qe[bt]==null&&delete Qe[bt];Ce=Wr({},he,{params:A(he.params)}),He.params=A(He.params)}const Te=e.resolve(Ce,He),Qn=he.hash||"";Te.params=C(P(Te.params));const Bn=XO(i,Wr({},he,{hash:OD(Qn),path:Te.path})),Ln=l.createHref(Bn);return Wr({fullPath:Bn,hash:Qn,query:i===A5?ND(he.query):he.query||{}},Te,{redirectedFrom:void 0,href:Ln})}function V(he){return typeof he=="string"?j1(n,he,y.value.path):Wr({},he)}function tt(he,He){if(E!==he)return af(8,{from:He,to:he})}function ft(he){return Rt(he)}function et(he){return ft(Wr(V(he),{replace:!0}))}function Pt(he){const He=he.matched[he.matched.length-1];if(He&&He.redirect){const{redirect:Ce}=He;let Te=typeof Ce=="function"?Ce(he):Ce;return typeof Te=="string"&&(Te=Te.includes("?")||Te.includes("#")?Te=V(Te):{path:Te},Te.params={}),Wr({query:he.query,hash:he.hash,params:he.params},Te)}}function Rt(he,He){const Ce=E=H(he),Te=y.value,Qn=he.state,Bn=he.force,Ln=he.replace===!0,Qe=Pt(Ce);if(Qe)return Rt(Wr(V(Qe),{state:Qn,force:Bn,replace:Ln}),He||Ce);const bt=Ce;bt.redirectedFrom=He;let vt;return!Bn&&YO(i,Te,Ce)&&(vt=af(16,{to:bt,from:Te}),Jn(Te,Te,!0,!1)),(vt?Promise.resolve(vt):jt(bt,Te)).catch(Jt=>eu(Jt)?eu(Jt,2)?Jt:Gn(Jt):gn(Jt,bt,Te)).then(Jt=>{if(Jt){if(eu(Jt,2))return Rt(Wr(V(Jt.to),{state:Qn,force:Bn,replace:Ln}),He||bt)}else Jt=ge(bt,Te,!0,Ln,Qn);return oe(bt,Te,Jt),Jt})}function zt(he,He){const Ce=tt(he,He);return Ce?Promise.reject(Ce):Promise.resolve()}function jt(he,He){let Ce;const[Te,Qn,Bn]=WD(he,He);Ce=U1(Te.reverse(),"beforeRouteLeave",he,He);for(const Qe of Te)Qe.leaveGuards.forEach(bt=>{Ce.push(lu(bt,he,He))});const Ln=zt.bind(null,he,He);return Ce.push(Ln),Dh(Ce).then(()=>{Ce=[];for(const Qe of d.list())Ce.push(lu(Qe,he,He));return Ce.push(Ln),Dh(Ce)}).then(()=>{Ce=U1(Qn,"beforeRouteUpdate",he,He);for(const Qe of Qn)Qe.updateGuards.forEach(bt=>{Ce.push(lu(bt,he,He))});return Ce.push(Ln),Dh(Ce)}).then(()=>{Ce=[];for(const Qe of he.matched)if(Qe.beforeEnter&&!He.matched.includes(Qe))if(Array.isArray(Qe.beforeEnter))for(const bt of Qe.beforeEnter)Ce.push(lu(bt,he,He));else Ce.push(lu(Qe.beforeEnter,he,He));return Ce.push(Ln),Dh(Ce)}).then(()=>(he.matched.forEach(Qe=>Qe.enterCallbacks={}),Ce=U1(Bn,"beforeRouteEnter",he,He),Ce.push(Ln),Dh(Ce))).then(()=>{Ce=[];for(const Qe of f.list())Ce.push(lu(Qe,he,He));return Ce.push(Ln),Dh(Ce)}).catch(Qe=>eu(Qe,8)?Qe:Promise.reject(Qe))}function oe(he,He,Ce){for(const Te of o.list())Te(he,He,Ce)}function ge(he,He,Ce,Te,Qn){const Bn=tt(he,He);if(Bn)return Bn;const Ln=He===tu,Qe=$h?history.state:{};Ce&&(Te||Ln?l.replace(he.fullPath,Wr({scroll:Ln&&Qe&&Qe.scroll},Qn)):l.push(he.fullPath,Qn)),y.value=he,Jn(he,He,Ce,Ln),Gn()}let ce;function Ue(){ce||(ce=l.listen((he,He,Ce)=>{const Te=H(he),Qn=Pt(Te);if(Qn){Rt(Wr(Qn,{replace:!0}),Te).catch(Xp);return}E=Te;const Bn=y.value;$h&&iD(w5(Bn.fullPath,Ce.delta),q_()),jt(Te,Bn).catch(Ln=>eu(Ln,12)?Ln:eu(Ln,2)?(Rt(Ln.to,Te).then(Qe=>{eu(Qe,20)&&!Ce.delta&&Ce.type===gm.pop&&l.go(-1,!1)}).catch(Xp),Promise.reject()):(Ce.delta&&l.go(-Ce.delta,!1),gn(Ln,Te,Bn))).then(Ln=>{Ln=Ln||ge(Te,Bn,!1),Ln&&(Ce.delta?l.go(-Ce.delta,!1):Ce.type===gm.pop&&eu(Ln,20)&&l.go(-1,!1)),oe(Te,Bn,Ln)}).catch(Xp)}))}let Ae=xp(),se=xp(),Ze;function gn(he,He,Ce){Gn(he);const Te=se.list();return Te.length?Te.forEach(Qn=>Qn(he,He,Ce)):console.error(he),Promise.reject(he)}function _n(){return Ze&&y.value!==tu?Promise.resolve():new Promise((he,He)=>{Ae.add([he,He])})}function Gn(he){return Ze||(Ze=!he,Ue(),Ae.list().forEach(([He,Ce])=>he?Ce(he):He()),Ae.reset()),he}function Jn(he,He,Ce,Te){const{scrollBehavior:Qn}=t;if(!$h||!Qn)return Promise.resolve();const Bn=!Ce&&oD(w5(he.fullPath,0))||(Te||!Ce)&&history.state&&history.state.scroll||null;return B_().then(()=>Qn(he,He,Bn)).then(Ln=>Ln&&rD(Ln)).catch(Ln=>gn(Ln,he,He))}const Wn=he=>l.go(he);let ur;const Zn=new Set;return{currentRoute:y,addRoute:B,removeRoute:j,hasRoute:W,getRoutes:Z,resolve:H,options:t,push:ft,replace:et,go:Wn,back:()=>Wn(-1),forward:()=>Wn(1),beforeEach:d.add,beforeResolve:f.add,afterEach:o.add,onError:se.add,isReady:_n,install(he){const He=this;he.component("RouterLink",$D),he.component("RouterView",cC),he.config.globalProperties.$router=He,Object.defineProperty(he.config.globalProperties,"$route",{enumerable:!0,get:()=>Zh(y)}),$h&&!ur&&y.value===tu&&(ur=!0,ft(l.location).catch(Qn=>{}));const Ce={};for(const Qn in tu)Ce[Qn]=mr(()=>y.value[Qn]);he.provide(Yv,He),he.provide(Kv,ya(Ce)),he.provide(Gb,y);const Te=he.unmount;Zn.add(he),he.unmount=function(){Zn.delete(he),Zn.size<1&&(E=tu,ce&&ce(),ce=null,y.value=tu,ur=!1,Ze=!1),Te()}}}}function Dh(t){return t.reduce((e,n)=>e.then(()=>n()),Promise.resolve())}function WD(t,e){const n=[],i=[],l=[],d=Math.max(e.matched.length,t.matched.length);for(let f=0;f<d;f++){const o=e.matched[f];o&&(t.matched.find(E=>of(E,o))?i.push(o):n.push(o));const y=t.matched[f];y&&(e.matched.find(E=>of(E,y))||l.push(y))}return[n,i,l]}function xet(){return Pr(Kv)}const ZD=t=>yi(t)?t:so(t),XD=()=>null;function YD(t,e,n={}){var C,A,P,B,j;if(typeof t!="string")throw new TypeError("asyncData key must be a string");if(typeof e!="function")throw new TypeError("asyncData handler must be a function");n={server:!0,default:XD,...n},n.defer&&console.warn("[useAsyncData] `defer` has been renamed to `lazy`. Support for `defer` will be removed in RC."),n.lazy=(A=(C=n.lazy)!=null?C:n.defer)!=null?A:!1,n.initialCache=(P=n.initialCache)!=null?P:!0;const i=ss(),l=qo();if(l&&!l._nuxtOnBeforeMountCbs){const Z=l._nuxtOnBeforeMountCbs=[];l&&(p4(()=>{Z.forEach(W=>{W()}),Z.splice(0,Z.length)}),Ni(()=>Z.splice(0,Z.length)))}const d=()=>n.initialCache&&i.payload.data[t]!==void 0,f={data:ZD((B=i.payload.data[t])!=null?B:n.default()),pending:so(!d()),error:so((j=i.payload._errors[t])!=null?j:null)};f.refresh=(Z={})=>i._asyncDataPromises[t]?i._asyncDataPromises[t]:Z._initial&&d()?i.payload.data[t]:(f.pending.value=!0,i._asyncDataPromises[t]=Promise.resolve(e(i)).then(W=>{n.transform&&(W=n.transform(W)),n.pick&&(W=KD(W,n.pick)),f.data.value=W,f.error.value=null}).catch(W=>{f.error.value=W,f.data.value=Zh(n.default())}).finally(()=>{f.pending.value=!1,i.payload.data[t]=f.data.value,f.error.value&&(i.payload._errors[t]=!0),delete i._asyncDataPromises[t]}),i._asyncDataPromises[t]);const o=()=>f.refresh({_initial:!0}),y=n.server!==!1&&i.payload.serverRendered;{y&&i.isHydrating&&t in i.payload.data?f.pending.value=!1:l&&i.payload.serverRendered&&(i.isHydrating||n.lazy)?l._nuxtOnBeforeMountCbs.push(o):o(),n.watch&&$r(n.watch,()=>f.refresh());const Z=i.hook("app:data:refresh",W=>{if(!W||W.includes(t))return f.refresh()});l&&Ni(Z)}const E=Promise.resolve(i._asyncDataPromises[t]).then(()=>f);return Object.assign(E,f),E}function KD(t,e){const n={};for(const i of e)n[i]=t[i];return n}const JD=(t,e)=>{const n=ss(),i=Uv(n.payload.state,t);if(i.value===void 0&&e){const l=e();if(yi(l))return n.payload.state[t]=l,l;i.value=l}return i},_m=()=>{const t=ss();return JD("error",()=>t.payload.error)},W0=t=>{const e=ss(),n=_m(),i=typeof t=="string"?new Error(t):t;return e.callHook("app:error",i),n.value=n.value||i,i},QD=async(t={})=>{const e=ss(),n=_m();e.callHook("app:error:cleared",t),t.redirect&&await e.$router.replace(t.redirect),n.value=null};function tR(t,e=0){typeof t=="string"&&(t=eR(t));let n=0,i=e,l,d;const f=t.length&3,o=t.length-f,y=3432918353,E=461845907;for(;n<o;)l=t[n]&255|(t[++n]&255)<<8|(t[++n]&255)<<16|(t[++n]&255)<<24,++n,l=(l&65535)*y+(((l>>>16)*y&65535)<<16)&4294967295,l=l<<15|l>>>17,l=(l&65535)*E+(((l>>>16)*E&65535)<<16)&4294967295,i^=l,i=i<<13|i>>>19,d=(i&65535)*5+(((i>>>16)*5&65535)<<16)&4294967295,i=(d&65535)+27492+(((d>>>16)+58964&65535)<<16);switch(l=0,f){case 3:l^=(t[n+2]&255)<<16;break;case 2:l^=(t[n+1]&255)<<8;break;case 1:l^=t[n]&255,l=(l&65535)*y+(((l>>>16)*y&65535)<<16)&4294967295,l=l<<15|l>>>17,l=(l&65535)*E+(((l>>>16)*E&65535)<<16)&4294967295,i^=l}return i^=t.length,i^=i>>>16,i=(i&65535)*2246822507+(((i>>>16)*2246822507&65535)<<16)&4294967295,i^=i>>>13,i=(i&65535)*3266489909+(((i>>>16)*3266489909&65535)<<16)&4294967295,i^=i>>>16,i>>>0}function eR(t){return new TextEncoder().encode(t)}const nR={ignoreUnknown:!1,respectType:!1,respectFunctionNames:!1,respectFunctionProperties:!1,unorderedObjects:!0,unorderedArrays:!1,unorderedSets:!1};function rR(t,e={}){e={...nR,...e};const n=uC(e);return n.dispatch(t),n.toString()}function uC(t){const e=[];let n=[];const i=l=>{e.push(l)};return{toString(){return e.join("")},getContext(){return n},dispatch(l){return t.replacer&&(l=t.replacer(l)),this["_"+(l===null?"null":typeof l)](l)},_object(l){const d=/\[object (.*)\]/i,f=Object.prototype.toString.call(l),o=d.exec(f),y=o?o[1].toLowerCase():"unknown:["+f.toLowerCase()+"]";let E=null;if((E=n.indexOf(l))>=0)return this.dispatch("[CIRCULAR:"+E+"]");if(n.push(l),typeof Buffer!="undefined"&&Buffer.isBuffer&&Buffer.isBuffer(l))return i("buffer:"),i(l.toString("utf8"));if(y!=="object"&&y!=="function"&&y!=="asyncfunction")if(this["_"+y])this["_"+y](l);else{if(t.ignoreUnknown)return i("["+y+"]");throw new Error('Unknown object type "'+y+'"')}else{let C=Object.keys(l);return t.unorderedObjects&&(C=C.sort()),t.respectType!==!1&&!O5(l)&&C.splice(0,0,"prototype","__proto__","letructor"),t.excludeKeys&&(C=C.filter(function(A){return!t.excludeKeys(A)})),i("object:"+C.length+":"),C.forEach(A=>{this.dispatch(A),i(":"),t.excludeValues||this.dispatch(l[A]),i(",")})}},_array(l,d){if(d=typeof d!="undefined"?d:t.unorderedArrays!==!1,i("array:"+l.length+":"),!d||l.length<=1)return l.forEach(y=>this.dispatch(y));const f=[],o=l.map(y=>{const E=uC(t);return E.dispatch(y),f.push(E.getContext()),E.toString()});return n=n.concat(f),o.sort(),this._array(o,!1)},_date(l){return i("date:"+l.toJSON())},_symbol(l){return i("symbol:"+l.toString())},_error(l){return i("error:"+l.toString())},_boolean(l){return i("bool:"+l.toString())},_string(l){i("string:"+l.length+":"),i(l.toString())},_function(l){i("fn:"),O5(l)?this.dispatch("[native]"):this.dispatch(l.toString()),t.respectFunctionNames!==!1&&this.dispatch("function-name:"+String(l.name)),t.respectFunctionProperties&&this._object(l)},_number(l){return i("number:"+l.toString())},_xml(l){return i("xml:"+l.toString())},_null(){return i("Null")},_undefined(){return i("Undefined")},_regexp(l){return i("regex:"+l.toString())},_uint8array(l){return i("uint8array:"),this.dispatch(Array.prototype.slice.call(l))},_uint8clampedarray(l){return i("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(l))},_int8array(l){return i("int8array:"),this.dispatch(Array.prototype.slice.call(l))},_uint16array(l){return i("uint16array:"),this.dispatch(Array.prototype.slice.call(l))},_int16array(l){return i("int16array:"),this.dispatch(Array.prototype.slice.call(l))},_uint32array(l){return i("uint32array:"),this.dispatch(Array.prototype.slice.call(l))},_int32array(l){return i("int32array:"),this.dispatch(Array.prototype.slice.call(l))},_float32array(l){return i("float32array:"),this.dispatch(Array.prototype.slice.call(l))},_float64array(l){return i("float64array:"),this.dispatch(Array.prototype.slice.call(l))},_arraybuffer(l){return i("arraybuffer:"),this.dispatch(new Uint8Array(l))},_url(l){return i("url:"+l.toString())},_map(l){i("map:");const d=Array.from(l);return this._array(d,t.unorderedSets!==!1)},_set(l){i("set:");const d=Array.from(l);return this._array(d,t.unorderedSets!==!1)},_file(l){return i("file:"),this.dispatch([l.name,l.size,l.type,l.lastModfied])},_blob(){if(t.ignoreUnknown)return i("[blob]");throw new Error(`Hashing Blob objects is currently not supported
Use "options.replacer" or "options.ignoreUnknown"
`)},_domwindow(){return i("domwindow")},_bigint(l){return i("bigint:"+l.toString())},_process(){return i("process")},_timer(){return i("timer")},_pipe(){return i("pipe")},_tcp(){return i("tcp")},_udp(){return i("udp")},_tty(){return i("tty")},_statwatcher(){return i("statwatcher")},_securecontext(){return i("securecontext")},_connection(){return i("connection")},_zlib(){return i("zlib")},_context(){return i("context")},_nodescript(){return i("nodescript")},_httpparser(){return i("httpparser")},_dataview(){return i("dataview")},_signal(){return i("signal")},_fsevent(){return i("fsevent")},_tlswrap(){return i("tlswrap")}}}function O5(t){return typeof t!="function"?!1:/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(t))!=null}function iR(t,e={}){const n=typeof t=="string"?t:rR(t,e);return String(tR(n))}function Di(t,e={}){const n="$f_"+(e.key||iR([t,{...e,transform:null}])),i=mr(()=>{let o=t;return typeof o=="function"&&(o=o()),yi(o)?o.value:o}),l={...e,cache:typeof e.cache=="boolean"?void 0:e.cache},d={...e,watch:[i,...e.watch||[]]};return YD(n,()=>$fetch(i.value,l),d)}class $1 extends Error{constructor(){super(...arguments),this.statusCode=500,this.statusMessage="Internal Server Error"}}function oR(t){var n;if(typeof t=="string")return new $1(t);if(t instanceof $1)return t;const e=new $1((n=t.message)!=null?n:t.statusMessage,t.cause?{cause:t.cause}:void 0);return t.statusCode&&(e.statusCode=t.statusCode),t.statusMessage&&(e.statusMessage=t.statusMessage),t.data&&(e.data=t.data),e}const aR=()=>{var t;return(t=ss())==null?void 0:t.$router},sR=(...t)=>t.find(e=>e!==void 0),lR="noopener noreferrer";function cR(t){const e=t.componentName||"NuxtLink";return gr({name:e,props:{to:{type:[String,Object],default:void 0,required:!1},href:{type:[String,Object],default:void 0,required:!1},target:{type:String,default:void 0,required:!1},rel:{type:String,default:void 0,required:!1},noRel:{type:Boolean,default:void 0,required:!1},activeClass:{type:String,default:void 0,required:!1},exactActiveClass:{type:String,default:void 0,required:!1},replace:{type:Boolean,default:void 0,required:!1},ariaCurrentValue:{type:String,default:void 0,required:!1},external:{type:Boolean,default:void 0,required:!1},custom:{type:Boolean,default:void 0,required:!1}},setup(n,{slots:i}){const l=aR(),d=mr(()=>n.to||n.href||""),f=mr(()=>n.external||n.target&&n.target!=="_self"?!0:typeof d.value=="object"?!1:d.value===""||V4(d.value,!0));return()=>{var C,A,P;if(!f.value)return Uo(ea("RouterLink"),{to:d.value,activeClass:n.activeClass||t.activeClass,exactActiveClass:n.exactActiveClass||t.exactActiveClass,replace:n.replace,ariaCurrentValue:n.ariaCurrentValue},i.default);const o=typeof d.value=="object"?(A=(C=l.resolve(d.value))==null?void 0:C.href)!=null?A:null:d.value||null,y=n.target||null,E=n.noRel?null:sR(n.rel,t.externalRelAttribute,o?lR:"")||null;return Uo("a",{href:o,rel:E,target:y},(P=i.default)==null?void 0:P.call(i))}}})}var Qv=cR({componentName:"NuxtLink"});function vl(t){const e=Vn(t)?mr(t):t;ss()._useHead(e)}const V1={};function uR(t){for(const e in V1)t.vueApp.component(e,V1[e]),t.vueApp.component("Lazy"+e,V1[e])}var dR=Object.defineProperty,D5=Object.getOwnPropertySymbols,hR=Object.prototype.hasOwnProperty,fR=Object.prototype.propertyIsEnumerable,R5=(t,e,n)=>e in t?dR(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,pR=(t,e)=>{for(var n in e||(e={}))hR.call(e,n)&&R5(t,n,e[n]);if(D5)for(var n of D5(e))fR.call(e,n)&&R5(t,n,e[n]);return t},mR="usehead",B5="head:count",G1="data-head-attrs",gR=(t,e,n)=>{const i=n.createElement(t);for(const l of Object.keys(e)){let d=e[l];l==="key"||d===!1||(l==="children"?i.textContent=d:i.setAttribute(l,d))}return i};function _R(t,e){if(t instanceof HTMLElement&&e instanceof HTMLElement){const n=e.getAttribute("nonce");if(n&&!t.getAttribute("nonce")){const i=e.cloneNode(!0);return i.setAttribute("nonce",""),i.nonce=n,n===t.nonce&&t.isEqualNode(i)}}return t.isEqualNode(e)}var yR=t=>{const e=["key","id","name","property"];for(const n of e){const i=typeof t.getAttribute=="function"?t.hasAttribute(n)?t.getAttribute(n):void 0:t[n];if(i!==void 0)return{name:n,value:i}}},bR=["title","meta","link","base","style","script","htmlAttrs","bodyAttrs"],vR=t=>{const e=[];for(const n of Object.keys(t))if(t[n]!=null){if(n==="title")e.push({tag:n,props:{children:t[n]}});else if(n==="base")e.push({tag:n,props:pR({key:"default"},t[n])});else if(bR.includes(n)){const i=t[n];Array.isArray(i)?i.forEach(l=>{e.push({tag:n,props:l})}):i&&e.push({tag:n,props:i})}}return e},F5=(t,e)=>{const n=t.getAttribute(G1);if(n)for(const l of n.split(","))l in e||t.removeAttribute(l);const i=[];for(const l in e){const d=e[l];d!=null&&(d===!1?t.removeAttribute(l):t.setAttribute(l,d),i.push(l))}i.length?t.setAttribute(G1,i.join(",")):t.removeAttribute(G1)},xR=(t=window.document,e,n)=>{var i;const l=t.head;let d=l.querySelector(`meta[name="${B5}"]`);const f=d?Number(d.getAttribute("content")):0,o=[];if(d)for(let E=0,C=d.previousElementSibling;E<f;E++,C=(C==null?void 0:C.previousElementSibling)||null)((i=C==null?void 0:C.tagName)==null?void 0:i.toLowerCase())===e&&o.push(C);else d=t.createElement("meta"),d.setAttribute("name",B5),d.setAttribute("content","0"),l.append(d);let y=n.map(E=>gR(E.tag,E.props,t));y=y.filter(E=>{for(let C=0;C<o.length;C++){const A=o[C];if(_R(A,E))return o.splice(C,1),!1}return!0}),o.forEach(E=>{var C;return(C=E.parentNode)==null?void 0:C.removeChild(E)}),y.forEach(E=>{l.insertBefore(E,d)}),d.setAttribute("content",""+(f-o.length+y.length))},wR=()=>{let t=[],e=new Set;const n={install(i){i.config.globalProperties.$head=n,i.provide(mR,n)},get headTags(){const i=[];return t.forEach(l=>{vR(l.value).forEach(f=>{if(f.tag==="meta"||f.tag==="base"||f.tag==="script"){const o=yR(f.props);if(o){let y=-1;for(let E=0;E<i.length;E++){const C=i[E],A=C.props[o.name],P=f.props[o.name];if(C.tag===f.tag&&A===P){y=E;break}}y!==-1&&i.splice(y,1)}}i.push(f)})}),i},addHeadObjs(i){t.push(i)},removeHeadObjs(i){t=t.filter(l=>l!==i)},updateDOM(i=window.document){let l,d={},f={};const o={};for(const E of n.headTags){if(E.tag==="title"){l=E.props.children;continue}if(E.tag==="htmlAttrs"){Object.assign(d,E.props);continue}if(E.tag==="bodyAttrs"){Object.assign(f,E.props);continue}o[E.tag]=o[E.tag]||[],o[E.tag].push(E)}l!==void 0&&(i.title=l),F5(i.documentElement,d),F5(i.body,f);const y=new Set([...Object.keys(o),...e]);for(const E of y)xR(i,E,o[E]||[]);e.clear(),Object.keys(o).forEach(E=>e.add(E))}};return n};function q1(t){return t!==null&&typeof t=="object"}function Wb(t,e,n=".",i){if(!q1(e))return Wb(t,{},n,i);const l=Object.assign({},e);for(const d in t){if(d==="__proto__"||d==="constructor")continue;const f=t[d];f!=null&&(i&&i(l,d,f,n)||(Array.isArray(f)&&Array.isArray(l[d])?l[d]=f.concat(l[d]):q1(f)&&q1(l[d])?l[d]=Wb(f,l[d],(n?`${n}.`:"")+d.toString(),i):l[d]=f))}return l}function ER(t){return(...e)=>e.reduce((n,i)=>Wb(n,i,"",t),{})}const TR=ER();var kR=yf(t=>{const e=wR();t.vueApp.use(e);let n=!1;t.hooks.hookOnce("app:mounted",()=>{F3(()=>{e.updateDOM()}),n=!0});const i=so();t._useHead=l=>{const d=so(l);"titleTemplate"in d.value&&(i.value=d.value.titleTemplate);const f=mr(()=>{const y={meta:[]};return i.value&&"title"in d.value&&(y.title=typeof i.value=="function"?i.value(d.value.title):i.value.replace(/%s/g,d.value.title)),d.value.charset&&y.meta.push({key:"charset",charset:d.value.charset}),d.value.viewport&&y.meta.push({name:"viewport",content:d.value.viewport}),TR(y,d.value)});e.addHeadObjs(f),n&&F3(()=>{e.updateDOM()}),qo()&&Dm(()=>{e.removeHeadObjs(f),e.updateDOM()})}});const CR=t=>Object.fromEntries(Object.entries(t).filter(([,e])=>e!==void 0)),Su=(t,e)=>(n,i)=>(vl(()=>t({...CR(n),...i.attrs},i)),()=>{var l,d;return e?(d=(l=i.slots).default)==null?void 0:d.call(l):null}),Ud={accesskey:String,autocapitalize:String,autofocus:{type:Boolean,default:void 0},class:String,contenteditable:{type:Boolean,default:void 0},contextmenu:String,dir:String,draggable:{type:Boolean,default:void 0},enterkeyhint:String,exportparts:String,hidden:{type:Boolean,default:void 0},id:String,inputmode:String,is:String,itemid:String,itemprop:String,itemref:String,itemscope:String,itemtype:String,lang:String,nonce:String,part:String,slot:String,spellcheck:{type:Boolean,default:void 0},style:String,tabindex:String,title:String,translate:String},SR=gr({name:"Script",inheritAttrs:!1,props:{...Ud,async:Boolean,crossorigin:{type:[Boolean,String],default:void 0},defer:Boolean,integrity:String,nomodule:Boolean,nonce:String,referrerpolicy:String,src:String,type:String,charset:String,language:String},setup:Su(t=>({script:[t]}))}),MR=gr({name:"Link",inheritAttrs:!1,props:{...Ud,as:String,crossorigin:String,disabled:Boolean,href:String,hreflang:String,imagesizes:String,imagesrcset:String,integrity:String,media:String,prefetch:{type:Boolean,default:void 0},referrerpolicy:String,rel:String,sizes:String,title:String,type:String,methods:String,target:String},setup:Su(t=>({link:[t]}))}),AR=gr({name:"Base",inheritAttrs:!1,props:{...Ud,href:String,target:String},setup:Su(t=>({base:t}))}),IR=gr({name:"Title",inheritAttrs:!1,setup:Su((t,{slots:e})=>{var i,l,d;return{title:((d=(l=(i=e.default)==null?void 0:i.call(e))==null?void 0:l[0])==null?void 0:d.children)||null}})}),PR=gr({name:"Meta",inheritAttrs:!1,props:{...Ud,charset:String,content:String,httpEquiv:String,name:String},setup:Su(t=>({meta:[t]}))}),LR=gr({name:"Style",inheritAttrs:!1,props:{...Ud,type:String,media:String,nonce:String,title:String,scoped:{type:Boolean,default:void 0}},setup:Su((t,{slots:e})=>{var l,d,f;const n={...t},i=(f=(d=(l=e.default)==null?void 0:l.call(e))==null?void 0:d[0])==null?void 0:f.children;return i&&(n.children=i),{style:[n]}})}),zR=gr({name:"Head",inheritAttrs:!1,setup:(t,e)=>()=>{var n,i;return(i=(n=e.slots).default)==null?void 0:i.call(n)}}),OR=gr({name:"Html",inheritAttrs:!1,props:{...Ud,manifest:String,version:String,xmlns:String},setup:Su(t=>({htmlAttrs:t}),!0)}),DR=gr({name:"Body",inheritAttrs:!1,props:Ud,setup:Su(t=>({bodyAttrs:t}),!0)});var N5=Object.freeze(Object.defineProperty({__proto__:null,Script:SR,Link:MR,Base:AR,Title:IR,Meta:PR,Style:LR,Head:zR,Html:OR,Body:DR},Symbol.toStringTag,{value:"Module"})),RR={globalMeta:{charset:"utf-8",viewport:"width=device-width, initial-scale=1",meta:[],link:[],style:[],script:[]}};const BR={created(){const t=qo();if(!t)return;const e=t.type;if(!e||!("head"in e))return;const n=ss(),i=typeof e.head=="function"?mr(()=>e.head(n)):e.head;vl(i)}};var FR=yf(t=>{vl(Od({title:"",...RR.globalMeta})),t.vueApp.mixin(BR);for(const e in N5)t.vueApp.component(e,N5[e])});const NR=(t,e)=>e.path.replace(/(:\w+)\([^)]+\)/g,"$1").replace(/(:\w+)[?+*]/g,"$1").replace(/:\w+/g,n=>{var i;return((i=t.params[n.slice(1)])==null?void 0:i.toString())||""}),j5=(t,e)=>{var l;const n=e.route.matched.find(d=>d.components.default===e.Component.type),i=(l=t!=null?t:n==null?void 0:n.meta.key)!=null?l:NR(e.route,n);return typeof i=="function"?i(e.route):i},jR=(t,e)=>({default:()=>t?Uo(_L,t===!0?{}:t,e):e}),UR={setup(t,{slots:e}){return()=>{var n;return(n=e.default)==null?void 0:n.call(e)}}},$R=(t,e,n)=>({default:()=>e?Uo(t,e===!0?{}:e,n):Uo(UR,{},n)}),U5=Symbol("isNested");var H1=gr({name:"NuxtPage",inheritAttrs:!1,props:{name:{type:String},route:{type:Object},pageKey:{type:[Function,String],default:null}},setup(t,{attrs:e}){const n=ss(),i=Pr(U5,!1);return na(U5,!0),()=>Uo(cC,{name:t.name,route:t.route,...e},{default:l=>{var d;return l.Component&&$R(Zv,(d=l.route.meta.pageTransition)!=null?d:VR,jR(l.route.meta.keepalive,i&&n.isHydrating?Uo(l.Component,{key:j5(t.pageKey,l)}):Uo(s4,{onPending:()=>n.callHook("page:start",l.Component),onResolve:()=>n.callHook("page:finish",l.Component)},{default:()=>Uo(l.Component,{key:j5(t.pageKey,l)})}))).default()}})}});const VR={name:"page",mode:"out-in"},GR="modulepreload",$5={},qR=TO(),oo=function(e,n){return!n||n.length===0?e():Promise.all(n.map(i=>{if(i=`${qR}${i}`,i in $5)return;$5[i]=!0;const l=i.endsWith(".css"),d=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${i}"]${d}`))return;const f=document.createElement("link");if(f.rel=l?"stylesheet":GR,l||(f.as="script",f.crossOrigin=""),f.href=i,document.head.appendChild(f),l)return new Promise((o,y)=>{f.addEventListener("load",o),f.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>e())};var bo=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function HR(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function WR(t){if(t.__esModule)return t;var e=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(t).forEach(function(n){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,i.get?i:{enumerable:!0,get:function(){return t[n]}})}),e}var dC={exports:{}};(function(t,e){var n=[],i={},l=function(P){return typeof P=="undefined"},d=/\s*(\.\d+|\d+(?:\.\d+)?)(%)?\s*/,f=/\s*(\.\d+|100|\d?\d(?:\.\d+)?)%\s*/,o=/\s*(\.\d+|\d+(?:\.\d+)?)\s*/,y=new RegExp("^(rgb|hsl|hsv)a?\\("+d.source+","+d.source+","+d.source+"(?:,"+o.source+")?\\)$","i");function E(P){if(Object.prototype.toString.apply(P)==="[object Array]"){if(typeof P[0]=="string"&&typeof E[P[0]]=="function")return new E[P[0]](P.slice(1,P.length));if(P.length===4)return new E.RGB(P[0]/255,P[1]/255,P[2]/255,P[3]/255)}else if(typeof P=="string"){var B=P.toLowerCase();i[B]&&(P="#"+i[B]),B==="transparent"&&(P="rgba(0,0,0,0)");var j=P.match(y);if(j){var Z=j[1].toUpperCase(),W=l(j[8])?j[8]:parseFloat(j[8]),H=Z[0]==="H",V=j[3]?100:H?360:255,tt=j[5]||H?100:255,ft=j[7]||H?100:255;if(l(E[Z]))throw new Error("one.color."+Z+" is not installed.");return new E[Z](parseFloat(j[2])/V,parseFloat(j[4])/tt,parseFloat(j[6])/ft,W)}P.length<6&&(P=P.replace(/^#?([0-9a-f])([0-9a-f])([0-9a-f])$/i,"$1$1$2$2$3$3"));var et=P.match(/^#?([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])$/i);if(et)return new E.RGB(parseInt(et[1],16)/255,parseInt(et[2],16)/255,parseInt(et[3],16)/255);if(E.CMYK){var Pt=P.match(new RegExp("^cmyk\\("+f.source+","+f.source+","+f.source+","+f.source+"\\)$","i"));if(Pt)return new E.CMYK(parseFloat(Pt[1])/100,parseFloat(Pt[2])/100,parseFloat(Pt[3])/100,parseFloat(Pt[4])/100)}}else if(typeof P=="object"&&P.isColor)return P;return!1}function C(P,B,j){E[P]=new Function(B.join(","),"if (Object.prototype.toString.apply("+B[0]+") === '[object Array]') {"+B.map(function(tt,ft){return tt+"="+B[0]+"["+ft+"];"}).reverse().join("")+"}if ("+B.filter(function(tt){return tt!=="alpha"}).map(function(tt){return"isNaN("+tt+")"}).join("||")+'){throw new Error("['+P+']: Invalid color: ("+'+B.join('+","+')+'+")");}'+B.map(function(tt){return tt==="hue"?"this._hue=hue<0?hue-Math.floor(hue):hue%1":tt==="alpha"?"this._alpha=(isNaN(alpha)||alpha>1)?1:(alpha<0?0:alpha);":"this._"+tt+"="+tt+"<0?0:("+tt+">1?1:"+tt+")"}).join(";")+";"),E[P].propertyNames=B;var Z=E[P].prototype;["valueOf","hex","hexa","css","cssa"].forEach(function(tt){Z[tt]=Z[tt]||(P==="RGB"?Z.hex:new Function("return this.rgb()."+tt+"();"))}),Z.isColor=!0,Z.equals=function(tt,ft){l(ft)&&(ft=1e-10),tt=tt[P.toLowerCase()]();for(var et=0;et<B.length;et=et+1)if(Math.abs(this["_"+B[et]]-tt["_"+B[et]])>ft)return!1;return!0},Z.toJSON=new Function("return ['"+P+"', "+B.map(function(tt){return"this._"+tt},this).join(", ")+"];");for(var W in j)if(j.hasOwnProperty(W)){var H=W.match(/^from(.*)$/);H?E[H[1].toUpperCase()].prototype[P.toLowerCase()]=j[W]:Z[W]=j[W]}Z[P.toLowerCase()]=function(){return this},Z.toString=new Function('return "[one.color.'+P+':"+'+B.map(function(tt,ft){return'" '+B[ft]+'="+this._'+tt}).join("+")+'+"]";'),B.forEach(function(tt,ft){Z[tt]=Z[tt==="black"?"k":tt[0]]=new Function("value","isDelta","if (typeof value === 'undefined') {return this._"+tt+";}if (isDelta) {return new this.constructor("+B.map(function(et,Pt){return"this._"+et+(tt===et?"+value":"")}).join(", ")+");}return new this.constructor("+B.map(function(et,Pt){return tt===et?"value":"this._"+et}).join(", ")+");")});function V(tt,ft){var et={};et[ft.toLowerCase()]=new Function("return this.rgb()."+ft.toLowerCase()+"();"),E[ft].propertyNames.forEach(function(Rt,zt){et[Rt]=et[Rt==="black"?"k":Rt[0]]=new Function("value","isDelta","return this."+ft.toLowerCase()+"()."+Rt+"(value, isDelta);")});for(var Pt in et)et.hasOwnProperty(Pt)&&E[tt].prototype[Pt]===void 0&&(E[tt].prototype[Pt]=et[Pt])}n.forEach(function(tt){V(P,tt),V(tt,P)}),n.push(P)}E.installMethod=function(P,B){n.forEach(function(j){E[j].prototype[P]=B})},C("RGB",["red","green","blue","alpha"],{hex:function(){var P=(Math.round(255*this._red)*65536+Math.round(255*this._green)*256+Math.round(255*this._blue)).toString(16);return"#"+"00000".substr(0,6-P.length)+P},hexa:function(){var P=Math.round(this._alpha*255).toString(16);return"#"+"00".substr(0,2-P.length)+P+this.hex().substr(1,6)},css:function(){return"rgb("+Math.round(255*this._red)+","+Math.round(255*this._green)+","+Math.round(255*this._blue)+")"},cssa:function(){return"rgba("+Math.round(255*this._red)+","+Math.round(255*this._green)+","+Math.round(255*this._blue)+","+this._alpha+")"}}),t.exports=E,typeof jQuery!="undefined"&&l(jQuery.color)&&(jQuery.color=E),i={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgrey:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",grey:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"639",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},C("XYZ",["x","y","z","alpha"],{fromRgb:function(){var P=function(W){return W>.04045?Math.pow((W+.055)/1.055,2.4):W/12.92},B=P(this._red),j=P(this._green),Z=P(this._blue);return new E.XYZ(B*.4124564+j*.3575761+Z*.1804375,B*.2126729+j*.7151522+Z*.072175,B*.0193339+j*.119192+Z*.9503041,this._alpha)},rgb:function(){var P=this._x,B=this._y,j=this._z,Z=function(W){return W>.0031308?1.055*Math.pow(W,1/2.4)-.055:12.92*W};return new E.RGB(Z(P*3.2404542+B*-1.5371385+j*-.4985314),Z(P*-.969266+B*1.8760108+j*.041556),Z(P*.0556434+B*-.2040259+j*1.0572252),this._alpha)},lab:function(){var P=function(W){return W>.008856?Math.pow(W,.3333333333333333):7.787037*W+.13793103448275862},B=P(this._x/95.047),j=P(this._y/100),Z=P(this._z/108.883);return new E.LAB(116*j-16,500*(B-j),200*(j-Z),this._alpha)}}),C("LAB",["l","a","b","alpha"],{fromRgb:function(){return this.xyz().lab()},rgb:function(){return this.xyz().rgb()},xyz:function(){var P=function(W){var H=Math.pow(W,3);return H>.008856?H:(W-.13793103448275862)/7.87},B=(this._l+16)/116,j=this._a/500+B,Z=B-this._b/200;return new E.XYZ(P(j)*95.047,P(B)*100,P(Z)*108.883,this._alpha)}}),C("HSV",["hue","saturation","value","alpha"],{rgb:function(){var P=this._hue,B=this._saturation,j=this._value,Z=Math.min(5,Math.floor(P*6)),W=P*6-Z,H=j*(1-B),V=j*(1-W*B),tt=j*(1-(1-W)*B),ft,et,Pt;switch(Z){case 0:ft=j,et=tt,Pt=H;break;case 1:ft=V,et=j,Pt=H;break;case 2:ft=H,et=j,Pt=tt;break;case 3:ft=H,et=V,Pt=j;break;case 4:ft=tt,et=H,Pt=j;break;case 5:ft=j,et=H,Pt=V;break}return new E.RGB(ft,et,Pt,this._alpha)},hsl:function(){var P=(2-this._saturation)*this._value,B=this._saturation*this._value,j=P<=1?P:2-P,Z;return j<1e-9?Z=0:Z=B/j,new E.HSL(this._hue,Z,P/2,this._alpha)},fromRgb:function(){var P=this._red,B=this._green,j=this._blue,Z=Math.max(P,B,j),W=Math.min(P,B,j),H=Z-W,V,tt=Z===0?0:H/Z,ft=Z;if(H===0)V=0;else switch(Z){case P:V=(B-j)/H/6+(B<j?1:0);break;case B:V=(j-P)/H/6+1/3;break;case j:V=(P-B)/H/6+2/3;break}return new E.HSV(V,tt,ft,this._alpha)}}),C("HSL",["hue","saturation","lightness","alpha"],{hsv:function(){var P=this._lightness*2,B=this._saturation*(P<=1?P:2-P),j;return P+B<1e-9?j=0:j=2*B/(P+B),new E.HSV(this._hue,j,(P+B)/2,this._alpha)},rgb:function(){return this.hsv().rgb()},fromRgb:function(){return this.hsv().hsl()}}),C("CMYK",["cyan","magenta","yellow","black","alpha"],{rgb:function(){return new E.RGB(1-this._cyan*(1-this._black)-this._black,1-this._magenta*(1-this._black)-this._black,1-this._yellow*(1-this._black)-this._black,this._alpha)},fromRgb:function(){var P=this._red,B=this._green,j=this._blue,Z=1-P,W=1-B,H=1-j,V=1;return P||B||j?(V=Math.min(Z,Math.min(W,H)),Z=(Z-V)/(1-V),W=(W-V)/(1-V),H=(H-V)/(1-V)):V=1,new E.CMYK(Z,W,H,V,this._alpha)}}),E.installMethod("clearer",function(P){return this.alpha(isNaN(P)?-.1:-P,!0)}),E.installMethod("darken",function(P){return this.lightness(isNaN(P)?-.1:-P,!0)}),E.installMethod("desaturate",function(P){return this.saturation(isNaN(P)?-.1:-P,!0)});function A(){var P=this.rgb(),B=P._red*.3+P._green*.59+P._blue*.11;return new E.RGB(B,B,B,this._alpha)}E.installMethod("greyscale",A),E.installMethod("grayscale",A),E.installMethod("lighten",function(P){return this.lightness(isNaN(P)?.1:P,!0)}),E.installMethod("mix",function(P,B){P=E(P).rgb(),B=1-(isNaN(B)?.5:B);var j=B*2-1,Z=this._alpha-P._alpha,W=((j*Z===-1?j:(j+Z)/(1+j*Z))+1)/2,H=1-W,V=this.rgb();return new E.RGB(V._red*W+P._red*H,V._green*W+P._green*H,V._blue*W+P._blue*H,V._alpha*B+P._alpha*(1-B))}),E.installMethod("negate",function(){var P=this.rgb();return new E.RGB(1-P._red,1-P._green,1-P._blue,this._alpha)}),E.installMethod("opaquer",function(P){return this.alpha(isNaN(P)?.1:P,!0)}),E.installMethod("rotate",function(P){return this.hue((P||0)/360,!0)}),E.installMethod("saturate",function(P){return this.saturation(isNaN(P)?.1:P,!0)}),E.installMethod("toAlpha",function(P){var B=this.rgb(),j=E(P).rgb(),Z=1e-10,W=new E.RGB(0,0,0,B._alpha),H=["_red","_green","_blue"];return H.forEach(function(V){B[V]<Z?W[V]=B[V]:B[V]>j[V]?W[V]=(B[V]-j[V])/(1-j[V]):B[V]>j[V]?W[V]=(j[V]-B[V])/j[V]:W[V]=0}),W._red>W._green?W._red>W._blue?B._alpha=W._red:B._alpha=W._blue:W._green>W._blue?B._alpha=W._green:B._alpha=W._blue,B._alpha<Z||(H.forEach(function(V){B[V]=(B[V]-j[V])/B._alpha+j[V]}),B._alpha*=W._alpha),B})})(dC);var u0=dC.exports,ZR=function(){var t=this,e={complementary:[0,180],splitComplementary:[0,150,320],splitComplementaryCW:[0,150,300],splitComplementaryCCW:[0,60,210],triadic:[0,120,240],clash:[0,90,270],tetradic:[0,90,180,270],fourToneCW:[0,60,180,240],fourToneCCW:[0,120,180,300],fiveToneA:[0,115,155,205,245],fiveToneB:[0,40,90,130,245],fiveToneC:[0,50,90,205,320],fiveToneD:[0,40,155,270,310],fiveToneE:[0,115,230,270,320],sixToneCW:[0,30,120,150,240,270],sixToneCCW:[0,90,120,210,240,330],neutral:[0,15,30,45,60,75],analogous:[0,30,60,90,120,150]},n=function(d){var f=u0(d);return f||(f=u0("#000000")),f},i=function(d,f){var o=[],y,E,C,A,P,B,j;for(y=d.hsl(),E=y._hue,C=y._saturation,A=y._lightness,P=y._alpha,B=0;B<f.length;B++)j=f[B],isFinite(j)&&typeof j=="number"&&o.push(new u0.HSL((E+1/360*j)%1,C,A,P).hex());return o},l=function(d,f,o){var y,E=[],C,A,P,B,j,Z,W;for((!isFinite(f)||typeof f!="number")&&(f=10),C=d.red(),A=d.green(),P=d.blue(),B=d.alpha(),j=(o-C)/f,Z=(o-A)/f,W=(o-P)/f,y=0;y<f;y++)E.push(new u0.RGB(C,A,P,B).hex()),C+=j,A+=Z,P+=W;return E};return t.add=function(d,f){Array.isArray(f)&&(e[d]=f)},t.harmonizeAll=function(d){var f={},o=n(d);for(var y in e)e.hasOwnProperty(y)&&(f[y]=i(o,e[y]));return f},t.harmonize=function(d,f){var o=n(d);return e.hasOwnProperty(f)&&(f=e[f]),Array.isArray(f)?i(o,f):[]},t.shades=function(d,f){return l(n(d),f,0)},t.tints=function(d,f){return l(n(d),f,1)},t.tones=function(d,f){return l(n(d),f,.5)},t},XR=function(){return new ZR};function Ai(t){if(t===null||t===!0||t===!1)return NaN;var e=Number(t);return isNaN(e)?e:e<0?Math.ceil(e):Math.floor(e)}function Wi(t,e){if(e.length<t)throw new TypeError(t+" argument"+(t>1?"s":"")+" required, but only "+e.length+" present")}function Vo(t){Wi(1,arguments);var e=Object.prototype.toString.call(t);return t instanceof Date||typeof t=="object"&&e==="[object Date]"?new Date(t.getTime()):typeof t=="number"||e==="[object Number]"?new Date(t):((typeof t=="string"||e==="[object String]")&&typeof console!="undefined"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://git.io/fjule"),console.warn(new Error().stack)),new Date(NaN))}function YR(t,e){Wi(2,arguments);var n=Vo(t).getTime(),i=Ai(e);return new Date(n+i)}function hC(t){var e=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return e.setUTCFullYear(t.getFullYear()),t.getTime()-e.getTime()}function KR(t){return Wi(1,arguments),t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function JR(t){if(Wi(1,arguments),!KR(t)&&typeof t!="number")return!1;var e=Vo(t);return!isNaN(Number(e))}var QR={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},t8=function(t,e,n){var i,l=QR[t];return typeof l=="string"?i=l:e===1?i=l.one:i=l.other.replace("{{count}}",e.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+i:i+" ago":i},e8=t8;function W1(t){return function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.width?String(e.width):t.defaultWidth,i=t.formats[n]||t.formats[t.defaultWidth];return i}}var n8={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},r8={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},i8={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},o8={date:W1({formats:n8,defaultWidth:"full"}),time:W1({formats:r8,defaultWidth:"full"}),dateTime:W1({formats:i8,defaultWidth:"full"})},a8=o8,s8={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},l8=function(t,e,n,i){return s8[t]},c8=l8;function wp(t){return function(e,n){var i=n||{},l=i.context?String(i.context):"standalone",d;if(l==="formatting"&&t.formattingValues){var f=t.defaultFormattingWidth||t.defaultWidth,o=i.width?String(i.width):f;d=t.formattingValues[o]||t.formattingValues[f]}else{var y=t.defaultWidth,E=i.width?String(i.width):t.defaultWidth;d=t.values[E]||t.values[y]}var C=t.argumentCallback?t.argumentCallback(e):e;return d[C]}}var u8={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},d8={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},h8={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},f8={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},p8={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},m8={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},g8=function(t,e){var n=Number(t),i=n%100;if(i>20||i<10)switch(i%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},_8={ordinalNumber:g8,era:wp({values:u8,defaultWidth:"wide"}),quarter:wp({values:d8,defaultWidth:"wide",argumentCallback:function(t){return t-1}}),month:wp({values:h8,defaultWidth:"wide"}),day:wp({values:f8,defaultWidth:"wide"}),dayPeriod:wp({values:p8,defaultWidth:"wide",formattingValues:m8,defaultFormattingWidth:"wide"})},y8=_8;function Ep(t){return function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=n.width,l=i&&t.matchPatterns[i]||t.matchPatterns[t.defaultMatchWidth],d=e.match(l);if(!d)return null;var f=d[0],o=i&&t.parsePatterns[i]||t.parsePatterns[t.defaultParseWidth],y=Array.isArray(o)?v8(o,function(A){return A.test(f)}):b8(o,function(A){return A.test(f)}),E;E=t.valueCallback?t.valueCallback(y):y,E=n.valueCallback?n.valueCallback(E):E;var C=e.slice(f.length);return{value:E,rest:C}}}function b8(t,e){for(var n in t)if(t.hasOwnProperty(n)&&e(t[n]))return n}function v8(t,e){for(var n=0;n<t.length;n++)if(e(t[n]))return n}function x8(t){return function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=e.match(t.matchPattern);if(!i)return null;var l=i[0],d=e.match(t.parsePattern);if(!d)return null;var f=t.valueCallback?t.valueCallback(d[0]):d[0];f=n.valueCallback?n.valueCallback(f):f;var o=e.slice(l.length);return{value:f,rest:o}}}var w8=/^(\d+)(th|st|nd|rd)?/i,E8=/\d+/i,T8={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},k8={any:[/^b/i,/^(a|c)/i]},C8={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},S8={any:[/1/i,/2/i,/3/i,/4/i]},M8={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},A8={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},I8={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},P8={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},L8={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},z8={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},O8={ordinalNumber:x8({matchPattern:w8,parsePattern:E8,valueCallback:function(t){return parseInt(t,10)}}),era:Ep({matchPatterns:T8,defaultMatchWidth:"wide",parsePatterns:k8,defaultParseWidth:"any"}),quarter:Ep({matchPatterns:C8,defaultMatchWidth:"wide",parsePatterns:S8,defaultParseWidth:"any",valueCallback:function(t){return t+1}}),month:Ep({matchPatterns:M8,defaultMatchWidth:"wide",parsePatterns:A8,defaultParseWidth:"any"}),day:Ep({matchPatterns:I8,defaultMatchWidth:"wide",parsePatterns:P8,defaultParseWidth:"any"}),dayPeriod:Ep({matchPatterns:L8,defaultMatchWidth:"any",parsePatterns:z8,defaultParseWidth:"any"})},D8=O8,R8={code:"en-US",formatDistance:e8,formatLong:a8,formatRelative:c8,localize:y8,match:D8,options:{weekStartsOn:0,firstWeekContainsDate:1}},fC=R8;function pC(t,e){Wi(2,arguments);var n=Ai(e);return YR(t,-n)}var B8=864e5;function F8(t){Wi(1,arguments);var e=Vo(t),n=e.getTime();e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0);var i=e.getTime(),l=n-i;return Math.floor(l/B8)+1}function sf(t){Wi(1,arguments);var e=1,n=Vo(t),i=n.getUTCDay(),l=(i<e?7:0)+i-e;return n.setUTCDate(n.getUTCDate()-l),n.setUTCHours(0,0,0,0),n}function mC(t){Wi(1,arguments);var e=Vo(t),n=e.getUTCFullYear(),i=new Date(0);i.setUTCFullYear(n+1,0,4),i.setUTCHours(0,0,0,0);var l=sf(i),d=new Date(0);d.setUTCFullYear(n,0,4),d.setUTCHours(0,0,0,0);var f=sf(d);return e.getTime()>=l.getTime()?n+1:e.getTime()>=f.getTime()?n:n-1}function N8(t){Wi(1,arguments);var e=mC(t),n=new Date(0);n.setUTCFullYear(e,0,4),n.setUTCHours(0,0,0,0);var i=sf(n);return i}var j8=6048e5;function gC(t){Wi(1,arguments);var e=Vo(t),n=sf(e).getTime()-N8(e).getTime();return Math.round(n/j8)+1}function Pd(t,e){Wi(1,arguments);var n=e||{},i=n.locale,l=i&&i.options&&i.options.weekStartsOn,d=l==null?0:Ai(l),f=n.weekStartsOn==null?d:Ai(n.weekStartsOn);if(!(f>=0&&f<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var o=Vo(t),y=o.getUTCDay(),E=(y<f?7:0)+y-f;return o.setUTCDate(o.getUTCDate()-E),o.setUTCHours(0,0,0,0),o}function tx(t,e){Wi(1,arguments);var n=Vo(t),i=n.getUTCFullYear(),l=e||{},d=l.locale,f=d&&d.options&&d.options.firstWeekContainsDate,o=f==null?1:Ai(f),y=l.firstWeekContainsDate==null?o:Ai(l.firstWeekContainsDate);if(!(y>=1&&y<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var E=new Date(0);E.setUTCFullYear(i+1,0,y),E.setUTCHours(0,0,0,0);var C=Pd(E,e),A=new Date(0);A.setUTCFullYear(i,0,y),A.setUTCHours(0,0,0,0);var P=Pd(A,e);return n.getTime()>=C.getTime()?i+1:n.getTime()>=P.getTime()?i:i-1}function U8(t,e){Wi(1,arguments);var n=e||{},i=n.locale,l=i&&i.options&&i.options.firstWeekContainsDate,d=l==null?1:Ai(l),f=n.firstWeekContainsDate==null?d:Ai(n.firstWeekContainsDate),o=tx(t,e),y=new Date(0);y.setUTCFullYear(o,0,f),y.setUTCHours(0,0,0,0);var E=Pd(y,e);return E}var $8=6048e5;function _C(t,e){Wi(1,arguments);var n=Vo(t),i=Pd(n,e).getTime()-U8(n,e).getTime();return Math.round(i/$8)+1}function jr(t,e){for(var n=t<0?"-":"",i=Math.abs(t).toString();i.length<e;)i="0"+i;return n+i}var V8={y:function(t,e){var n=t.getUTCFullYear(),i=n>0?n:1-n;return jr(e==="yy"?i%100:i,e.length)},M:function(t,e){var n=t.getUTCMonth();return e==="M"?String(n+1):jr(n+1,2)},d:function(t,e){return jr(t.getUTCDate(),e.length)},a:function(t,e){var n=t.getUTCHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h:function(t,e){return jr(t.getUTCHours()%12||12,e.length)},H:function(t,e){return jr(t.getUTCHours(),e.length)},m:function(t,e){return jr(t.getUTCMinutes(),e.length)},s:function(t,e){return jr(t.getUTCSeconds(),e.length)},S:function(t,e){var n=e.length,i=t.getUTCMilliseconds(),l=Math.floor(i*Math.pow(10,n-3));return jr(l,e.length)}},nu=V8,Rh={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},G8={G:function(t,e,n){var i=t.getUTCFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return n.era(i,{width:"abbreviated"});case"GGGGG":return n.era(i,{width:"narrow"});case"GGGG":default:return n.era(i,{width:"wide"})}},y:function(t,e,n){if(e==="yo"){var i=t.getUTCFullYear(),l=i>0?i:1-i;return n.ordinalNumber(l,{unit:"year"})}return nu.y(t,e)},Y:function(t,e,n,i){var l=tx(t,i),d=l>0?l:1-l;if(e==="YY"){var f=d%100;return jr(f,2)}return e==="Yo"?n.ordinalNumber(d,{unit:"year"}):jr(d,e.length)},R:function(t,e){var n=mC(t);return jr(n,e.length)},u:function(t,e){var n=t.getUTCFullYear();return jr(n,e.length)},Q:function(t,e,n){var i=Math.ceil((t.getUTCMonth()+1)/3);switch(e){case"Q":return String(i);case"QQ":return jr(i,2);case"Qo":return n.ordinalNumber(i,{unit:"quarter"});case"QQQ":return n.quarter(i,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(i,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(i,{width:"wide",context:"formatting"})}},q:function(t,e,n){var i=Math.ceil((t.getUTCMonth()+1)/3);switch(e){case"q":return String(i);case"qq":return jr(i,2);case"qo":return n.ordinalNumber(i,{unit:"quarter"});case"qqq":return n.quarter(i,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(i,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(i,{width:"wide",context:"standalone"})}},M:function(t,e,n){var i=t.getUTCMonth();switch(e){case"M":case"MM":return nu.M(t,e);case"Mo":return n.ordinalNumber(i+1,{unit:"month"});case"MMM":return n.month(i,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(i,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(i,{width:"wide",context:"formatting"})}},L:function(t,e,n){var i=t.getUTCMonth();switch(e){case"L":return String(i+1);case"LL":return jr(i+1,2);case"Lo":return n.ordinalNumber(i+1,{unit:"month"});case"LLL":return n.month(i,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(i,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(i,{width:"wide",context:"standalone"})}},w:function(t,e,n,i){var l=_C(t,i);return e==="wo"?n.ordinalNumber(l,{unit:"week"}):jr(l,e.length)},I:function(t,e,n){var i=gC(t);return e==="Io"?n.ordinalNumber(i,{unit:"week"}):jr(i,e.length)},d:function(t,e,n){return e==="do"?n.ordinalNumber(t.getUTCDate(),{unit:"date"}):nu.d(t,e)},D:function(t,e,n){var i=F8(t);return e==="Do"?n.ordinalNumber(i,{unit:"dayOfYear"}):jr(i,e.length)},E:function(t,e,n){var i=t.getUTCDay();switch(e){case"E":case"EE":case"EEE":return n.day(i,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(i,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(i,{width:"short",context:"formatting"});case"EEEE":default:return n.day(i,{width:"wide",context:"formatting"})}},e:function(t,e,n,i){var l=t.getUTCDay(),d=(l-i.weekStartsOn+8)%7||7;switch(e){case"e":return String(d);case"ee":return jr(d,2);case"eo":return n.ordinalNumber(d,{unit:"day"});case"eee":return n.day(l,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(l,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(l,{width:"short",context:"formatting"});case"eeee":default:return n.day(l,{width:"wide",context:"formatting"})}},c:function(t,e,n,i){var l=t.getUTCDay(),d=(l-i.weekStartsOn+8)%7||7;switch(e){case"c":return String(d);case"cc":return jr(d,e.length);case"co":return n.ordinalNumber(d,{unit:"day"});case"ccc":return n.day(l,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(l,{width:"narrow",context:"standalone"});case"cccccc":return n.day(l,{width:"short",context:"standalone"});case"cccc":default:return n.day(l,{width:"wide",context:"standalone"})}},i:function(t,e,n){var i=t.getUTCDay(),l=i===0?7:i;switch(e){case"i":return String(l);case"ii":return jr(l,e.length);case"io":return n.ordinalNumber(l,{unit:"day"});case"iii":return n.day(i,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(i,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(i,{width:"short",context:"formatting"});case"iiii":default:return n.day(i,{width:"wide",context:"formatting"})}},a:function(t,e,n){var i=t.getUTCHours(),l=i/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.dayPeriod(l,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(l,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(l,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(l,{width:"wide",context:"formatting"})}},b:function(t,e,n){var i=t.getUTCHours(),l;switch(i===12?l=Rh.noon:i===0?l=Rh.midnight:l=i/12>=1?"pm":"am",e){case"b":case"bb":return n.dayPeriod(l,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(l,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(l,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(l,{width:"wide",context:"formatting"})}},B:function(t,e,n){var i=t.getUTCHours(),l;switch(i>=17?l=Rh.evening:i>=12?l=Rh.afternoon:i>=4?l=Rh.morning:l=Rh.night,e){case"B":case"BB":case"BBB":return n.dayPeriod(l,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(l,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(l,{width:"wide",context:"formatting"})}},h:function(t,e,n){if(e==="ho"){var i=t.getUTCHours()%12;return i===0&&(i=12),n.ordinalNumber(i,{unit:"hour"})}return nu.h(t,e)},H:function(t,e,n){return e==="Ho"?n.ordinalNumber(t.getUTCHours(),{unit:"hour"}):nu.H(t,e)},K:function(t,e,n){var i=t.getUTCHours()%12;return e==="Ko"?n.ordinalNumber(i,{unit:"hour"}):jr(i,e.length)},k:function(t,e,n){var i=t.getUTCHours();return i===0&&(i=24),e==="ko"?n.ordinalNumber(i,{unit:"hour"}):jr(i,e.length)},m:function(t,e,n){return e==="mo"?n.ordinalNumber(t.getUTCMinutes(),{unit:"minute"}):nu.m(t,e)},s:function(t,e,n){return e==="so"?n.ordinalNumber(t.getUTCSeconds(),{unit:"second"}):nu.s(t,e)},S:function(t,e){return nu.S(t,e)},X:function(t,e,n,i){var l=i._originalDate||t,d=l.getTimezoneOffset();if(d===0)return"Z";switch(e){case"X":return G5(d);case"XXXX":case"XX":return vd(d);case"XXXXX":case"XXX":default:return vd(d,":")}},x:function(t,e,n,i){var l=i._originalDate||t,d=l.getTimezoneOffset();switch(e){case"x":return G5(d);case"xxxx":case"xx":return vd(d);case"xxxxx":case"xxx":default:return vd(d,":")}},O:function(t,e,n,i){var l=i._originalDate||t,d=l.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+V5(d,":");case"OOOO":default:return"GMT"+vd(d,":")}},z:function(t,e,n,i){var l=i._originalDate||t,d=l.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+V5(d,":");case"zzzz":default:return"GMT"+vd(d,":")}},t:function(t,e,n,i){var l=i._originalDate||t,d=Math.floor(l.getTime()/1e3);return jr(d,e.length)},T:function(t,e,n,i){var l=i._originalDate||t,d=l.getTime();return jr(d,e.length)}};function V5(t,e){var n=t>0?"-":"+",i=Math.abs(t),l=Math.floor(i/60),d=i%60;if(d===0)return n+String(l);var f=e||"";return n+String(l)+f+jr(d,2)}function G5(t,e){if(t%60===0){var n=t>0?"-":"+";return n+jr(Math.abs(t)/60,2)}return vd(t,e)}function vd(t,e){var n=e||"",i=t>0?"-":"+",l=Math.abs(t),d=jr(Math.floor(l/60),2),f=jr(l%60,2);return i+d+n+f}var q8=G8;function q5(t,e){switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}}function yC(t,e){switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}}function H8(t,e){var n=t.match(/(P+)(p+)?/)||[],i=n[1],l=n[2];if(!l)return q5(t,e);var d;switch(i){case"P":d=e.dateTime({width:"short"});break;case"PP":d=e.dateTime({width:"medium"});break;case"PPP":d=e.dateTime({width:"long"});break;case"PPPP":default:d=e.dateTime({width:"full"});break}return d.replace("{{date}}",q5(i,e)).replace("{{time}}",yC(l,e))}var W8={p:yC,P:H8},bC=W8,Z8=["D","DD"],X8=["YY","YYYY"];function vC(t){return Z8.indexOf(t)!==-1}function xC(t){return X8.indexOf(t)!==-1}function h_(t,e,n){if(t==="YYYY")throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(e,"`) for formatting years to the input `").concat(n,"`; see: https://git.io/fxCyr"));if(t==="YY")throw new RangeError("Use `yy` instead of `YY` (in `".concat(e,"`) for formatting years to the input `").concat(n,"`; see: https://git.io/fxCyr"));if(t==="D")throw new RangeError("Use `d` instead of `D` (in `".concat(e,"`) for formatting days of the month to the input `").concat(n,"`; see: https://git.io/fxCyr"));if(t==="DD")throw new RangeError("Use `dd` instead of `DD` (in `".concat(e,"`) for formatting days of the month to the input `").concat(n,"`; see: https://git.io/fxCyr"))}var Y8=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,K8=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,J8=/^'([^]*?)'?$/,Q8=/''/g,t7=/[a-zA-Z]/;function e7(t,e,n){Wi(2,arguments);var i=String(e),l=n||{},d=l.locale||fC,f=d.options&&d.options.firstWeekContainsDate,o=f==null?1:Ai(f),y=l.firstWeekContainsDate==null?o:Ai(l.firstWeekContainsDate);if(!(y>=1&&y<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var E=d.options&&d.options.weekStartsOn,C=E==null?0:Ai(E),A=l.weekStartsOn==null?C:Ai(l.weekStartsOn);if(!(A>=0&&A<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!d.localize)throw new RangeError("locale must contain localize property");if(!d.formatLong)throw new RangeError("locale must contain formatLong property");var P=Vo(t);if(!JR(P))throw new RangeError("Invalid time value");var B=hC(P),j=pC(P,B),Z={firstWeekContainsDate:y,weekStartsOn:A,locale:d,_originalDate:P},W=i.match(K8).map(function(H){var V=H[0];if(V==="p"||V==="P"){var tt=bC[V];return tt(H,d.formatLong,Z)}return H}).join("").match(Y8).map(function(H){if(H==="''")return"'";var V=H[0];if(V==="'")return n7(H);var tt=q8[V];if(tt)return!l.useAdditionalWeekYearTokens&&xC(H)&&h_(H,e,t),!l.useAdditionalDayOfYearTokens&&vC(H)&&h_(H,e,t),tt(j,H,d.localize,Z);if(V.match(t7))throw new RangeError("Format string contains an unescaped latin alphabet character `"+V+"`");return H}).join("");return W}function n7(t){return t.match(J8)[1].replace(Q8,"'")}function r7(t,e){if(t==null)throw new TypeError("assign requires that input parameter not be null or undefined");e=e||{};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}function Z1(t,e,n){Wi(2,arguments);var i=n||{},l=i.locale,d=l&&l.options&&l.options.weekStartsOn,f=d==null?0:Ai(d),o=i.weekStartsOn==null?f:Ai(i.weekStartsOn);if(!(o>=0&&o<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var y=Vo(t),E=Ai(e),C=y.getUTCDay(),A=E%7,P=(A+7)%7,B=(P<o?7:0)+E-C;return y.setUTCDate(y.getUTCDate()+B),y}function i7(t,e){Wi(2,arguments);var n=Ai(e);n%7===0&&(n=n-7);var i=1,l=Vo(t),d=l.getUTCDay(),f=n%7,o=(f+7)%7,y=(o<i?7:0)+n-d;return l.setUTCDate(l.getUTCDate()+y),l}function o7(t,e){Wi(2,arguments);var n=Vo(t),i=Ai(e),l=gC(n)-i;return n.setUTCDate(n.getUTCDate()-l*7),n}function a7(t,e,n){Wi(2,arguments);var i=Vo(t),l=Ai(e),d=_C(i,n)-l;return i.setUTCDate(i.getUTCDate()-d*7),i}var s7=36e5,l7=6e4,c7=1e3,Oi={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},ul={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function Ti(t,e,n){var i=e.match(t);if(!i)return null;var l=parseInt(i[0],10);return{value:n?n(l):l,rest:e.slice(i[0].length)}}function dl(t,e){var n=e.match(t);if(!n)return null;if(n[0]==="Z")return{value:0,rest:e.slice(1)};var i=n[1]==="+"?1:-1,l=n[2]?parseInt(n[2],10):0,d=n[3]?parseInt(n[3],10):0,f=n[5]?parseInt(n[5],10):0;return{value:i*(l*s7+d*l7+f*c7),rest:e.slice(n[0].length)}}function H5(t,e){return Ti(Oi.anyDigitsSigned,t,e)}function Si(t,e,n){switch(t){case 1:return Ti(Oi.singleDigit,e,n);case 2:return Ti(Oi.twoDigits,e,n);case 3:return Ti(Oi.threeDigits,e,n);case 4:return Ti(Oi.fourDigits,e,n);default:return Ti(new RegExp("^\\d{1,"+t+"}"),e,n)}}function d0(t,e,n){switch(t){case 1:return Ti(Oi.singleDigitSigned,e,n);case 2:return Ti(Oi.twoDigitsSigned,e,n);case 3:return Ti(Oi.threeDigitsSigned,e,n);case 4:return Ti(Oi.fourDigitsSigned,e,n);default:return Ti(new RegExp("^-?\\d{1,"+t+"}"),e,n)}}function X1(t){switch(t){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function W5(t,e){var n=e>0,i=n?e:1-e,l;if(i<=50)l=t||100;else{var d=i+50,f=Math.floor(d/100)*100,o=t>=d%100;l=t+f-(o?100:0)}return n?l:1-l}var u7=[31,28,31,30,31,30,31,31,30,31,30,31],d7=[31,29,31,30,31,30,31,31,30,31,30,31];function Z5(t){return t%400===0||t%4===0&&t%100!==0}var h7={G:{priority:140,parse:function(t,e,n,i){switch(e){case"G":case"GG":case"GGG":return n.era(t,{width:"abbreviated"})||n.era(t,{width:"narrow"});case"GGGGG":return n.era(t,{width:"narrow"});case"GGGG":default:return n.era(t,{width:"wide"})||n.era(t,{width:"abbreviated"})||n.era(t,{width:"narrow"})}},set:function(t,e,n,i){return e.era=n,t.setUTCFullYear(n,0,1),t.setUTCHours(0,0,0,0),t},incompatibleTokens:["R","u","t","T"]},y:{priority:130,parse:function(t,e,n,i){var l=function(d){return{year:d,isTwoDigitYear:e==="yy"}};switch(e){case"y":return Si(4,t,l);case"yo":return n.ordinalNumber(t,{unit:"year",valueCallback:l});default:return Si(e.length,t,l)}},validate:function(t,e,n){return e.isTwoDigitYear||e.year>0},set:function(t,e,n,i){var l=t.getUTCFullYear();if(n.isTwoDigitYear){var d=W5(n.year,l);return t.setUTCFullYear(d,0,1),t.setUTCHours(0,0,0,0),t}var f=!("era"in e)||e.era===1?n.year:1-n.year;return t.setUTCFullYear(f,0,1),t.setUTCHours(0,0,0,0),t},incompatibleTokens:["Y","R","u","w","I","i","e","c","t","T"]},Y:{priority:130,parse:function(t,e,n,i){var l=function(d){return{year:d,isTwoDigitYear:e==="YY"}};switch(e){case"Y":return Si(4,t,l);case"Yo":return n.ordinalNumber(t,{unit:"year",valueCallback:l});default:return Si(e.length,t,l)}},validate:function(t,e,n){return e.isTwoDigitYear||e.year>0},set:function(t,e,n,i){var l=tx(t,i);if(n.isTwoDigitYear){var d=W5(n.year,l);return t.setUTCFullYear(d,0,i.firstWeekContainsDate),t.setUTCHours(0,0,0,0),Pd(t,i)}var f=!("era"in e)||e.era===1?n.year:1-n.year;return t.setUTCFullYear(f,0,i.firstWeekContainsDate),t.setUTCHours(0,0,0,0),Pd(t,i)},incompatibleTokens:["y","R","u","Q","q","M","L","I","d","D","i","t","T"]},R:{priority:130,parse:function(t,e,n,i){return d0(e==="R"?4:e.length,t)},set:function(t,e,n,i){var l=new Date(0);return l.setUTCFullYear(n,0,4),l.setUTCHours(0,0,0,0),sf(l)},incompatibleTokens:["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]},u:{priority:130,parse:function(t,e,n,i){return d0(e==="u"?4:e.length,t)},set:function(t,e,n,i){return t.setUTCFullYear(n,0,1),t.setUTCHours(0,0,0,0),t},incompatibleTokens:["G","y","Y","R","w","I","i","e","c","t","T"]},Q:{priority:120,parse:function(t,e,n,i){switch(e){case"Q":case"QQ":return Si(e.length,t);case"Qo":return n.ordinalNumber(t,{unit:"quarter"});case"QQQ":return n.quarter(t,{width:"abbreviated",context:"formatting"})||n.quarter(t,{width:"narrow",context:"formatting"});case"QQQQQ":return n.quarter(t,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(t,{width:"wide",context:"formatting"})||n.quarter(t,{width:"abbreviated",context:"formatting"})||n.quarter(t,{width:"narrow",context:"formatting"})}},validate:function(t,e,n){return e>=1&&e<=4},set:function(t,e,n,i){return t.setUTCMonth((n-1)*3,1),t.setUTCHours(0,0,0,0),t},incompatibleTokens:["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]},q:{priority:120,parse:function(t,e,n,i){switch(e){case"q":case"qq":return Si(e.length,t);case"qo":return n.ordinalNumber(t,{unit:"quarter"});case"qqq":return n.quarter(t,{width:"abbreviated",context:"standalone"})||n.quarter(t,{width:"narrow",context:"standalone"});case"qqqqq":return n.quarter(t,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(t,{width:"wide",context:"standalone"})||n.quarter(t,{width:"abbreviated",context:"standalone"})||n.quarter(t,{width:"narrow",context:"standalone"})}},validate:function(t,e,n){return e>=1&&e<=4},set:function(t,e,n,i){return t.setUTCMonth((n-1)*3,1),t.setUTCHours(0,0,0,0),t},incompatibleTokens:["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]},M:{priority:110,parse:function(t,e,n,i){var l=function(d){return d-1};switch(e){case"M":return Ti(Oi.month,t,l);case"MM":return Si(2,t,l);case"Mo":return n.ordinalNumber(t,{unit:"month",valueCallback:l});case"MMM":return n.month(t,{width:"abbreviated",context:"formatting"})||n.month(t,{width:"narrow",context:"formatting"});case"MMMMM":return n.month(t,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(t,{width:"wide",context:"formatting"})||n.month(t,{width:"abbreviated",context:"formatting"})||n.month(t,{width:"narrow",context:"formatting"})}},validate:function(t,e,n){return e>=0&&e<=11},set:function(t,e,n,i){return t.setUTCMonth(n,1),t.setUTCHours(0,0,0,0),t},incompatibleTokens:["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]},L:{priority:110,parse:function(t,e,n,i){var l=function(d){return d-1};switch(e){case"L":return Ti(Oi.month,t,l);case"LL":return Si(2,t,l);case"Lo":return n.ordinalNumber(t,{unit:"month",valueCallback:l});case"LLL":return n.month(t,{width:"abbreviated",context:"standalone"})||n.month(t,{width:"narrow",context:"standalone"});case"LLLLL":return n.month(t,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(t,{width:"wide",context:"standalone"})||n.month(t,{width:"abbreviated",context:"standalone"})||n.month(t,{width:"narrow",context:"standalone"})}},validate:function(t,e,n){return e>=0&&e<=11},set:function(t,e,n,i){return t.setUTCMonth(n,1),t.setUTCHours(0,0,0,0),t},incompatibleTokens:["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]},w:{priority:100,parse:function(t,e,n,i){switch(e){case"w":return Ti(Oi.week,t);case"wo":return n.ordinalNumber(t,{unit:"week"});default:return Si(e.length,t)}},validate:function(t,e,n){return e>=1&&e<=53},set:function(t,e,n,i){return Pd(a7(t,n,i),i)},incompatibleTokens:["y","R","u","q","Q","M","L","I","d","D","i","t","T"]},I:{priority:100,parse:function(t,e,n,i){switch(e){case"I":return Ti(Oi.week,t);case"Io":return n.ordinalNumber(t,{unit:"week"});default:return Si(e.length,t)}},validate:function(t,e,n){return e>=1&&e<=53},set:function(t,e,n,i){return sf(o7(t,n,i),i)},incompatibleTokens:["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]},d:{priority:90,subPriority:1,parse:function(t,e,n,i){switch(e){case"d":return Ti(Oi.date,t);case"do":return n.ordinalNumber(t,{unit:"date"});default:return Si(e.length,t)}},validate:function(t,e,n){var i=t.getUTCFullYear(),l=Z5(i),d=t.getUTCMonth();return l?e>=1&&e<=d7[d]:e>=1&&e<=u7[d]},set:function(t,e,n,i){return t.setUTCDate(n),t.setUTCHours(0,0,0,0),t},incompatibleTokens:["Y","R","q","Q","w","I","D","i","e","c","t","T"]},D:{priority:90,subPriority:1,parse:function(t,e,n,i){switch(e){case"D":case"DD":return Ti(Oi.dayOfYear,t);case"Do":return n.ordinalNumber(t,{unit:"date"});default:return Si(e.length,t)}},validate:function(t,e,n){var i=t.getUTCFullYear(),l=Z5(i);return l?e>=1&&e<=366:e>=1&&e<=365},set:function(t,e,n,i){return t.setUTCMonth(0,n),t.setUTCHours(0,0,0,0),t},incompatibleTokens:["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]},E:{priority:90,parse:function(t,e,n,i){switch(e){case"E":case"EE":case"EEE":return n.day(t,{width:"abbreviated",context:"formatting"})||n.day(t,{width:"short",context:"formatting"})||n.day(t,{width:"narrow",context:"formatting"});case"EEEEE":return n.day(t,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(t,{width:"short",context:"formatting"})||n.day(t,{width:"narrow",context:"formatting"});case"EEEE":default:return n.day(t,{width:"wide",context:"formatting"})||n.day(t,{width:"abbreviated",context:"formatting"})||n.day(t,{width:"short",context:"formatting"})||n.day(t,{width:"narrow",context:"formatting"})}},validate:function(t,e,n){return e>=0&&e<=6},set:function(t,e,n,i){return t=Z1(t,n,i),t.setUTCHours(0,0,0,0),t},incompatibleTokens:["D","i","e","c","t","T"]},e:{priority:90,parse:function(t,e,n,i){var l=function(d){var f=Math.floor((d-1)/7)*7;return(d+i.weekStartsOn+6)%7+f};switch(e){case"e":case"ee":return Si(e.length,t,l);case"eo":return n.ordinalNumber(t,{unit:"day",valueCallback:l});case"eee":return n.day(t,{width:"abbreviated",context:"formatting"})||n.day(t,{width:"short",context:"formatting"})||n.day(t,{width:"narrow",context:"formatting"});case"eeeee":return n.day(t,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(t,{width:"short",context:"formatting"})||n.day(t,{width:"narrow",context:"formatting"});case"eeee":default:return n.day(t,{width:"wide",context:"formatting"})||n.day(t,{width:"abbreviated",context:"formatting"})||n.day(t,{width:"short",context:"formatting"})||n.day(t,{width:"narrow",context:"formatting"})}},validate:function(t,e,n){return e>=0&&e<=6},set:function(t,e,n,i){return t=Z1(t,n,i),t.setUTCHours(0,0,0,0),t},incompatibleTokens:["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]},c:{priority:90,parse:function(t,e,n,i){var l=function(d){var f=Math.floor((d-1)/7)*7;return(d+i.weekStartsOn+6)%7+f};switch(e){case"c":case"cc":return Si(e.length,t,l);case"co":return n.ordinalNumber(t,{unit:"day",valueCallback:l});case"ccc":return n.day(t,{width:"abbreviated",context:"standalone"})||n.day(t,{width:"short",context:"standalone"})||n.day(t,{width:"narrow",context:"standalone"});case"ccccc":return n.day(t,{width:"narrow",context:"standalone"});case"cccccc":return n.day(t,{width:"short",context:"standalone"})||n.day(t,{width:"narrow",context:"standalone"});case"cccc":default:return n.day(t,{width:"wide",context:"standalone"})||n.day(t,{width:"abbreviated",context:"standalone"})||n.day(t,{width:"short",context:"standalone"})||n.day(t,{width:"narrow",context:"standalone"})}},validate:function(t,e,n){return e>=0&&e<=6},set:function(t,e,n,i){return t=Z1(t,n,i),t.setUTCHours(0,0,0,0),t},incompatibleTokens:["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]},i:{priority:90,parse:function(t,e,n,i){var l=function(d){return d===0?7:d};switch(e){case"i":case"ii":return Si(e.length,t);case"io":return n.ordinalNumber(t,{unit:"day"});case"iii":return n.day(t,{width:"abbreviated",context:"formatting",valueCallback:l})||n.day(t,{width:"short",context:"formatting",valueCallback:l})||n.day(t,{width:"narrow",context:"formatting",valueCallback:l});case"iiiii":return n.day(t,{width:"narrow",context:"formatting",valueCallback:l});case"iiiiii":return n.day(t,{width:"short",context:"formatting",valueCallback:l})||n.day(t,{width:"narrow",context:"formatting",valueCallback:l});case"iiii":default:return n.day(t,{width:"wide",context:"formatting",valueCallback:l})||n.day(t,{width:"abbreviated",context:"formatting",valueCallback:l})||n.day(t,{width:"short",context:"formatting",valueCallback:l})||n.day(t,{width:"narrow",context:"formatting",valueCallback:l})}},validate:function(t,e,n){return e>=1&&e<=7},set:function(t,e,n,i){return t=i7(t,n,i),t.setUTCHours(0,0,0,0),t},incompatibleTokens:["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]},a:{priority:80,parse:function(t,e,n,i){switch(e){case"a":case"aa":case"aaa":return n.dayPeriod(t,{width:"abbreviated",context:"formatting"})||n.dayPeriod(t,{width:"narrow",context:"formatting"});case"aaaaa":return n.dayPeriod(t,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(t,{width:"wide",context:"formatting"})||n.dayPeriod(t,{width:"abbreviated",context:"formatting"})||n.dayPeriod(t,{width:"narrow",context:"formatting"})}},set:function(t,e,n,i){return t.setUTCHours(X1(n),0,0,0),t},incompatibleTokens:["b","B","H","k","t","T"]},b:{priority:80,parse:function(t,e,n,i){switch(e){case"b":case"bb":case"bbb":return n.dayPeriod(t,{width:"abbreviated",context:"formatting"})||n.dayPeriod(t,{width:"narrow",context:"formatting"});case"bbbbb":return n.dayPeriod(t,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(t,{width:"wide",context:"formatting"})||n.dayPeriod(t,{width:"abbreviated",context:"formatting"})||n.dayPeriod(t,{width:"narrow",context:"formatting"})}},set:function(t,e,n,i){return t.setUTCHours(X1(n),0,0,0),t},incompatibleTokens:["a","B","H","k","t","T"]},B:{priority:80,parse:function(t,e,n,i){switch(e){case"B":case"BB":case"BBB":return n.dayPeriod(t,{width:"abbreviated",context:"formatting"})||n.dayPeriod(t,{width:"narrow",context:"formatting"});case"BBBBB":return n.dayPeriod(t,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(t,{width:"wide",context:"formatting"})||n.dayPeriod(t,{width:"abbreviated",context:"formatting"})||n.dayPeriod(t,{width:"narrow",context:"formatting"})}},set:function(t,e,n,i){return t.setUTCHours(X1(n),0,0,0),t},incompatibleTokens:["a","b","t","T"]},h:{priority:70,parse:function(t,e,n,i){switch(e){case"h":return Ti(Oi.hour12h,t);case"ho":return n.ordinalNumber(t,{unit:"hour"});default:return Si(e.length,t)}},validate:function(t,e,n){return e>=1&&e<=12},set:function(t,e,n,i){var l=t.getUTCHours()>=12;return l&&n<12?t.setUTCHours(n+12,0,0,0):!l&&n===12?t.setUTCHours(0,0,0,0):t.setUTCHours(n,0,0,0),t},incompatibleTokens:["H","K","k","t","T"]},H:{priority:70,parse:function(t,e,n,i){switch(e){case"H":return Ti(Oi.hour23h,t);case"Ho":return n.ordinalNumber(t,{unit:"hour"});default:return Si(e.length,t)}},validate:function(t,e,n){return e>=0&&e<=23},set:function(t,e,n,i){return t.setUTCHours(n,0,0,0),t},incompatibleTokens:["a","b","h","K","k","t","T"]},K:{priority:70,parse:function(t,e,n,i){switch(e){case"K":return Ti(Oi.hour11h,t);case"Ko":return n.ordinalNumber(t,{unit:"hour"});default:return Si(e.length,t)}},validate:function(t,e,n){return e>=0&&e<=11},set:function(t,e,n,i){var l=t.getUTCHours()>=12;return l&&n<12?t.setUTCHours(n+12,0,0,0):t.setUTCHours(n,0,0,0),t},incompatibleTokens:["h","H","k","t","T"]},k:{priority:70,parse:function(t,e,n,i){switch(e){case"k":return Ti(Oi.hour24h,t);case"ko":return n.ordinalNumber(t,{unit:"hour"});default:return Si(e.length,t)}},validate:function(t,e,n){return e>=1&&e<=24},set:function(t,e,n,i){var l=n<=24?n%24:n;return t.setUTCHours(l,0,0,0),t},incompatibleTokens:["a","b","h","H","K","t","T"]},m:{priority:60,parse:function(t,e,n,i){switch(e){case"m":return Ti(Oi.minute,t);case"mo":return n.ordinalNumber(t,{unit:"minute"});default:return Si(e.length,t)}},validate:function(t,e,n){return e>=0&&e<=59},set:function(t,e,n,i){return t.setUTCMinutes(n,0,0),t},incompatibleTokens:["t","T"]},s:{priority:50,parse:function(t,e,n,i){switch(e){case"s":return Ti(Oi.second,t);case"so":return n.ordinalNumber(t,{unit:"second"});default:return Si(e.length,t)}},validate:function(t,e,n){return e>=0&&e<=59},set:function(t,e,n,i){return t.setUTCSeconds(n,0),t},incompatibleTokens:["t","T"]},S:{priority:30,parse:function(t,e,n,i){var l=function(d){return Math.floor(d*Math.pow(10,-e.length+3))};return Si(e.length,t,l)},set:function(t,e,n,i){return t.setUTCMilliseconds(n),t},incompatibleTokens:["t","T"]},X:{priority:10,parse:function(t,e,n,i){switch(e){case"X":return dl(ul.basicOptionalMinutes,t);case"XX":return dl(ul.basic,t);case"XXXX":return dl(ul.basicOptionalSeconds,t);case"XXXXX":return dl(ul.extendedOptionalSeconds,t);case"XXX":default:return dl(ul.extended,t)}},set:function(t,e,n,i){return e.timestampIsSet?t:new Date(t.getTime()-n)},incompatibleTokens:["t","T","x"]},x:{priority:10,parse:function(t,e,n,i){switch(e){case"x":return dl(ul.basicOptionalMinutes,t);case"xx":return dl(ul.basic,t);case"xxxx":return dl(ul.basicOptionalSeconds,t);case"xxxxx":return dl(ul.extendedOptionalSeconds,t);case"xxx":default:return dl(ul.extended,t)}},set:function(t,e,n,i){return e.timestampIsSet?t:new Date(t.getTime()-n)},incompatibleTokens:["t","T","X"]},t:{priority:40,parse:function(t,e,n,i){return H5(t)},set:function(t,e,n,i){return[new Date(n*1e3),{timestampIsSet:!0}]},incompatibleTokens:"*"},T:{priority:20,parse:function(t,e,n,i){return H5(t)},set:function(t,e,n,i){return[new Date(n),{timestampIsSet:!0}]},incompatibleTokens:"*"}},f7=h7,p7=10,m7=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,g7=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,_7=/^'([^]*?)'?$/,y7=/''/g,b7=/\S/,v7=/[a-zA-Z]/;function x7(t,e,n,i){Wi(3,arguments);var l=String(t),d=String(e),f=i||{},o=f.locale||fC;if(!o.match)throw new RangeError("locale must contain match property");var y=o.options&&o.options.firstWeekContainsDate,E=y==null?1:Ai(y),C=f.firstWeekContainsDate==null?E:Ai(f.firstWeekContainsDate);if(!(C>=1&&C<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var A=o.options&&o.options.weekStartsOn,P=A==null?0:Ai(A),B=f.weekStartsOn==null?P:Ai(f.weekStartsOn);if(!(B>=0&&B<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(d==="")return l===""?Vo(n):new Date(NaN);var j={firstWeekContainsDate:C,weekStartsOn:B,locale:o},Z=[{priority:p7,subPriority:-1,set:w7,index:0}],W,H=d.match(g7).map(function(gn){var _n=gn[0];if(_n==="p"||_n==="P"){var Gn=bC[_n];return Gn(gn,o.formatLong,j)}return gn}).join("").match(m7),V=[];for(W=0;W<H.length;W++){var tt=H[W];!f.useAdditionalWeekYearTokens&&xC(tt)&&h_(tt,d,t),!f.useAdditionalDayOfYearTokens&&vC(tt)&&h_(tt,d,t);var ft=tt[0],et=f7[ft];if(et){var Pt=et.incompatibleTokens;if(Array.isArray(Pt)){for(var Rt=void 0,zt=0;zt<V.length;zt++){var jt=V[zt].token;if(Pt.indexOf(jt)!==-1||jt===ft){Rt=V[zt];break}}if(Rt)throw new RangeError("The format string mustn't contain `".concat(Rt.fullToken,"` and `").concat(tt,"` at the same time"))}else if(et.incompatibleTokens==="*"&&V.length)throw new RangeError("The format string mustn't contain `".concat(tt,"` and any other token at the same time"));V.push({token:ft,fullToken:tt});var oe=et.parse(l,tt,o.match,j);if(!oe)return new Date(NaN);Z.push({priority:et.priority,subPriority:et.subPriority||0,set:et.set,validate:et.validate,value:oe.value,index:Z.length}),l=oe.rest}else{if(ft.match(v7))throw new RangeError("Format string contains an unescaped latin alphabet character `"+ft+"`");if(tt==="''"?tt="'":ft==="'"&&(tt=E7(tt)),l.indexOf(tt)===0)l=l.slice(tt.length);else return new Date(NaN)}}if(l.length>0&&b7.test(l))return new Date(NaN);var ge=Z.map(function(gn){return gn.priority}).sort(function(gn,_n){return _n-gn}).filter(function(gn,_n,Gn){return Gn.indexOf(gn)===_n}).map(function(gn){return Z.filter(function(_n){return _n.priority===gn}).sort(function(_n,Gn){return Gn.subPriority-_n.subPriority})}).map(function(gn){return gn[0]}),ce=Vo(n);if(isNaN(ce))return new Date(NaN);var Ue=pC(ce,hC(ce)),Ae={};for(W=0;W<ge.length;W++){var se=ge[W];if(se.validate&&!se.validate(Ue,se.value,j))return new Date(NaN);var Ze=se.set(Ue,Ae,se.value,j);Ze[0]?(Ue=Ze[0],r7(Ae,Ze[1])):Ue=Ze}return Ue}function w7(t,e){if(e.timestampIsSet)return t;var n=new Date(0);return n.setFullYear(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()),n.setHours(t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),t.getUTCMilliseconds()),n}function E7(t){return t.match(_7)[1].replace(y7,"'")}var ba=(t,e)=>{const n=t.__vccOpts||t;for(const[i,l]of e)n[i]=l;return n};const T7={name:"ExternalLinkInline",props:{link:String,text:{type:String,default:""}}},k7=["href"];function C7(t,e,n,i,l,d){const f=ea("font-awesome-icon");return wn(),$n("a",{href:n.link,target:"_blank"},[Ao(t.$slots,"default",{},void 0,!0),Yr(Mi(n.text),1),ln(f,{class:"ms-2",icon:["fas","external-link-alt"]})],8,k7)}var S7=ba(T7,[["render",C7],["__scopeId","data-v-1aabd0ee"]]);const M7={name:"ColourStripe",props:{colour:String,secondaryColour:String},computed:{harmony:function(){var t=new XR;return this.colour?this.secondaryColour?[this.colour,this.secondaryColour]:t.harmonize(this.colour,"neutral"):["#58787f","rgb(52, 148, 148)"]},gradient:function(){return`linear-gradient(230deg, ${this.harmony[1]} 0%, ${this.harmony[0]} 50%)`}}};function A7(t,e,n,i,l,d){return wn(),$n("div",{id:"stripe",style:hu({backgroundImage:d.gradient})},null,4)}var I7=ba(M7,[["render",A7],["__scopeId","data-v-dcbfc80a"]]);const P7={name:"Card",props:{missing:{type:Boolean,default:!1},gradient:{type:Boolean,default:!1},frosted:{type:Boolean,default:!1},stripeColour:String}},L7={class:"padding-div"};function z7(t,e,n,i,l,d){const f=I7;return wn(),$n("div",{class:ts(["wts-card",{"wts-card-missing":n.missing,"wts-card-gradient":n.gradient,"wts-card-frosted":n.frosted}])},[Ee("div",L7,[Ao(t.$slots,"default",{},void 0,!0)]),n.stripeColour?(wn(),_l(f,{key:0,colour:n.stripeColour},null,8,["colour"])):es("",!0)],2)}var ex=ba(P7,[["render",z7],["__scopeId","data-v-41c29105"]]);const h0=void 0;const O7=!1;/*!
  * pinia v2.0.14
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */let wC;const Rm=t=>wC=t,EC=Symbol();function Zb(t){return t&&typeof t=="object"&&Object.prototype.toString.call(t)==="[object Object]"&&typeof t.toJSON!="function"}var Kp;(function(t){t.direct="direct",t.patchObject="patch object",t.patchFunction="patch function"})(Kp||(Kp={}));function D7(){const t=Rk(!0),e=t.run(()=>so({}));let n=[],i=[];const l=Od({install(d){Rm(l),l._a=d,d.provide(EC,l),d.config.globalProperties.$pinia=l,i.forEach(f=>n.push(f)),i=[]},use(d){return!this._a&&!O7?i.push(d):n.push(d),this},_p:n,_a:null,_e:t,_s:new Map,state:e});return l}const TC=()=>{};function X5(t,e,n,i=TC){t.push(e);const l=()=>{const d=t.indexOf(e);d>-1&&(t.splice(d,1),i())};return!n&&qo()&&Ni(l),l}function Bh(t,...e){t.slice().forEach(n=>{n(...e)})}function Xb(t,e){for(const n in e){if(!e.hasOwnProperty(n))continue;const i=e[n],l=t[n];Zb(l)&&Zb(i)&&t.hasOwnProperty(n)&&!yi(i)&&!pu(i)?t[n]=Xb(l,i):t[n]=i}return t}const R7=Symbol();function B7(t){return!Zb(t)||!t.hasOwnProperty(R7)}const{assign:tc}=Object;function F7(t){return!!(yi(t)&&t.effect)}function N7(t,e,n,i){const{state:l,actions:d,getters:f}=e,o=n.state.value[t];let y;function E(){o||(n.state.value[t]=l?l():{});const C=jv(n.state.value[t]);return tc(C,d,Object.keys(f||{}).reduce((A,P)=>(A[P]=Od(mr(()=>{Rm(n);const B=n._s.get(t);return f[P].call(B,B)})),A),{}))}return y=kC(t,E,e,n,i,!0),y.$reset=function(){const A=l?l():{};this.$patch(P=>{tc(P,A)})},y}function kC(t,e,n={},i,l,d){let f;const o=tc({actions:{}},n),y={deep:!0};let E,C,A=Od([]),P=Od([]),B;const j=i.state.value[t];!d&&!j&&(i.state.value[t]={}),so({});let Z;function W(Rt){let zt;E=C=!1,typeof Rt=="function"?(Rt(i.state.value[t]),zt={type:Kp.patchFunction,storeId:t,events:B}):(Xb(i.state.value[t],Rt),zt={type:Kp.patchObject,payload:Rt,storeId:t,events:B});const jt=Z=Symbol();B_().then(()=>{Z===jt&&(E=!0)}),C=!0,Bh(A,zt,i.state.value[t])}const H=TC;function V(){f.stop(),A=[],P=[],i._s.delete(t)}function tt(Rt,zt){return function(){Rm(i);const jt=Array.from(arguments),oe=[],ge=[];function ce(se){oe.push(se)}function Ue(se){ge.push(se)}Bh(P,{args:jt,name:Rt,store:et,after:ce,onError:Ue});let Ae;try{Ae=zt.apply(this&&this.$id===t?this:et,jt)}catch(se){throw Bh(ge,se),se}return Ae instanceof Promise?Ae.then(se=>(Bh(oe,se),se)).catch(se=>(Bh(ge,se),Promise.reject(se))):(Bh(oe,Ae),Ae)}}const ft={_p:i,$id:t,$onAction:X5.bind(null,P),$patch:W,$reset:H,$subscribe(Rt,zt={}){const jt=X5(A,Rt,zt.detached,()=>oe()),oe=f.run(()=>$r(()=>i.state.value[t],ge=>{(zt.flush==="sync"?C:E)&&Rt({storeId:t,type:Kp.direct,events:B},ge)},tc({},y,zt)));return jt},$dispose:V},et=ya(tc({},ft));i._s.set(t,et);const Pt=i._e.run(()=>(f=Rk(),f.run(()=>e())));for(const Rt in Pt){const zt=Pt[Rt];if(yi(zt)&&!F7(zt)||pu(zt))d||(j&&B7(zt)&&(yi(zt)?zt.value=j[Rt]:Xb(zt,j[Rt])),i.state.value[t][Rt]=zt);else if(typeof zt=="function"){const jt=tt(Rt,zt);Pt[Rt]=jt,o.actions[Rt]=zt}}return tc(et,Pt),tc(kr(et),Pt),Object.defineProperty(et,"$state",{get:()=>i.state.value[t],set:Rt=>{W(zt=>{tc(zt,Rt)})}}),i._p.forEach(Rt=>{tc(et,f.run(()=>Rt({store:et,app:i._a,pinia:i,options:o})))}),j&&d&&n.hydrate&&n.hydrate(et.$state,j),E=!0,C=!0,et}function $d(t,e,n){let i,l;const d=typeof e=="function";typeof t=="string"?(i=t,l=d?n:e):(l=t,i=t.id);function f(o,y){const E=qo();return o=o||E&&Pr(EC),o&&Rm(o),o=wC,o._s.has(i)||(d?kC(i,e,l,o):N7(i,l,o)),o._s.get(i)}return f.$id=i,f}const Ri="https://wheretheystand.nz/api/",wet=$d("bills",{state(){return{items:[]}},getters:{byID:t=>e=>t.items.find(n=>n.id==e)},actions:{async fetch(t){if(!this.byID(t)){var e=this;await Di(Ri+"bills/"+t+"/",{onResponse({request:n,response:i,options:l}){e.items.push(i._data)},onResponseError({request:n,response:i,options:l}){useNotificationsStore().postResponseError(i)},onRequestError({request:n,options:i,error:l}){useNotificationsStore().addToast("Error fetching resource (request)",l)}})}}}});const f0=void 0;const p0=void 0,Eet=$d("electorates",{state(){return{items:[],data:{histories:{},shapes:{}}}},getters:{byIdentifier:t=>e=>t.items.find(n=>n.slug===e)?t.items.find(n=>n.slug===e):t.items.find(n=>n.id===e),historyByIdentifier:t=>e=>t.data.histories[e],shapeByIdentifier:t=>e=>t.data.shapes[e]},actions:{async fetch(t){if(!this.byIdentifier(t)){var e=this;await Di(Ri+"electorates/"+t+"/",{onResponse({request:n,response:i,options:l}){e.items.push(i._data)},onResponseError({request:n,response:i,options:l}){useNotificationsStore().postResponseError(i)},onRequestError({request:n,options:i,error:l}){useNotificationsStore().addToast("Error fetching resource (request)",l)}})}},async fetchHistory(t){if(!this.historyByIdentifier(t)){var e=this;await Di(Ri+"electorates/"+t+"/history/",{onResponse({request:n,response:i,options:l}){e.data.histories[t]=i._data},onResponseError({request:n,response:i,options:l}){useNotificationsStore().postResponseError(i)},onRequestError({request:n,options:i,error:l}){useNotificationsStore().addToast("Error fetching resource (request)",l)}})}},async fetchShape(t){if(!this.shapeByIdentifier(t)){var e=this;await Di(Ri+"electorates/"+t+"/shape/",{onResponse({request:n,response:i,options:l}){e.data.shapes[t]=i._data},onResponseError({request:n,response:i,options:l}){useNotificationsStore().postResponseError(i)},onRequestError({request:n,options:i,error:l}){useNotificationsStore().addToast("Error fetching resource (request)",l)}})}}}});const m0=void 0;const Tet=$d("groups",{state(){return{items:[]}},getters:{byName:t=>(e,n)=>{if(t.items.find(i=>i.name===e&&i.type===n))return t.items.find(i=>i.name===e&&i.type===n).items}},actions:{async fetchPeople(t){if(!this.byName(t,"people")){var e=this;await Di(Ri+"people/?group="+t,{onResponse({request:n,response:i,options:l}){e.items.push({items:i._data,name:t,type:"people"})},onResponseError({request:n,response:i,options:l}){useNotificationsStore().postResponseError(i)},onRequestError({request:n,options:i,error:l}){useNotificationsStore().addToast("Error fetching resource (request)",l)}})}},async fetchElectorates(t){if(!this.byName(t,"electorates")){var e=this;await Di(Ri+"electorates/?group="+t,{onResponse({request:n,response:i,options:l}){e.items.push({items:i._data,name:t,type:"electorates"})},onResponseError({request:n,response:i,options:l}){useNotificationsStore().postResponseError(i)},onRequestError({request:n,options:i,error:l}){useNotificationsStore().addToast("Error fetching resource (request)",l)}})}},async fetchParties(t){if(!this.byName(t,"parties")){var e=this;await Di(Ri+"parties/?group="+t,{onResponse({request:n,response:i,options:l}){e.items.push({items:i._data,name:t,type:"parties"})},onResponseError({request:n,response:i,options:l}){useNotificationsStore().postResponseError(i)},onRequestError({request:n,options:i,error:l}){useNotificationsStore().addToast("Error fetching resource (request)",l)}})}}}}),g0=void 0;const _0=void 0,ket=$d("parties",{state(){return{items:[],data:{members:{},leaders:{}}}},getters:{byIdentifier:t=>e=>t.items.find(n=>n.slug===e)?t.items.find(n=>n.slug===e):t.items.find(n=>n.id===e),membersByIdentifier:t=>e=>t.data.members[e],leadersByIdentifier:t=>e=>t.data.leaders[e]},actions:{async fetch(t){if(!this.byIdentifier(t)){var e=this;await Di(Ri+"parties/"+t+"/",{onResponse({request:n,response:i,options:l}){e.items.push(i._data)},onResponseError({request:n,response:i,options:l}){useNotificationsStore().postResponseError(i)},onRequestError({request:n,options:i,error:l}){useNotificationsStore().addToast("Error fetching resource (request)",l)}})}},async fetchMembers(t){if(!this.membersByIdentifier(t)){var e=this;await Di(Ri+"parties/"+t+"/members/",{onResponse({request:n,response:i,options:l}){e.data.members[t]=i._data},onResponseError({request:n,response:i,options:l}){useNotificationsStore().postResponseError(i)},onRequestError({request:n,options:i,error:l}){useNotificationsStore().addToast("Error fetching resource (request)",l)}})}},async fetchLeaders(t){if(!this.leadersByIdentifier(t)){var e=this;await Di(Ri+"parties/"+t+"/leaders/",{onResponse({request:n,response:i,options:l}){e.data.leaders[t]=i._data},onResponseError({request:n,response:i,options:l}){useNotificationsStore().postResponseError(i)},onRequestError({request:n,options:i,error:l}){useNotificationsStore().addToast("Error fetching resource (request)",l)}})}}}}),y0=void 0,b0=void 0;const v0=void 0;const x0=void 0,qi=$d("notifications",{state(){return{banners:[{id:0,linkBehaviour:"none",title:"New look",message:"WhereTheyStand has had a facelift! The new design is still in the early stages (this is the minimum viable product), so if you run into any issues, try refreshing the page. You're always welcome to leave feedback via the link in the footer."}],toasts:[],loaded:!0,toastId:0}},actions:{async fetch(){this.loaded||await Di(Ri+"notifications/banners/",{onResponse({request:t,response:e,options:n}){this.banners=e._data},onResponseError({request:t,response:e,options:n}){},onRequestError({request:t,options:e,error:n}){}})},addToast(t,e){this.toasts.push({id:this.toastId,title:t,message:e}),this.toastId=this.toastId+1},closeToast(t){var e=this.toasts.map(n=>n.id).indexOf(t);e>=0&&this.toasts.splice(e,1)},closeBanner(t){var e=this.banners.map(n=>n.id).indexOf(t);e>=0&&this.banners.splice(e,1)},postResponseError(t){this.addToast("Error fetching resource (response)",t.status+" "+t._data.detail)}}}),Cet=$d("people",{state(){return{items:[],data:{votes:{},bills:{},interests:{},mpExpenses:{},execExpenses:{},returns:{},votingSimilarity:{},details:{}}}},getters:{byIdentifier:t=>e=>t.items.find(n=>n.slug===e)?t.items.find(n=>n.slug===e):t.items.find(n=>n.id===e),votesByIdentifier:t=>e=>t.data.votes[e],billsByIdentifier:t=>e=>t.data.bills[e],interestsByIdentifier:t=>e=>t.data.interests[e],mpExpensesByIdentifier:t=>e=>t.data.mpExpenses[e],execExpensesByIdentifier:t=>e=>t.data.execExpenses[e],returnsByIdentifier:t=>e=>t.data.returns[e],votingSimilarityByIdentifier:t=>e=>t.data.votingSimilarity[e],detailsByIdentifier:t=>e=>t.data.details[e]},actions:{async fetch(t){if(!this.byIdentifier(t)){var e=this;await Di(Ri+"people/"+t+"/",{onResponse({request:n,response:i,options:l}){e.items.push(i._data)},onResponseError({request:n,response:i,options:l}){qi().postResponseError(i)},onRequestError({request:n,options:i,error:l}){qi().addToast("Error fetching resource (request)",l)}})}},async fetchVotes(t){if(!this.votesByIdentifier(t)){var e=this;await Di(Ri+"people/"+t+"/votes/",{onResponse({request:n,response:i,options:l}){e.data.votes[t]=i._data},onResponseError({request:n,response:i,options:l}){qi().postResponseError(i)},onRequestError({request:n,options:i,error:l}){qi().addToast("Error fetching resource (request)",l)}})}},async fetchBills(t){if(!this.billsByIdentifier(t)){var e=this;await Di(Ri+"people/"+t+"/bills/",{onResponse({request:n,response:i,options:l}){e.data.bills[t]=i._data},onResponseError({request:n,response:i,options:l}){qi().postResponseError(i)},onRequestError({request:n,options:i,error:l}){qi().addToast("Error fetching resource (request)",l)}})}},async fetchInterests(t){if(!this.interestsByIdentifier(t)){var e=this;await Di(Ri+"people/"+t+"/interests/",{onResponse({request:n,response:i,options:l}){e.data.interests[t]=i._data},onResponseError({request:n,response:i,options:l}){qi().postResponseError(i)},onRequestError({request:n,options:i,error:l}){qi().addToast("Error fetching resource (request)",l)}})}},async fetchMpExpenses(t){if(!this.mpExpensesByIdentifier(t)){var e=this;await Di(Ri+"people/"+t+"/mp-expenses/",{onResponse({request:n,response:i,options:l}){e.data.mpExpenses[t]=i._data},onResponseError({request:n,response:i,options:l}){qi().postResponseError(i)},onRequestError({request:n,options:i,error:l}){qi().addToast("Error fetching resource (request)",l)}})}},async fetchExecExpenses(t){if(!this.execExpensesByIdentifier(t)){var e=this;await Di(Ri+"people/"+t+"/exec-expenses/",{onResponse({request:n,response:i,options:l}){e.data.execExpenses[t]=i._data},onResponseError({request:n,response:i,options:l}){qi().postResponseError(i)},onRequestError({request:n,options:i,error:l}){qi().addToast("Error fetching resource (request)",l)}})}},async fetchReturns(t){if(!this.returnsByIdentifier(t)){var e=this;await Di(Ri+"people/"+t+"/returns/",{onResponse({request:n,response:i,options:l}){e.data.returns[t]=i._data},onResponseError({request:n,response:i,options:l}){qi().postResponseError(i)},onRequestError({request:n,options:i,error:l}){qi().addToast("Error fetching resource (request)",l)}})}},async fetchVotingSimilarity(t){if(!this.votingSimilarityByIdentifier(t)){var e=this;await Di(Ri+"people/"+t+"/voting-similarity/",{onResponse({request:n,response:i,options:l}){e.data.votingSimilarity[t]=i._data},onResponseError({request:n,response:i,options:l}){qi().postResponseError(i)},onRequestError({request:n,options:i,error:l}){qi().addToast("Error fetching resource (request)",l)}})}},async fetchDetails(t){if(!this.detailsByIdentifier(t)){var e=this;await Di(Ri+"people/"+t+"/details/",{onResponse({request:n,response:i,options:l}){e.data.details[t]=i._data},onResponseError({request:n,response:i,options:l}){qi().postResponseError(i)},onRequestError({request:n,options:i,error:l}){qi().addToast("Error fetching resource (request)",l)}})}}}}),w0=void 0;/*!
 * Chart.js v3.8.0
 * https://www.chartjs.org
 * (c) 2022 Chart.js Contributors
 * Released under the MIT License
 */const CC=function(){return typeof window=="undefined"?function(t){return t()}:window.requestAnimationFrame}();function SC(t,e,n){const i=n||(f=>Array.prototype.slice.call(f));let l=!1,d=[];return function(...f){d=i(f),l||(l=!0,CC.call(window,()=>{l=!1,t.apply(e,d)}))}}function j7(t,e){let n;return function(...i){return e?(clearTimeout(n),n=setTimeout(t,e,i)):t.apply(this,i),e}}const nx=t=>t==="start"?"left":t==="end"?"right":"center",Fo=(t,e,n)=>t==="start"?e:t==="end"?n:(e+n)/2,U7=(t,e,n,i)=>t===(i?"left":"right")?n:t==="center"?(e+n)/2:e;function Kl(){}const $7=function(){let t=0;return function(){return t++}}();function Tr(t){return t===null||typeof t=="undefined"}function ti(t){if(Array.isArray&&Array.isArray(t))return!0;const e=Object.prototype.toString.call(t);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function lr(t){return t!==null&&Object.prototype.toString.call(t)==="[object Object]"}const Bi=t=>(typeof t=="number"||t instanceof Number)&&isFinite(+t);function Qa(t,e){return Bi(t)?t:e}function Kn(t,e){return typeof t=="undefined"?e:t}const V7=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100:t/e,MC=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100*e:+t;function Qr(t,e,n){if(t&&typeof t.call=="function")return t.apply(n,e)}function Ur(t,e,n,i){let l,d,f;if(ti(t))if(d=t.length,i)for(l=d-1;l>=0;l--)e.call(n,t[l],l);else for(l=0;l<d;l++)e.call(n,t[l],l);else if(lr(t))for(f=Object.keys(t),d=f.length,l=0;l<d;l++)e.call(n,t[f[l]],f[l])}function f_(t,e){let n,i,l,d;if(!t||!e||t.length!==e.length)return!1;for(n=0,i=t.length;n<i;++n)if(l=t[n],d=e[n],l.datasetIndex!==d.datasetIndex||l.index!==d.index)return!1;return!0}function p_(t){if(ti(t))return t.map(p_);if(lr(t)){const e=Object.create(null),n=Object.keys(t),i=n.length;let l=0;for(;l<i;++l)e[n[l]]=p_(t[n[l]]);return e}return t}function AC(t){return["__proto__","prototype","constructor"].indexOf(t)===-1}function G7(t,e,n,i){if(!AC(t))return;const l=e[t],d=n[t];lr(l)&&lr(d)?ym(l,d,i):e[t]=p_(d)}function ym(t,e,n){const i=ti(e)?e:[e],l=i.length;if(!lr(t))return t;n=n||{};const d=n.merger||G7;for(let f=0;f<l;++f){if(e=i[f],!lr(e))continue;const o=Object.keys(e);for(let y=0,E=o.length;y<E;++y)d(o[y],t,e,n)}return t}function Jp(t,e){return ym(t,e,{merger:q7})}function q7(t,e,n){if(!AC(t))return;const i=e[t],l=n[t];lr(i)&&lr(l)?Jp(i,l):Object.prototype.hasOwnProperty.call(e,t)||(e[t]=p_(l))}const H7="",W7=".";function Y5(t,e){const n=t.indexOf(W7,e);return n===-1?t.length:n}function vu(t,e){if(e===H7)return t;let n=0,i=Y5(e,n);for(;t&&i>n;)t=t[e.slice(n,i)],n=i+1,i=Y5(e,n);return t}function rx(t){return t.charAt(0).toUpperCase()+t.slice(1)}const ls=t=>typeof t!="undefined",xu=t=>typeof t=="function",K5=(t,e)=>{if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0};function Z7(t){return t.type==="mouseup"||t.type==="click"||t.type==="contextmenu"}const bi=Math.PI,Kr=2*bi,X7=Kr+bi,m_=Number.POSITIVE_INFINITY,Y7=bi/180,Ii=bi/2,Tp=bi/4,J5=bi*2/3,is=Math.log10,yl=Math.sign;function Q5(t){const e=Math.round(t);t=Qp(t,e,t/1e3)?e:t;const n=Math.pow(10,Math.floor(is(t))),i=t/n;return(i<=1?1:i<=2?2:i<=5?5:10)*n}function K7(t){const e=[],n=Math.sqrt(t);let i;for(i=1;i<n;i++)t%i===0&&(e.push(i),e.push(t/i));return n===(n|0)&&e.push(n),e.sort((l,d)=>l-d).pop(),e}function bm(t){return!isNaN(parseFloat(t))&&isFinite(t)}function Qp(t,e,n){return Math.abs(t-e)<n}function J7(t,e){const n=Math.round(t);return n-e<=t&&n+e>=t}function IC(t,e,n){let i,l,d;for(i=0,l=t.length;i<l;i++)d=t[i][n],isNaN(d)||(e.min=Math.min(e.min,d),e.max=Math.max(e.max,d))}function Bs(t){return t*(bi/180)}function ix(t){return t*(180/bi)}function tE(t){if(!Bi(t))return;let e=1,n=0;for(;Math.round(t*e)/e!==t;)e*=10,n++;return n}function PC(t,e){const n=e.x-t.x,i=e.y-t.y,l=Math.sqrt(n*n+i*i);let d=Math.atan2(i,n);return d<-.5*bi&&(d+=Kr),{angle:d,distance:l}}function Yb(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function Q7(t,e){return(t-e+X7)%Kr-bi}function Oa(t){return(t%Kr+Kr)%Kr}function vm(t,e,n,i){const l=Oa(t),d=Oa(e),f=Oa(n),o=Oa(d-l),y=Oa(f-l),E=Oa(l-d),C=Oa(l-f);return l===d||l===f||i&&d===f||o>y&&E<C}function vo(t,e,n){return Math.max(e,Math.min(n,t))}function tB(t){return vo(t,-32768,32767)}function rc(t,e,n,i=1e-6){return t>=Math.min(e,n)-i&&t<=Math.max(e,n)+i}const E0=t=>t===0||t===1,eE=(t,e,n)=>-(Math.pow(2,10*(t-=1))*Math.sin((t-e)*Kr/n)),nE=(t,e,n)=>Math.pow(2,-10*t)*Math.sin((t-e)*Kr/n)+1,tm={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>-t*(t-2),easeInOutQuad:t=>(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1),easeInCubic:t=>t*t*t,easeOutCubic:t=>(t-=1)*t*t+1,easeInOutCubic:t=>(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2),easeInQuart:t=>t*t*t*t,easeOutQuart:t=>-((t-=1)*t*t*t-1),easeInOutQuart:t=>(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2),easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>(t-=1)*t*t*t*t+1,easeInOutQuint:t=>(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2),easeInSine:t=>-Math.cos(t*Ii)+1,easeOutSine:t=>Math.sin(t*Ii),easeInOutSine:t=>-.5*(Math.cos(bi*t)-1),easeInExpo:t=>t===0?0:Math.pow(2,10*(t-1)),easeOutExpo:t=>t===1?1:-Math.pow(2,-10*t)+1,easeInOutExpo:t=>E0(t)?t:t<.5?.5*Math.pow(2,10*(t*2-1)):.5*(-Math.pow(2,-10*(t*2-1))+2),easeInCirc:t=>t>=1?t:-(Math.sqrt(1-t*t)-1),easeOutCirc:t=>Math.sqrt(1-(t-=1)*t),easeInOutCirc:t=>(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1),easeInElastic:t=>E0(t)?t:eE(t,.075,.3),easeOutElastic:t=>E0(t)?t:nE(t,.075,.3),easeInOutElastic(t){return E0(t)?t:t<.5?.5*eE(t*2,.1125,.45):.5+.5*nE(t*2-1,.1125,.45)},easeInBack(t){return t*t*((1.70158+1)*t-1.70158)},easeOutBack(t){return(t-=1)*t*((1.70158+1)*t+1.70158)+1},easeInOutBack(t){let e=1.70158;return(t/=.5)<1?.5*(t*t*(((e*=1.525)+1)*t-e)):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},easeInBounce:t=>1-tm.easeOutBounce(1-t),easeOutBounce(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInOutBounce:t=>t<.5?tm.easeInBounce(t*2)*.5:tm.easeOutBounce(t*2-1)*.5+.5};/*!
 * @kurkle/color v0.2.1
 * https://github.com/kurkle/color#readme
 * (c) 2022 Jukka Kurkela
 * Released under the MIT License
 */function Bm(t){return t+.5|0}const uu=(t,e,n)=>Math.max(Math.min(t,n),e);function Bp(t){return uu(Bm(t*2.55),0,255)}function _u(t){return uu(Bm(t*255),0,255)}function ec(t){return uu(Bm(t/2.55)/100,0,1)}function rE(t){return uu(Bm(t*100),0,100)}const Ja={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Kb=[..."0123456789ABCDEF"],eB=t=>Kb[t&15],nB=t=>Kb[(t&240)>>4]+Kb[t&15],T0=t=>(t&240)>>4===(t&15),rB=t=>T0(t.r)&&T0(t.g)&&T0(t.b)&&T0(t.a);function iB(t){var e=t.length,n;return t[0]==="#"&&(e===4||e===5?n={r:255&Ja[t[1]]*17,g:255&Ja[t[2]]*17,b:255&Ja[t[3]]*17,a:e===5?Ja[t[4]]*17:255}:(e===7||e===9)&&(n={r:Ja[t[1]]<<4|Ja[t[2]],g:Ja[t[3]]<<4|Ja[t[4]],b:Ja[t[5]]<<4|Ja[t[6]],a:e===9?Ja[t[7]]<<4|Ja[t[8]]:255})),n}const oB=(t,e)=>t<255?e(t):"";function aB(t){var e=rB(t)?eB:nB;return t?"#"+e(t.r)+e(t.g)+e(t.b)+oB(t.a,e):void 0}const sB=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function LC(t,e,n){const i=e*Math.min(n,1-n),l=(d,f=(d+t/30)%12)=>n-i*Math.max(Math.min(f-3,9-f,1),-1);return[l(0),l(8),l(4)]}function lB(t,e,n){const i=(l,d=(l+t/60)%6)=>n-n*e*Math.max(Math.min(d,4-d,1),0);return[i(5),i(3),i(1)]}function cB(t,e,n){const i=LC(t,1,.5);let l;for(e+n>1&&(l=1/(e+n),e*=l,n*=l),l=0;l<3;l++)i[l]*=1-e-n,i[l]+=e;return i}function uB(t,e,n,i,l){return t===l?(e-n)/i+(e<n?6:0):e===l?(n-t)/i+2:(t-e)/i+4}function ox(t){const n=t.r/255,i=t.g/255,l=t.b/255,d=Math.max(n,i,l),f=Math.min(n,i,l),o=(d+f)/2;let y,E,C;return d!==f&&(C=d-f,E=o>.5?C/(2-d-f):C/(d+f),y=uB(n,i,l,C,d),y=y*60+.5),[y|0,E||0,o]}function ax(t,e,n,i){return(Array.isArray(e)?t(e[0],e[1],e[2]):t(e,n,i)).map(_u)}function sx(t,e,n){return ax(LC,t,e,n)}function dB(t,e,n){return ax(cB,t,e,n)}function hB(t,e,n){return ax(lB,t,e,n)}function zC(t){return(t%360+360)%360}function fB(t){const e=sB.exec(t);let n=255,i;if(!e)return;e[5]!==i&&(n=e[6]?Bp(+e[5]):_u(+e[5]));const l=zC(+e[2]),d=+e[3]/100,f=+e[4]/100;return e[1]==="hwb"?i=dB(l,d,f):e[1]==="hsv"?i=hB(l,d,f):i=sx(l,d,f),{r:i[0],g:i[1],b:i[2],a:n}}function pB(t,e){var n=ox(t);n[0]=zC(n[0]+e),n=sx(n),t.r=n[0],t.g=n[1],t.b=n[2]}function mB(t){if(!t)return;const e=ox(t),n=e[0],i=rE(e[1]),l=rE(e[2]);return t.a<255?`hsla(${n}, ${i}%, ${l}%, ${ec(t.a)})`:`hsl(${n}, ${i}%, ${l}%)`}const iE={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},oE={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function gB(){const t={},e=Object.keys(oE),n=Object.keys(iE);let i,l,d,f,o;for(i=0;i<e.length;i++){for(f=o=e[i],l=0;l<n.length;l++)d=n[l],o=o.replace(d,iE[d]);d=parseInt(oE[f],16),t[o]=[d>>16&255,d>>8&255,d&255]}return t}let k0;function _B(t){k0||(k0=gB(),k0.transparent=[0,0,0,0]);const e=k0[t.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const yB=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function bB(t){const e=yB.exec(t);let n=255,i,l,d;if(!!e){if(e[7]!==i){const f=+e[7];n=e[8]?Bp(f):uu(f*255,0,255)}return i=+e[1],l=+e[3],d=+e[5],i=255&(e[2]?Bp(i):uu(i,0,255)),l=255&(e[4]?Bp(l):uu(l,0,255)),d=255&(e[6]?Bp(d):uu(d,0,255)),{r:i,g:l,b:d,a:n}}}function vB(t){return t&&(t.a<255?`rgba(${t.r}, ${t.g}, ${t.b}, ${ec(t.a)})`:`rgb(${t.r}, ${t.g}, ${t.b})`)}const Y1=t=>t<=.0031308?t*12.92:Math.pow(t,1/2.4)*1.055-.055,Fh=t=>t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4);function xB(t,e,n){const i=Fh(ec(t.r)),l=Fh(ec(t.g)),d=Fh(ec(t.b));return{r:_u(Y1(i+n*(Fh(ec(e.r))-i))),g:_u(Y1(l+n*(Fh(ec(e.g))-l))),b:_u(Y1(d+n*(Fh(ec(e.b))-d))),a:t.a+n*(e.a-t.a)}}function C0(t,e,n){if(t){let i=ox(t);i[e]=Math.max(0,Math.min(i[e]+i[e]*n,e===0?360:1)),i=sx(i),t.r=i[0],t.g=i[1],t.b=i[2]}}function OC(t,e){return t&&Object.assign(e||{},t)}function aE(t){var e={r:0,g:0,b:0,a:255};return Array.isArray(t)?t.length>=3&&(e={r:t[0],g:t[1],b:t[2],a:255},t.length>3&&(e.a=_u(t[3]))):(e=OC(t,{r:0,g:0,b:0,a:1}),e.a=_u(e.a)),e}function wB(t){return t.charAt(0)==="r"?bB(t):fB(t)}class g_{constructor(e){if(e instanceof g_)return e;const n=typeof e;let i;n==="object"?i=aE(e):n==="string"&&(i=iB(e)||_B(e)||wB(e)),this._rgb=i,this._valid=!!i}get valid(){return this._valid}get rgb(){var e=OC(this._rgb);return e&&(e.a=ec(e.a)),e}set rgb(e){this._rgb=aE(e)}rgbString(){return this._valid?vB(this._rgb):void 0}hexString(){return this._valid?aB(this._rgb):void 0}hslString(){return this._valid?mB(this._rgb):void 0}mix(e,n){if(e){const i=this.rgb,l=e.rgb;let d;const f=n===d?.5:n,o=2*f-1,y=i.a-l.a,E=((o*y===-1?o:(o+y)/(1+o*y))+1)/2;d=1-E,i.r=255&E*i.r+d*l.r+.5,i.g=255&E*i.g+d*l.g+.5,i.b=255&E*i.b+d*l.b+.5,i.a=f*i.a+(1-f)*l.a,this.rgb=i}return this}interpolate(e,n){return e&&(this._rgb=xB(this._rgb,e._rgb,n)),this}clone(){return new g_(this.rgb)}alpha(e){return this._rgb.a=_u(e),this}clearer(e){const n=this._rgb;return n.a*=1-e,this}greyscale(){const e=this._rgb,n=Bm(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=n,this}opaquer(e){const n=this._rgb;return n.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return C0(this._rgb,2,e),this}darken(e){return C0(this._rgb,2,-e),this}saturate(e){return C0(this._rgb,1,e),this}desaturate(e){return C0(this._rgb,1,-e),this}rotate(e){return pB(this._rgb,e),this}}function DC(t){return new g_(t)}function RC(t){if(t&&typeof t=="object"){const e=t.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function sE(t){return RC(t)?t:DC(t)}function K1(t){return RC(t)?t:DC(t).saturate(.5).darken(.1).hexString()}const Dd=Object.create(null),Jb=Object.create(null);function em(t,e){if(!e)return t;const n=e.split(".");for(let i=0,l=n.length;i<l;++i){const d=n[i];t=t[d]||(t[d]=Object.create(null))}return t}function J1(t,e,n){return typeof e=="string"?ym(em(t,e),n):ym(em(t,""),e)}class EB{constructor(e){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=n=>n.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(n,i)=>K1(i.backgroundColor),this.hoverBorderColor=(n,i)=>K1(i.borderColor),this.hoverColor=(n,i)=>K1(i.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e)}set(e,n){return J1(this,e,n)}get(e){return em(this,e)}describe(e,n){return J1(Jb,e,n)}override(e,n){return J1(Dd,e,n)}route(e,n,i,l){const d=em(this,e),f=em(this,i),o="_"+n;Object.defineProperties(d,{[o]:{value:d[n],writable:!0},[n]:{enumerable:!0,get(){const y=this[o],E=f[l];return lr(y)?Object.assign({},E,y):Kn(y,E)},set(y){this[o]=y}}})}}var cr=new EB({_scriptable:t=>!t.startsWith("on"),_indexable:t=>t!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}});function TB(t){return!t||Tr(t.size)||Tr(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}function __(t,e,n,i,l){let d=e[l];return d||(d=e[l]=t.measureText(l).width,n.push(l)),d>i&&(i=d),i}function kB(t,e,n,i){i=i||{};let l=i.data=i.data||{},d=i.garbageCollect=i.garbageCollect||[];i.font!==e&&(l=i.data={},d=i.garbageCollect=[],i.font=e),t.save(),t.font=e;let f=0;const o=n.length;let y,E,C,A,P;for(y=0;y<o;y++)if(A=n[y],A!=null&&ti(A)!==!0)f=__(t,l,d,f,A);else if(ti(A))for(E=0,C=A.length;E<C;E++)P=A[E],P!=null&&!ti(P)&&(f=__(t,l,d,f,P));t.restore();const B=d.length/2;if(B>n.length){for(y=0;y<B;y++)delete l[d[y]];d.splice(0,B)}return f}function gd(t,e,n){const i=t.currentDevicePixelRatio,l=n!==0?Math.max(n/2,.5):0;return Math.round((e-l)*i)/i+l}function lE(t,e){e=e||t.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,t.width,t.height),e.restore()}function y_(t,e,n,i){let l,d,f,o,y;const E=e.pointStyle,C=e.rotation,A=e.radius;let P=(C||0)*Y7;if(E&&typeof E=="object"&&(l=E.toString(),l==="[object HTMLImageElement]"||l==="[object HTMLCanvasElement]")){t.save(),t.translate(n,i),t.rotate(P),t.drawImage(E,-E.width/2,-E.height/2,E.width,E.height),t.restore();return}if(!(isNaN(A)||A<=0)){switch(t.beginPath(),E){default:t.arc(n,i,A,0,Kr),t.closePath();break;case"triangle":t.moveTo(n+Math.sin(P)*A,i-Math.cos(P)*A),P+=J5,t.lineTo(n+Math.sin(P)*A,i-Math.cos(P)*A),P+=J5,t.lineTo(n+Math.sin(P)*A,i-Math.cos(P)*A),t.closePath();break;case"rectRounded":y=A*.516,o=A-y,d=Math.cos(P+Tp)*o,f=Math.sin(P+Tp)*o,t.arc(n-d,i-f,y,P-bi,P-Ii),t.arc(n+f,i-d,y,P-Ii,P),t.arc(n+d,i+f,y,P,P+Ii),t.arc(n-f,i+d,y,P+Ii,P+bi),t.closePath();break;case"rect":if(!C){o=Math.SQRT1_2*A,t.rect(n-o,i-o,2*o,2*o);break}P+=Tp;case"rectRot":d=Math.cos(P)*A,f=Math.sin(P)*A,t.moveTo(n-d,i-f),t.lineTo(n+f,i-d),t.lineTo(n+d,i+f),t.lineTo(n-f,i+d),t.closePath();break;case"crossRot":P+=Tp;case"cross":d=Math.cos(P)*A,f=Math.sin(P)*A,t.moveTo(n-d,i-f),t.lineTo(n+d,i+f),t.moveTo(n+f,i-d),t.lineTo(n-f,i+d);break;case"star":d=Math.cos(P)*A,f=Math.sin(P)*A,t.moveTo(n-d,i-f),t.lineTo(n+d,i+f),t.moveTo(n+f,i-d),t.lineTo(n-f,i+d),P+=Tp,d=Math.cos(P)*A,f=Math.sin(P)*A,t.moveTo(n-d,i-f),t.lineTo(n+d,i+f),t.moveTo(n+f,i-d),t.lineTo(n-f,i+d);break;case"line":d=Math.cos(P)*A,f=Math.sin(P)*A,t.moveTo(n-d,i-f),t.lineTo(n+d,i+f);break;case"dash":t.moveTo(n,i),t.lineTo(n+Math.cos(P)*A,i+Math.sin(P)*A);break}t.fill(),e.borderWidth>0&&t.stroke()}}function xm(t,e,n){return n=n||.5,!e||t&&t.x>e.left-n&&t.x<e.right+n&&t.y>e.top-n&&t.y<e.bottom+n}function H_(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()}function W_(t){t.restore()}function CB(t,e,n,i,l){if(!e)return t.lineTo(n.x,n.y);if(l==="middle"){const d=(e.x+n.x)/2;t.lineTo(d,e.y),t.lineTo(d,n.y)}else l==="after"!=!!i?t.lineTo(e.x,n.y):t.lineTo(n.x,e.y);t.lineTo(n.x,n.y)}function SB(t,e,n,i){if(!e)return t.lineTo(n.x,n.y);t.bezierCurveTo(i?e.cp1x:e.cp2x,i?e.cp1y:e.cp2y,i?n.cp2x:n.cp1x,i?n.cp2y:n.cp1y,n.x,n.y)}function Rd(t,e,n,i,l,d={}){const f=ti(e)?e:[e],o=d.strokeWidth>0&&d.strokeColor!=="";let y,E;for(t.save(),t.font=l.string,MB(t,d),y=0;y<f.length;++y)E=f[y],o&&(d.strokeColor&&(t.strokeStyle=d.strokeColor),Tr(d.strokeWidth)||(t.lineWidth=d.strokeWidth),t.strokeText(E,n,i,d.maxWidth)),t.fillText(E,n,i,d.maxWidth),AB(t,n,i,E,d),i+=l.lineHeight;t.restore()}function MB(t,e){e.translation&&t.translate(e.translation[0],e.translation[1]),Tr(e.rotation)||t.rotate(e.rotation),e.color&&(t.fillStyle=e.color),e.textAlign&&(t.textAlign=e.textAlign),e.textBaseline&&(t.textBaseline=e.textBaseline)}function AB(t,e,n,i,l){if(l.strikethrough||l.underline){const d=t.measureText(i),f=e-d.actualBoundingBoxLeft,o=e+d.actualBoundingBoxRight,y=n-d.actualBoundingBoxAscent,E=n+d.actualBoundingBoxDescent,C=l.strikethrough?(y+E)/2:E;t.strokeStyle=t.fillStyle,t.beginPath(),t.lineWidth=l.decorationWidth||2,t.moveTo(f,C),t.lineTo(o,C),t.stroke()}}function wm(t,e){const{x:n,y:i,w:l,h:d,radius:f}=e;t.arc(n+f.topLeft,i+f.topLeft,f.topLeft,-Ii,bi,!0),t.lineTo(n,i+d-f.bottomLeft),t.arc(n+f.bottomLeft,i+d-f.bottomLeft,f.bottomLeft,bi,Ii,!0),t.lineTo(n+l-f.bottomRight,i+d),t.arc(n+l-f.bottomRight,i+d-f.bottomRight,f.bottomRight,Ii,0,!0),t.lineTo(n+l,i+f.topRight),t.arc(n+l-f.topRight,i+f.topRight,f.topRight,0,-Ii,!0),t.lineTo(n+f.topLeft,i)}const IB=new RegExp(/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/),PB=new RegExp(/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/);function LB(t,e){const n=(""+t).match(IB);if(!n||n[1]==="normal")return e*1.2;switch(t=+n[2],n[3]){case"px":return t;case"%":t/=100;break}return e*t}const zB=t=>+t||0;function lx(t,e){const n={},i=lr(e),l=i?Object.keys(e):e,d=lr(t)?i?f=>Kn(t[f],t[e[f]]):f=>t[f]:()=>t;for(const f of l)n[f]=zB(d(f));return n}function BC(t){return lx(t,{top:"y",right:"x",bottom:"y",left:"x"})}function Ld(t){return lx(t,["topLeft","topRight","bottomLeft","bottomRight"])}function Go(t){const e=BC(t);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function ao(t,e){t=t||{},e=e||cr.font;let n=Kn(t.size,e.size);typeof n=="string"&&(n=parseInt(n,10));let i=Kn(t.style,e.style);i&&!(""+i).match(PB)&&(console.warn('Invalid font style specified: "'+i+'"'),i="");const l={family:Kn(t.family,e.family),lineHeight:LB(Kn(t.lineHeight,e.lineHeight),n),size:n,style:i,weight:Kn(t.weight,e.weight),string:""};return l.string=TB(l),l}function Fp(t,e,n,i){let l=!0,d,f,o;for(d=0,f=t.length;d<f;++d)if(o=t[d],o!==void 0&&(e!==void 0&&typeof o=="function"&&(o=o(e),l=!1),n!==void 0&&ti(o)&&(o=o[n%o.length],l=!1),o!==void 0))return i&&!l&&(i.cacheable=!1),o}function OB(t,e,n){const{min:i,max:l}=t,d=MC(e,(l-i)/2),f=(o,y)=>n&&o===0?0:o+y;return{min:f(i,-Math.abs(d)),max:f(l,d)}}function Mu(t,e){return Object.assign(Object.create(t),e)}function cx(t,e,n){n=n||(f=>t[f]<e);let i=t.length-1,l=0,d;for(;i-l>1;)d=l+i>>1,n(d)?l=d:i=d;return{lo:l,hi:i}}const ic=(t,e,n)=>cx(t,n,i=>t[i][e]<n),DB=(t,e,n)=>cx(t,n,i=>t[i][e]>=n);function RB(t,e,n){let i=0,l=t.length;for(;i<l&&t[i]<e;)i++;for(;l>i&&t[l-1]>n;)l--;return i>0||l<t.length?t.slice(i,l):t}const FC=["push","pop","shift","splice","unshift"];function BB(t,e){if(t._chartjs){t._chartjs.listeners.push(e);return}Object.defineProperty(t,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),FC.forEach(n=>{const i="_onData"+rx(n),l=t[n];Object.defineProperty(t,n,{configurable:!0,enumerable:!1,value(...d){const f=l.apply(this,d);return t._chartjs.listeners.forEach(o=>{typeof o[i]=="function"&&o[i](...d)}),f}})})}function cE(t,e){const n=t._chartjs;if(!n)return;const i=n.listeners,l=i.indexOf(e);l!==-1&&i.splice(l,1),!(i.length>0)&&(FC.forEach(d=>{delete t[d]}),delete t._chartjs)}function NC(t){const e=new Set;let n,i;for(n=0,i=t.length;n<i;++n)e.add(t[n]);return e.size===i?t:Array.from(e)}function ux(t,e=[""],n=t,i,l=()=>t[0]){ls(i)||(i=VC("_fallback",t));const d={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:t,_rootScopes:n,_fallback:i,_getTarget:l,override:f=>ux([f,...t],e,n,i)};return new Proxy(d,{deleteProperty(f,o){return delete f[o],delete f._keys,delete t[0][o],!0},get(f,o){return UC(f,o,()=>qB(o,e,t,f))},getOwnPropertyDescriptor(f,o){return Reflect.getOwnPropertyDescriptor(f._scopes[0],o)},getPrototypeOf(){return Reflect.getPrototypeOf(t[0])},has(f,o){return dE(f).includes(o)},ownKeys(f){return dE(f)},set(f,o,y){const E=f._storage||(f._storage=l());return f[o]=E[o]=y,delete f._keys,!0}})}function lf(t,e,n,i){const l={_cacheable:!1,_proxy:t,_context:e,_subProxy:n,_stack:new Set,_descriptors:jC(t,i),setContext:d=>lf(t,d,n,i),override:d=>lf(t.override(d),e,n,i)};return new Proxy(l,{deleteProperty(d,f){return delete d[f],delete t[f],!0},get(d,f,o){return UC(d,f,()=>NB(d,f,o))},getOwnPropertyDescriptor(d,f){return d._descriptors.allKeys?Reflect.has(t,f)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(t,f)},getPrototypeOf(){return Reflect.getPrototypeOf(t)},has(d,f){return Reflect.has(t,f)},ownKeys(){return Reflect.ownKeys(t)},set(d,f,o){return t[f]=o,delete d[f],!0}})}function jC(t,e={scriptable:!0,indexable:!0}){const{_scriptable:n=e.scriptable,_indexable:i=e.indexable,_allKeys:l=e.allKeys}=t;return{allKeys:l,scriptable:n,indexable:i,isScriptable:xu(n)?n:()=>n,isIndexable:xu(i)?i:()=>i}}const FB=(t,e)=>t?t+rx(e):e,dx=(t,e)=>lr(e)&&t!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function UC(t,e,n){if(Object.prototype.hasOwnProperty.call(t,e))return t[e];const i=n();return t[e]=i,i}function NB(t,e,n){const{_proxy:i,_context:l,_subProxy:d,_descriptors:f}=t;let o=i[e];return xu(o)&&f.isScriptable(e)&&(o=jB(e,o,t,n)),ti(o)&&o.length&&(o=UB(e,o,t,f.isIndexable)),dx(e,o)&&(o=lf(o,l,d&&d[e],f)),o}function jB(t,e,n,i){const{_proxy:l,_context:d,_subProxy:f,_stack:o}=n;if(o.has(t))throw new Error("Recursion detected: "+Array.from(o).join("->")+"->"+t);return o.add(t),e=e(d,f||i),o.delete(t),dx(t,e)&&(e=hx(l._scopes,l,t,e)),e}function UB(t,e,n,i){const{_proxy:l,_context:d,_subProxy:f,_descriptors:o}=n;if(ls(d.index)&&i(t))e=e[d.index%e.length];else if(lr(e[0])){const y=e,E=l._scopes.filter(C=>C!==y);e=[];for(const C of y){const A=hx(E,l,t,C);e.push(lf(A,d,f&&f[t],o))}}return e}function $C(t,e,n){return xu(t)?t(e,n):t}const $B=(t,e)=>t===!0?e:typeof t=="string"?vu(e,t):void 0;function VB(t,e,n,i,l){for(const d of e){const f=$B(n,d);if(f){t.add(f);const o=$C(f._fallback,n,l);if(ls(o)&&o!==n&&o!==i)return o}else if(f===!1&&ls(i)&&n!==i)return null}return!1}function hx(t,e,n,i){const l=e._rootScopes,d=$C(e._fallback,n,i),f=[...t,...l],o=new Set;o.add(i);let y=uE(o,f,n,d||n,i);return y===null||ls(d)&&d!==n&&(y=uE(o,f,d,y,i),y===null)?!1:ux(Array.from(o),[""],l,d,()=>GB(e,n,i))}function uE(t,e,n,i,l){for(;n;)n=VB(t,e,n,i,l);return n}function GB(t,e,n){const i=t._getTarget();e in i||(i[e]={});const l=i[e];return ti(l)&&lr(n)?n:l}function qB(t,e,n,i){let l;for(const d of e)if(l=VC(FB(d,t),n),ls(l))return dx(t,l)?hx(n,i,t,l):l}function VC(t,e){for(const n of e){if(!n)continue;const i=n[t];if(ls(i))return i}}function dE(t){let e=t._keys;return e||(e=t._keys=HB(t._scopes)),e}function HB(t){const e=new Set;for(const n of t)for(const i of Object.keys(n).filter(l=>!l.startsWith("_")))e.add(i);return Array.from(e)}function GC(t,e,n,i){const{iScale:l}=t,{key:d="r"}=this._parsing,f=new Array(i);let o,y,E,C;for(o=0,y=i;o<y;++o)E=o+n,C=e[E],f[o]={r:l.parse(vu(C,d),E)};return f}const WB=Number.EPSILON||1e-14,cf=(t,e)=>e<t.length&&!t[e].skip&&t[e],qC=t=>t==="x"?"y":"x";function ZB(t,e,n,i){const l=t.skip?e:t,d=e,f=n.skip?e:n,o=Yb(d,l),y=Yb(f,d);let E=o/(o+y),C=y/(o+y);E=isNaN(E)?0:E,C=isNaN(C)?0:C;const A=i*E,P=i*C;return{previous:{x:d.x-A*(f.x-l.x),y:d.y-A*(f.y-l.y)},next:{x:d.x+P*(f.x-l.x),y:d.y+P*(f.y-l.y)}}}function XB(t,e,n){const i=t.length;let l,d,f,o,y,E=cf(t,0);for(let C=0;C<i-1;++C)if(y=E,E=cf(t,C+1),!(!y||!E)){if(Qp(e[C],0,WB)){n[C]=n[C+1]=0;continue}l=n[C]/e[C],d=n[C+1]/e[C],o=Math.pow(l,2)+Math.pow(d,2),!(o<=9)&&(f=3/Math.sqrt(o),n[C]=l*f*e[C],n[C+1]=d*f*e[C])}}function YB(t,e,n="x"){const i=qC(n),l=t.length;let d,f,o,y=cf(t,0);for(let E=0;E<l;++E){if(f=o,o=y,y=cf(t,E+1),!o)continue;const C=o[n],A=o[i];f&&(d=(C-f[n])/3,o[`cp1${n}`]=C-d,o[`cp1${i}`]=A-d*e[E]),y&&(d=(y[n]-C)/3,o[`cp2${n}`]=C+d,o[`cp2${i}`]=A+d*e[E])}}function KB(t,e="x"){const n=qC(e),i=t.length,l=Array(i).fill(0),d=Array(i);let f,o,y,E=cf(t,0);for(f=0;f<i;++f)if(o=y,y=E,E=cf(t,f+1),!!y){if(E){const C=E[e]-y[e];l[f]=C!==0?(E[n]-y[n])/C:0}d[f]=o?E?yl(l[f-1])!==yl(l[f])?0:(l[f-1]+l[f])/2:l[f-1]:l[f]}XB(t,l,d),YB(t,d,e)}function S0(t,e,n){return Math.max(Math.min(t,n),e)}function JB(t,e){let n,i,l,d,f,o=xm(t[0],e);for(n=0,i=t.length;n<i;++n)f=d,d=o,o=n<i-1&&xm(t[n+1],e),d&&(l=t[n],f&&(l.cp1x=S0(l.cp1x,e.left,e.right),l.cp1y=S0(l.cp1y,e.top,e.bottom)),o&&(l.cp2x=S0(l.cp2x,e.left,e.right),l.cp2y=S0(l.cp2y,e.top,e.bottom)))}function QB(t,e,n,i,l){let d,f,o,y;if(e.spanGaps&&(t=t.filter(E=>!E.skip)),e.cubicInterpolationMode==="monotone")KB(t,l);else{let E=i?t[t.length-1]:t[0];for(d=0,f=t.length;d<f;++d)o=t[d],y=ZB(E,o,t[Math.min(d+1,f-(i?0:1))%f],e.tension),o.cp1x=y.previous.x,o.cp1y=y.previous.y,o.cp2x=y.next.x,o.cp2y=y.next.y,E=o}e.capBezierPoints&&JB(t,n)}function HC(){return typeof window!="undefined"&&typeof document!="undefined"}function fx(t){let e=t.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function b_(t,e,n){let i;return typeof t=="string"?(i=parseInt(t,10),t.indexOf("%")!==-1&&(i=i/100*e.parentNode[n])):i=t,i}const Z_=t=>window.getComputedStyle(t,null);function t9(t,e){return Z_(t).getPropertyValue(e)}const e9=["top","right","bottom","left"];function zd(t,e,n){const i={};n=n?"-"+n:"";for(let l=0;l<4;l++){const d=e9[l];i[d]=parseFloat(t[e+"-"+d+n])||0}return i.width=i.left+i.right,i.height=i.top+i.bottom,i}const n9=(t,e,n)=>(t>0||e>0)&&(!n||!n.shadowRoot);function r9(t,e){const n=t.touches,i=n&&n.length?n[0]:t,{offsetX:l,offsetY:d}=i;let f=!1,o,y;if(n9(l,d,t.target))o=l,y=d;else{const E=e.getBoundingClientRect();o=i.clientX-E.left,y=i.clientY-E.top,f=!0}return{x:o,y,box:f}}function xd(t,e){if("native"in t)return t;const{canvas:n,currentDevicePixelRatio:i}=e,l=Z_(n),d=l.boxSizing==="border-box",f=zd(l,"padding"),o=zd(l,"border","width"),{x:y,y:E,box:C}=r9(t,n),A=f.left+(C&&o.left),P=f.top+(C&&o.top);let{width:B,height:j}=e;return d&&(B-=f.width+o.width,j-=f.height+o.height),{x:Math.round((y-A)/B*n.width/i),y:Math.round((E-P)/j*n.height/i)}}function i9(t,e,n){let i,l;if(e===void 0||n===void 0){const d=fx(t);if(!d)e=t.clientWidth,n=t.clientHeight;else{const f=d.getBoundingClientRect(),o=Z_(d),y=zd(o,"border","width"),E=zd(o,"padding");e=f.width-E.width-y.width,n=f.height-E.height-y.height,i=b_(o.maxWidth,d,"clientWidth"),l=b_(o.maxHeight,d,"clientHeight")}}return{width:e,height:n,maxWidth:i||m_,maxHeight:l||m_}}const Q1=t=>Math.round(t*10)/10;function o9(t,e,n,i){const l=Z_(t),d=zd(l,"margin"),f=b_(l.maxWidth,t,"clientWidth")||m_,o=b_(l.maxHeight,t,"clientHeight")||m_,y=i9(t,e,n);let{width:E,height:C}=y;if(l.boxSizing==="content-box"){const A=zd(l,"border","width"),P=zd(l,"padding");E-=P.width+A.width,C-=P.height+A.height}return E=Math.max(0,E-d.width),C=Math.max(0,i?Math.floor(E/i):C-d.height),E=Q1(Math.min(E,f,y.maxWidth)),C=Q1(Math.min(C,o,y.maxHeight)),E&&!C&&(C=Q1(E/2)),{width:E,height:C}}function hE(t,e,n){const i=e||1,l=Math.floor(t.height*i),d=Math.floor(t.width*i);t.height=l/i,t.width=d/i;const f=t.canvas;return f.style&&(n||!f.style.height&&!f.style.width)&&(f.style.height=`${t.height}px`,f.style.width=`${t.width}px`),t.currentDevicePixelRatio!==i||f.height!==l||f.width!==d?(t.currentDevicePixelRatio=i,f.height=l,f.width=d,t.ctx.setTransform(i,0,0,i,0,0),!0):!1}const a9=function(){let t=!1;try{const e={get passive(){return t=!0,!1}};window.addEventListener("test",null,e),window.removeEventListener("test",null,e)}catch{}return t}();function fE(t,e){const n=t9(t,e),i=n&&n.match(/^(\d+)(\.\d+)?px$/);return i?+i[1]:void 0}function wd(t,e,n,i){return{x:t.x+n*(e.x-t.x),y:t.y+n*(e.y-t.y)}}function s9(t,e,n,i){return{x:t.x+n*(e.x-t.x),y:i==="middle"?n<.5?t.y:e.y:i==="after"?n<1?t.y:e.y:n>0?e.y:t.y}}function l9(t,e,n,i){const l={x:t.cp2x,y:t.cp2y},d={x:e.cp1x,y:e.cp1y},f=wd(t,l,n),o=wd(l,d,n),y=wd(d,e,n),E=wd(f,o,n),C=wd(o,y,n);return wd(E,C,n)}const pE=new Map;function c9(t,e){e=e||{};const n=t+JSON.stringify(e);let i=pE.get(n);return i||(i=new Intl.NumberFormat(t,e),pE.set(n,i)),i}function Fm(t,e,n){return c9(e,n).format(t)}const u9=function(t,e){return{x(n){return t+t+e-n},setWidth(n){e=n},textAlign(n){return n==="center"?n:n==="right"?"left":"right"},xPlus(n,i){return n-i},leftForLtr(n,i){return n-i}}},d9=function(){return{x(t){return t},setWidth(t){},textAlign(t){return t},xPlus(t,e){return t+e},leftForLtr(t,e){return t}}};function Yh(t,e,n){return t?u9(e,n):d9()}function WC(t,e){let n,i;(e==="ltr"||e==="rtl")&&(n=t.canvas.style,i=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",e,"important"),t.prevTextDirection=i)}function ZC(t,e){e!==void 0&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",e[0],e[1]))}function XC(t){return t==="angle"?{between:vm,compare:Q7,normalize:Oa}:{between:rc,compare:(e,n)=>e-n,normalize:e=>e}}function mE({start:t,end:e,count:n,loop:i,style:l}){return{start:t%n,end:e%n,loop:i&&(e-t+1)%n===0,style:l}}function h9(t,e,n){const{property:i,start:l,end:d}=n,{between:f,normalize:o}=XC(i),y=e.length;let{start:E,end:C,loop:A}=t,P,B;if(A){for(E+=y,C+=y,P=0,B=y;P<B&&f(o(e[E%y][i]),l,d);++P)E--,C--;E%=y,C%=y}return C<E&&(C+=y),{start:E,end:C,loop:A,style:t.style}}function YC(t,e,n){if(!n)return[t];const{property:i,start:l,end:d}=n,f=e.length,{compare:o,between:y,normalize:E}=XC(i),{start:C,end:A,loop:P,style:B}=h9(t,e,n),j=[];let Z=!1,W=null,H,V,tt;const ft=()=>y(l,tt,H)&&o(l,tt)!==0,et=()=>o(d,H)===0||y(d,tt,H),Pt=()=>Z||ft(),Rt=()=>!Z||et();for(let zt=C,jt=C;zt<=A;++zt)V=e[zt%f],!V.skip&&(H=E(V[i]),H!==tt&&(Z=y(H,l,d),W===null&&Pt()&&(W=o(H,l)===0?zt:jt),W!==null&&Rt()&&(j.push(mE({start:W,end:zt,loop:P,count:f,style:B})),W=null),jt=zt,tt=H));return W!==null&&j.push(mE({start:W,end:A,loop:P,count:f,style:B})),j}function KC(t,e){const n=[],i=t.segments;for(let l=0;l<i.length;l++){const d=YC(i[l],t.points,e);d.length&&n.push(...d)}return n}function f9(t,e,n,i){let l=0,d=e-1;if(n&&!i)for(;l<e&&!t[l].skip;)l++;for(;l<e&&t[l].skip;)l++;for(l%=e,n&&(d+=l);d>l&&t[d%e].skip;)d--;return d%=e,{start:l,end:d}}function p9(t,e,n,i){const l=t.length,d=[];let f=e,o=t[e],y;for(y=e+1;y<=n;++y){const E=t[y%l];E.skip||E.stop?o.skip||(i=!1,d.push({start:e%l,end:(y-1)%l,loop:i}),e=f=E.stop?y:null):(f=y,o.skip&&(e=y)),o=E}return f!==null&&d.push({start:e%l,end:f%l,loop:i}),d}function m9(t,e){const n=t.points,i=t.options.spanGaps,l=n.length;if(!l)return[];const d=!!t._loop,{start:f,end:o}=f9(n,l,d,i);if(i===!0)return gE(t,[{start:f,end:o,loop:d}],n,e);const y=o<f?o+l:o,E=!!t._fullLoop&&f===0&&o===l-1;return gE(t,p9(n,f,y,E),n,e)}function gE(t,e,n,i){return!i||!i.setContext||!n?e:g9(t,e,n,i)}function g9(t,e,n,i){const l=t._chart.getContext(),d=_E(t.options),{_datasetIndex:f,options:{spanGaps:o}}=t,y=n.length,E=[];let C=d,A=e[0].start,P=A;function B(j,Z,W,H){const V=o?-1:1;if(j!==Z){for(j+=y;n[j%y].skip;)j-=V;for(;n[Z%y].skip;)Z+=V;j%y!==Z%y&&(E.push({start:j%y,end:Z%y,loop:W,style:H}),C=H,A=Z%y)}}for(const j of e){A=o?A:j.start;let Z=n[A%y],W;for(P=A+1;P<=j.end;P++){const H=n[P%y];W=_E(i.setContext(Mu(l,{type:"segment",p0:Z,p1:H,p0DataIndex:(P-1)%y,p1DataIndex:P%y,datasetIndex:f}))),_9(W,C)&&B(A,P-1,j.loop,C),Z=H,C=W}A<P-1&&B(A,P-1,j.loop,C)}return E}function _E(t){return{backgroundColor:t.backgroundColor,borderCapStyle:t.borderCapStyle,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderJoinStyle:t.borderJoinStyle,borderWidth:t.borderWidth,borderColor:t.borderColor}}function _9(t,e){return e&&JSON.stringify(t)!==JSON.stringify(e)}/*!
 * Chart.js v3.8.0
 * https://www.chartjs.org
 * (c) 2022 Chart.js Contributors
 * Released under the MIT License
 */class y9{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,n,i,l){const d=n.listeners[l],f=n.duration;d.forEach(o=>o({chart:e,initial:n.initial,numSteps:f,currentStep:Math.min(i-n.start,f)}))}_refresh(){this._request||(this._running=!0,this._request=CC.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let n=0;this._charts.forEach((i,l)=>{if(!i.running||!i.items.length)return;const d=i.items;let f=d.length-1,o=!1,y;for(;f>=0;--f)y=d[f],y._active?(y._total>i.duration&&(i.duration=y._total),y.tick(e),o=!0):(d[f]=d[d.length-1],d.pop());o&&(l.draw(),this._notify(l,i,e,"progress")),d.length||(i.running=!1,this._notify(l,i,e,"complete"),i.initial=!1),n+=d.length}),this._lastDate=e,n===0&&(this._running=!1)}_getAnims(e){const n=this._charts;let i=n.get(e);return i||(i={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},n.set(e,i)),i}listen(e,n,i){this._getAnims(e).listeners[n].push(i)}add(e,n){!n||!n.length||this._getAnims(e).items.push(...n)}has(e){return this._getAnims(e).items.length>0}start(e){const n=this._charts.get(e);!n||(n.running=!0,n.start=Date.now(),n.duration=n.items.reduce((i,l)=>Math.max(i,l._duration),0),this._refresh())}running(e){if(!this._running)return!1;const n=this._charts.get(e);return!(!n||!n.running||!n.items.length)}stop(e){const n=this._charts.get(e);if(!n||!n.items.length)return;const i=n.items;let l=i.length-1;for(;l>=0;--l)i[l].cancel();n.items=[],this._notify(e,n,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var Jl=new y9;const yE="transparent",b9={boolean(t,e,n){return n>.5?e:t},color(t,e,n){const i=sE(t||yE),l=i.valid&&sE(e||yE);return l&&l.valid?l.mix(i,n).hexString():e},number(t,e,n){return t+(e-t)*n}};class v9{constructor(e,n,i,l){const d=n[i];l=Fp([e.to,l,d,e.from]);const f=Fp([e.from,d,l]);this._active=!0,this._fn=e.fn||b9[e.type||typeof f],this._easing=tm[e.easing]||tm.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=n,this._prop=i,this._from=f,this._to=l,this._promises=void 0}active(){return this._active}update(e,n,i){if(this._active){this._notify(!1);const l=this._target[this._prop],d=i-this._start,f=this._duration-d;this._start=i,this._duration=Math.floor(Math.max(f,e.duration)),this._total+=d,this._loop=!!e.loop,this._to=Fp([e.to,n,l,e.from]),this._from=Fp([e.from,l,n])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const n=e-this._start,i=this._duration,l=this._prop,d=this._from,f=this._loop,o=this._to;let y;if(this._active=d!==o&&(f||n<i),!this._active){this._target[l]=o,this._notify(!0);return}if(n<0){this._target[l]=d;return}y=n/i%2,y=f&&y>1?2-y:y,y=this._easing(Math.min(1,Math.max(0,y))),this._target[l]=this._fn(d,o,y)}wait(){const e=this._promises||(this._promises=[]);return new Promise((n,i)=>{e.push({res:n,rej:i})})}_notify(e){const n=e?"res":"rej",i=this._promises||[];for(let l=0;l<i.length;l++)i[l][n]()}}const x9=["x","y","borderWidth","radius","tension"],w9=["color","borderColor","backgroundColor"];cr.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0});const E9=Object.keys(cr.animation);cr.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>t!=="onProgress"&&t!=="onComplete"&&t!=="fn"});cr.set("animations",{colors:{type:"color",properties:w9},numbers:{type:"number",properties:x9}});cr.describe("animations",{_fallback:"animation"});cr.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>t|0}}}});class JC{constructor(e,n){this._chart=e,this._properties=new Map,this.configure(n)}configure(e){if(!lr(e))return;const n=this._properties;Object.getOwnPropertyNames(e).forEach(i=>{const l=e[i];if(!lr(l))return;const d={};for(const f of E9)d[f]=l[f];(ti(l.properties)&&l.properties||[i]).forEach(f=>{(f===i||!n.has(f))&&n.set(f,d)})})}_animateOptions(e,n){const i=n.options,l=k9(e,i);if(!l)return[];const d=this._createAnimations(l,i);return i.$shared&&T9(e.options.$animations,i).then(()=>{e.options=i},()=>{}),d}_createAnimations(e,n){const i=this._properties,l=[],d=e.$animations||(e.$animations={}),f=Object.keys(n),o=Date.now();let y;for(y=f.length-1;y>=0;--y){const E=f[y];if(E.charAt(0)==="$")continue;if(E==="options"){l.push(...this._animateOptions(e,n));continue}const C=n[E];let A=d[E];const P=i.get(E);if(A)if(P&&A.active()){A.update(P,C,o);continue}else A.cancel();if(!P||!P.duration){e[E]=C;continue}d[E]=A=new v9(P,e,E,C),l.push(A)}return l}update(e,n){if(this._properties.size===0){Object.assign(e,n);return}const i=this._createAnimations(e,n);if(i.length)return Jl.add(this._chart,i),!0}}function T9(t,e){const n=[],i=Object.keys(e);for(let l=0;l<i.length;l++){const d=t[i[l]];d&&d.active()&&n.push(d.wait())}return Promise.all(n)}function k9(t,e){if(!e)return;let n=t.options;if(!n){t.options=e;return}return n.$shared&&(t.options=n=Object.assign({},n,{$shared:!1,$animations:{}})),n}function bE(t,e){const n=t&&t.options||{},i=n.reverse,l=n.min===void 0?e:0,d=n.max===void 0?e:0;return{start:i?d:l,end:i?l:d}}function C9(t,e,n){if(n===!1)return!1;const i=bE(t,n),l=bE(e,n);return{top:l.end,right:i.end,bottom:l.start,left:i.start}}function S9(t){let e,n,i,l;return lr(t)?(e=t.top,n=t.right,i=t.bottom,l=t.left):e=n=i=l=t,{top:e,right:n,bottom:i,left:l,disabled:t===!1}}function QC(t,e){const n=[],i=t._getSortedDatasetMetas(e);let l,d;for(l=0,d=i.length;l<d;++l)n.push(i[l].index);return n}function vE(t,e,n,i={}){const l=t.keys,d=i.mode==="single";let f,o,y,E;if(e!==null){for(f=0,o=l.length;f<o;++f){if(y=+l[f],y===n){if(i.all)continue;break}E=t.values[y],Bi(E)&&(d||e===0||yl(e)===yl(E))&&(e+=E)}return e}}function M9(t){const e=Object.keys(t),n=new Array(e.length);let i,l,d;for(i=0,l=e.length;i<l;++i)d=e[i],n[i]={x:d,y:t[d]};return n}function xE(t,e){const n=t&&t.options.stacked;return n||n===void 0&&e.stack!==void 0}function A9(t,e,n){return`${t.id}.${e.id}.${n.stack||n.type}`}function I9(t){const{min:e,max:n,minDefined:i,maxDefined:l}=t.getUserBounds();return{min:i?e:Number.NEGATIVE_INFINITY,max:l?n:Number.POSITIVE_INFINITY}}function P9(t,e,n){const i=t[e]||(t[e]={});return i[n]||(i[n]={})}function wE(t,e,n,i){for(const l of e.getMatchingVisibleMetas(i).reverse()){const d=t[l.index];if(n&&d>0||!n&&d<0)return l.index}return null}function EE(t,e){const{chart:n,_cachedMeta:i}=t,l=n._stacks||(n._stacks={}),{iScale:d,vScale:f,index:o}=i,y=d.axis,E=f.axis,C=A9(d,f,i),A=e.length;let P;for(let B=0;B<A;++B){const j=e[B],{[y]:Z,[E]:W}=j,H=j._stacks||(j._stacks={});P=H[E]=P9(l,C,Z),P[o]=W,P._top=wE(P,f,!0,i.type),P._bottom=wE(P,f,!1,i.type)}}function tb(t,e){const n=t.scales;return Object.keys(n).filter(i=>n[i].axis===e).shift()}function L9(t,e){return Mu(t,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function z9(t,e,n){return Mu(t,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:n,index:e,mode:"default",type:"data"})}function kp(t,e){const n=t.controller.index,i=t.vScale&&t.vScale.axis;if(!!i){e=e||t._parsed;for(const l of e){const d=l._stacks;if(!d||d[i]===void 0||d[i][n]===void 0)return;delete d[i][n]}}}const eb=t=>t==="reset"||t==="none",TE=(t,e)=>e?t:Object.assign({},t),O9=(t,e,n)=>t&&!e.hidden&&e._stacked&&{keys:QC(n,!0),values:null};class wl{constructor(e,n){this.chart=e,this._ctx=e.ctx,this.index=n,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=xE(e.vScale,e),this.addElements()}updateIndex(e){this.index!==e&&kp(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,n=this._cachedMeta,i=this.getDataset(),l=(A,P,B,j)=>A==="x"?P:A==="r"?j:B,d=n.xAxisID=Kn(i.xAxisID,tb(e,"x")),f=n.yAxisID=Kn(i.yAxisID,tb(e,"y")),o=n.rAxisID=Kn(i.rAxisID,tb(e,"r")),y=n.indexAxis,E=n.iAxisID=l(y,d,f,o),C=n.vAxisID=l(y,f,d,o);n.xScale=this.getScaleForId(d),n.yScale=this.getScaleForId(f),n.rScale=this.getScaleForId(o),n.iScale=this.getScaleForId(E),n.vScale=this.getScaleForId(C)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const n=this._cachedMeta;return e===n.iScale?n.vScale:n.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&cE(this._data,this),e._stacked&&kp(e)}_dataCheck(){const e=this.getDataset(),n=e.data||(e.data=[]),i=this._data;if(lr(n))this._data=M9(n);else if(i!==n){if(i){cE(i,this);const l=this._cachedMeta;kp(l),l._parsed=[]}n&&Object.isExtensible(n)&&BB(n,this),this._syncList=[],this._data=n}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const n=this._cachedMeta,i=this.getDataset();let l=!1;this._dataCheck();const d=n._stacked;n._stacked=xE(n.vScale,n),n.stack!==i.stack&&(l=!0,kp(n),n.stack=i.stack),this._resyncElements(e),(l||d!==n._stacked)&&EE(this,n._parsed)}configure(){const e=this.chart.config,n=e.datasetScopeKeys(this._type),i=e.getOptionScopes(this.getDataset(),n,!0);this.options=e.createResolver(i,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,n){const{_cachedMeta:i,_data:l}=this,{iScale:d,_stacked:f}=i,o=d.axis;let y=e===0&&n===l.length?!0:i._sorted,E=e>0&&i._parsed[e-1],C,A,P;if(this._parsing===!1)i._parsed=l,i._sorted=!0,P=l;else{ti(l[e])?P=this.parseArrayData(i,l,e,n):lr(l[e])?P=this.parseObjectData(i,l,e,n):P=this.parsePrimitiveData(i,l,e,n);const B=()=>A[o]===null||E&&A[o]<E[o];for(C=0;C<n;++C)i._parsed[C+e]=A=P[C],y&&(B()&&(y=!1),E=A);i._sorted=y}f&&EE(this,P)}parsePrimitiveData(e,n,i,l){const{iScale:d,vScale:f}=e,o=d.axis,y=f.axis,E=d.getLabels(),C=d===f,A=new Array(l);let P,B,j;for(P=0,B=l;P<B;++P)j=P+i,A[P]={[o]:C||d.parse(E[j],j),[y]:f.parse(n[j],j)};return A}parseArrayData(e,n,i,l){const{xScale:d,yScale:f}=e,o=new Array(l);let y,E,C,A;for(y=0,E=l;y<E;++y)C=y+i,A=n[C],o[y]={x:d.parse(A[0],C),y:f.parse(A[1],C)};return o}parseObjectData(e,n,i,l){const{xScale:d,yScale:f}=e,{xAxisKey:o="x",yAxisKey:y="y"}=this._parsing,E=new Array(l);let C,A,P,B;for(C=0,A=l;C<A;++C)P=C+i,B=n[P],E[C]={x:d.parse(vu(B,o),P),y:f.parse(vu(B,y),P)};return E}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,n,i){const l=this.chart,d=this._cachedMeta,f=n[e.axis],o={keys:QC(l,!0),values:n._stacks[e.axis]};return vE(o,f,d.index,{mode:i})}updateRangeFromParsed(e,n,i,l){const d=i[n.axis];let f=d===null?NaN:d;const o=l&&i._stacks[n.axis];l&&o&&(l.values=o,f=vE(l,d,this._cachedMeta.index)),e.min=Math.min(e.min,f),e.max=Math.max(e.max,f)}getMinMax(e,n){const i=this._cachedMeta,l=i._parsed,d=i._sorted&&e===i.iScale,f=l.length,o=this._getOtherScale(e),y=O9(n,i,this.chart),E={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:C,max:A}=I9(o);let P,B;function j(){B=l[P];const Z=B[o.axis];return!Bi(B[e.axis])||C>Z||A<Z}for(P=0;P<f&&!(!j()&&(this.updateRangeFromParsed(E,e,B,y),d));++P);if(d){for(P=f-1;P>=0;--P)if(!j()){this.updateRangeFromParsed(E,e,B,y);break}}return E}getAllParsedValues(e){const n=this._cachedMeta._parsed,i=[];let l,d,f;for(l=0,d=n.length;l<d;++l)f=n[l][e.axis],Bi(f)&&i.push(f);return i}getMaxOverflow(){return!1}getLabelAndValue(e){const n=this._cachedMeta,i=n.iScale,l=n.vScale,d=this.getParsed(e);return{label:i?""+i.getLabelForValue(d[i.axis]):"",value:l?""+l.getLabelForValue(d[l.axis]):""}}_update(e){const n=this._cachedMeta;this.update(e||"default"),n._clip=S9(Kn(this.options.clip,C9(n.xScale,n.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,n=this.chart,i=this._cachedMeta,l=i.data||[],d=n.chartArea,f=[],o=this._drawStart||0,y=this._drawCount||l.length-o,E=this.options.drawActiveElementsOnTop;let C;for(i.dataset&&i.dataset.draw(e,d,o,y),C=o;C<o+y;++C){const A=l[C];A.hidden||(A.active&&E?f.push(A):A.draw(e,d))}for(C=0;C<f.length;++C)f[C].draw(e,d)}getStyle(e,n){const i=n?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(i):this.resolveDataElementOptions(e||0,i)}getContext(e,n,i){const l=this.getDataset();let d;if(e>=0&&e<this._cachedMeta.data.length){const f=this._cachedMeta.data[e];d=f.$context||(f.$context=z9(this.getContext(),e,f)),d.parsed=this.getParsed(e),d.raw=l.data[e],d.index=d.dataIndex=e}else d=this.$context||(this.$context=L9(this.chart.getContext(),this.index)),d.dataset=l,d.index=d.datasetIndex=this.index;return d.active=!!n,d.mode=i,d}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,n){return this._resolveElementOptions(this.dataElementType.id,n,e)}_resolveElementOptions(e,n="default",i){const l=n==="active",d=this._cachedDataOpts,f=e+"-"+n,o=d[f],y=this.enableOptionSharing&&ls(i);if(o)return TE(o,y);const E=this.chart.config,C=E.datasetElementScopeKeys(this._type,e),A=l?[`${e}Hover`,"hover",e,""]:[e,""],P=E.getOptionScopes(this.getDataset(),C),B=Object.keys(cr.elements[e]),j=()=>this.getContext(i,l),Z=E.resolveNamedOptions(P,B,j,A);return Z.$shared&&(Z.$shared=y,d[f]=Object.freeze(TE(Z,y))),Z}_resolveAnimations(e,n,i){const l=this.chart,d=this._cachedDataOpts,f=`animation-${n}`,o=d[f];if(o)return o;let y;if(l.options.animation!==!1){const C=this.chart.config,A=C.datasetAnimationScopeKeys(this._type,n),P=C.getOptionScopes(this.getDataset(),A);y=C.createResolver(P,this.getContext(e,i,n))}const E=new JC(l,y&&y.animations);return y&&y._cacheable&&(d[f]=Object.freeze(E)),E}getSharedOptions(e){if(!!e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,n){return!n||eb(e)||this.chart._animationsDisabled}updateElement(e,n,i,l){eb(l)?Object.assign(e,i):this._resolveAnimations(n,l).update(e,i)}updateSharedOptions(e,n,i){e&&!eb(n)&&this._resolveAnimations(void 0,n).update(e,i)}_setStyle(e,n,i,l){e.active=l;const d=this.getStyle(n,l);this._resolveAnimations(n,i,l).update(e,{options:!l&&this.getSharedOptions(d)||d})}removeHoverStyle(e,n,i){this._setStyle(e,i,"active",!1)}setHoverStyle(e,n,i){this._setStyle(e,i,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const n=this._data,i=this._cachedMeta.data;for(const[o,y,E]of this._syncList)this[o](y,E);this._syncList=[];const l=i.length,d=n.length,f=Math.min(d,l);f&&this.parse(0,f),d>l?this._insertElements(l,d-l,e):d<l&&this._removeElements(d,l-d)}_insertElements(e,n,i=!0){const l=this._cachedMeta,d=l.data,f=e+n;let o;const y=E=>{for(E.length+=n,o=E.length-1;o>=f;o--)E[o]=E[o-n]};for(y(d),o=e;o<f;++o)d[o]=new this.dataElementType;this._parsing&&y(l._parsed),this.parse(e,n),i&&this.updateElements(d,e,n,"reset")}updateElements(e,n,i,l){}_removeElements(e,n){const i=this._cachedMeta;if(this._parsing){const l=i._parsed.splice(e,n);i._stacked&&kp(i,l)}i.data.splice(e,n)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[n,i,l]=e;this[n](i,l)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,n){n&&this._sync(["_removeElements",e,n]);const i=arguments.length-2;i&&this._sync(["_insertElements",e,i])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}wl.defaults={};wl.prototype.datasetElementType=null;wl.prototype.dataElementType=null;function D9(t,e){if(!t._cache.$bar){const n=t.getMatchingVisibleMetas(e);let i=[];for(let l=0,d=n.length;l<d;l++)i=i.concat(n[l].controller.getAllParsedValues(t));t._cache.$bar=NC(i.sort((l,d)=>l-d))}return t._cache.$bar}function R9(t){const e=t.iScale,n=D9(e,t.type);let i=e._length,l,d,f,o;const y=()=>{f===32767||f===-32768||(ls(o)&&(i=Math.min(i,Math.abs(f-o)||i)),o=f)};for(l=0,d=n.length;l<d;++l)f=e.getPixelForValue(n[l]),y();for(o=void 0,l=0,d=e.ticks.length;l<d;++l)f=e.getPixelForTick(l),y();return i}function B9(t,e,n,i){const l=n.barThickness;let d,f;return Tr(l)?(d=e.min*n.categoryPercentage,f=n.barPercentage):(d=l*i,f=1),{chunk:d/i,ratio:f,start:e.pixels[t]-d/2}}function F9(t,e,n,i){const l=e.pixels,d=l[t];let f=t>0?l[t-1]:null,o=t<l.length-1?l[t+1]:null;const y=n.categoryPercentage;f===null&&(f=d-(o===null?e.end-e.start:o-d)),o===null&&(o=d+d-f);const E=d-(d-Math.min(f,o))/2*y;return{chunk:Math.abs(o-f)/2*y/i,ratio:n.barPercentage,start:E}}function N9(t,e,n,i){const l=n.parse(t[0],i),d=n.parse(t[1],i),f=Math.min(l,d),o=Math.max(l,d);let y=f,E=o;Math.abs(f)>Math.abs(o)&&(y=o,E=f),e[n.axis]=E,e._custom={barStart:y,barEnd:E,start:l,end:d,min:f,max:o}}function tS(t,e,n,i){return ti(t)?N9(t,e,n,i):e[n.axis]=n.parse(t,i),e}function kE(t,e,n,i){const l=t.iScale,d=t.vScale,f=l.getLabels(),o=l===d,y=[];let E,C,A,P;for(E=n,C=n+i;E<C;++E)P=e[E],A={},A[l.axis]=o||l.parse(f[E],E),y.push(tS(P,A,d,E));return y}function nb(t){return t&&t.barStart!==void 0&&t.barEnd!==void 0}function j9(t,e,n){return t!==0?yl(t):(e.isHorizontal()?1:-1)*(e.min>=n?1:-1)}function U9(t){let e,n,i,l,d;return t.horizontal?(e=t.base>t.x,n="left",i="right"):(e=t.base<t.y,n="bottom",i="top"),e?(l="end",d="start"):(l="start",d="end"),{start:n,end:i,reverse:e,top:l,bottom:d}}function $9(t,e,n,i){let l=e.borderSkipped;const d={};if(!l){t.borderSkipped=d;return}const{start:f,end:o,reverse:y,top:E,bottom:C}=U9(t);l==="middle"&&n&&(t.enableBorderRadius=!0,(n._top||0)===i?l=E:(n._bottom||0)===i?l=C:(d[CE(C,f,o,y)]=!0,l=E)),d[CE(l,f,o,y)]=!0,t.borderSkipped=d}function CE(t,e,n,i){return i?(t=V9(t,e,n),t=SE(t,n,e)):t=SE(t,e,n),t}function V9(t,e,n){return t===e?n:t===n?e:t}function SE(t,e,n){return t==="start"?e:t==="end"?n:t}function G9(t,{inflateAmount:e},n){t.inflateAmount=e==="auto"?n===1?.33:0:e}class X_ extends wl{parsePrimitiveData(e,n,i,l){return kE(e,n,i,l)}parseArrayData(e,n,i,l){return kE(e,n,i,l)}parseObjectData(e,n,i,l){const{iScale:d,vScale:f}=e,{xAxisKey:o="x",yAxisKey:y="y"}=this._parsing,E=d.axis==="x"?o:y,C=f.axis==="x"?o:y,A=[];let P,B,j,Z;for(P=i,B=i+l;P<B;++P)Z=n[P],j={},j[d.axis]=d.parse(vu(Z,E),P),A.push(tS(vu(Z,C),j,f,P));return A}updateRangeFromParsed(e,n,i,l){super.updateRangeFromParsed(e,n,i,l);const d=i._custom;d&&n===this._cachedMeta.vScale&&(e.min=Math.min(e.min,d.min),e.max=Math.max(e.max,d.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const n=this._cachedMeta,{iScale:i,vScale:l}=n,d=this.getParsed(e),f=d._custom,o=nb(f)?"["+f.start+", "+f.end+"]":""+l.getLabelForValue(d[l.axis]);return{label:""+i.getLabelForValue(d[i.axis]),value:o}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const n=this._cachedMeta;this.updateElements(n.data,0,n.data.length,e)}updateElements(e,n,i,l){const d=l==="reset",{index:f,_cachedMeta:{vScale:o}}=this,y=o.getBasePixel(),E=o.isHorizontal(),C=this._getRuler(),A=this.resolveDataElementOptions(n,l),P=this.getSharedOptions(A),B=this.includeOptions(l,P);this.updateSharedOptions(P,l,A);for(let j=n;j<n+i;j++){const Z=this.getParsed(j),W=d||Tr(Z[o.axis])?{base:y,head:y}:this._calculateBarValuePixels(j),H=this._calculateBarIndexPixels(j,C),V=(Z._stacks||{})[o.axis],tt={horizontal:E,base:W.base,enableBorderRadius:!V||nb(Z._custom)||f===V._top||f===V._bottom,x:E?W.head:H.center,y:E?H.center:W.head,height:E?H.size:Math.abs(W.size),width:E?Math.abs(W.size):H.size};B&&(tt.options=P||this.resolveDataElementOptions(j,e[j].active?"active":l));const ft=tt.options||e[j].options;$9(tt,ft,V,f),G9(tt,ft,C.ratio),this.updateElement(e[j],j,tt,l)}}_getStacks(e,n){const l=this._cachedMeta.iScale,d=l.getMatchingVisibleMetas(this._type),f=l.options.stacked,o=d.length,y=[];let E,C;for(E=0;E<o;++E)if(C=d[E],!!C.controller.options.grouped){if(typeof n!="undefined"){const A=C.controller.getParsed(n)[C.controller._cachedMeta.vScale.axis];if(Tr(A)||isNaN(A))continue}if((f===!1||y.indexOf(C.stack)===-1||f===void 0&&C.stack===void 0)&&y.push(C.stack),C.index===e)break}return y.length||y.push(void 0),y}_getStackCount(e){return this._getStacks(void 0,e).length}_getStackIndex(e,n,i){const l=this._getStacks(e,i),d=n!==void 0?l.indexOf(n):-1;return d===-1?l.length-1:d}_getRuler(){const e=this.options,n=this._cachedMeta,i=n.iScale,l=[];let d,f;for(d=0,f=n.data.length;d<f;++d)l.push(i.getPixelForValue(this.getParsed(d)[i.axis],d));const o=e.barThickness;return{min:o||R9(n),pixels:l,start:i._startPixel,end:i._endPixel,stackCount:this._getStackCount(),scale:i,grouped:e.grouped,ratio:o?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:n,_stacked:i},options:{base:l,minBarLength:d}}=this,f=l||0,o=this.getParsed(e),y=o._custom,E=nb(y);let C=o[n.axis],A=0,P=i?this.applyStack(n,o,i):C,B,j;P!==C&&(A=P-C,P=C),E&&(C=y.barStart,P=y.barEnd-y.barStart,C!==0&&yl(C)!==yl(y.barEnd)&&(A=0),A+=C);const Z=!Tr(l)&&!E?l:A;let W=n.getPixelForValue(Z);if(this.chart.getDataVisibility(e)?B=n.getPixelForValue(A+P):B=W,j=B-W,Math.abs(j)<d){j=j9(j,n,f)*d,C===f&&(W-=j/2);const H=n.getPixelForDecimal(0),V=n.getPixelForDecimal(1),tt=Math.min(H,V),ft=Math.max(H,V);W=Math.max(Math.min(W,ft),tt),B=W+j}if(W===n.getPixelForValue(f)){const H=yl(j)*n.getLineWidthForValue(f)/2;W+=H,j-=H}return{size:j,base:W,head:B,center:B+j/2}}_calculateBarIndexPixels(e,n){const i=n.scale,l=this.options,d=l.skipNull,f=Kn(l.maxBarThickness,1/0);let o,y;if(n.grouped){const E=d?this._getStackCount(e):n.stackCount,C=l.barThickness==="flex"?F9(e,n,l,E):B9(e,n,l,E),A=this._getStackIndex(this.index,this._cachedMeta.stack,d?e:void 0);o=C.start+C.chunk*A+C.chunk/2,y=Math.min(f,C.chunk*C.ratio)}else o=i.getPixelForValue(this.getParsed(e)[i.axis],e),y=Math.min(f,n.min*n.ratio);return{base:o-y/2,head:o+y/2,center:o,size:y}}draw(){const e=this._cachedMeta,n=e.vScale,i=e.data,l=i.length;let d=0;for(;d<l;++d)this.getParsed(d)[n.axis]!==null&&i[d].draw(this._ctx)}}X_.id="bar";X_.defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};X_.overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};class Y_ extends wl{initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(e,n,i,l){const d=super.parsePrimitiveData(e,n,i,l);for(let f=0;f<d.length;f++)d[f]._custom=this.resolveDataElementOptions(f+i).radius;return d}parseArrayData(e,n,i,l){const d=super.parseArrayData(e,n,i,l);for(let f=0;f<d.length;f++){const o=n[i+f];d[f]._custom=Kn(o[2],this.resolveDataElementOptions(f+i).radius)}return d}parseObjectData(e,n,i,l){const d=super.parseObjectData(e,n,i,l);for(let f=0;f<d.length;f++){const o=n[i+f];d[f]._custom=Kn(o&&o.r&&+o.r,this.resolveDataElementOptions(f+i).radius)}return d}getMaxOverflow(){const e=this._cachedMeta.data;let n=0;for(let i=e.length-1;i>=0;--i)n=Math.max(n,e[i].size(this.resolveDataElementOptions(i))/2);return n>0&&n}getLabelAndValue(e){const n=this._cachedMeta,{xScale:i,yScale:l}=n,d=this.getParsed(e),f=i.getLabelForValue(d.x),o=l.getLabelForValue(d.y),y=d._custom;return{label:n.label,value:"("+f+", "+o+(y?", "+y:"")+")"}}update(e){const n=this._cachedMeta.data;this.updateElements(n,0,n.length,e)}updateElements(e,n,i,l){const d=l==="reset",{iScale:f,vScale:o}=this._cachedMeta,y=this.resolveDataElementOptions(n,l),E=this.getSharedOptions(y),C=this.includeOptions(l,E),A=f.axis,P=o.axis;for(let B=n;B<n+i;B++){const j=e[B],Z=!d&&this.getParsed(B),W={},H=W[A]=d?f.getPixelForDecimal(.5):f.getPixelForValue(Z[A]),V=W[P]=d?o.getBasePixel():o.getPixelForValue(Z[P]);W.skip=isNaN(H)||isNaN(V),C&&(W.options=this.resolveDataElementOptions(B,j.active?"active":l),d&&(W.options.radius=0)),this.updateElement(j,B,W,l)}this.updateSharedOptions(E,l,y)}resolveDataElementOptions(e,n){const i=this.getParsed(e);let l=super.resolveDataElementOptions(e,n);l.$shared&&(l=Object.assign({},l,{$shared:!1}));const d=l.radius;return n!=="active"&&(l.radius=0),l.radius+=Kn(i&&i._custom,d),l}}Y_.id="bubble";Y_.defaults={datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}};Y_.overrides={scales:{x:{type:"linear"},y:{type:"linear"}},plugins:{tooltip:{callbacks:{title(){return""}}}}};function q9(t,e,n){let i=1,l=1,d=0,f=0;if(e<Kr){const o=t,y=o+e,E=Math.cos(o),C=Math.sin(o),A=Math.cos(y),P=Math.sin(y),B=(tt,ft,et)=>vm(tt,o,y,!0)?1:Math.max(ft,ft*n,et,et*n),j=(tt,ft,et)=>vm(tt,o,y,!0)?-1:Math.min(ft,ft*n,et,et*n),Z=B(0,E,A),W=B(Ii,C,P),H=j(bi,E,A),V=j(bi+Ii,C,P);i=(Z-H)/2,l=(W-V)/2,d=-(Z+H)/2,f=-(W+V)/2}return{ratioX:i,ratioY:l,offsetX:d,offsetY:f}}class vf extends wl{constructor(e,n){super(e,n),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,n){const i=this.getDataset().data,l=this._cachedMeta;if(this._parsing===!1)l._parsed=i;else{let d=y=>+i[y];if(lr(i[e])){const{key:y="value"}=this._parsing;d=E=>+vu(i[E],y)}let f,o;for(f=e,o=e+n;f<o;++f)l._parsed[f]=d(f)}}_getRotation(){return Bs(this.options.rotation-90)}_getCircumference(){return Bs(this.options.circumference)}_getRotationExtents(){let e=Kr,n=-Kr;for(let i=0;i<this.chart.data.datasets.length;++i)if(this.chart.isDatasetVisible(i)){const l=this.chart.getDatasetMeta(i).controller,d=l._getRotation(),f=l._getCircumference();e=Math.min(e,d),n=Math.max(n,d+f)}return{rotation:e,circumference:n-e}}update(e){const n=this.chart,{chartArea:i}=n,l=this._cachedMeta,d=l.data,f=this.getMaxBorderWidth()+this.getMaxOffset(d)+this.options.spacing,o=Math.max((Math.min(i.width,i.height)-f)/2,0),y=Math.min(V7(this.options.cutout,o),1),E=this._getRingWeight(this.index),{circumference:C,rotation:A}=this._getRotationExtents(),{ratioX:P,ratioY:B,offsetX:j,offsetY:Z}=q9(A,C,y),W=(i.width-f)/P,H=(i.height-f)/B,V=Math.max(Math.min(W,H)/2,0),tt=MC(this.options.radius,V),ft=Math.max(tt*y,0),et=(tt-ft)/this._getVisibleDatasetWeightTotal();this.offsetX=j*tt,this.offsetY=Z*tt,l.total=this.calculateTotal(),this.outerRadius=tt-et*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-et*E,0),this.updateElements(d,0,d.length,e)}_circumference(e,n){const i=this.options,l=this._cachedMeta,d=this._getCircumference();return n&&i.animation.animateRotate||!this.chart.getDataVisibility(e)||l._parsed[e]===null||l.data[e].hidden?0:this.calculateCircumference(l._parsed[e]*d/Kr)}updateElements(e,n,i,l){const d=l==="reset",f=this.chart,o=f.chartArea,E=f.options.animation,C=(o.left+o.right)/2,A=(o.top+o.bottom)/2,P=d&&E.animateScale,B=P?0:this.innerRadius,j=P?0:this.outerRadius,Z=this.resolveDataElementOptions(n,l),W=this.getSharedOptions(Z),H=this.includeOptions(l,W);let V=this._getRotation(),tt;for(tt=0;tt<n;++tt)V+=this._circumference(tt,d);for(tt=n;tt<n+i;++tt){const ft=this._circumference(tt,d),et=e[tt],Pt={x:C+this.offsetX,y:A+this.offsetY,startAngle:V,endAngle:V+ft,circumference:ft,outerRadius:j,innerRadius:B};H&&(Pt.options=W||this.resolveDataElementOptions(tt,et.active?"active":l)),V+=ft,this.updateElement(et,tt,Pt,l)}this.updateSharedOptions(W,l,Z)}calculateTotal(){const e=this._cachedMeta,n=e.data;let i=0,l;for(l=0;l<n.length;l++){const d=e._parsed[l];d!==null&&!isNaN(d)&&this.chart.getDataVisibility(l)&&!n[l].hidden&&(i+=Math.abs(d))}return i}calculateCircumference(e){const n=this._cachedMeta.total;return n>0&&!isNaN(e)?Kr*(Math.abs(e)/n):0}getLabelAndValue(e){const n=this._cachedMeta,i=this.chart,l=i.data.labels||[],d=Fm(n._parsed[e],i.options.locale);return{label:l[e]||"",value:d}}getMaxBorderWidth(e){let n=0;const i=this.chart;let l,d,f,o,y;if(!e){for(l=0,d=i.data.datasets.length;l<d;++l)if(i.isDatasetVisible(l)){f=i.getDatasetMeta(l),e=f.data,o=f.controller;break}}if(!e)return 0;for(l=0,d=e.length;l<d;++l)y=o.resolveDataElementOptions(l),y.borderAlign!=="inner"&&(n=Math.max(n,y.borderWidth||0,y.hoverBorderWidth||0));return n}getMaxOffset(e){let n=0;for(let i=0,l=e.length;i<l;++i){const d=this.resolveDataElementOptions(i);n=Math.max(n,d.offset||0,d.hoverOffset||0)}return n}_getRingWeightOffset(e){let n=0;for(let i=0;i<e;++i)this.chart.isDatasetVisible(i)&&(n+=this._getRingWeight(i));return n}_getRingWeight(e){return Math.max(Kn(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}vf.id="doughnut";vf.defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};vf.descriptors={_scriptable:t=>t!=="spacing",_indexable:t=>t!=="spacing"};vf.overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const e=t.data;if(e.labels.length&&e.datasets.length){const{labels:{pointStyle:n}}=t.legend.options;return e.labels.map((i,l)=>{const f=t.getDatasetMeta(0).controller.getStyle(l);return{text:i,fillStyle:f.backgroundColor,strokeStyle:f.borderColor,lineWidth:f.borderWidth,pointStyle:n,hidden:!t.getDataVisibility(l),index:l}})}return[]}},onClick(t,e,n){n.chart.toggleDataVisibility(e.index),n.chart.update()}},tooltip:{callbacks:{title(){return""},label(t){let e=t.label;const n=": "+t.formattedValue;return ti(e)?(e=e.slice(),e[0]+=n):e+=n,e}}}}};class Nm extends wl{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const n=this._cachedMeta,{dataset:i,data:l=[],_dataset:d}=n,f=this.chart._animationsDisabled;let{start:o,count:y}=H9(n,l,f);this._drawStart=o,this._drawCount=y,W9(n)&&(o=0,y=l.length),i._chart=this.chart,i._datasetIndex=this.index,i._decimated=!!d._decimated,i.points=l;const E=this.resolveDatasetElementOptions(e);this.options.showLine||(E.borderWidth=0),E.segment=this.options.segment,this.updateElement(i,void 0,{animated:!f,options:E},e),this.updateElements(l,o,y,e)}updateElements(e,n,i,l){const d=l==="reset",{iScale:f,vScale:o,_stacked:y,_dataset:E}=this._cachedMeta,C=this.resolveDataElementOptions(n,l),A=this.getSharedOptions(C),P=this.includeOptions(l,A),B=f.axis,j=o.axis,{spanGaps:Z,segment:W}=this.options,H=bm(Z)?Z:Number.POSITIVE_INFINITY,V=this.chart._animationsDisabled||d||l==="none";let tt=n>0&&this.getParsed(n-1);for(let ft=n;ft<n+i;++ft){const et=e[ft],Pt=this.getParsed(ft),Rt=V?et:{},zt=Tr(Pt[j]),jt=Rt[B]=f.getPixelForValue(Pt[B],ft),oe=Rt[j]=d||zt?o.getBasePixel():o.getPixelForValue(y?this.applyStack(o,Pt,y):Pt[j],ft);Rt.skip=isNaN(jt)||isNaN(oe)||zt,Rt.stop=ft>0&&Math.abs(Pt[B]-tt[B])>H,W&&(Rt.parsed=Pt,Rt.raw=E.data[ft]),P&&(Rt.options=A||this.resolveDataElementOptions(ft,et.active?"active":l)),V||this.updateElement(et,ft,Rt,l),tt=Pt}this.updateSharedOptions(A,l,C)}getMaxOverflow(){const e=this._cachedMeta,n=e.dataset,i=n.options&&n.options.borderWidth||0,l=e.data||[];if(!l.length)return i;const d=l[0].size(this.resolveDataElementOptions(0)),f=l[l.length-1].size(this.resolveDataElementOptions(l.length-1));return Math.max(i,d,f)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}Nm.id="line";Nm.defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};Nm.overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};function H9(t,e,n){const i=e.length;let l=0,d=i;if(t._sorted){const{iScale:f,_parsed:o}=t,y=f.axis,{min:E,max:C,minDefined:A,maxDefined:P}=f.getUserBounds();A&&(l=vo(Math.min(ic(o,f.axis,E).lo,n?i:ic(e,y,f.getPixelForValue(E)).lo),0,i-1)),P?d=vo(Math.max(ic(o,f.axis,C).hi+1,n?0:ic(e,y,f.getPixelForValue(C)).hi+1),l,i)-l:d=i-l}return{start:l,count:d}}function W9(t){const{xScale:e,yScale:n,_scaleRanges:i}=t,l={xmin:e.min,xmax:e.max,ymin:n.min,ymax:n.max};if(!i)return t._scaleRanges=l,!0;const d=i.xmin!==e.min||i.xmax!==e.max||i.ymin!==n.min||i.ymax!==n.max;return Object.assign(i,l),d}class K_ extends wl{constructor(e,n){super(e,n),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(e){const n=this._cachedMeta,i=this.chart,l=i.data.labels||[],d=Fm(n._parsed[e].r,i.options.locale);return{label:l[e]||"",value:d}}parseObjectData(e,n,i,l){return GC.bind(this)(e,n,i,l)}update(e){const n=this._cachedMeta.data;this._updateRadius(),this.updateElements(n,0,n.length,e)}getMinMax(){const e=this._cachedMeta,n={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return e.data.forEach((i,l)=>{const d=this.getParsed(l).r;!isNaN(d)&&this.chart.getDataVisibility(l)&&(d<n.min&&(n.min=d),d>n.max&&(n.max=d))}),n}_updateRadius(){const e=this.chart,n=e.chartArea,i=e.options,l=Math.min(n.right-n.left,n.bottom-n.top),d=Math.max(l/2,0),f=Math.max(i.cutoutPercentage?d/100*i.cutoutPercentage:1,0),o=(d-f)/e.getVisibleDatasetCount();this.outerRadius=d-o*this.index,this.innerRadius=this.outerRadius-o}updateElements(e,n,i,l){const d=l==="reset",f=this.chart,y=f.options.animation,E=this._cachedMeta.rScale,C=E.xCenter,A=E.yCenter,P=E.getIndexAngle(0)-.5*bi;let B=P,j;const Z=360/this.countVisibleElements();for(j=0;j<n;++j)B+=this._computeAngle(j,l,Z);for(j=n;j<n+i;j++){const W=e[j];let H=B,V=B+this._computeAngle(j,l,Z),tt=f.getDataVisibility(j)?E.getDistanceFromCenterForValue(this.getParsed(j).r):0;B=V,d&&(y.animateScale&&(tt=0),y.animateRotate&&(H=V=P));const ft={x:C,y:A,innerRadius:0,outerRadius:tt,startAngle:H,endAngle:V,options:this.resolveDataElementOptions(j,W.active?"active":l)};this.updateElement(W,j,ft,l)}}countVisibleElements(){const e=this._cachedMeta;let n=0;return e.data.forEach((i,l)=>{!isNaN(this.getParsed(l).r)&&this.chart.getDataVisibility(l)&&n++}),n}_computeAngle(e,n,i){return this.chart.getDataVisibility(e)?Bs(this.resolveDataElementOptions(e,n).angle||i):0}}K_.id="polarArea";K_.defaults={dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0};K_.overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const e=t.data;if(e.labels.length&&e.datasets.length){const{labels:{pointStyle:n}}=t.legend.options;return e.labels.map((i,l)=>{const f=t.getDatasetMeta(0).controller.getStyle(l);return{text:i,fillStyle:f.backgroundColor,strokeStyle:f.borderColor,lineWidth:f.borderWidth,pointStyle:n,hidden:!t.getDataVisibility(l),index:l}})}return[]}},onClick(t,e,n){n.chart.toggleDataVisibility(e.index),n.chart.update()}},tooltip:{callbacks:{title(){return""},label(t){return t.chart.data.labels[t.dataIndex]+": "+t.formattedValue}}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}};class px extends vf{}px.id="pie";px.defaults={cutout:0,rotation:0,circumference:360,radius:"100%"};class J_ extends wl{getLabelAndValue(e){const n=this._cachedMeta.vScale,i=this.getParsed(e);return{label:n.getLabels()[e],value:""+n.getLabelForValue(i[n.axis])}}parseObjectData(e,n,i,l){return GC.bind(this)(e,n,i,l)}update(e){const n=this._cachedMeta,i=n.dataset,l=n.data||[],d=n.iScale.getLabels();if(i.points=l,e!=="resize"){const f=this.resolveDatasetElementOptions(e);this.options.showLine||(f.borderWidth=0);const o={_loop:!0,_fullLoop:d.length===l.length,options:f};this.updateElement(i,void 0,o,e)}this.updateElements(l,0,l.length,e)}updateElements(e,n,i,l){const d=this._cachedMeta.rScale,f=l==="reset";for(let o=n;o<n+i;o++){const y=e[o],E=this.resolveDataElementOptions(o,y.active?"active":l),C=d.getPointPositionForValue(o,this.getParsed(o).r),A=f?d.xCenter:C.x,P=f?d.yCenter:C.y,B={x:A,y:P,angle:C.angle,skip:isNaN(A)||isNaN(P),options:E};this.updateElement(y,o,B,l)}}}J_.id="radar";J_.defaults={datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}};J_.overrides={aspectRatio:1,scales:{r:{type:"radialLinear"}}};class Q_ extends Nm{}Q_.id="scatter";Q_.defaults={showLine:!1,fill:!1};Q_.overrides={interaction:{mode:"point"},plugins:{tooltip:{callbacks:{title(){return""},label(t){return"("+t.label+", "+t.formattedValue+")"}}}},scales:{x:{type:"linear"},y:{type:"linear"}}};var Z9=Object.freeze({__proto__:null,BarController:X_,BubbleController:Y_,DoughnutController:vf,LineController:Nm,PolarAreaController:K_,PieController:px,RadarController:J_,ScatterController:Q_});function _d(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class Qb{constructor(e){this.options=e||{}}formats(){return _d()}parse(e,n){return _d()}format(e,n){return _d()}add(e,n,i){return _d()}diff(e,n,i){return _d()}startOf(e,n,i){return _d()}endOf(e,n){return _d()}}Qb.override=function(t){Object.assign(Qb.prototype,t)};var X9={_date:Qb};function Y9(t,e,n,i){const{controller:l,data:d,_sorted:f}=t,o=l._cachedMeta.iScale;if(o&&e===o.axis&&e!=="r"&&f&&d.length){const y=o._reversePixels?DB:ic;if(i){if(l._sharedOptions){const E=d[0],C=typeof E.getRange=="function"&&E.getRange(e);if(C){const A=y(d,e,n-C),P=y(d,e,n+C);return{lo:A.lo,hi:P.hi}}}}else return y(d,e,n)}return{lo:0,hi:d.length-1}}function jm(t,e,n,i,l){const d=t.getSortedVisibleDatasetMetas(),f=n[e];for(let o=0,y=d.length;o<y;++o){const{index:E,data:C}=d[o],{lo:A,hi:P}=Y9(d[o],e,f,l);for(let B=A;B<=P;++B){const j=C[B];j.skip||i(j,E,B)}}}function K9(t){const e=t.indexOf("x")!==-1,n=t.indexOf("y")!==-1;return function(i,l){const d=e?Math.abs(i.x-l.x):0,f=n?Math.abs(i.y-l.y):0;return Math.sqrt(Math.pow(d,2)+Math.pow(f,2))}}function rb(t,e,n,i,l){const d=[];return!l&&!t.isPointInArea(e)||jm(t,n,e,function(o,y,E){!l&&!xm(o,t.chartArea,0)||o.inRange(e.x,e.y,i)&&d.push({element:o,datasetIndex:y,index:E})},!0),d}function J9(t,e,n,i){let l=[];function d(f,o,y){const{startAngle:E,endAngle:C}=f.getProps(["startAngle","endAngle"],i),{angle:A}=PC(f,{x:e.x,y:e.y});vm(A,E,C)&&l.push({element:f,datasetIndex:o,index:y})}return jm(t,n,e,d),l}function Q9(t,e,n,i,l,d){let f=[];const o=K9(n);let y=Number.POSITIVE_INFINITY;function E(C,A,P){const B=C.inRange(e.x,e.y,l);if(i&&!B)return;const j=C.getCenterPoint(l);if(!(!!d||t.isPointInArea(j))&&!B)return;const W=o(e,j);W<y?(f=[{element:C,datasetIndex:A,index:P}],y=W):W===y&&f.push({element:C,datasetIndex:A,index:P})}return jm(t,n,e,E),f}function ib(t,e,n,i,l,d){return!d&&!t.isPointInArea(e)?[]:n==="r"&&!i?J9(t,e,n,l):Q9(t,e,n,i,l,d)}function ME(t,e,n,i,l){const d=[],f=n==="x"?"inXRange":"inYRange";let o=!1;return jm(t,n,e,(y,E,C)=>{y[f](e[n],l)&&(d.push({element:y,datasetIndex:E,index:C}),o=o||y.inRange(e.x,e.y,l))}),i&&!o?[]:d}var tF={evaluateInteractionItems:jm,modes:{index(t,e,n,i){const l=xd(e,t),d=n.axis||"x",f=n.includeInvisible||!1,o=n.intersect?rb(t,l,d,i,f):ib(t,l,d,!1,i,f),y=[];return o.length?(t.getSortedVisibleDatasetMetas().forEach(E=>{const C=o[0].index,A=E.data[C];A&&!A.skip&&y.push({element:A,datasetIndex:E.index,index:C})}),y):[]},dataset(t,e,n,i){const l=xd(e,t),d=n.axis||"xy",f=n.includeInvisible||!1;let o=n.intersect?rb(t,l,d,i,f):ib(t,l,d,!1,i,f);if(o.length>0){const y=o[0].datasetIndex,E=t.getDatasetMeta(y).data;o=[];for(let C=0;C<E.length;++C)o.push({element:E[C],datasetIndex:y,index:C})}return o},point(t,e,n,i){const l=xd(e,t),d=n.axis||"xy",f=n.includeInvisible||!1;return rb(t,l,d,i,f)},nearest(t,e,n,i){const l=xd(e,t),d=n.axis||"xy",f=n.includeInvisible||!1;return ib(t,l,d,n.intersect,i,f)},x(t,e,n,i){const l=xd(e,t);return ME(t,l,"x",n.intersect,i)},y(t,e,n,i){const l=xd(e,t);return ME(t,l,"y",n.intersect,i)}}};const eS=["left","top","right","bottom"];function Cp(t,e){return t.filter(n=>n.pos===e)}function AE(t,e){return t.filter(n=>eS.indexOf(n.pos)===-1&&n.box.axis===e)}function Sp(t,e){return t.sort((n,i)=>{const l=e?i:n,d=e?n:i;return l.weight===d.weight?l.index-d.index:l.weight-d.weight})}function eF(t){const e=[];let n,i,l,d,f,o;for(n=0,i=(t||[]).length;n<i;++n)l=t[n],{position:d,options:{stack:f,stackWeight:o=1}}=l,e.push({index:n,box:l,pos:d,horizontal:l.isHorizontal(),weight:l.weight,stack:f&&d+f,stackWeight:o});return e}function nF(t){const e={};for(const n of t){const{stack:i,pos:l,stackWeight:d}=n;if(!i||!eS.includes(l))continue;const f=e[i]||(e[i]={count:0,placed:0,weight:0,size:0});f.count++,f.weight+=d}return e}function rF(t,e){const n=nF(t),{vBoxMaxWidth:i,hBoxMaxHeight:l}=e;let d,f,o;for(d=0,f=t.length;d<f;++d){o=t[d];const{fullSize:y}=o.box,E=n[o.stack],C=E&&o.stackWeight/E.weight;o.horizontal?(o.width=C?C*i:y&&e.availableWidth,o.height=l):(o.width=i,o.height=C?C*l:y&&e.availableHeight)}return n}function iF(t){const e=eF(t),n=Sp(e.filter(E=>E.box.fullSize),!0),i=Sp(Cp(e,"left"),!0),l=Sp(Cp(e,"right")),d=Sp(Cp(e,"top"),!0),f=Sp(Cp(e,"bottom")),o=AE(e,"x"),y=AE(e,"y");return{fullSize:n,leftAndTop:i.concat(d),rightAndBottom:l.concat(y).concat(f).concat(o),chartArea:Cp(e,"chartArea"),vertical:i.concat(l).concat(y),horizontal:d.concat(f).concat(o)}}function IE(t,e,n,i){return Math.max(t[n],e[n])+Math.max(t[i],e[i])}function nS(t,e){t.top=Math.max(t.top,e.top),t.left=Math.max(t.left,e.left),t.bottom=Math.max(t.bottom,e.bottom),t.right=Math.max(t.right,e.right)}function oF(t,e,n,i){const{pos:l,box:d}=n,f=t.maxPadding;if(!lr(l)){n.size&&(t[l]-=n.size);const A=i[n.stack]||{size:0,count:1};A.size=Math.max(A.size,n.horizontal?d.height:d.width),n.size=A.size/A.count,t[l]+=n.size}d.getPadding&&nS(f,d.getPadding());const o=Math.max(0,e.outerWidth-IE(f,t,"left","right")),y=Math.max(0,e.outerHeight-IE(f,t,"top","bottom")),E=o!==t.w,C=y!==t.h;return t.w=o,t.h=y,n.horizontal?{same:E,other:C}:{same:C,other:E}}function aF(t){const e=t.maxPadding;function n(i){const l=Math.max(e[i]-t[i],0);return t[i]+=l,l}t.y+=n("top"),t.x+=n("left"),n("right"),n("bottom")}function sF(t,e){const n=e.maxPadding;function i(l){const d={left:0,top:0,right:0,bottom:0};return l.forEach(f=>{d[f]=Math.max(e[f],n[f])}),d}return i(t?["left","right"]:["top","bottom"])}function Np(t,e,n,i){const l=[];let d,f,o,y,E,C;for(d=0,f=t.length,E=0;d<f;++d){o=t[d],y=o.box,y.update(o.width||e.w,o.height||e.h,sF(o.horizontal,e));const{same:A,other:P}=oF(e,n,o,i);E|=A&&l.length,C=C||P,y.fullSize||l.push(o)}return E&&Np(l,e,n,i)||C}function M0(t,e,n,i,l){t.top=n,t.left=e,t.right=e+i,t.bottom=n+l,t.width=i,t.height=l}function PE(t,e,n,i){const l=n.padding;let{x:d,y:f}=e;for(const o of t){const y=o.box,E=i[o.stack]||{count:1,placed:0,weight:1},C=o.stackWeight/E.weight||1;if(o.horizontal){const A=e.w*C,P=E.size||y.height;ls(E.start)&&(f=E.start),y.fullSize?M0(y,l.left,f,n.outerWidth-l.right-l.left,P):M0(y,e.left+E.placed,f,A,P),E.start=f,E.placed+=A,f=y.bottom}else{const A=e.h*C,P=E.size||y.width;ls(E.start)&&(d=E.start),y.fullSize?M0(y,d,l.top,P,n.outerHeight-l.bottom-l.top):M0(y,d,e.top+E.placed,P,A),E.start=d,E.placed+=A,d=y.right}}e.x=d,e.y=f}cr.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}});var $o={addBox(t,e){t.boxes||(t.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(n){e.draw(n)}}]},t.boxes.push(e)},removeBox(t,e){const n=t.boxes?t.boxes.indexOf(e):-1;n!==-1&&t.boxes.splice(n,1)},configure(t,e,n){e.fullSize=n.fullSize,e.position=n.position,e.weight=n.weight},update(t,e,n,i){if(!t)return;const l=Go(t.options.layout.padding),d=Math.max(e-l.width,0),f=Math.max(n-l.height,0),o=iF(t.boxes),y=o.vertical,E=o.horizontal;Ur(t.boxes,Z=>{typeof Z.beforeLayout=="function"&&Z.beforeLayout()});const C=y.reduce((Z,W)=>W.box.options&&W.box.options.display===!1?Z:Z+1,0)||1,A=Object.freeze({outerWidth:e,outerHeight:n,padding:l,availableWidth:d,availableHeight:f,vBoxMaxWidth:d/2/C,hBoxMaxHeight:f/2}),P=Object.assign({},l);nS(P,Go(i));const B=Object.assign({maxPadding:P,w:d,h:f,x:l.left,y:l.top},l),j=rF(y.concat(E),A);Np(o.fullSize,B,A,j),Np(y,B,A,j),Np(E,B,A,j)&&Np(y,B,A,j),aF(B),PE(o.leftAndTop,B,A,j),B.x+=B.w,B.y+=B.h,PE(o.rightAndBottom,B,A,j),t.chartArea={left:B.left,top:B.top,right:B.left+B.w,bottom:B.top+B.h,height:B.h,width:B.w},Ur(o.chartArea,Z=>{const W=Z.box;Object.assign(W,t.chartArea),W.update(B.w,B.h,{left:0,top:0,right:0,bottom:0})})}};class rS{acquireContext(e,n){}releaseContext(e){return!1}addEventListener(e,n,i){}removeEventListener(e,n,i){}getDevicePixelRatio(){return 1}getMaximumSize(e,n,i,l){return n=Math.max(0,n||e.width),i=i||e.height,{width:n,height:Math.max(0,l?Math.floor(n/l):i)}}isAttached(e){return!0}updateConfig(e){}}class lF extends rS{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const Z0="$chartjs",cF={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},LE=t=>t===null||t==="";function uF(t,e){const n=t.style,i=t.getAttribute("height"),l=t.getAttribute("width");if(t[Z0]={initial:{height:i,width:l,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",LE(l)){const d=fE(t,"width");d!==void 0&&(t.width=d)}if(LE(i))if(t.style.height==="")t.height=t.width/(e||2);else{const d=fE(t,"height");d!==void 0&&(t.height=d)}return t}const iS=a9?{passive:!0}:!1;function dF(t,e,n){t.addEventListener(e,n,iS)}function hF(t,e,n){t.canvas.removeEventListener(e,n,iS)}function fF(t,e){const n=cF[t.type]||t.type,{x:i,y:l}=xd(t,e);return{type:n,chart:e,native:t,x:i!==void 0?i:null,y:l!==void 0?l:null}}function v_(t,e){for(const n of t)if(n===e||n.contains(e))return!0}function pF(t,e,n){const i=t.canvas,l=new MutationObserver(d=>{let f=!1;for(const o of d)f=f||v_(o.addedNodes,i),f=f&&!v_(o.removedNodes,i);f&&n()});return l.observe(document,{childList:!0,subtree:!0}),l}function mF(t,e,n){const i=t.canvas,l=new MutationObserver(d=>{let f=!1;for(const o of d)f=f||v_(o.removedNodes,i),f=f&&!v_(o.addedNodes,i);f&&n()});return l.observe(document,{childList:!0,subtree:!0}),l}const Em=new Map;let zE=0;function oS(){const t=window.devicePixelRatio;t!==zE&&(zE=t,Em.forEach((e,n)=>{n.currentDevicePixelRatio!==t&&e()}))}function gF(t,e){Em.size||window.addEventListener("resize",oS),Em.set(t,e)}function _F(t){Em.delete(t),Em.size||window.removeEventListener("resize",oS)}function yF(t,e,n){const i=t.canvas,l=i&&fx(i);if(!l)return;const d=SC((o,y)=>{const E=l.clientWidth;n(o,y),E<l.clientWidth&&n()},window),f=new ResizeObserver(o=>{const y=o[0],E=y.contentRect.width,C=y.contentRect.height;E===0&&C===0||d(E,C)});return f.observe(l),gF(t,d),f}function ob(t,e,n){n&&n.disconnect(),e==="resize"&&_F(t)}function bF(t,e,n){const i=t.canvas,l=SC(d=>{t.ctx!==null&&n(fF(d,t))},t,d=>{const f=d[0];return[f,f.offsetX,f.offsetY]});return dF(i,e,l),l}class vF extends rS{acquireContext(e,n){const i=e&&e.getContext&&e.getContext("2d");return i&&i.canvas===e?(uF(e,n),i):null}releaseContext(e){const n=e.canvas;if(!n[Z0])return!1;const i=n[Z0].initial;["height","width"].forEach(d=>{const f=i[d];Tr(f)?n.removeAttribute(d):n.setAttribute(d,f)});const l=i.style||{};return Object.keys(l).forEach(d=>{n.style[d]=l[d]}),n.width=n.width,delete n[Z0],!0}addEventListener(e,n,i){this.removeEventListener(e,n);const l=e.$proxies||(e.$proxies={}),f={attach:pF,detach:mF,resize:yF}[n]||bF;l[n]=f(e,n,i)}removeEventListener(e,n){const i=e.$proxies||(e.$proxies={}),l=i[n];if(!l)return;({attach:ob,detach:ob,resize:ob}[n]||hF)(e,n,l),i[n]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,n,i,l){return o9(e,n,i,l)}isAttached(e){const n=fx(e);return!!(n&&n.isConnected)}}function xF(t){return!HC()||typeof OffscreenCanvas!="undefined"&&t instanceof OffscreenCanvas?lF:vF}class js{constructor(){this.x=void 0,this.y=void 0,this.active=!1,this.options=void 0,this.$animations=void 0}tooltipPosition(e){const{x:n,y:i}=this.getProps(["x","y"],e);return{x:n,y:i}}hasValue(){return bm(this.x)&&bm(this.y)}getProps(e,n){const i=this.$animations;if(!n||!i)return this;const l={};return e.forEach(d=>{l[d]=i[d]&&i[d].active()?i[d]._to:this[d]}),l}}js.defaults={};js.defaultRoutes=void 0;const aS={values(t){return ti(t)?t:""+t},numeric(t,e,n){if(t===0)return"0";const i=this.chart.options.locale;let l,d=t;if(n.length>1){const E=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(E<1e-4||E>1e15)&&(l="scientific"),d=wF(t,n)}const f=is(Math.abs(d)),o=Math.max(Math.min(-1*Math.floor(f),20),0),y={notation:l,minimumFractionDigits:o,maximumFractionDigits:o};return Object.assign(y,this.options.ticks.format),Fm(t,i,y)},logarithmic(t,e,n){if(t===0)return"0";const i=t/Math.pow(10,Math.floor(is(t)));return i===1||i===2||i===5?aS.numeric.call(this,t,e,n):""}};function wF(t,e){let n=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(n)>=1&&t!==Math.floor(t)&&(n=t-Math.floor(t)),n}var ty={formatters:aS};cr.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",grace:0,grid:{display:!0,lineWidth:1,drawBorder:!0,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,e)=>e.lineWidth,tickColor:(t,e)=>e.color,offset:!1,borderDash:[],borderDashOffset:0,borderWidth:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:ty.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}});cr.route("scale.ticks","color","","color");cr.route("scale.grid","color","","borderColor");cr.route("scale.grid","borderColor","","borderColor");cr.route("scale.title","color","","color");cr.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&t!=="callback"&&t!=="parser",_indexable:t=>t!=="borderDash"&&t!=="tickBorderDash"});cr.describe("scales",{_fallback:"scale"});cr.describe("scale.ticks",{_scriptable:t=>t!=="backdropPadding"&&t!=="callback",_indexable:t=>t!=="backdropPadding"});function EF(t,e){const n=t.options.ticks,i=n.maxTicksLimit||TF(t),l=n.major.enabled?CF(e):[],d=l.length,f=l[0],o=l[d-1],y=[];if(d>i)return SF(e,y,l,d/i),y;const E=kF(l,e,i);if(d>0){let C,A;const P=d>1?Math.round((o-f)/(d-1)):null;for(A0(e,y,E,Tr(P)?0:f-P,f),C=0,A=d-1;C<A;C++)A0(e,y,E,l[C],l[C+1]);return A0(e,y,E,o,Tr(P)?e.length:o+P),y}return A0(e,y,E),y}function TF(t){const e=t.options.offset,n=t._tickSize(),i=t._length/n+(e?0:1),l=t._maxLength/n;return Math.floor(Math.min(i,l))}function kF(t,e,n){const i=MF(t),l=e.length/n;if(!i)return Math.max(l,1);const d=K7(i);for(let f=0,o=d.length-1;f<o;f++){const y=d[f];if(y>l)return y}return Math.max(l,1)}function CF(t){const e=[];let n,i;for(n=0,i=t.length;n<i;n++)t[n].major&&e.push(n);return e}function SF(t,e,n,i){let l=0,d=n[0],f;for(i=Math.ceil(i),f=0;f<t.length;f++)f===d&&(e.push(t[f]),l++,d=n[l*i])}function A0(t,e,n,i,l){const d=Kn(i,0),f=Math.min(Kn(l,t.length),t.length);let o=0,y,E,C;for(n=Math.ceil(n),l&&(y=l-i,n=y/Math.floor(y/n)),C=d;C<0;)o++,C=Math.round(d+o*n);for(E=Math.max(d,0);E<f;E++)E===C&&(e.push(t[E]),o++,C=Math.round(d+o*n))}function MF(t){const e=t.length;let n,i;if(e<2)return!1;for(i=t[0],n=1;n<e;++n)if(t[n]-t[n-1]!==i)return!1;return i}const AF=t=>t==="left"?"right":t==="right"?"left":t,OE=(t,e,n)=>e==="top"||e==="left"?t[e]+n:t[e]-n;function DE(t,e){const n=[],i=t.length/e,l=t.length;let d=0;for(;d<l;d+=i)n.push(t[Math.floor(d)]);return n}function IF(t,e,n){const i=t.ticks.length,l=Math.min(e,i-1),d=t._startPixel,f=t._endPixel,o=1e-6;let y=t.getPixelForTick(l),E;if(!(n&&(i===1?E=Math.max(y-d,f-y):e===0?E=(t.getPixelForTick(1)-y)/2:E=(y-t.getPixelForTick(l-1))/2,y+=l<e?E:-E,y<d-o||y>f+o)))return y}function PF(t,e){Ur(t,n=>{const i=n.gc,l=i.length/2;let d;if(l>e){for(d=0;d<l;++d)delete n.data[i[d]];i.splice(0,l)}})}function Mp(t){return t.drawTicks?t.tickLength:0}function RE(t,e){if(!t.display)return 0;const n=ao(t.font,e),i=Go(t.padding);return(ti(t.text)?t.text.length:1)*n.lineHeight+i.height}function LF(t,e){return Mu(t,{scale:e,type:"scale"})}function zF(t,e,n){return Mu(t,{tick:n,index:e,type:"tick"})}function OF(t,e,n){let i=nx(t);return(n&&e!=="right"||!n&&e==="right")&&(i=AF(i)),i}function DF(t,e,n,i){const{top:l,left:d,bottom:f,right:o,chart:y}=t,{chartArea:E,scales:C}=y;let A=0,P,B,j;const Z=f-l,W=o-d;if(t.isHorizontal()){if(B=Fo(i,d,o),lr(n)){const H=Object.keys(n)[0],V=n[H];j=C[H].getPixelForValue(V)+Z-e}else n==="center"?j=(E.bottom+E.top)/2+Z-e:j=OE(t,n,e);P=o-d}else{if(lr(n)){const H=Object.keys(n)[0],V=n[H];B=C[H].getPixelForValue(V)-W+e}else n==="center"?B=(E.left+E.right)/2-W+e:B=OE(t,n,e);j=Fo(i,f,l),A=n==="left"?-Ii:Ii}return{titleX:B,titleY:j,maxWidth:P,rotation:A}}class Vd extends js{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,n){return e}getUserBounds(){let{_userMin:e,_userMax:n,_suggestedMin:i,_suggestedMax:l}=this;return e=Qa(e,Number.POSITIVE_INFINITY),n=Qa(n,Number.NEGATIVE_INFINITY),i=Qa(i,Number.POSITIVE_INFINITY),l=Qa(l,Number.NEGATIVE_INFINITY),{min:Qa(e,i),max:Qa(n,l),minDefined:Bi(e),maxDefined:Bi(n)}}getMinMax(e){let{min:n,max:i,minDefined:l,maxDefined:d}=this.getUserBounds(),f;if(l&&d)return{min:n,max:i};const o=this.getMatchingVisibleMetas();for(let y=0,E=o.length;y<E;++y)f=o[y].controller.getMinMax(this,e),l||(n=Math.min(n,f.min)),d||(i=Math.max(i,f.max));return n=d&&n>i?i:n,i=l&&n>i?n:i,{min:Qa(n,Qa(i,n)),max:Qa(i,Qa(n,i))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Qr(this.options.beforeUpdate,[this])}update(e,n,i){const{beginAtZero:l,grace:d,ticks:f}=this.options,o=f.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=n,this._margins=i=Object.assign({left:0,right:0,top:0,bottom:0},i),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+i.left+i.right:this.height+i.top+i.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=OB(this,d,l),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const y=o<this.ticks.length;this._convertTicksToLabels(y?DE(this.ticks,o):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),f.display&&(f.autoSkip||f.source==="auto")&&(this.ticks=EF(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),y&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,n,i;this.isHorizontal()?(n=this.left,i=this.right):(n=this.top,i=this.bottom,e=!e),this._startPixel=n,this._endPixel=i,this._reversePixels=e,this._length=i-n,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Qr(this.options.afterUpdate,[this])}beforeSetDimensions(){Qr(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Qr(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),Qr(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Qr(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const n=this.options.ticks;let i,l,d;for(i=0,l=e.length;i<l;i++)d=e[i],d.label=Qr(n.callback,[d.value,i,e],this)}afterTickToLabelConversion(){Qr(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Qr(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,n=e.ticks,i=this.ticks.length,l=n.minRotation||0,d=n.maxRotation;let f=l,o,y,E;if(!this._isVisible()||!n.display||l>=d||i<=1||!this.isHorizontal()){this.labelRotation=l;return}const C=this._getLabelSizes(),A=C.widest.width,P=C.highest.height,B=vo(this.chart.width-A,0,this.maxWidth);o=e.offset?this.maxWidth/i:B/(i-1),A+6>o&&(o=B/(i-(e.offset?.5:1)),y=this.maxHeight-Mp(e.grid)-n.padding-RE(e.title,this.chart.options.font),E=Math.sqrt(A*A+P*P),f=ix(Math.min(Math.asin(vo((C.highest.height+6)/o,-1,1)),Math.asin(vo(y/E,-1,1))-Math.asin(vo(P/E,-1,1)))),f=Math.max(l,Math.min(d,f))),this.labelRotation=f}afterCalculateLabelRotation(){Qr(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Qr(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:n,options:{ticks:i,title:l,grid:d}}=this,f=this._isVisible(),o=this.isHorizontal();if(f){const y=RE(l,n.options.font);if(o?(e.width=this.maxWidth,e.height=Mp(d)+y):(e.height=this.maxHeight,e.width=Mp(d)+y),i.display&&this.ticks.length){const{first:E,last:C,widest:A,highest:P}=this._getLabelSizes(),B=i.padding*2,j=Bs(this.labelRotation),Z=Math.cos(j),W=Math.sin(j);if(o){const H=i.mirror?0:W*A.width+Z*P.height;e.height=Math.min(this.maxHeight,e.height+H+B)}else{const H=i.mirror?0:Z*A.width+W*P.height;e.width=Math.min(this.maxWidth,e.width+H+B)}this._calculatePadding(E,C,W,Z)}}this._handleMargins(),o?(this.width=this._length=n.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=n.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,n,i,l){const{ticks:{align:d,padding:f},position:o}=this.options,y=this.labelRotation!==0,E=o!=="top"&&this.axis==="x";if(this.isHorizontal()){const C=this.getPixelForTick(0)-this.left,A=this.right-this.getPixelForTick(this.ticks.length-1);let P=0,B=0;y?E?(P=l*e.width,B=i*n.height):(P=i*e.height,B=l*n.width):d==="start"?B=n.width:d==="end"?P=e.width:d!=="inner"&&(P=e.width/2,B=n.width/2),this.paddingLeft=Math.max((P-C+f)*this.width/(this.width-C),0),this.paddingRight=Math.max((B-A+f)*this.width/(this.width-A),0)}else{let C=n.height/2,A=e.height/2;d==="start"?(C=0,A=e.height):d==="end"&&(C=n.height,A=0),this.paddingTop=C+f,this.paddingBottom=A+f}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Qr(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:n}=this.options;return n==="top"||n==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let n,i;for(n=0,i=e.length;n<i;n++)Tr(e[n].label)&&(e.splice(n,1),i--,n--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const n=this.options.ticks.sampleSize;let i=this.ticks;n<i.length&&(i=DE(i,n)),this._labelSizes=e=this._computeLabelSizes(i,i.length)}return e}_computeLabelSizes(e,n){const{ctx:i,_longestTextCache:l}=this,d=[],f=[];let o=0,y=0,E,C,A,P,B,j,Z,W,H,V,tt;for(E=0;E<n;++E){if(P=e[E].label,B=this._resolveTickFontOptions(E),i.font=j=B.string,Z=l[j]=l[j]||{data:{},gc:[]},W=B.lineHeight,H=V=0,!Tr(P)&&!ti(P))H=__(i,Z.data,Z.gc,H,P),V=W;else if(ti(P))for(C=0,A=P.length;C<A;++C)tt=P[C],!Tr(tt)&&!ti(tt)&&(H=__(i,Z.data,Z.gc,H,tt),V+=W);d.push(H),f.push(V),o=Math.max(H,o),y=Math.max(V,y)}PF(l,n);const ft=d.indexOf(o),et=f.indexOf(y),Pt=Rt=>({width:d[Rt]||0,height:f[Rt]||0});return{first:Pt(0),last:Pt(n-1),widest:Pt(ft),highest:Pt(et),widths:d,heights:f}}getLabelForValue(e){return e}getPixelForValue(e,n){return NaN}getValueForPixel(e){}getPixelForTick(e){const n=this.ticks;return e<0||e>n.length-1?null:this.getPixelForValue(n[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const n=this._startPixel+e*this._length;return tB(this._alignToPixels?gd(this.chart,n,0):n)}getDecimalForPixel(e){const n=(e-this._startPixel)/this._length;return this._reversePixels?1-n:n}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:n}=this;return e<0&&n<0?n:e>0&&n>0?e:0}getContext(e){const n=this.ticks||[];if(e>=0&&e<n.length){const i=n[e];return i.$context||(i.$context=zF(this.getContext(),e,i))}return this.$context||(this.$context=LF(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,n=Bs(this.labelRotation),i=Math.abs(Math.cos(n)),l=Math.abs(Math.sin(n)),d=this._getLabelSizes(),f=e.autoSkipPadding||0,o=d?d.widest.width+f:0,y=d?d.highest.height+f:0;return this.isHorizontal()?y*i>o*l?o/i:y/l:y*l<o*i?y/i:o/l}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const n=this.axis,i=this.chart,l=this.options,{grid:d,position:f}=l,o=d.offset,y=this.isHorizontal(),C=this.ticks.length+(o?1:0),A=Mp(d),P=[],B=d.setContext(this.getContext()),j=B.drawBorder?B.borderWidth:0,Z=j/2,W=function(se){return gd(i,se,j)};let H,V,tt,ft,et,Pt,Rt,zt,jt,oe,ge,ce;if(f==="top")H=W(this.bottom),Pt=this.bottom-A,zt=H-Z,oe=W(e.top)+Z,ce=e.bottom;else if(f==="bottom")H=W(this.top),oe=e.top,ce=W(e.bottom)-Z,Pt=H+Z,zt=this.top+A;else if(f==="left")H=W(this.right),et=this.right-A,Rt=H-Z,jt=W(e.left)+Z,ge=e.right;else if(f==="right")H=W(this.left),jt=e.left,ge=W(e.right)-Z,et=H+Z,Rt=this.left+A;else if(n==="x"){if(f==="center")H=W((e.top+e.bottom)/2+.5);else if(lr(f)){const se=Object.keys(f)[0],Ze=f[se];H=W(this.chart.scales[se].getPixelForValue(Ze))}oe=e.top,ce=e.bottom,Pt=H+Z,zt=Pt+A}else if(n==="y"){if(f==="center")H=W((e.left+e.right)/2);else if(lr(f)){const se=Object.keys(f)[0],Ze=f[se];H=W(this.chart.scales[se].getPixelForValue(Ze))}et=H-Z,Rt=et-A,jt=e.left,ge=e.right}const Ue=Kn(l.ticks.maxTicksLimit,C),Ae=Math.max(1,Math.ceil(C/Ue));for(V=0;V<C;V+=Ae){const se=d.setContext(this.getContext(V)),Ze=se.lineWidth,gn=se.color,_n=d.borderDash||[],Gn=se.borderDashOffset,Jn=se.tickWidth,Wn=se.tickColor,ur=se.tickBorderDash||[],Zn=se.tickBorderDashOffset;tt=IF(this,V,o),tt!==void 0&&(ft=gd(i,tt,Ze),y?et=Rt=jt=ge=ft:Pt=zt=oe=ce=ft,P.push({tx1:et,ty1:Pt,tx2:Rt,ty2:zt,x1:jt,y1:oe,x2:ge,y2:ce,width:Ze,color:gn,borderDash:_n,borderDashOffset:Gn,tickWidth:Jn,tickColor:Wn,tickBorderDash:ur,tickBorderDashOffset:Zn}))}return this._ticksLength=C,this._borderValue=H,P}_computeLabelItems(e){const n=this.axis,i=this.options,{position:l,ticks:d}=i,f=this.isHorizontal(),o=this.ticks,{align:y,crossAlign:E,padding:C,mirror:A}=d,P=Mp(i.grid),B=P+C,j=A?-C:B,Z=-Bs(this.labelRotation),W=[];let H,V,tt,ft,et,Pt,Rt,zt,jt,oe,ge,ce,Ue="middle";if(l==="top")Pt=this.bottom-j,Rt=this._getXAxisLabelAlignment();else if(l==="bottom")Pt=this.top+j,Rt=this._getXAxisLabelAlignment();else if(l==="left"){const se=this._getYAxisLabelAlignment(P);Rt=se.textAlign,et=se.x}else if(l==="right"){const se=this._getYAxisLabelAlignment(P);Rt=se.textAlign,et=se.x}else if(n==="x"){if(l==="center")Pt=(e.top+e.bottom)/2+B;else if(lr(l)){const se=Object.keys(l)[0],Ze=l[se];Pt=this.chart.scales[se].getPixelForValue(Ze)+B}Rt=this._getXAxisLabelAlignment()}else if(n==="y"){if(l==="center")et=(e.left+e.right)/2-B;else if(lr(l)){const se=Object.keys(l)[0],Ze=l[se];et=this.chart.scales[se].getPixelForValue(Ze)}Rt=this._getYAxisLabelAlignment(P).textAlign}n==="y"&&(y==="start"?Ue="top":y==="end"&&(Ue="bottom"));const Ae=this._getLabelSizes();for(H=0,V=o.length;H<V;++H){tt=o[H],ft=tt.label;const se=d.setContext(this.getContext(H));zt=this.getPixelForTick(H)+d.labelOffset,jt=this._resolveTickFontOptions(H),oe=jt.lineHeight,ge=ti(ft)?ft.length:1;const Ze=ge/2,gn=se.color,_n=se.textStrokeColor,Gn=se.textStrokeWidth;let Jn=Rt;f?(et=zt,Rt==="inner"&&(H===V-1?Jn=this.options.reverse?"left":"right":H===0?Jn=this.options.reverse?"right":"left":Jn="center"),l==="top"?E==="near"||Z!==0?ce=-ge*oe+oe/2:E==="center"?ce=-Ae.highest.height/2-Ze*oe+oe:ce=-Ae.highest.height+oe/2:E==="near"||Z!==0?ce=oe/2:E==="center"?ce=Ae.highest.height/2-Ze*oe:ce=Ae.highest.height-ge*oe,A&&(ce*=-1)):(Pt=zt,ce=(1-ge)*oe/2);let Wn;if(se.showLabelBackdrop){const ur=Go(se.backdropPadding),Zn=Ae.heights[H],_r=Ae.widths[H];let he=Pt+ce-ur.top,He=et-ur.left;switch(Ue){case"middle":he-=Zn/2;break;case"bottom":he-=Zn;break}switch(Rt){case"center":He-=_r/2;break;case"right":He-=_r;break}Wn={left:He,top:he,width:_r+ur.width,height:Zn+ur.height,color:se.backdropColor}}W.push({rotation:Z,label:ft,font:jt,color:gn,strokeColor:_n,strokeWidth:Gn,textOffset:ce,textAlign:Jn,textBaseline:Ue,translation:[et,Pt],backdrop:Wn})}return W}_getXAxisLabelAlignment(){const{position:e,ticks:n}=this.options;if(-Bs(this.labelRotation))return e==="top"?"left":"right";let l="center";return n.align==="start"?l="left":n.align==="end"?l="right":n.align==="inner"&&(l="inner"),l}_getYAxisLabelAlignment(e){const{position:n,ticks:{crossAlign:i,mirror:l,padding:d}}=this.options,f=this._getLabelSizes(),o=e+d,y=f.widest.width;let E,C;return n==="left"?l?(C=this.right+d,i==="near"?E="left":i==="center"?(E="center",C+=y/2):(E="right",C+=y)):(C=this.right-o,i==="near"?E="right":i==="center"?(E="center",C-=y/2):(E="left",C=this.left)):n==="right"?l?(C=this.left+d,i==="near"?E="right":i==="center"?(E="center",C-=y/2):(E="left",C-=y)):(C=this.left+o,i==="near"?E="left":i==="center"?(E="center",C+=y/2):(E="right",C=this.right)):E="right",{textAlign:E,x:C}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,n=this.options.position;if(n==="left"||n==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(n==="top"||n==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:n},left:i,top:l,width:d,height:f}=this;n&&(e.save(),e.fillStyle=n,e.fillRect(i,l,d,f),e.restore())}getLineWidthForValue(e){const n=this.options.grid;if(!this._isVisible()||!n.display)return 0;const l=this.ticks.findIndex(d=>d.value===e);return l>=0?n.setContext(this.getContext(l)).lineWidth:0}drawGrid(e){const n=this.options.grid,i=this.ctx,l=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let d,f;const o=(y,E,C)=>{!C.width||!C.color||(i.save(),i.lineWidth=C.width,i.strokeStyle=C.color,i.setLineDash(C.borderDash||[]),i.lineDashOffset=C.borderDashOffset,i.beginPath(),i.moveTo(y.x,y.y),i.lineTo(E.x,E.y),i.stroke(),i.restore())};if(n.display)for(d=0,f=l.length;d<f;++d){const y=l[d];n.drawOnChartArea&&o({x:y.x1,y:y.y1},{x:y.x2,y:y.y2},y),n.drawTicks&&o({x:y.tx1,y:y.ty1},{x:y.tx2,y:y.ty2},{color:y.tickColor,width:y.tickWidth,borderDash:y.tickBorderDash,borderDashOffset:y.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:n,options:{grid:i}}=this,l=i.setContext(this.getContext()),d=i.drawBorder?l.borderWidth:0;if(!d)return;const f=i.setContext(this.getContext(0)).lineWidth,o=this._borderValue;let y,E,C,A;this.isHorizontal()?(y=gd(e,this.left,d)-d/2,E=gd(e,this.right,f)+f/2,C=A=o):(C=gd(e,this.top,d)-d/2,A=gd(e,this.bottom,f)+f/2,y=E=o),n.save(),n.lineWidth=l.borderWidth,n.strokeStyle=l.borderColor,n.beginPath(),n.moveTo(y,C),n.lineTo(E,A),n.stroke(),n.restore()}drawLabels(e){if(!this.options.ticks.display)return;const i=this.ctx,l=this._computeLabelArea();l&&H_(i,l);const d=this._labelItems||(this._labelItems=this._computeLabelItems(e));let f,o;for(f=0,o=d.length;f<o;++f){const y=d[f],E=y.font,C=y.label;y.backdrop&&(i.fillStyle=y.backdrop.color,i.fillRect(y.backdrop.left,y.backdrop.top,y.backdrop.width,y.backdrop.height));let A=y.textOffset;Rd(i,C,0,A,E,y)}l&&W_(i)}drawTitle(){const{ctx:e,options:{position:n,title:i,reverse:l}}=this;if(!i.display)return;const d=ao(i.font),f=Go(i.padding),o=i.align;let y=d.lineHeight/2;n==="bottom"||n==="center"||lr(n)?(y+=f.bottom,ti(i.text)&&(y+=d.lineHeight*(i.text.length-1))):y+=f.top;const{titleX:E,titleY:C,maxWidth:A,rotation:P}=DF(this,y,n,o);Rd(e,i.text,0,0,d,{color:i.color,maxWidth:A,rotation:P,textAlign:OF(o,n,l),textBaseline:"middle",translation:[E,C]})}draw(e){!this._isVisible()||(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,n=e.ticks&&e.ticks.z||0,i=Kn(e.grid&&e.grid.z,-1);return!this._isVisible()||this.draw!==Vd.prototype.draw?[{z:n,draw:l=>{this.draw(l)}}]:[{z:i,draw:l=>{this.drawBackground(),this.drawGrid(l),this.drawTitle()}},{z:i+1,draw:()=>{this.drawBorder()}},{z:n,draw:l=>{this.drawLabels(l)}}]}getMatchingVisibleMetas(e){const n=this.chart.getSortedVisibleDatasetMetas(),i=this.axis+"AxisID",l=[];let d,f;for(d=0,f=n.length;d<f;++d){const o=n[d];o[i]===this.id&&(!e||o.type===e)&&l.push(o)}return l}_resolveTickFontOptions(e){const n=this.options.ticks.setContext(this.getContext(e));return ao(n.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class I0{constructor(e,n,i){this.type=e,this.scope=n,this.override=i,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const n=Object.getPrototypeOf(e);let i;FF(n)&&(i=this.register(n));const l=this.items,d=e.id,f=this.scope+"."+d;if(!d)throw new Error("class does not have id: "+e);return d in l||(l[d]=e,RF(e,f,i),this.override&&cr.override(e.id,e.overrides)),f}get(e){return this.items[e]}unregister(e){const n=this.items,i=e.id,l=this.scope;i in n&&delete n[i],l&&i in cr[l]&&(delete cr[l][i],this.override&&delete Dd[i])}}function RF(t,e,n){const i=ym(Object.create(null),[n?cr.get(n):{},cr.get(e),t.defaults]);cr.set(e,i),t.defaultRoutes&&BF(e,t.defaultRoutes),t.descriptors&&cr.describe(e,t.descriptors)}function BF(t,e){Object.keys(e).forEach(n=>{const i=n.split("."),l=i.pop(),d=[t].concat(i).join("."),f=e[n].split("."),o=f.pop(),y=f.join(".");cr.route(d,l,y,o)})}function FF(t){return"id"in t&&"defaults"in t}class NF{constructor(){this.controllers=new I0(wl,"datasets",!0),this.elements=new I0(js,"elements"),this.plugins=new I0(Object,"plugins"),this.scales=new I0(Vd,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,n,i){[...n].forEach(l=>{const d=i||this._getRegistryForType(l);i||d.isForType(l)||d===this.plugins&&l.id?this._exec(e,d,l):Ur(l,f=>{const o=i||this._getRegistryForType(f);this._exec(e,o,f)})})}_exec(e,n,i){const l=rx(e);Qr(i["before"+l],[],i),n[e](i),Qr(i["after"+l],[],i)}_getRegistryForType(e){for(let n=0;n<this._typedRegistries.length;n++){const i=this._typedRegistries[n];if(i.isForType(e))return i}return this.plugins}_get(e,n,i){const l=n.get(e);if(l===void 0)throw new Error('"'+e+'" is not a registered '+i+".");return l}}var oc=new NF;class jF{constructor(){this._init=[]}notify(e,n,i,l){n==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));const d=l?this._descriptors(e).filter(l):this._descriptors(e),f=this._notify(d,e,n,i);return n==="afterDestroy"&&(this._notify(d,e,"stop"),this._notify(this._init,e,"uninstall")),f}_notify(e,n,i,l){l=l||{};for(const d of e){const f=d.plugin,o=f[i],y=[n,l,d.options];if(Qr(o,y,f)===!1&&l.cancelable)return!1}return!0}invalidate(){Tr(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const n=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),n}_createDescriptors(e,n){const i=e&&e.config,l=Kn(i.options&&i.options.plugins,{}),d=UF(i);return l===!1&&!n?[]:VF(e,d,l,n)}_notifyStateChanges(e){const n=this._oldCache||[],i=this._cache,l=(d,f)=>d.filter(o=>!f.some(y=>o.plugin.id===y.plugin.id));this._notify(l(n,i),e,"stop"),this._notify(l(i,n),e,"start")}}function UF(t){const e=[],n=Object.keys(oc.plugins.items);for(let l=0;l<n.length;l++)e.push(oc.getPlugin(n[l]));const i=t.plugins||[];for(let l=0;l<i.length;l++){const d=i[l];e.indexOf(d)===-1&&e.push(d)}return e}function $F(t,e){return!e&&t===!1?null:t===!0?{}:t}function VF(t,e,n,i){const l=[],d=t.getContext();for(let f=0;f<e.length;f++){const o=e[f],y=o.id,E=$F(n[y],i);E!==null&&l.push({plugin:o,options:GF(t.config,o,E,d)})}return l}function GF(t,e,n,i){const l=t.pluginScopeKeys(e),d=t.getOptionScopes(n,l);return t.createResolver(d,i,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function tv(t,e){const n=cr.datasets[t]||{};return((e.datasets||{})[t]||{}).indexAxis||e.indexAxis||n.indexAxis||"x"}function qF(t,e){let n=t;return t==="_index_"?n=e:t==="_value_"&&(n=e==="x"?"y":"x"),n}function HF(t,e){return t===e?"_index_":"_value_"}function WF(t){if(t==="top"||t==="bottom")return"x";if(t==="left"||t==="right")return"y"}function ev(t,e){return t==="x"||t==="y"?t:e.axis||WF(e.position)||t.charAt(0).toLowerCase()}function ZF(t,e){const n=Dd[t.type]||{scales:{}},i=e.scales||{},l=tv(t.type,e),d=Object.create(null),f=Object.create(null);return Object.keys(i).forEach(o=>{const y=i[o];if(!lr(y))return console.error(`Invalid scale configuration for scale: ${o}`);if(y._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const E=ev(o,y),C=HF(E,l),A=n.scales||{};d[E]=d[E]||o,f[o]=Jp(Object.create(null),[{axis:E},y,A[E],A[C]])}),t.data.datasets.forEach(o=>{const y=o.type||t.type,E=o.indexAxis||tv(y,e),A=(Dd[y]||{}).scales||{};Object.keys(A).forEach(P=>{const B=qF(P,E),j=o[B+"AxisID"]||d[B]||B;f[j]=f[j]||Object.create(null),Jp(f[j],[{axis:B},i[j],A[P]])})}),Object.keys(f).forEach(o=>{const y=f[o];Jp(y,[cr.scales[y.type],cr.scale])}),f}function sS(t){const e=t.options||(t.options={});e.plugins=Kn(e.plugins,{}),e.scales=ZF(t,e)}function lS(t){return t=t||{},t.datasets=t.datasets||[],t.labels=t.labels||[],t}function XF(t){return t=t||{},t.data=lS(t.data),sS(t),t}const BE=new Map,cS=new Set;function P0(t,e){let n=BE.get(t);return n||(n=e(),BE.set(t,n),cS.add(n)),n}const Ap=(t,e,n)=>{const i=vu(e,n);i!==void 0&&t.add(i)};class YF{constructor(e){this._config=XF(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=lS(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),sS(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return P0(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,n){return P0(`${e}.transition.${n}`,()=>[[`datasets.${e}.transitions.${n}`,`transitions.${n}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,n){return P0(`${e}-${n}`,()=>[[`datasets.${e}.elements.${n}`,`datasets.${e}`,`elements.${n}`,""]])}pluginScopeKeys(e){const n=e.id,i=this.type;return P0(`${i}-plugin-${n}`,()=>[[`plugins.${n}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,n){const i=this._scopeCache;let l=i.get(e);return(!l||n)&&(l=new Map,i.set(e,l)),l}getOptionScopes(e,n,i){const{options:l,type:d}=this,f=this._cachedScopes(e,i),o=f.get(n);if(o)return o;const y=new Set;n.forEach(C=>{e&&(y.add(e),C.forEach(A=>Ap(y,e,A))),C.forEach(A=>Ap(y,l,A)),C.forEach(A=>Ap(y,Dd[d]||{},A)),C.forEach(A=>Ap(y,cr,A)),C.forEach(A=>Ap(y,Jb,A))});const E=Array.from(y);return E.length===0&&E.push(Object.create(null)),cS.has(n)&&f.set(n,E),E}chartOptionScopes(){const{options:e,type:n}=this;return[e,Dd[n]||{},cr.datasets[n]||{},{type:n},cr,Jb]}resolveNamedOptions(e,n,i,l=[""]){const d={$shared:!0},{resolver:f,subPrefixes:o}=FE(this._resolverCache,e,l);let y=f;if(JF(f,n)){d.$shared=!1,i=xu(i)?i():i;const E=this.createResolver(e,i,o);y=lf(f,i,E)}for(const E of n)d[E]=y[E];return d}createResolver(e,n,i=[""],l){const{resolver:d}=FE(this._resolverCache,e,i);return lr(n)?lf(d,n,void 0,l):d}}function FE(t,e,n){let i=t.get(e);i||(i=new Map,t.set(e,i));const l=n.join();let d=i.get(l);return d||(d={resolver:ux(e,n),subPrefixes:n.filter(o=>!o.toLowerCase().includes("hover"))},i.set(l,d)),d}const KF=t=>lr(t)&&Object.getOwnPropertyNames(t).reduce((e,n)=>e||xu(t[n]),!1);function JF(t,e){const{isScriptable:n,isIndexable:i}=jC(t);for(const l of e){const d=n(l),f=i(l),o=(f||d)&&t[l];if(d&&(xu(o)||KF(o))||f&&ti(o))return!0}return!1}var QF="3.8.0";const tN=["top","bottom","left","right","chartArea"];function NE(t,e){return t==="top"||t==="bottom"||tN.indexOf(t)===-1&&e==="x"}function jE(t,e){return function(n,i){return n[t]===i[t]?n[e]-i[e]:n[t]-i[t]}}function UE(t){const e=t.chart,n=e.options.animation;e.notifyPlugins("afterRender"),Qr(n&&n.onComplete,[t],e)}function eN(t){const e=t.chart,n=e.options.animation;Qr(n&&n.onProgress,[t],e)}function uS(t){return HC()&&typeof t=="string"?t=document.getElementById(t):t&&t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas),t}const x_={},dS=t=>{const e=uS(t);return Object.values(x_).filter(n=>n.canvas===e).pop()};function nN(t,e,n){const i=Object.keys(t);for(const l of i){const d=+l;if(d>=e){const f=t[l];delete t[l],(n>0||d>e)&&(t[d+n]=f)}}}function rN(t,e,n,i){return!n||t.type==="mouseout"?null:i?e:t}class ey{constructor(e,n){const i=this.config=new YF(n),l=uS(e),d=dS(l);if(d)throw new Error("Canvas is already in use. Chart with ID '"+d.id+"' must be destroyed before the canvas can be reused.");const f=i.createResolver(i.chartOptionScopes(),this.getContext());this.platform=new(i.platform||xF(l)),this.platform.updateConfig(i);const o=this.platform.acquireContext(l,f.aspectRatio),y=o&&o.canvas,E=y&&y.height,C=y&&y.width;if(this.id=$7(),this.ctx=o,this.canvas=y,this.width=C,this.height=E,this._options=f,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new jF,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=j7(A=>this.update(A),f.resizeDelay||0),this._dataChanges=[],x_[this.id]=this,!o||!y){console.error("Failed to create chart: can't acquire context from the given item");return}Jl.listen(this,"complete",UE),Jl.listen(this,"progress",eN),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:n},width:i,height:l,_aspectRatio:d}=this;return Tr(e)?n&&d?d:l?i/l:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():hE(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return lE(this.canvas,this.ctx),this}stop(){return Jl.stop(this),this}resize(e,n){Jl.running(this)?this._resizeBeforeDraw={width:e,height:n}:this._resize(e,n)}_resize(e,n){const i=this.options,l=this.canvas,d=i.maintainAspectRatio&&this.aspectRatio,f=this.platform.getMaximumSize(l,e,n,d),o=i.devicePixelRatio||this.platform.getDevicePixelRatio(),y=this.width?"resize":"attach";this.width=f.width,this.height=f.height,this._aspectRatio=this.aspectRatio,hE(this,o,!0)&&(this.notifyPlugins("resize",{size:f}),Qr(i.onResize,[this,f],this),this.attached&&this._doResize(y)&&this.render())}ensureScalesHaveIDs(){const n=this.options.scales||{};Ur(n,(i,l)=>{i.id=l})}buildOrUpdateScales(){const e=this.options,n=e.scales,i=this.scales,l=Object.keys(i).reduce((f,o)=>(f[o]=!1,f),{});let d=[];n&&(d=d.concat(Object.keys(n).map(f=>{const o=n[f],y=ev(f,o),E=y==="r",C=y==="x";return{options:o,dposition:E?"chartArea":C?"bottom":"left",dtype:E?"radialLinear":C?"category":"linear"}}))),Ur(d,f=>{const o=f.options,y=o.id,E=ev(y,o),C=Kn(o.type,f.dtype);(o.position===void 0||NE(o.position,E)!==NE(f.dposition))&&(o.position=f.dposition),l[y]=!0;let A=null;if(y in i&&i[y].type===C)A=i[y];else{const P=oc.getScale(C);A=new P({id:y,type:C,ctx:this.ctx,chart:this}),i[A.id]=A}A.init(o,e)}),Ur(l,(f,o)=>{f||delete i[o]}),Ur(i,f=>{$o.configure(this,f,f.options),$o.addBox(this,f)})}_updateMetasets(){const e=this._metasets,n=this.data.datasets.length,i=e.length;if(e.sort((l,d)=>l.index-d.index),i>n){for(let l=n;l<i;++l)this._destroyDatasetMeta(l);e.splice(n,i-n)}this._sortedMetasets=e.slice(0).sort(jE("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:n}}=this;e.length>n.length&&delete this._stacks,e.forEach((i,l)=>{n.filter(d=>d===i._dataset).length===0&&this._destroyDatasetMeta(l)})}buildOrUpdateControllers(){const e=[],n=this.data.datasets;let i,l;for(this._removeUnreferencedMetasets(),i=0,l=n.length;i<l;i++){const d=n[i];let f=this.getDatasetMeta(i);const o=d.type||this.config.type;if(f.type&&f.type!==o&&(this._destroyDatasetMeta(i),f=this.getDatasetMeta(i)),f.type=o,f.indexAxis=d.indexAxis||tv(o,this.options),f.order=d.order||0,f.index=i,f.label=""+d.label,f.visible=this.isDatasetVisible(i),f.controller)f.controller.updateIndex(i),f.controller.linkScales();else{const y=oc.getController(o),{datasetElementType:E,dataElementType:C}=cr.datasets[o];Object.assign(y.prototype,{dataElementType:oc.getElement(C),datasetElementType:E&&oc.getElement(E)}),f.controller=new y(this,i),e.push(f.controller)}}return this._updateMetasets(),e}_resetElements(){Ur(this.data.datasets,(e,n)=>{this.getDatasetMeta(n).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const n=this.config;n.update();const i=this._options=n.createResolver(n.chartOptionScopes(),this.getContext()),l=this._animationsDisabled=!i.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const d=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let f=0;for(let E=0,C=this.data.datasets.length;E<C;E++){const{controller:A}=this.getDatasetMeta(E),P=!l&&d.indexOf(A)===-1;A.buildOrUpdateElements(P),f=Math.max(+A.getMaxOverflow(),f)}f=this._minPadding=i.layout.autoPadding?f:0,this._updateLayout(f),l||Ur(d,E=>{E.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(jE("z","_idx"));const{_active:o,_lastEvent:y}=this;y?this._eventHandler(y,!0):o.length&&this._updateHoverStyles(o,o,!0),this.render()}_updateScales(){Ur(this.scales,e=>{$o.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,n=new Set(Object.keys(this._listeners)),i=new Set(e.events);(!K5(n,i)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,n=this._getUniformDataChanges()||[];for(const{method:i,start:l,count:d}of n){const f=i==="_removeElements"?-d:d;nN(e,l,f)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const n=this.data.datasets.length,i=d=>new Set(e.filter(f=>f[0]===d).map((f,o)=>o+","+f.splice(1).join(","))),l=i(0);for(let d=1;d<n;d++)if(!K5(l,i(d)))return;return Array.from(l).map(d=>d.split(",")).map(d=>({method:d[1],start:+d[2],count:+d[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;$o.update(this,this.width,this.height,e);const n=this.chartArea,i=n.width<=0||n.height<=0;this._layers=[],Ur(this.boxes,l=>{i&&l.position==="chartArea"||(l.configure&&l.configure(),this._layers.push(...l._layers()))},this),this._layers.forEach((l,d)=>{l._idx=d}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let n=0,i=this.data.datasets.length;n<i;++n)this.getDatasetMeta(n).controller.configure();for(let n=0,i=this.data.datasets.length;n<i;++n)this._updateDataset(n,xu(e)?e({datasetIndex:n}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,n){const i=this.getDatasetMeta(e),l={meta:i,index:e,mode:n,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",l)!==!1&&(i.controller._update(n),l.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",l))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(Jl.has(this)?this.attached&&!Jl.running(this)&&Jl.start(this):(this.draw(),UE({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:i,height:l}=this._resizeBeforeDraw;this._resize(i,l),this._resizeBeforeDraw=null}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const n=this._layers;for(e=0;e<n.length&&n[e].z<=0;++e)n[e].draw(this.chartArea);for(this._drawDatasets();e<n.length;++e)n[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const n=this._sortedMetasets,i=[];let l,d;for(l=0,d=n.length;l<d;++l){const f=n[l];(!e||f.visible)&&i.push(f)}return i}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let n=e.length-1;n>=0;--n)this._drawDataset(e[n]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const n=this.ctx,i=e._clip,l=!i.disabled,d=this.chartArea,f={meta:e,index:e.index,cancelable:!0};this.notifyPlugins("beforeDatasetDraw",f)!==!1&&(l&&H_(n,{left:i.left===!1?0:d.left-i.left,right:i.right===!1?this.width:d.right+i.right,top:i.top===!1?0:d.top-i.top,bottom:i.bottom===!1?this.height:d.bottom+i.bottom}),e.controller.draw(),l&&W_(n),f.cancelable=!1,this.notifyPlugins("afterDatasetDraw",f))}isPointInArea(e){return xm(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,n,i,l){const d=tF.modes[n];return typeof d=="function"?d(this,e,i,l):[]}getDatasetMeta(e){const n=this.data.datasets[e],i=this._metasets;let l=i.filter(d=>d&&d._dataset===n).pop();return l||(l={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:n&&n.order||0,index:e,_dataset:n,_parsed:[],_sorted:!1},i.push(l)),l}getContext(){return this.$context||(this.$context=Mu(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const n=this.data.datasets[e];if(!n)return!1;const i=this.getDatasetMeta(e);return typeof i.hidden=="boolean"?!i.hidden:!n.hidden}setDatasetVisibility(e,n){const i=this.getDatasetMeta(e);i.hidden=!n}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,n,i){const l=i?"show":"hide",d=this.getDatasetMeta(e),f=d.controller._resolveAnimations(void 0,l);ls(n)?(d.data[n].hidden=!i,this.update()):(this.setDatasetVisibility(e,i),f.update(d,{visible:i}),this.update(o=>o.datasetIndex===e?l:void 0))}hide(e,n){this._updateVisibility(e,n,!1)}show(e,n){this._updateVisibility(e,n,!0)}_destroyDatasetMeta(e){const n=this._metasets[e];n&&n.controller&&n.controller._destroy(),delete this._metasets[e]}_stop(){let e,n;for(this.stop(),Jl.remove(this),e=0,n=this.data.datasets.length;e<n;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:n}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),lE(e,n),this.platform.releaseContext(n),this.canvas=null,this.ctx=null),this.notifyPlugins("destroy"),delete x_[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,n=this.platform,i=(d,f)=>{n.addEventListener(this,d,f),e[d]=f},l=(d,f,o)=>{d.offsetX=f,d.offsetY=o,this._eventHandler(d)};Ur(this.options.events,d=>i(d,l))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,n=this.platform,i=(y,E)=>{n.addEventListener(this,y,E),e[y]=E},l=(y,E)=>{e[y]&&(n.removeEventListener(this,y,E),delete e[y])},d=(y,E)=>{this.canvas&&this.resize(y,E)};let f;const o=()=>{l("attach",o),this.attached=!0,this.resize(),i("resize",d),i("detach",f)};f=()=>{this.attached=!1,l("resize",d),this._stop(),this._resize(0,0),i("attach",o)},n.isAttached(this.canvas)?o():f()}unbindEvents(){Ur(this._listeners,(e,n)=>{this.platform.removeEventListener(this,n,e)}),this._listeners={},Ur(this._responsiveListeners,(e,n)=>{this.platform.removeEventListener(this,n,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,n,i){const l=i?"set":"remove";let d,f,o,y;for(n==="dataset"&&(d=this.getDatasetMeta(e[0].datasetIndex),d.controller["_"+l+"DatasetHoverStyle"]()),o=0,y=e.length;o<y;++o){f=e[o];const E=f&&this.getDatasetMeta(f.datasetIndex).controller;E&&E[l+"HoverStyle"](f.element,f.datasetIndex,f.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const n=this._active||[],i=e.map(({datasetIndex:d,index:f})=>{const o=this.getDatasetMeta(d);if(!o)throw new Error("No dataset found at index "+d);return{datasetIndex:d,element:o.data[f],index:f}});!f_(i,n)&&(this._active=i,this._lastEvent=null,this._updateHoverStyles(i,n))}notifyPlugins(e,n,i){return this._plugins.notify(this,e,n,i)}_updateHoverStyles(e,n,i){const l=this.options.hover,d=(y,E)=>y.filter(C=>!E.some(A=>C.datasetIndex===A.datasetIndex&&C.index===A.index)),f=d(n,e),o=i?e:d(e,n);f.length&&this.updateHoverStyle(f,l.mode,!1),o.length&&l.mode&&this.updateHoverStyle(o,l.mode,!0)}_eventHandler(e,n){const i={event:e,replay:n,cancelable:!0,inChartArea:this.isPointInArea(e)},l=f=>(f.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",i,l)===!1)return;const d=this._handleEvent(e,n,i.inChartArea);return i.cancelable=!1,this.notifyPlugins("afterEvent",i,l),(d||i.changed)&&this.render(),this}_handleEvent(e,n,i){const{_active:l=[],options:d}=this,f=n,o=this._getActiveElements(e,l,i,f),y=Z7(e),E=rN(e,this._lastEvent,i,y);i&&(this._lastEvent=null,Qr(d.onHover,[e,o,this],this),y&&Qr(d.onClick,[e,o,this],this));const C=!f_(o,l);return(C||n)&&(this._active=o,this._updateHoverStyles(o,l,n)),this._lastEvent=E,C}_getActiveElements(e,n,i,l){if(e.type==="mouseout")return[];if(!i)return n;const d=this.options.hover;return this.getElementsAtEventForMode(e,d.mode,d,l)}}const $E=()=>Ur(ey.instances,t=>t._plugins.invalidate()),ru=!0;Object.defineProperties(ey,{defaults:{enumerable:ru,value:cr},instances:{enumerable:ru,value:x_},overrides:{enumerable:ru,value:Dd},registry:{enumerable:ru,value:oc},version:{enumerable:ru,value:QF},getChart:{enumerable:ru,value:dS},register:{enumerable:ru,value:(...t)=>{oc.add(...t),$E()}},unregister:{enumerable:ru,value:(...t)=>{oc.remove(...t),$E()}}});function hS(t,e,n){const{startAngle:i,pixelMargin:l,x:d,y:f,outerRadius:o,innerRadius:y}=e;let E=l/o;t.beginPath(),t.arc(d,f,o,i-E,n+E),y>l?(E=l/y,t.arc(d,f,y,n+E,i-E,!0)):t.arc(d,f,l,n+Ii,i-Ii),t.closePath(),t.clip()}function iN(t){return lx(t,["outerStart","outerEnd","innerStart","innerEnd"])}function oN(t,e,n,i){const l=iN(t.options.borderRadius),d=(n-e)/2,f=Math.min(d,i*e/2),o=y=>{const E=(n-Math.min(d,y))*i/2;return vo(y,0,Math.min(d,E))};return{outerStart:o(l.outerStart),outerEnd:o(l.outerEnd),innerStart:vo(l.innerStart,0,f),innerEnd:vo(l.innerEnd,0,f)}}function Nh(t,e,n,i){return{x:n+t*Math.cos(e),y:i+t*Math.sin(e)}}function nv(t,e,n,i,l){const{x:d,y:f,startAngle:o,pixelMargin:y,innerRadius:E}=e,C=Math.max(e.outerRadius+i+n-y,0),A=E>0?E+i+n+y:0;let P=0;const B=l-o;if(i){const Ze=E>0?E-i:0,gn=C>0?C-i:0,_n=(Ze+gn)/2,Gn=_n!==0?B*_n/(_n+i):B;P=(B-Gn)/2}const j=Math.max(.001,B*C-n/bi)/C,Z=(B-j)/2,W=o+Z+P,H=l-Z-P,{outerStart:V,outerEnd:tt,innerStart:ft,innerEnd:et}=oN(e,A,C,H-W),Pt=C-V,Rt=C-tt,zt=W+V/Pt,jt=H-tt/Rt,oe=A+ft,ge=A+et,ce=W+ft/oe,Ue=H-et/ge;if(t.beginPath(),t.arc(d,f,C,zt,jt),tt>0){const Ze=Nh(Rt,jt,d,f);t.arc(Ze.x,Ze.y,tt,jt,H+Ii)}const Ae=Nh(ge,H,d,f);if(t.lineTo(Ae.x,Ae.y),et>0){const Ze=Nh(ge,Ue,d,f);t.arc(Ze.x,Ze.y,et,H+Ii,Ue+Math.PI)}if(t.arc(d,f,A,H-et/A,W+ft/A,!0),ft>0){const Ze=Nh(oe,ce,d,f);t.arc(Ze.x,Ze.y,ft,ce+Math.PI,W-Ii)}const se=Nh(Pt,W,d,f);if(t.lineTo(se.x,se.y),V>0){const Ze=Nh(Pt,zt,d,f);t.arc(Ze.x,Ze.y,V,W-Ii,zt)}t.closePath()}function aN(t,e,n,i){const{fullCircles:l,startAngle:d,circumference:f}=e;let o=e.endAngle;if(l){nv(t,e,n,i,d+Kr);for(let y=0;y<l;++y)t.fill();isNaN(f)||(o=d+f%Kr,f%Kr===0&&(o+=Kr))}return nv(t,e,n,i,o),t.fill(),o}function sN(t,e,n){const{x:i,y:l,startAngle:d,pixelMargin:f,fullCircles:o}=e,y=Math.max(e.outerRadius-f,0),E=e.innerRadius+f;let C;for(n&&hS(t,e,d+Kr),t.beginPath(),t.arc(i,l,E,d+Kr,d,!0),C=0;C<o;++C)t.stroke();for(t.beginPath(),t.arc(i,l,y,d,d+Kr),C=0;C<o;++C)t.stroke()}function lN(t,e,n,i,l){const{options:d}=e,{borderWidth:f,borderJoinStyle:o}=d,y=d.borderAlign==="inner";!f||(y?(t.lineWidth=f*2,t.lineJoin=o||"round"):(t.lineWidth=f,t.lineJoin=o||"bevel"),e.fullCircles&&sN(t,e,y),y&&hS(t,e,l),nv(t,e,n,i,l),t.stroke())}class ny extends js{constructor(e){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,e&&Object.assign(this,e)}inRange(e,n,i){const l=this.getProps(["x","y"],i),{angle:d,distance:f}=PC(l,{x:e,y:n}),{startAngle:o,endAngle:y,innerRadius:E,outerRadius:C,circumference:A}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],i),P=this.options.spacing/2,j=Kn(A,y-o)>=Kr||vm(d,o,y),Z=rc(f,E+P,C+P);return j&&Z}getCenterPoint(e){const{x:n,y:i,startAngle:l,endAngle:d,innerRadius:f,outerRadius:o}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius","circumference"],e),{offset:y,spacing:E}=this.options,C=(l+d)/2,A=(f+o+E+y)/2;return{x:n+Math.cos(C)*A,y:i+Math.sin(C)*A}}tooltipPosition(e){return this.getCenterPoint(e)}draw(e){const{options:n,circumference:i}=this,l=(n.offset||0)/2,d=(n.spacing||0)/2;if(this.pixelMargin=n.borderAlign==="inner"?.33:0,this.fullCircles=i>Kr?Math.floor(i/Kr):0,i===0||this.innerRadius<0||this.outerRadius<0)return;e.save();let f=0;if(l){f=l/2;const y=(this.startAngle+this.endAngle)/2;e.translate(Math.cos(y)*f,Math.sin(y)*f),this.circumference>=bi&&(f=l)}e.fillStyle=n.backgroundColor,e.strokeStyle=n.borderColor;const o=aN(e,this,f,d);lN(e,this,f,d,o),e.restore()}}ny.id="arc";ny.defaults={borderAlign:"center",borderColor:"#fff",borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0};ny.defaultRoutes={backgroundColor:"backgroundColor"};function fS(t,e,n=e){t.lineCap=Kn(n.borderCapStyle,e.borderCapStyle),t.setLineDash(Kn(n.borderDash,e.borderDash)),t.lineDashOffset=Kn(n.borderDashOffset,e.borderDashOffset),t.lineJoin=Kn(n.borderJoinStyle,e.borderJoinStyle),t.lineWidth=Kn(n.borderWidth,e.borderWidth),t.strokeStyle=Kn(n.borderColor,e.borderColor)}function cN(t,e,n){t.lineTo(n.x,n.y)}function uN(t){return t.stepped?CB:t.tension||t.cubicInterpolationMode==="monotone"?SB:cN}function pS(t,e,n={}){const i=t.length,{start:l=0,end:d=i-1}=n,{start:f,end:o}=e,y=Math.max(l,f),E=Math.min(d,o),C=l<f&&d<f||l>o&&d>o;return{count:i,start:y,loop:e.loop,ilen:E<y&&!C?i+E-y:E-y}}function dN(t,e,n,i){const{points:l,options:d}=e,{count:f,start:o,loop:y,ilen:E}=pS(l,n,i),C=uN(d);let{move:A=!0,reverse:P}=i||{},B,j,Z;for(B=0;B<=E;++B)j=l[(o+(P?E-B:B))%f],!j.skip&&(A?(t.moveTo(j.x,j.y),A=!1):C(t,Z,j,P,d.stepped),Z=j);return y&&(j=l[(o+(P?E:0))%f],C(t,Z,j,P,d.stepped)),!!y}function hN(t,e,n,i){const l=e.points,{count:d,start:f,ilen:o}=pS(l,n,i),{move:y=!0,reverse:E}=i||{};let C=0,A=0,P,B,j,Z,W,H;const V=ft=>(f+(E?o-ft:ft))%d,tt=()=>{Z!==W&&(t.lineTo(C,W),t.lineTo(C,Z),t.lineTo(C,H))};for(y&&(B=l[V(0)],t.moveTo(B.x,B.y)),P=0;P<=o;++P){if(B=l[V(P)],B.skip)continue;const ft=B.x,et=B.y,Pt=ft|0;Pt===j?(et<Z?Z=et:et>W&&(W=et),C=(A*C+ft)/++A):(tt(),t.lineTo(ft,et),j=Pt,A=0,Z=W=et),H=et}tt()}function rv(t){const e=t.options,n=e.borderDash&&e.borderDash.length;return!t._decimated&&!t._loop&&!e.tension&&e.cubicInterpolationMode!=="monotone"&&!e.stepped&&!n?hN:dN}function fN(t){return t.stepped?s9:t.tension||t.cubicInterpolationMode==="monotone"?l9:wd}function pN(t,e,n,i){let l=e._path;l||(l=e._path=new Path2D,e.path(l,n,i)&&l.closePath()),fS(t,e.options),t.stroke(l)}function mN(t,e,n,i){const{segments:l,options:d}=e,f=rv(e);for(const o of l)fS(t,d,o.style),t.beginPath(),f(t,e,o,{start:n,end:n+i-1})&&t.closePath(),t.stroke()}const gN=typeof Path2D=="function";function _N(t,e,n,i){gN&&!e.options.segment?pN(t,e,n,i):mN(t,e,n,i)}class Au extends js{constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,n){const i=this.options;if((i.tension||i.cubicInterpolationMode==="monotone")&&!i.stepped&&!this._pointsUpdated){const l=i.spanGaps?this._loop:this._fullLoop;QB(this._points,i,e,l,n),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=m9(this,this.options.segment))}first(){const e=this.segments,n=this.points;return e.length&&n[e[0].start]}last(){const e=this.segments,n=this.points,i=e.length;return i&&n[e[i-1].end]}interpolate(e,n){const i=this.options,l=e[n],d=this.points,f=KC(this,{property:n,start:l,end:l});if(!f.length)return;const o=[],y=fN(i);let E,C;for(E=0,C=f.length;E<C;++E){const{start:A,end:P}=f[E],B=d[A],j=d[P];if(B===j){o.push(B);continue}const Z=Math.abs((l-B[n])/(j[n]-B[n])),W=y(B,j,Z,i.stepped);W[n]=e[n],o.push(W)}return o.length===1?o[0]:o}pathSegment(e,n,i){return rv(this)(e,this,n,i)}path(e,n,i){const l=this.segments,d=rv(this);let f=this._loop;n=n||0,i=i||this.points.length-n;for(const o of l)f&=d(e,this,o,{start:n,end:n+i-1});return!!f}draw(e,n,i,l){const d=this.options||{};(this.points||[]).length&&d.borderWidth&&(e.save(),_N(e,this,i,l),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}Au.id="line";Au.defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};Au.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};Au.descriptors={_scriptable:!0,_indexable:t=>t!=="borderDash"&&t!=="fill"};function VE(t,e,n,i){const l=t.options,{[n]:d}=t.getProps([n],i);return Math.abs(e-d)<l.radius+l.hitRadius}class ry extends js{constructor(e){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}inRange(e,n,i){const l=this.options,{x:d,y:f}=this.getProps(["x","y"],i);return Math.pow(e-d,2)+Math.pow(n-f,2)<Math.pow(l.hitRadius+l.radius,2)}inXRange(e,n){return VE(this,e,"x",n)}inYRange(e,n){return VE(this,e,"y",n)}getCenterPoint(e){const{x:n,y:i}=this.getProps(["x","y"],e);return{x:n,y:i}}size(e){e=e||this.options||{};let n=e.radius||0;n=Math.max(n,n&&e.hoverRadius||0);const i=n&&e.borderWidth||0;return(n+i)*2}draw(e,n){const i=this.options;this.skip||i.radius<.1||!xm(this,n,this.size(i)/2)||(e.strokeStyle=i.borderColor,e.lineWidth=i.borderWidth,e.fillStyle=i.backgroundColor,y_(e,i,this.x,this.y))}getRange(){const e=this.options||{};return e.radius+e.hitRadius}}ry.id="point";ry.defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};ry.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};function mS(t,e){const{x:n,y:i,base:l,width:d,height:f}=t.getProps(["x","y","base","width","height"],e);let o,y,E,C,A;return t.horizontal?(A=f/2,o=Math.min(n,l),y=Math.max(n,l),E=i-A,C=i+A):(A=d/2,o=n-A,y=n+A,E=Math.min(i,l),C=Math.max(i,l)),{left:o,top:E,right:y,bottom:C}}function du(t,e,n,i){return t?0:vo(e,n,i)}function yN(t,e,n){const i=t.options.borderWidth,l=t.borderSkipped,d=BC(i);return{t:du(l.top,d.top,0,n),r:du(l.right,d.right,0,e),b:du(l.bottom,d.bottom,0,n),l:du(l.left,d.left,0,e)}}function bN(t,e,n){const{enableBorderRadius:i}=t.getProps(["enableBorderRadius"]),l=t.options.borderRadius,d=Ld(l),f=Math.min(e,n),o=t.borderSkipped,y=i||lr(l);return{topLeft:du(!y||o.top||o.left,d.topLeft,0,f),topRight:du(!y||o.top||o.right,d.topRight,0,f),bottomLeft:du(!y||o.bottom||o.left,d.bottomLeft,0,f),bottomRight:du(!y||o.bottom||o.right,d.bottomRight,0,f)}}function vN(t){const e=mS(t),n=e.right-e.left,i=e.bottom-e.top,l=yN(t,n/2,i/2),d=bN(t,n/2,i/2);return{outer:{x:e.left,y:e.top,w:n,h:i,radius:d},inner:{x:e.left+l.l,y:e.top+l.t,w:n-l.l-l.r,h:i-l.t-l.b,radius:{topLeft:Math.max(0,d.topLeft-Math.max(l.t,l.l)),topRight:Math.max(0,d.topRight-Math.max(l.t,l.r)),bottomLeft:Math.max(0,d.bottomLeft-Math.max(l.b,l.l)),bottomRight:Math.max(0,d.bottomRight-Math.max(l.b,l.r))}}}}function ab(t,e,n,i){const l=e===null,d=n===null,o=t&&!(l&&d)&&mS(t,i);return o&&(l||rc(e,o.left,o.right))&&(d||rc(n,o.top,o.bottom))}function xN(t){return t.topLeft||t.topRight||t.bottomLeft||t.bottomRight}function wN(t,e){t.rect(e.x,e.y,e.w,e.h)}function sb(t,e,n={}){const i=t.x!==n.x?-e:0,l=t.y!==n.y?-e:0,d=(t.x+t.w!==n.x+n.w?e:0)-i,f=(t.y+t.h!==n.y+n.h?e:0)-l;return{x:t.x+i,y:t.y+l,w:t.w+d,h:t.h+f,radius:t.radius}}class iy extends js{constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:n,options:{borderColor:i,backgroundColor:l}}=this,{inner:d,outer:f}=vN(this),o=xN(f.radius)?wm:wN;e.save(),(f.w!==d.w||f.h!==d.h)&&(e.beginPath(),o(e,sb(f,n,d)),e.clip(),o(e,sb(d,-n,f)),e.fillStyle=i,e.fill("evenodd")),e.beginPath(),o(e,sb(d,n)),e.fillStyle=l,e.fill(),e.restore()}inRange(e,n,i){return ab(this,e,n,i)}inXRange(e,n){return ab(this,e,null,n)}inYRange(e,n){return ab(this,null,e,n)}getCenterPoint(e){const{x:n,y:i,base:l,horizontal:d}=this.getProps(["x","y","base","horizontal"],e);return{x:d?(n+l)/2:n,y:d?i:(i+l)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}iy.id="bar";iy.defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};iy.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};var EN=Object.freeze({__proto__:null,ArcElement:ny,LineElement:Au,PointElement:ry,BarElement:iy});function TN(t,e,n,i,l){const d=l.samples||i;if(d>=n)return t.slice(e,e+n);const f=[],o=(n-2)/(d-2);let y=0;const E=e+n-1;let C=e,A,P,B,j,Z;for(f[y++]=t[C],A=0;A<d-2;A++){let W=0,H=0,V;const tt=Math.floor((A+1)*o)+1+e,ft=Math.min(Math.floor((A+2)*o)+1,n)+e,et=ft-tt;for(V=tt;V<ft;V++)W+=t[V].x,H+=t[V].y;W/=et,H/=et;const Pt=Math.floor(A*o)+1+e,Rt=Math.min(Math.floor((A+1)*o)+1,n)+e,{x:zt,y:jt}=t[C];for(B=j=-1,V=Pt;V<Rt;V++)j=.5*Math.abs((zt-W)*(t[V].y-jt)-(zt-t[V].x)*(H-jt)),j>B&&(B=j,P=t[V],Z=V);f[y++]=P,C=Z}return f[y++]=t[E],f}function kN(t,e,n,i){let l=0,d=0,f,o,y,E,C,A,P,B,j,Z;const W=[],H=e+n-1,V=t[e].x,ft=t[H].x-V;for(f=e;f<e+n;++f){o=t[f],y=(o.x-V)/ft*i,E=o.y;const et=y|0;if(et===C)E<j?(j=E,A=f):E>Z&&(Z=E,P=f),l=(d*l+o.x)/++d;else{const Pt=f-1;if(!Tr(A)&&!Tr(P)){const Rt=Math.min(A,P),zt=Math.max(A,P);Rt!==B&&Rt!==Pt&&W.push({...t[Rt],x:l}),zt!==B&&zt!==Pt&&W.push({...t[zt],x:l})}f>0&&Pt!==B&&W.push(t[Pt]),W.push(o),C=et,d=0,j=Z=E,A=P=B=f}}return W}function gS(t){if(t._decimated){const e=t._data;delete t._decimated,delete t._data,Object.defineProperty(t,"data",{value:e})}}function GE(t){t.data.datasets.forEach(e=>{gS(e)})}function CN(t,e){const n=e.length;let i=0,l;const{iScale:d}=t,{min:f,max:o,minDefined:y,maxDefined:E}=d.getUserBounds();return y&&(i=vo(ic(e,d.axis,f).lo,0,n-1)),E?l=vo(ic(e,d.axis,o).hi+1,i,n)-i:l=n-i,{start:i,count:l}}var SN={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(t,e,n)=>{if(!n.enabled){GE(t);return}const i=t.width;t.data.datasets.forEach((l,d)=>{const{_data:f,indexAxis:o}=l,y=t.getDatasetMeta(d),E=f||l.data;if(Fp([o,t.options.indexAxis])==="y"||!y.controller.supportsDecimation)return;const C=t.scales[y.xAxisID];if(C.type!=="linear"&&C.type!=="time"||t.options.parsing)return;let{start:A,count:P}=CN(y,E);const B=n.threshold||4*i;if(P<=B){gS(l);return}Tr(f)&&(l._data=E,delete l.data,Object.defineProperty(l,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(Z){this._data=Z}}));let j;switch(n.algorithm){case"lttb":j=TN(E,A,P,i,n);break;case"min-max":j=kN(E,A,P,i);break;default:throw new Error(`Unsupported decimation algorithm '${n.algorithm}'`)}l._decimated=j})},destroy(t){GE(t)}};function MN(t,e,n){const i=t.segments,l=t.points,d=e.points,f=[];for(const o of i){let{start:y,end:E}=o;E=mx(y,E,l);const C=iv(n,l[y],l[E],o.loop);if(!e.segments){f.push({source:o,target:C,start:l[y],end:l[E]});continue}const A=KC(e,C);for(const P of A){const B=iv(n,d[P.start],d[P.end],P.loop),j=YC(o,l,B);for(const Z of j)f.push({source:Z,target:P,start:{[n]:qE(C,B,"start",Math.max)},end:{[n]:qE(C,B,"end",Math.min)}})}}return f}function iv(t,e,n,i){if(i)return;let l=e[t],d=n[t];return t==="angle"&&(l=Oa(l),d=Oa(d)),{property:t,start:l,end:d}}function AN(t,e){const{x:n=null,y:i=null}=t||{},l=e.points,d=[];return e.segments.forEach(({start:f,end:o})=>{o=mx(f,o,l);const y=l[f],E=l[o];i!==null?(d.push({x:y.x,y:i}),d.push({x:E.x,y:i})):n!==null&&(d.push({x:n,y:y.y}),d.push({x:n,y:E.y}))}),d}function mx(t,e,n){for(;e>t;e--){const i=n[e];if(!isNaN(i.x)&&!isNaN(i.y))break}return e}function qE(t,e,n,i){return t&&e?i(t[n],e[n]):t?t[n]:e?e[n]:0}function _S(t,e){let n=[],i=!1;return ti(t)?(i=!0,n=t):n=AN(t,e),n.length?new Au({points:n,options:{tension:0},_loop:i,_fullLoop:i}):null}function IN(t,e,n){let l=t[e].fill;const d=[e];let f;if(!n)return l;for(;l!==!1&&d.indexOf(l)===-1;){if(!Bi(l))return l;if(f=t[l],!f)return!1;if(f.visible)return l;d.push(l),l=f.fill}return!1}function PN(t,e,n){const i=DN(t);if(lr(i))return isNaN(i.value)?!1:i;let l=parseFloat(i);return Bi(l)&&Math.floor(l)===l?LN(i[0],e,l,n):["origin","start","end","stack","shape"].indexOf(i)>=0&&i}function LN(t,e,n,i){return(t==="-"||t==="+")&&(n=e+n),n===e||n<0||n>=i?!1:n}function zN(t,e){let n=null;return t==="start"?n=e.bottom:t==="end"?n=e.top:lr(t)?n=e.getPixelForValue(t.value):e.getBasePixel&&(n=e.getBasePixel()),n}function ON(t,e,n){let i;return t==="start"?i=n:t==="end"?i=e.options.reverse?e.min:e.max:lr(t)?i=t.value:i=e.getBaseValue(),i}function DN(t){const e=t.options,n=e.fill;let i=Kn(n&&n.target,n);return i===void 0&&(i=!!e.backgroundColor),i===!1||i===null?!1:i===!0?"origin":i}function RN(t){const{scale:e,index:n,line:i}=t,l=[],d=i.segments,f=i.points,o=BN(e,n);o.push(_S({x:null,y:e.bottom},i));for(let y=0;y<d.length;y++){const E=d[y];for(let C=E.start;C<=E.end;C++)FN(l,f[C],o)}return new Au({points:l,options:{}})}function BN(t,e){const n=[],i=t.getMatchingVisibleMetas("line");for(let l=0;l<i.length;l++){const d=i[l];if(d.index===e)break;d.hidden||n.unshift(d.dataset)}return n}function FN(t,e,n){const i=[];for(let l=0;l<n.length;l++){const d=n[l],{first:f,last:o,point:y}=NN(d,e,"x");if(!(!y||f&&o)){if(f)i.unshift(y);else if(t.push(y),!o)break}}t.push(...i)}function NN(t,e,n){const i=t.interpolate(e,n);if(!i)return{};const l=i[n],d=t.segments,f=t.points;let o=!1,y=!1;for(let E=0;E<d.length;E++){const C=d[E],A=f[C.start][n],P=f[C.end][n];if(rc(l,A,P)){o=l===A,y=l===P;break}}return{first:o,last:y,point:i}}class yS{constructor(e){this.x=e.x,this.y=e.y,this.radius=e.radius}pathSegment(e,n,i){const{x:l,y:d,radius:f}=this;return n=n||{start:0,end:Kr},e.arc(l,d,f,n.end,n.start,!0),!i.bounds}interpolate(e){const{x:n,y:i,radius:l}=this,d=e.angle;return{x:n+Math.cos(d)*l,y:i+Math.sin(d)*l,angle:d}}}function jN(t){const{chart:e,fill:n,line:i}=t;if(Bi(n))return UN(e,n);if(n==="stack")return RN(t);if(n==="shape")return!0;const l=$N(t);return l instanceof yS?l:_S(l,i)}function UN(t,e){const n=t.getDatasetMeta(e);return n&&t.isDatasetVisible(e)?n.dataset:null}function $N(t){return(t.scale||{}).getPointPositionForValue?GN(t):VN(t)}function VN(t){const{scale:e={},fill:n}=t,i=zN(n,e);if(Bi(i)){const l=e.isHorizontal();return{x:l?i:null,y:l?null:i}}return null}function GN(t){const{scale:e,fill:n}=t,i=e.options,l=e.getLabels().length,d=i.reverse?e.max:e.min,f=ON(n,e,d),o=[];if(i.grid.circular){const y=e.getPointPositionForValue(0,d);return new yS({x:y.x,y:y.y,radius:e.getDistanceFromCenterForValue(f)})}for(let y=0;y<l;++y)o.push(e.getPointPositionForValue(y,f));return o}function lb(t,e,n){const i=jN(e),{line:l,scale:d,axis:f}=e,o=l.options,y=o.fill,E=o.backgroundColor,{above:C=E,below:A=E}=y||{};i&&l.points.length&&(H_(t,n),qN(t,{line:l,target:i,above:C,below:A,area:n,scale:d,axis:f}),W_(t))}function qN(t,e){const{line:n,target:i,above:l,below:d,area:f,scale:o}=e,y=n._loop?"angle":e.axis;t.save(),y==="x"&&d!==l&&(HE(t,i,f.top),WE(t,{line:n,target:i,color:l,scale:o,property:y}),t.restore(),t.save(),HE(t,i,f.bottom)),WE(t,{line:n,target:i,color:d,scale:o,property:y}),t.restore()}function HE(t,e,n){const{segments:i,points:l}=e;let d=!0,f=!1;t.beginPath();for(const o of i){const{start:y,end:E}=o,C=l[y],A=l[mx(y,E,l)];d?(t.moveTo(C.x,C.y),d=!1):(t.lineTo(C.x,n),t.lineTo(C.x,C.y)),f=!!e.pathSegment(t,o,{move:f}),f?t.closePath():t.lineTo(A.x,n)}t.lineTo(e.first().x,n),t.closePath(),t.clip()}function WE(t,e){const{line:n,target:i,property:l,color:d,scale:f}=e,o=MN(n,i,l);for(const{source:y,target:E,start:C,end:A}of o){const{style:{backgroundColor:P=d}={}}=y,B=i!==!0;t.save(),t.fillStyle=P,HN(t,f,B&&iv(l,C,A)),t.beginPath();const j=!!n.pathSegment(t,y);let Z;if(B){j?t.closePath():ZE(t,i,A,l);const W=!!i.pathSegment(t,E,{move:j,reverse:!0});Z=j&&W,Z||ZE(t,i,C,l)}t.closePath(),t.fill(Z?"evenodd":"nonzero"),t.restore()}}function HN(t,e,n){const{top:i,bottom:l}=e.chart.chartArea,{property:d,start:f,end:o}=n||{};d==="x"&&(t.beginPath(),t.rect(f,i,o-f,l-i),t.clip())}function ZE(t,e,n,i){const l=e.interpolate(n,i);l&&t.lineTo(l.x,l.y)}var WN={id:"filler",afterDatasetsUpdate(t,e,n){const i=(t.data.datasets||[]).length,l=[];let d,f,o,y;for(f=0;f<i;++f)d=t.getDatasetMeta(f),o=d.dataset,y=null,o&&o.options&&o instanceof Au&&(y={visible:t.isDatasetVisible(f),index:f,fill:PN(o,f,i),chart:t,axis:d.controller.options.indexAxis,scale:d.vScale,line:o}),d.$filler=y,l.push(y);for(f=0;f<i;++f)y=l[f],!(!y||y.fill===!1)&&(y.fill=IN(l,f,n.propagate))},beforeDraw(t,e,n){const i=n.drawTime==="beforeDraw",l=t.getSortedVisibleDatasetMetas(),d=t.chartArea;for(let f=l.length-1;f>=0;--f){const o=l[f].$filler;!o||(o.line.updateControlPoints(d,o.axis),i&&lb(t.ctx,o,d))}},beforeDatasetsDraw(t,e,n){if(n.drawTime!=="beforeDatasetsDraw")return;const i=t.getSortedVisibleDatasetMetas();for(let l=i.length-1;l>=0;--l){const d=i[l].$filler;d&&lb(t.ctx,d,t.chartArea)}},beforeDatasetDraw(t,e,n){const i=e.meta.$filler;!i||i.fill===!1||n.drawTime!=="beforeDatasetDraw"||lb(t.ctx,i,t.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const XE=(t,e)=>{let{boxHeight:n=e,boxWidth:i=e}=t;return t.usePointStyle&&(n=Math.min(n,e),i=Math.min(i,e)),{boxWidth:i,boxHeight:n,itemHeight:Math.max(e,n)}},ZN=(t,e)=>t!==null&&e!==null&&t.datasetIndex===e.datasetIndex&&t.index===e.index;class YE extends js{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,n,i){this.maxWidth=e,this.maxHeight=n,this._margins=i,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let n=Qr(e.generateLabels,[this.chart],this)||[];e.filter&&(n=n.filter(i=>e.filter(i,this.chart.data))),e.sort&&(n=n.sort((i,l)=>e.sort(i,l,this.chart.data))),this.options.reverse&&n.reverse(),this.legendItems=n}fit(){const{options:e,ctx:n}=this;if(!e.display){this.width=this.height=0;return}const i=e.labels,l=ao(i.font),d=l.size,f=this._computeTitleHeight(),{boxWidth:o,itemHeight:y}=XE(i,d);let E,C;n.font=l.string,this.isHorizontal()?(E=this.maxWidth,C=this._fitRows(f,d,o,y)+10):(C=this.maxHeight,E=this._fitCols(f,d,o,y)+10),this.width=Math.min(E,e.maxWidth||this.maxWidth),this.height=Math.min(C,e.maxHeight||this.maxHeight)}_fitRows(e,n,i,l){const{ctx:d,maxWidth:f,options:{labels:{padding:o}}}=this,y=this.legendHitBoxes=[],E=this.lineWidths=[0],C=l+o;let A=e;d.textAlign="left",d.textBaseline="middle";let P=-1,B=-C;return this.legendItems.forEach((j,Z)=>{const W=i+n/2+d.measureText(j.text).width;(Z===0||E[E.length-1]+W+2*o>f)&&(A+=C,E[E.length-(Z>0?0:1)]=0,B+=C,P++),y[Z]={left:0,top:B,row:P,width:W,height:l},E[E.length-1]+=W+o}),A}_fitCols(e,n,i,l){const{ctx:d,maxHeight:f,options:{labels:{padding:o}}}=this,y=this.legendHitBoxes=[],E=this.columnSizes=[],C=f-e;let A=o,P=0,B=0,j=0,Z=0;return this.legendItems.forEach((W,H)=>{const V=i+n/2+d.measureText(W.text).width;H>0&&B+l+2*o>C&&(A+=P+o,E.push({width:P,height:B}),j+=P+o,Z++,P=B=0),y[H]={left:j,top:B,col:Z,width:V,height:l},P=Math.max(P,V),B+=l+o}),A+=P,E.push({width:P,height:B}),A}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:n,options:{align:i,labels:{padding:l},rtl:d}}=this,f=Yh(d,this.left,this.width);if(this.isHorizontal()){let o=0,y=Fo(i,this.left+l,this.right-this.lineWidths[o]);for(const E of n)o!==E.row&&(o=E.row,y=Fo(i,this.left+l,this.right-this.lineWidths[o])),E.top+=this.top+e+l,E.left=f.leftForLtr(f.x(y),E.width),y+=E.width+l}else{let o=0,y=Fo(i,this.top+e+l,this.bottom-this.columnSizes[o].height);for(const E of n)E.col!==o&&(o=E.col,y=Fo(i,this.top+e+l,this.bottom-this.columnSizes[o].height)),E.top=y,E.left+=this.left+l,E.left=f.leftForLtr(f.x(E.left),E.width),y+=E.height+l}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;H_(e,this),this._draw(),W_(e)}}_draw(){const{options:e,columnSizes:n,lineWidths:i,ctx:l}=this,{align:d,labels:f}=e,o=cr.color,y=Yh(e.rtl,this.left,this.width),E=ao(f.font),{color:C,padding:A}=f,P=E.size,B=P/2;let j;this.drawTitle(),l.textAlign=y.textAlign("left"),l.textBaseline="middle",l.lineWidth=.5,l.font=E.string;const{boxWidth:Z,boxHeight:W,itemHeight:H}=XE(f,P),V=function(Rt,zt,jt){if(isNaN(Z)||Z<=0||isNaN(W)||W<0)return;l.save();const oe=Kn(jt.lineWidth,1);if(l.fillStyle=Kn(jt.fillStyle,o),l.lineCap=Kn(jt.lineCap,"butt"),l.lineDashOffset=Kn(jt.lineDashOffset,0),l.lineJoin=Kn(jt.lineJoin,"miter"),l.lineWidth=oe,l.strokeStyle=Kn(jt.strokeStyle,o),l.setLineDash(Kn(jt.lineDash,[])),f.usePointStyle){const ge={radius:Z*Math.SQRT2/2,pointStyle:jt.pointStyle,rotation:jt.rotation,borderWidth:oe},ce=y.xPlus(Rt,Z/2),Ue=zt+B;y_(l,ge,ce,Ue)}else{const ge=zt+Math.max((P-W)/2,0),ce=y.leftForLtr(Rt,Z),Ue=Ld(jt.borderRadius);l.beginPath(),Object.values(Ue).some(Ae=>Ae!==0)?wm(l,{x:ce,y:ge,w:Z,h:W,radius:Ue}):l.rect(ce,ge,Z,W),l.fill(),oe!==0&&l.stroke()}l.restore()},tt=function(Rt,zt,jt){Rd(l,jt.text,Rt,zt+H/2,E,{strikethrough:jt.hidden,textAlign:y.textAlign(jt.textAlign)})},ft=this.isHorizontal(),et=this._computeTitleHeight();ft?j={x:Fo(d,this.left+A,this.right-i[0]),y:this.top+A+et,line:0}:j={x:this.left+A,y:Fo(d,this.top+et+A,this.bottom-n[0].height),line:0},WC(this.ctx,e.textDirection);const Pt=H+A;this.legendItems.forEach((Rt,zt)=>{l.strokeStyle=Rt.fontColor||C,l.fillStyle=Rt.fontColor||C;const jt=l.measureText(Rt.text).width,oe=y.textAlign(Rt.textAlign||(Rt.textAlign=f.textAlign)),ge=Z+B+jt;let ce=j.x,Ue=j.y;y.setWidth(this.width),ft?zt>0&&ce+ge+A>this.right&&(Ue=j.y+=Pt,j.line++,ce=j.x=Fo(d,this.left+A,this.right-i[j.line])):zt>0&&Ue+Pt>this.bottom&&(ce=j.x=ce+n[j.line].width+A,j.line++,Ue=j.y=Fo(d,this.top+et+A,this.bottom-n[j.line].height));const Ae=y.x(ce);V(Ae,Ue,Rt),ce=U7(oe,ce+Z+B,ft?ce+ge:this.right,e.rtl),tt(y.x(ce),Ue,Rt),ft?j.x+=ge+A:j.y+=Pt}),ZC(this.ctx,e.textDirection)}drawTitle(){const e=this.options,n=e.title,i=ao(n.font),l=Go(n.padding);if(!n.display)return;const d=Yh(e.rtl,this.left,this.width),f=this.ctx,o=n.position,y=i.size/2,E=l.top+y;let C,A=this.left,P=this.width;if(this.isHorizontal())P=Math.max(...this.lineWidths),C=this.top+E,A=Fo(e.align,A,this.right-P);else{const j=this.columnSizes.reduce((Z,W)=>Math.max(Z,W.height),0);C=E+Fo(e.align,this.top,this.bottom-j-e.labels.padding-this._computeTitleHeight())}const B=Fo(o,A,A+P);f.textAlign=d.textAlign(nx(o)),f.textBaseline="middle",f.strokeStyle=n.color,f.fillStyle=n.color,f.font=i.string,Rd(f,n.text,B,C,i)}_computeTitleHeight(){const e=this.options.title,n=ao(e.font),i=Go(e.padding);return e.display?n.lineHeight+i.height:0}_getLegendItemAt(e,n){let i,l,d;if(rc(e,this.left,this.right)&&rc(n,this.top,this.bottom)){for(d=this.legendHitBoxes,i=0;i<d.length;++i)if(l=d[i],rc(e,l.left,l.left+l.width)&&rc(n,l.top,l.top+l.height))return this.legendItems[i]}return null}handleEvent(e){const n=this.options;if(!XN(e.type,n))return;const i=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const l=this._hoveredItem,d=ZN(l,i);l&&!d&&Qr(n.onLeave,[e,l,this],this),this._hoveredItem=i,i&&!d&&Qr(n.onHover,[e,i,this],this)}else i&&Qr(n.onClick,[e,i,this],this)}}function XN(t,e){return!!((t==="mousemove"||t==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(t==="click"||t==="mouseup"))}var YN={id:"legend",_element:YE,start(t,e,n){const i=t.legend=new YE({ctx:t.ctx,options:n,chart:t});$o.configure(t,i,n),$o.addBox(t,i)},stop(t){$o.removeBox(t,t.legend),delete t.legend},beforeUpdate(t,e,n){const i=t.legend;$o.configure(t,i,n),i.options=n},afterUpdate(t){const e=t.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(t,e){e.replay||t.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(t,e,n){const i=e.datasetIndex,l=n.chart;l.isDatasetVisible(i)?(l.hide(i),e.hidden=!0):(l.show(i),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:t=>t.chart.options.color,boxWidth:40,padding:10,generateLabels(t){const e=t.data.datasets,{labels:{usePointStyle:n,pointStyle:i,textAlign:l,color:d}}=t.legend.options;return t._getSortedDatasetMetas().map(f=>{const o=f.controller.getStyle(n?0:void 0),y=Go(o.borderWidth);return{text:e[f.index].label,fillStyle:o.backgroundColor,fontColor:d,hidden:!f.visible,lineCap:o.borderCapStyle,lineDash:o.borderDash,lineDashOffset:o.borderDashOffset,lineJoin:o.borderJoinStyle,lineWidth:(y.width+y.height)/4,strokeStyle:o.borderColor,pointStyle:i||o.pointStyle,rotation:o.rotation,textAlign:l||o.textAlign,borderRadius:0,datasetIndex:f.index}},this)}},title:{color:t=>t.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:t=>!t.startsWith("on"),labels:{_scriptable:t=>!["generateLabels","filter","sort"].includes(t)}}};class gx extends js{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,n){const i=this.options;if(this.left=0,this.top=0,!i.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=e,this.height=this.bottom=n;const l=ti(i.text)?i.text.length:1;this._padding=Go(i.padding);const d=l*ao(i.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=d:this.width=d}isHorizontal(){const e=this.options.position;return e==="top"||e==="bottom"}_drawArgs(e){const{top:n,left:i,bottom:l,right:d,options:f}=this,o=f.align;let y=0,E,C,A;return this.isHorizontal()?(C=Fo(o,i,d),A=n+e,E=d-i):(f.position==="left"?(C=i+e,A=Fo(o,l,n),y=bi*-.5):(C=d-e,A=Fo(o,n,l),y=bi*.5),E=l-n),{titleX:C,titleY:A,maxWidth:E,rotation:y}}draw(){const e=this.ctx,n=this.options;if(!n.display)return;const i=ao(n.font),d=i.lineHeight/2+this._padding.top,{titleX:f,titleY:o,maxWidth:y,rotation:E}=this._drawArgs(d);Rd(e,n.text,0,0,i,{color:n.color,maxWidth:y,rotation:E,textAlign:nx(n.align),textBaseline:"middle",translation:[f,o]})}}function KN(t,e){const n=new gx({ctx:t.ctx,options:e,chart:t});$o.configure(t,n,e),$o.addBox(t,n),t.titleBlock=n}var JN={id:"title",_element:gx,start(t,e,n){KN(t,n)},stop(t){const e=t.titleBlock;$o.removeBox(t,e),delete t.titleBlock},beforeUpdate(t,e,n){const i=t.titleBlock;$o.configure(t,i,n),i.options=n},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const L0=new WeakMap;var QN={id:"subtitle",start(t,e,n){const i=new gx({ctx:t.ctx,options:n,chart:t});$o.configure(t,i,n),$o.addBox(t,i),L0.set(t,i)},stop(t){$o.removeBox(t,L0.get(t)),L0.delete(t)},beforeUpdate(t,e,n){const i=L0.get(t);$o.configure(t,i,n),i.options=n},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const nm={average(t){if(!t.length)return!1;let e,n,i=0,l=0,d=0;for(e=0,n=t.length;e<n;++e){const f=t[e].element;if(f&&f.hasValue()){const o=f.tooltipPosition();i+=o.x,l+=o.y,++d}}return{x:i/d,y:l/d}},nearest(t,e){if(!t.length)return!1;let n=e.x,i=e.y,l=Number.POSITIVE_INFINITY,d,f,o;for(d=0,f=t.length;d<f;++d){const y=t[d].element;if(y&&y.hasValue()){const E=y.getCenterPoint(),C=Yb(e,E);C<l&&(l=C,o=y)}}if(o){const y=o.tooltipPosition();n=y.x,i=y.y}return{x:n,y:i}}};function fl(t,e){return e&&(ti(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function Ql(t){return(typeof t=="string"||t instanceof String)&&t.indexOf(`
`)>-1?t.split(`
`):t}function tj(t,e){const{element:n,datasetIndex:i,index:l}=e,d=t.getDatasetMeta(i).controller,{label:f,value:o}=d.getLabelAndValue(l);return{chart:t,label:f,parsed:d.getParsed(l),raw:t.data.datasets[i].data[l],formattedValue:o,dataset:d.getDataset(),dataIndex:l,datasetIndex:i,element:n}}function KE(t,e){const n=t.chart.ctx,{body:i,footer:l,title:d}=t,{boxWidth:f,boxHeight:o}=e,y=ao(e.bodyFont),E=ao(e.titleFont),C=ao(e.footerFont),A=d.length,P=l.length,B=i.length,j=Go(e.padding);let Z=j.height,W=0,H=i.reduce((ft,et)=>ft+et.before.length+et.lines.length+et.after.length,0);if(H+=t.beforeBody.length+t.afterBody.length,A&&(Z+=A*E.lineHeight+(A-1)*e.titleSpacing+e.titleMarginBottom),H){const ft=e.displayColors?Math.max(o,y.lineHeight):y.lineHeight;Z+=B*ft+(H-B)*y.lineHeight+(H-1)*e.bodySpacing}P&&(Z+=e.footerMarginTop+P*C.lineHeight+(P-1)*e.footerSpacing);let V=0;const tt=function(ft){W=Math.max(W,n.measureText(ft).width+V)};return n.save(),n.font=E.string,Ur(t.title,tt),n.font=y.string,Ur(t.beforeBody.concat(t.afterBody),tt),V=e.displayColors?f+2+e.boxPadding:0,Ur(i,ft=>{Ur(ft.before,tt),Ur(ft.lines,tt),Ur(ft.after,tt)}),V=0,n.font=C.string,Ur(t.footer,tt),n.restore(),W+=j.width,{width:W,height:Z}}function ej(t,e){const{y:n,height:i}=e;return n<i/2?"top":n>t.height-i/2?"bottom":"center"}function nj(t,e,n,i){const{x:l,width:d}=i,f=n.caretSize+n.caretPadding;if(t==="left"&&l+d+f>e.width||t==="right"&&l-d-f<0)return!0}function rj(t,e,n,i){const{x:l,width:d}=n,{width:f,chartArea:{left:o,right:y}}=t;let E="center";return i==="center"?E=l<=(o+y)/2?"left":"right":l<=d/2?E="left":l>=f-d/2&&(E="right"),nj(E,t,e,n)&&(E="center"),E}function JE(t,e,n){const i=n.yAlign||e.yAlign||ej(t,n);return{xAlign:n.xAlign||e.xAlign||rj(t,e,n,i),yAlign:i}}function ij(t,e){let{x:n,width:i}=t;return e==="right"?n-=i:e==="center"&&(n-=i/2),n}function oj(t,e,n){let{y:i,height:l}=t;return e==="top"?i+=n:e==="bottom"?i-=l+n:i-=l/2,i}function QE(t,e,n,i){const{caretSize:l,caretPadding:d,cornerRadius:f}=t,{xAlign:o,yAlign:y}=n,E=l+d,{topLeft:C,topRight:A,bottomLeft:P,bottomRight:B}=Ld(f);let j=ij(e,o);const Z=oj(e,y,E);return y==="center"?o==="left"?j+=E:o==="right"&&(j-=E):o==="left"?j-=Math.max(C,P)+l:o==="right"&&(j+=Math.max(A,B)+l),{x:vo(j,0,i.width-e.width),y:vo(Z,0,i.height-e.height)}}function z0(t,e,n){const i=Go(n.padding);return e==="center"?t.x+t.width/2:e==="right"?t.x+t.width-i.right:t.x+i.left}function tT(t){return fl([],Ql(t))}function aj(t,e,n){return Mu(t,{tooltip:e,tooltipItems:n,type:"tooltip"})}function eT(t,e){const n=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return n?t.override(n):t}class ov extends js{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart||e._chart,this._chart=this.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const n=this.chart,i=this.options.setContext(this.getContext()),l=i.enabled&&n.options.animation&&i.animations,d=new JC(this.chart,l);return l._cacheable&&(this._cachedAnimations=Object.freeze(d)),d}getContext(){return this.$context||(this.$context=aj(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,n){const{callbacks:i}=n,l=i.beforeTitle.apply(this,[e]),d=i.title.apply(this,[e]),f=i.afterTitle.apply(this,[e]);let o=[];return o=fl(o,Ql(l)),o=fl(o,Ql(d)),o=fl(o,Ql(f)),o}getBeforeBody(e,n){return tT(n.callbacks.beforeBody.apply(this,[e]))}getBody(e,n){const{callbacks:i}=n,l=[];return Ur(e,d=>{const f={before:[],lines:[],after:[]},o=eT(i,d);fl(f.before,Ql(o.beforeLabel.call(this,d))),fl(f.lines,o.label.call(this,d)),fl(f.after,Ql(o.afterLabel.call(this,d))),l.push(f)}),l}getAfterBody(e,n){return tT(n.callbacks.afterBody.apply(this,[e]))}getFooter(e,n){const{callbacks:i}=n,l=i.beforeFooter.apply(this,[e]),d=i.footer.apply(this,[e]),f=i.afterFooter.apply(this,[e]);let o=[];return o=fl(o,Ql(l)),o=fl(o,Ql(d)),o=fl(o,Ql(f)),o}_createItems(e){const n=this._active,i=this.chart.data,l=[],d=[],f=[];let o=[],y,E;for(y=0,E=n.length;y<E;++y)o.push(tj(this.chart,n[y]));return e.filter&&(o=o.filter((C,A,P)=>e.filter(C,A,P,i))),e.itemSort&&(o=o.sort((C,A)=>e.itemSort(C,A,i))),Ur(o,C=>{const A=eT(e.callbacks,C);l.push(A.labelColor.call(this,C)),d.push(A.labelPointStyle.call(this,C)),f.push(A.labelTextColor.call(this,C))}),this.labelColors=l,this.labelPointStyles=d,this.labelTextColors=f,this.dataPoints=o,o}update(e,n){const i=this.options.setContext(this.getContext()),l=this._active;let d,f=[];if(!l.length)this.opacity!==0&&(d={opacity:0});else{const o=nm[i.position].call(this,l,this._eventPosition);f=this._createItems(i),this.title=this.getTitle(f,i),this.beforeBody=this.getBeforeBody(f,i),this.body=this.getBody(f,i),this.afterBody=this.getAfterBody(f,i),this.footer=this.getFooter(f,i);const y=this._size=KE(this,i),E=Object.assign({},o,y),C=JE(this.chart,i,E),A=QE(i,E,C,this.chart);this.xAlign=C.xAlign,this.yAlign=C.yAlign,d={opacity:1,x:A.x,y:A.y,width:y.width,height:y.height,caretX:o.x,caretY:o.y}}this._tooltipItems=f,this.$context=void 0,d&&this._resolveAnimations().update(this,d),e&&i.external&&i.external.call(this,{chart:this.chart,tooltip:this,replay:n})}drawCaret(e,n,i,l){const d=this.getCaretPosition(e,i,l);n.lineTo(d.x1,d.y1),n.lineTo(d.x2,d.y2),n.lineTo(d.x3,d.y3)}getCaretPosition(e,n,i){const{xAlign:l,yAlign:d}=this,{caretSize:f,cornerRadius:o}=i,{topLeft:y,topRight:E,bottomLeft:C,bottomRight:A}=Ld(o),{x:P,y:B}=e,{width:j,height:Z}=n;let W,H,V,tt,ft,et;return d==="center"?(ft=B+Z/2,l==="left"?(W=P,H=W-f,tt=ft+f,et=ft-f):(W=P+j,H=W+f,tt=ft-f,et=ft+f),V=W):(l==="left"?H=P+Math.max(y,C)+f:l==="right"?H=P+j-Math.max(E,A)-f:H=this.caretX,d==="top"?(tt=B,ft=tt-f,W=H-f,V=H+f):(tt=B+Z,ft=tt+f,W=H+f,V=H-f),et=tt),{x1:W,x2:H,x3:V,y1:tt,y2:ft,y3:et}}drawTitle(e,n,i){const l=this.title,d=l.length;let f,o,y;if(d){const E=Yh(i.rtl,this.x,this.width);for(e.x=z0(this,i.titleAlign,i),n.textAlign=E.textAlign(i.titleAlign),n.textBaseline="middle",f=ao(i.titleFont),o=i.titleSpacing,n.fillStyle=i.titleColor,n.font=f.string,y=0;y<d;++y)n.fillText(l[y],E.x(e.x),e.y+f.lineHeight/2),e.y+=f.lineHeight+o,y+1===d&&(e.y+=i.titleMarginBottom-o)}}_drawColorBox(e,n,i,l,d){const f=this.labelColors[i],o=this.labelPointStyles[i],{boxHeight:y,boxWidth:E,boxPadding:C}=d,A=ao(d.bodyFont),P=z0(this,"left",d),B=l.x(P),j=y<A.lineHeight?(A.lineHeight-y)/2:0,Z=n.y+j;if(d.usePointStyle){const W={radius:Math.min(E,y)/2,pointStyle:o.pointStyle,rotation:o.rotation,borderWidth:1},H=l.leftForLtr(B,E)+E/2,V=Z+y/2;e.strokeStyle=d.multiKeyBackground,e.fillStyle=d.multiKeyBackground,y_(e,W,H,V),e.strokeStyle=f.borderColor,e.fillStyle=f.backgroundColor,y_(e,W,H,V)}else{e.lineWidth=f.borderWidth||1,e.strokeStyle=f.borderColor,e.setLineDash(f.borderDash||[]),e.lineDashOffset=f.borderDashOffset||0;const W=l.leftForLtr(B,E-C),H=l.leftForLtr(l.xPlus(B,1),E-C-2),V=Ld(f.borderRadius);Object.values(V).some(tt=>tt!==0)?(e.beginPath(),e.fillStyle=d.multiKeyBackground,wm(e,{x:W,y:Z,w:E,h:y,radius:V}),e.fill(),e.stroke(),e.fillStyle=f.backgroundColor,e.beginPath(),wm(e,{x:H,y:Z+1,w:E-2,h:y-2,radius:V}),e.fill()):(e.fillStyle=d.multiKeyBackground,e.fillRect(W,Z,E,y),e.strokeRect(W,Z,E,y),e.fillStyle=f.backgroundColor,e.fillRect(H,Z+1,E-2,y-2))}e.fillStyle=this.labelTextColors[i]}drawBody(e,n,i){const{body:l}=this,{bodySpacing:d,bodyAlign:f,displayColors:o,boxHeight:y,boxWidth:E,boxPadding:C}=i,A=ao(i.bodyFont);let P=A.lineHeight,B=0;const j=Yh(i.rtl,this.x,this.width),Z=function(zt){n.fillText(zt,j.x(e.x+B),e.y+P/2),e.y+=P+d},W=j.textAlign(f);let H,V,tt,ft,et,Pt,Rt;for(n.textAlign=f,n.textBaseline="middle",n.font=A.string,e.x=z0(this,W,i),n.fillStyle=i.bodyColor,Ur(this.beforeBody,Z),B=o&&W!=="right"?f==="center"?E/2+C:E+2+C:0,ft=0,Pt=l.length;ft<Pt;++ft){for(H=l[ft],V=this.labelTextColors[ft],n.fillStyle=V,Ur(H.before,Z),tt=H.lines,o&&tt.length&&(this._drawColorBox(n,e,ft,j,i),P=Math.max(A.lineHeight,y)),et=0,Rt=tt.length;et<Rt;++et)Z(tt[et]),P=A.lineHeight;Ur(H.after,Z)}B=0,P=A.lineHeight,Ur(this.afterBody,Z),e.y-=d}drawFooter(e,n,i){const l=this.footer,d=l.length;let f,o;if(d){const y=Yh(i.rtl,this.x,this.width);for(e.x=z0(this,i.footerAlign,i),e.y+=i.footerMarginTop,n.textAlign=y.textAlign(i.footerAlign),n.textBaseline="middle",f=ao(i.footerFont),n.fillStyle=i.footerColor,n.font=f.string,o=0;o<d;++o)n.fillText(l[o],y.x(e.x),e.y+f.lineHeight/2),e.y+=f.lineHeight+i.footerSpacing}}drawBackground(e,n,i,l){const{xAlign:d,yAlign:f}=this,{x:o,y}=e,{width:E,height:C}=i,{topLeft:A,topRight:P,bottomLeft:B,bottomRight:j}=Ld(l.cornerRadius);n.fillStyle=l.backgroundColor,n.strokeStyle=l.borderColor,n.lineWidth=l.borderWidth,n.beginPath(),n.moveTo(o+A,y),f==="top"&&this.drawCaret(e,n,i,l),n.lineTo(o+E-P,y),n.quadraticCurveTo(o+E,y,o+E,y+P),f==="center"&&d==="right"&&this.drawCaret(e,n,i,l),n.lineTo(o+E,y+C-j),n.quadraticCurveTo(o+E,y+C,o+E-j,y+C),f==="bottom"&&this.drawCaret(e,n,i,l),n.lineTo(o+B,y+C),n.quadraticCurveTo(o,y+C,o,y+C-B),f==="center"&&d==="left"&&this.drawCaret(e,n,i,l),n.lineTo(o,y+A),n.quadraticCurveTo(o,y,o+A,y),n.closePath(),n.fill(),l.borderWidth>0&&n.stroke()}_updateAnimationTarget(e){const n=this.chart,i=this.$animations,l=i&&i.x,d=i&&i.y;if(l||d){const f=nm[e.position].call(this,this._active,this._eventPosition);if(!f)return;const o=this._size=KE(this,e),y=Object.assign({},f,this._size),E=JE(n,e,y),C=QE(e,y,E,n);(l._to!==C.x||d._to!==C.y)&&(this.xAlign=E.xAlign,this.yAlign=E.yAlign,this.width=o.width,this.height=o.height,this.caretX=f.x,this.caretY=f.y,this._resolveAnimations().update(this,C))}}_willRender(){return!!this.opacity}draw(e){const n=this.options.setContext(this.getContext());let i=this.opacity;if(!i)return;this._updateAnimationTarget(n);const l={width:this.width,height:this.height},d={x:this.x,y:this.y};i=Math.abs(i)<.001?0:i;const f=Go(n.padding),o=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;n.enabled&&o&&(e.save(),e.globalAlpha=i,this.drawBackground(d,e,l,n),WC(e,n.textDirection),d.y+=f.top,this.drawTitle(d,e,n),this.drawBody(d,e,n),this.drawFooter(d,e,n),ZC(e,n.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,n){const i=this._active,l=e.map(({datasetIndex:o,index:y})=>{const E=this.chart.getDatasetMeta(o);if(!E)throw new Error("Cannot find a dataset at index "+o);return{datasetIndex:o,element:E.data[y],index:y}}),d=!f_(i,l),f=this._positionChanged(l,n);(d||f)&&(this._active=l,this._eventPosition=n,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,n,i=!0){if(n&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const l=this.options,d=this._active||[],f=this._getActiveElements(e,d,n,i),o=this._positionChanged(f,e),y=n||!f_(f,d)||o;return y&&(this._active=f,(l.enabled||l.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,n))),y}_getActiveElements(e,n,i,l){const d=this.options;if(e.type==="mouseout")return[];if(!l)return n;const f=this.chart.getElementsAtEventForMode(e,d.mode,d,i);return d.reverse&&f.reverse(),f}_positionChanged(e,n){const{caretX:i,caretY:l,options:d}=this,f=nm[d.position].call(this,e,n);return f!==!1&&(i!==f.x||l!==f.y)}}ov.positioners=nm;var sj={id:"tooltip",_element:ov,positioners:nm,afterInit(t,e,n){n&&(t.tooltip=new ov({chart:t,options:n}))},beforeUpdate(t,e,n){t.tooltip&&t.tooltip.initialize(n)},reset(t,e,n){t.tooltip&&t.tooltip.initialize(n)},afterDraw(t){const e=t.tooltip;if(e&&e._willRender()){const n={tooltip:e};if(t.notifyPlugins("beforeTooltipDraw",n)===!1)return;e.draw(t.ctx),t.notifyPlugins("afterTooltipDraw",n)}},afterEvent(t,e){if(t.tooltip){const n=e.replay;t.tooltip.handleEvent(e.event,n,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(t,e)=>e.bodyFont.size,boxWidth:(t,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:{beforeTitle:Kl,title(t){if(t.length>0){const e=t[0],n=e.chart.data.labels,i=n?n.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(i>0&&e.dataIndex<i)return n[e.dataIndex]}return""},afterTitle:Kl,beforeBody:Kl,beforeLabel:Kl,label(t){if(this&&this.options&&this.options.mode==="dataset")return t.label+": "+t.formattedValue||t.formattedValue;let e=t.dataset.label||"";e&&(e+=": ");const n=t.formattedValue;return Tr(n)||(e+=n),e},labelColor(t){const n=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{borderColor:n.borderColor,backgroundColor:n.backgroundColor,borderWidth:n.borderWidth,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(t){const n=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{pointStyle:n.pointStyle,rotation:n.rotation}},afterLabel:Kl,afterBody:Kl,beforeFooter:Kl,footer:Kl,afterFooter:Kl}},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:t=>t!=="filter"&&t!=="itemSort"&&t!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},lj=Object.freeze({__proto__:null,Decimation:SN,Filler:WN,Legend:YN,SubTitle:QN,Title:JN,Tooltip:sj});const cj=(t,e,n,i)=>(typeof e=="string"?(n=t.push(e)-1,i.unshift({index:n,label:e})):isNaN(e)&&(n=null),n);function uj(t,e,n,i){const l=t.indexOf(e);if(l===-1)return cj(t,e,n,i);const d=t.lastIndexOf(e);return l!==d?n:l}const dj=(t,e)=>t===null?null:vo(Math.round(t),0,e);class w_ extends Vd{constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const n=this._addedLabels;if(n.length){const i=this.getLabels();for(const{index:l,label:d}of n)i[l]===d&&i.splice(l,1);this._addedLabels=[]}super.init(e)}parse(e,n){if(Tr(e))return null;const i=this.getLabels();return n=isFinite(n)&&i[n]===e?n:uj(i,e,Kn(n,e),this._addedLabels),dj(n,i.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:n}=this.getUserBounds();let{min:i,max:l}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(i=0),n||(l=this.getLabels().length-1)),this.min=i,this.max=l}buildTicks(){const e=this.min,n=this.max,i=this.options.offset,l=[];let d=this.getLabels();d=e===0&&n===d.length-1?d:d.slice(e,n+1),this._valueRange=Math.max(d.length-(i?0:1),1),this._startValue=this.min-(i?.5:0);for(let f=e;f<=n;f++)l.push({value:f});return l}getLabelForValue(e){const n=this.getLabels();return e>=0&&e<n.length?n[e]:e}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const n=this.ticks;return e<0||e>n.length-1?null:this.getPixelForValue(n[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}w_.id="category";w_.defaults={ticks:{callback:w_.prototype.getLabelForValue}};function hj(t,e){const n=[],{bounds:l,step:d,min:f,max:o,precision:y,count:E,maxTicks:C,maxDigits:A,includeBounds:P}=t,B=d||1,j=C-1,{min:Z,max:W}=e,H=!Tr(f),V=!Tr(o),tt=!Tr(E),ft=(W-Z)/(A+1);let et=Q5((W-Z)/j/B)*B,Pt,Rt,zt,jt;if(et<1e-14&&!H&&!V)return[{value:Z},{value:W}];jt=Math.ceil(W/et)-Math.floor(Z/et),jt>j&&(et=Q5(jt*et/j/B)*B),Tr(y)||(Pt=Math.pow(10,y),et=Math.ceil(et*Pt)/Pt),l==="ticks"?(Rt=Math.floor(Z/et)*et,zt=Math.ceil(W/et)*et):(Rt=Z,zt=W),H&&V&&d&&J7((o-f)/d,et/1e3)?(jt=Math.round(Math.min((o-f)/et,C)),et=(o-f)/jt,Rt=f,zt=o):tt?(Rt=H?f:Rt,zt=V?o:zt,jt=E-1,et=(zt-Rt)/jt):(jt=(zt-Rt)/et,Qp(jt,Math.round(jt),et/1e3)?jt=Math.round(jt):jt=Math.ceil(jt));const oe=Math.max(tE(et),tE(Rt));Pt=Math.pow(10,Tr(y)?oe:y),Rt=Math.round(Rt*Pt)/Pt,zt=Math.round(zt*Pt)/Pt;let ge=0;for(H&&(P&&Rt!==f?(n.push({value:f}),Rt<f&&ge++,Qp(Math.round((Rt+ge*et)*Pt)/Pt,f,nT(f,ft,t))&&ge++):Rt<f&&ge++);ge<jt;++ge)n.push({value:Math.round((Rt+ge*et)*Pt)/Pt});return V&&P&&zt!==o?n.length&&Qp(n[n.length-1].value,o,nT(o,ft,t))?n[n.length-1].value=o:n.push({value:o}):(!V||zt===o)&&n.push({value:zt}),n}function nT(t,e,{horizontal:n,minRotation:i}){const l=Bs(i),d=(n?Math.sin(l):Math.cos(l))||.001,f=.75*e*(""+t).length;return Math.min(e/d,f)}class E_ extends Vd{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,n){return Tr(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:n,maxDefined:i}=this.getUserBounds();let{min:l,max:d}=this;const f=y=>l=n?l:y,o=y=>d=i?d:y;if(e){const y=yl(l),E=yl(d);y<0&&E<0?o(0):y>0&&E>0&&f(0)}if(l===d){let y=1;(d>=Number.MAX_SAFE_INTEGER||l<=Number.MIN_SAFE_INTEGER)&&(y=Math.abs(d*.05)),o(d+y),e||f(l-y)}this.min=l,this.max=d}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:n,stepSize:i}=e,l;return i?(l=Math.ceil(this.max/i)-Math.floor(this.min/i)+1,l>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${i} would result generating up to ${l} ticks. Limiting to 1000.`),l=1e3)):(l=this.computeTickLimit(),n=n||11),n&&(l=Math.min(n,l)),l}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,n=e.ticks;let i=this.getTickLimit();i=Math.max(2,i);const l={maxTicks:i,bounds:e.bounds,min:e.min,max:e.max,precision:n.precision,step:n.stepSize,count:n.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:n.minRotation||0,includeBounds:n.includeBounds!==!1},d=this._range||this,f=hj(l,d);return e.bounds==="ticks"&&IC(f,this,"value"),e.reverse?(f.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),f}configure(){const e=this.ticks;let n=this.min,i=this.max;if(super.configure(),this.options.offset&&e.length){const l=(i-n)/Math.max(e.length-1,1)/2;n-=l,i+=l}this._startValue=n,this._endValue=i,this._valueRange=i-n}getLabelForValue(e){return Fm(e,this.chart.options.locale,this.options.ticks.format)}}class _x extends E_{determineDataLimits(){const{min:e,max:n}=this.getMinMax(!0);this.min=Bi(e)?e:0,this.max=Bi(n)?n:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),n=e?this.width:this.height,i=Bs(this.options.ticks.minRotation),l=(e?Math.sin(i):Math.cos(i))||.001,d=this._resolveTickFontOptions(0);return Math.ceil(n/Math.min(40,d.lineHeight/l))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}_x.id="linear";_x.defaults={ticks:{callback:ty.formatters.numeric}};function rT(t){return t/Math.pow(10,Math.floor(is(t)))===1}function fj(t,e){const n=Math.floor(is(e.max)),i=Math.ceil(e.max/Math.pow(10,n)),l=[];let d=Qa(t.min,Math.pow(10,Math.floor(is(e.min)))),f=Math.floor(is(d)),o=Math.floor(d/Math.pow(10,f)),y=f<0?Math.pow(10,Math.abs(f)):1;do l.push({value:d,major:rT(d)}),++o,o===10&&(o=1,++f,y=f>=0?1:y),d=Math.round(o*Math.pow(10,f)*y)/y;while(f<n||f===n&&o<i);const E=Qa(t.max,d);return l.push({value:E,major:rT(d)}),l}class yx extends Vd{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(e,n){const i=E_.prototype.parse.apply(this,[e,n]);if(i===0){this._zero=!0;return}return Bi(i)&&i>0?i:null}determineDataLimits(){const{min:e,max:n}=this.getMinMax(!0);this.min=Bi(e)?Math.max(0,e):null,this.max=Bi(n)?Math.max(0,n):null,this.options.beginAtZero&&(this._zero=!0),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:e,maxDefined:n}=this.getUserBounds();let i=this.min,l=this.max;const d=y=>i=e?i:y,f=y=>l=n?l:y,o=(y,E)=>Math.pow(10,Math.floor(is(y))+E);i===l&&(i<=0?(d(1),f(10)):(d(o(i,-1)),f(o(l,1)))),i<=0&&d(o(l,-1)),l<=0&&f(o(i,1)),this._zero&&this.min!==this._suggestedMin&&i===o(this.min,0)&&d(o(i,-1)),this.min=i,this.max=l}buildTicks(){const e=this.options,n={min:this._userMin,max:this._userMax},i=fj(n,this);return e.bounds==="ticks"&&IC(i,this,"value"),e.reverse?(i.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),i}getLabelForValue(e){return e===void 0?"0":Fm(e,this.chart.options.locale,this.options.ticks.format)}configure(){const e=this.min;super.configure(),this._startValue=is(e),this._valueRange=is(this.max)-is(e)}getPixelForValue(e){return(e===void 0||e===0)&&(e=this.min),e===null||isNaN(e)?NaN:this.getPixelForDecimal(e===this.min?0:(is(e)-this._startValue)/this._valueRange)}getValueForPixel(e){const n=this.getDecimalForPixel(e);return Math.pow(10,this._startValue+n*this._valueRange)}}yx.id="logarithmic";yx.defaults={ticks:{callback:ty.formatters.logarithmic,major:{enabled:!0}}};function av(t){const e=t.ticks;if(e.display&&t.display){const n=Go(e.backdropPadding);return Kn(e.font&&e.font.size,cr.font.size)+n.height}return 0}function pj(t,e,n){return n=ti(n)?n:[n],{w:kB(t,e.string,n),h:n.length*e.lineHeight}}function iT(t,e,n,i,l){return t===i||t===l?{start:e-n/2,end:e+n/2}:t<i||t>l?{start:e-n,end:e}:{start:e,end:e+n}}function mj(t){const e={l:t.left+t._padding.left,r:t.right-t._padding.right,t:t.top+t._padding.top,b:t.bottom-t._padding.bottom},n=Object.assign({},e),i=[],l=[],d=t._pointLabels.length,f=t.options.pointLabels,o=f.centerPointLabels?bi/d:0;for(let y=0;y<d;y++){const E=f.setContext(t.getPointLabelContext(y));l[y]=E.padding;const C=t.getPointPosition(y,t.drawingArea+l[y],o),A=ao(E.font),P=pj(t.ctx,A,t._pointLabels[y]);i[y]=P;const B=Oa(t.getIndexAngle(y)+o),j=Math.round(ix(B)),Z=iT(j,C.x,P.w,0,180),W=iT(j,C.y,P.h,90,270);gj(n,e,B,Z,W)}t.setCenterPoint(e.l-n.l,n.r-e.r,e.t-n.t,n.b-e.b),t._pointLabelItems=_j(t,i,l)}function gj(t,e,n,i,l){const d=Math.abs(Math.sin(n)),f=Math.abs(Math.cos(n));let o=0,y=0;i.start<e.l?(o=(e.l-i.start)/d,t.l=Math.min(t.l,e.l-o)):i.end>e.r&&(o=(i.end-e.r)/d,t.r=Math.max(t.r,e.r+o)),l.start<e.t?(y=(e.t-l.start)/f,t.t=Math.min(t.t,e.t-y)):l.end>e.b&&(y=(l.end-e.b)/f,t.b=Math.max(t.b,e.b+y))}function _j(t,e,n){const i=[],l=t._pointLabels.length,d=t.options,f=av(d)/2,o=t.drawingArea,y=d.pointLabels.centerPointLabels?bi/l:0;for(let E=0;E<l;E++){const C=t.getPointPosition(E,o+f+n[E],y),A=Math.round(ix(Oa(C.angle+Ii))),P=e[E],B=vj(C.y,P.h,A),j=yj(A),Z=bj(C.x,P.w,j);i.push({x:C.x,y:B,textAlign:j,left:Z,top:B,right:Z+P.w,bottom:B+P.h})}return i}function yj(t){return t===0||t===180?"center":t<180?"left":"right"}function bj(t,e,n){return n==="right"?t-=e:n==="center"&&(t-=e/2),t}function vj(t,e,n){return n===90||n===270?t-=e/2:(n>270||n<90)&&(t-=e),t}function xj(t,e){const{ctx:n,options:{pointLabels:i}}=t;for(let l=e-1;l>=0;l--){const d=i.setContext(t.getPointLabelContext(l)),f=ao(d.font),{x:o,y,textAlign:E,left:C,top:A,right:P,bottom:B}=t._pointLabelItems[l],{backdropColor:j}=d;if(!Tr(j)){const Z=Ld(d.borderRadius),W=Go(d.backdropPadding);n.fillStyle=j;const H=C-W.left,V=A-W.top,tt=P-C+W.width,ft=B-A+W.height;Object.values(Z).some(et=>et!==0)?(n.beginPath(),wm(n,{x:H,y:V,w:tt,h:ft,radius:Z}),n.fill()):n.fillRect(H,V,tt,ft)}Rd(n,t._pointLabels[l],o,y+f.lineHeight/2,f,{color:d.color,textAlign:E,textBaseline:"middle"})}}function bS(t,e,n,i){const{ctx:l}=t;if(n)l.arc(t.xCenter,t.yCenter,e,0,Kr);else{let d=t.getPointPosition(0,e);l.moveTo(d.x,d.y);for(let f=1;f<i;f++)d=t.getPointPosition(f,e),l.lineTo(d.x,d.y)}}function wj(t,e,n,i){const l=t.ctx,d=e.circular,{color:f,lineWidth:o}=e;!d&&!i||!f||!o||n<0||(l.save(),l.strokeStyle=f,l.lineWidth=o,l.setLineDash(e.borderDash),l.lineDashOffset=e.borderDashOffset,l.beginPath(),bS(t,n,d,i),l.closePath(),l.stroke(),l.restore())}function Ej(t,e,n){return Mu(t,{label:n,index:e,type:"pointLabel"})}class Um extends E_{constructor(e){super(e),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const e=this._padding=Go(av(this.options)/2),n=this.width=this.maxWidth-e.width,i=this.height=this.maxHeight-e.height;this.xCenter=Math.floor(this.left+n/2+e.left),this.yCenter=Math.floor(this.top+i/2+e.top),this.drawingArea=Math.floor(Math.min(n,i)/2)}determineDataLimits(){const{min:e,max:n}=this.getMinMax(!1);this.min=Bi(e)&&!isNaN(e)?e:0,this.max=Bi(n)&&!isNaN(n)?n:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/av(this.options))}generateTickLabels(e){E_.prototype.generateTickLabels.call(this,e),this._pointLabels=this.getLabels().map((n,i)=>{const l=Qr(this.options.pointLabels.callback,[n,i],this);return l||l===0?l:""}).filter((n,i)=>this.chart.getDataVisibility(i))}fit(){const e=this.options;e.display&&e.pointLabels.display?mj(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(e,n,i,l){this.xCenter+=Math.floor((e-n)/2),this.yCenter+=Math.floor((i-l)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(e,n,i,l))}getIndexAngle(e){const n=Kr/(this._pointLabels.length||1),i=this.options.startAngle||0;return Oa(e*n+Bs(i))}getDistanceFromCenterForValue(e){if(Tr(e))return NaN;const n=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-e)*n:(e-this.min)*n}getValueForDistanceFromCenter(e){if(Tr(e))return NaN;const n=e/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-n:this.min+n}getPointLabelContext(e){const n=this._pointLabels||[];if(e>=0&&e<n.length){const i=n[e];return Ej(this.getContext(),e,i)}}getPointPosition(e,n,i=0){const l=this.getIndexAngle(e)-Ii+i;return{x:Math.cos(l)*n+this.xCenter,y:Math.sin(l)*n+this.yCenter,angle:l}}getPointPositionForValue(e,n){return this.getPointPosition(e,this.getDistanceFromCenterForValue(n))}getBasePosition(e){return this.getPointPositionForValue(e||0,this.getBaseValue())}getPointLabelPosition(e){const{left:n,top:i,right:l,bottom:d}=this._pointLabelItems[e];return{left:n,top:i,right:l,bottom:d}}drawBackground(){const{backgroundColor:e,grid:{circular:n}}=this.options;if(e){const i=this.ctx;i.save(),i.beginPath(),bS(this,this.getDistanceFromCenterForValue(this._endValue),n,this._pointLabels.length),i.closePath(),i.fillStyle=e,i.fill(),i.restore()}}drawGrid(){const e=this.ctx,n=this.options,{angleLines:i,grid:l}=n,d=this._pointLabels.length;let f,o,y;if(n.pointLabels.display&&xj(this,d),l.display&&this.ticks.forEach((E,C)=>{if(C!==0){o=this.getDistanceFromCenterForValue(E.value);const A=l.setContext(this.getContext(C-1));wj(this,A,o,d)}}),i.display){for(e.save(),f=d-1;f>=0;f--){const E=i.setContext(this.getPointLabelContext(f)),{color:C,lineWidth:A}=E;!A||!C||(e.lineWidth=A,e.strokeStyle=C,e.setLineDash(E.borderDash),e.lineDashOffset=E.borderDashOffset,o=this.getDistanceFromCenterForValue(n.ticks.reverse?this.min:this.max),y=this.getPointPosition(f,o),e.beginPath(),e.moveTo(this.xCenter,this.yCenter),e.lineTo(y.x,y.y),e.stroke())}e.restore()}}drawBorder(){}drawLabels(){const e=this.ctx,n=this.options,i=n.ticks;if(!i.display)return;const l=this.getIndexAngle(0);let d,f;e.save(),e.translate(this.xCenter,this.yCenter),e.rotate(l),e.textAlign="center",e.textBaseline="middle",this.ticks.forEach((o,y)=>{if(y===0&&!n.reverse)return;const E=i.setContext(this.getContext(y)),C=ao(E.font);if(d=this.getDistanceFromCenterForValue(this.ticks[y].value),E.showLabelBackdrop){e.font=C.string,f=e.measureText(o.label).width,e.fillStyle=E.backdropColor;const A=Go(E.backdropPadding);e.fillRect(-f/2-A.left,-d-C.size/2-A.top,f+A.width,C.size+A.height)}Rd(e,o.label,0,-d,C,{color:E.color})}),e.restore()}drawTitle(){}}Um.id="radialLinear";Um.defaults={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:ty.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(t){return t},padding:5,centerPointLabels:!1}};Um.defaultRoutes={"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"};Um.descriptors={angleLines:{_fallback:"grid"}};const oy={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},_a=Object.keys(oy);function Tj(t,e){return t-e}function oT(t,e){if(Tr(e))return null;const n=t._adapter,{parser:i,round:l,isoWeekday:d}=t._parseOpts;let f=e;return typeof i=="function"&&(f=i(f)),Bi(f)||(f=typeof i=="string"?n.parse(f,i):n.parse(f)),f===null?null:(l&&(f=l==="week"&&(bm(d)||d===!0)?n.startOf(f,"isoWeek",d):n.startOf(f,l)),+f)}function aT(t,e,n,i){const l=_a.length;for(let d=_a.indexOf(t);d<l-1;++d){const f=oy[_a[d]],o=f.steps?f.steps:Number.MAX_SAFE_INTEGER;if(f.common&&Math.ceil((n-e)/(o*f.size))<=i)return _a[d]}return _a[l-1]}function kj(t,e,n,i,l){for(let d=_a.length-1;d>=_a.indexOf(n);d--){const f=_a[d];if(oy[f].common&&t._adapter.diff(l,i,f)>=e-1)return f}return _a[n?_a.indexOf(n):0]}function Cj(t){for(let e=_a.indexOf(t)+1,n=_a.length;e<n;++e)if(oy[_a[e]].common)return _a[e]}function sT(t,e,n){if(!n)t[e]=!0;else if(n.length){const{lo:i,hi:l}=cx(n,e),d=n[i]>=e?n[i]:n[l];t[d]=!0}}function Sj(t,e,n,i){const l=t._adapter,d=+l.startOf(e[0].value,i),f=e[e.length-1].value;let o,y;for(o=d;o<=f;o=+l.add(o,1,i))y=n[o],y>=0&&(e[y].major=!0);return e}function lT(t,e,n){const i=[],l={},d=e.length;let f,o;for(f=0;f<d;++f)o=e[f],l[o]=f,i.push({value:o,major:!1});return d===0||!n?i:Sj(t,i,l,n)}class $m extends Vd{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,n){const i=e.time||(e.time={}),l=this._adapter=new X9._date(e.adapters.date);Jp(i.displayFormats,l.formats()),this._parseOpts={parser:i.parser,round:i.round,isoWeekday:i.isoWeekday},super.init(e),this._normalized=n.normalized}parse(e,n){return e===void 0?null:oT(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,n=this._adapter,i=e.time.unit||"day";let{min:l,max:d,minDefined:f,maxDefined:o}=this.getUserBounds();function y(E){!f&&!isNaN(E.min)&&(l=Math.min(l,E.min)),!o&&!isNaN(E.max)&&(d=Math.max(d,E.max))}(!f||!o)&&(y(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&y(this.getMinMax(!1))),l=Bi(l)&&!isNaN(l)?l:+n.startOf(Date.now(),i),d=Bi(d)&&!isNaN(d)?d:+n.endOf(Date.now(),i)+1,this.min=Math.min(l,d-1),this.max=Math.max(l+1,d)}_getLabelBounds(){const e=this.getLabelTimestamps();let n=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;return e.length&&(n=e[0],i=e[e.length-1]),{min:n,max:i}}buildTicks(){const e=this.options,n=e.time,i=e.ticks,l=i.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&l.length&&(this.min=this._userMin||l[0],this.max=this._userMax||l[l.length-1]);const d=this.min,f=this.max,o=RB(l,d,f);return this._unit=n.unit||(i.autoSkip?aT(n.minUnit,this.min,this.max,this._getLabelCapacity(d)):kj(this,o.length,n.minUnit,this.min,this.max)),this._majorUnit=!i.major.enabled||this._unit==="year"?void 0:Cj(this._unit),this.initOffsets(l),e.reverse&&o.reverse(),lT(this,o,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e){let n=0,i=0,l,d;this.options.offset&&e.length&&(l=this.getDecimalForValue(e[0]),e.length===1?n=1-l:n=(this.getDecimalForValue(e[1])-l)/2,d=this.getDecimalForValue(e[e.length-1]),e.length===1?i=d:i=(d-this.getDecimalForValue(e[e.length-2]))/2);const f=e.length<3?.5:.25;n=vo(n,0,f),i=vo(i,0,f),this._offsets={start:n,end:i,factor:1/(n+1+i)}}_generate(){const e=this._adapter,n=this.min,i=this.max,l=this.options,d=l.time,f=d.unit||aT(d.minUnit,n,i,this._getLabelCapacity(n)),o=Kn(d.stepSize,1),y=f==="week"?d.isoWeekday:!1,E=bm(y)||y===!0,C={};let A=n,P,B;if(E&&(A=+e.startOf(A,"isoWeek",y)),A=+e.startOf(A,E?"day":f),e.diff(i,n,f)>1e5*o)throw new Error(n+" and "+i+" are too far apart with stepSize of "+o+" "+f);const j=l.ticks.source==="data"&&this.getDataTimestamps();for(P=A,B=0;P<i;P=+e.add(P,o,f),B++)sT(C,P,j);return(P===i||l.bounds==="ticks"||B===1)&&sT(C,P,j),Object.keys(C).sort((Z,W)=>Z-W).map(Z=>+Z)}getLabelForValue(e){const n=this._adapter,i=this.options.time;return i.tooltipFormat?n.format(e,i.tooltipFormat):n.format(e,i.displayFormats.datetime)}_tickFormatFunction(e,n,i,l){const d=this.options,f=d.time.displayFormats,o=this._unit,y=this._majorUnit,E=o&&f[o],C=y&&f[y],A=i[n],P=y&&C&&A&&A.major,B=this._adapter.format(e,l||(P?C:E)),j=d.ticks.callback;return j?Qr(j,[B,n,i],this):B}generateTickLabels(e){let n,i,l;for(n=0,i=e.length;n<i;++n)l=e[n],l.label=this._tickFormatFunction(l.value,n,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const n=this._offsets,i=this.getDecimalForValue(e);return this.getPixelForDecimal((n.start+i)*n.factor)}getValueForPixel(e){const n=this._offsets,i=this.getDecimalForPixel(e)/n.factor-n.end;return this.min+i*(this.max-this.min)}_getLabelSize(e){const n=this.options.ticks,i=this.ctx.measureText(e).width,l=Bs(this.isHorizontal()?n.maxRotation:n.minRotation),d=Math.cos(l),f=Math.sin(l),o=this._resolveTickFontOptions(0).size;return{w:i*d+o*f,h:i*f+o*d}}_getLabelCapacity(e){const n=this.options.time,i=n.displayFormats,l=i[n.unit]||i.millisecond,d=this._tickFormatFunction(e,0,lT(this,[e],this._majorUnit),l),f=this._getLabelSize(d),o=Math.floor(this.isHorizontal()?this.width/f.w:this.height/f.h)-1;return o>0?o:1}getDataTimestamps(){let e=this._cache.data||[],n,i;if(e.length)return e;const l=this.getMatchingVisibleMetas();if(this._normalized&&l.length)return this._cache.data=l[0].controller.getAllParsedValues(this);for(n=0,i=l.length;n<i;++n)e=e.concat(l[n].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let n,i;if(e.length)return e;const l=this.getLabels();for(n=0,i=l.length;n<i;++n)e.push(oT(this,l[n]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return NC(e.sort(Tj))}}$m.id="time";$m.defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",major:{enabled:!1}}};function O0(t,e,n){let i=0,l=t.length-1,d,f,o,y;n?(e>=t[i].pos&&e<=t[l].pos&&({lo:i,hi:l}=ic(t,"pos",e)),{pos:d,time:o}=t[i],{pos:f,time:y}=t[l]):(e>=t[i].time&&e<=t[l].time&&({lo:i,hi:l}=ic(t,"time",e)),{time:d,pos:o}=t[i],{time:f,pos:y}=t[l]);const E=f-d;return E?o+(y-o)*(e-d)/E:o}class bx extends $m{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),n=this._table=this.buildLookupTable(e);this._minPos=O0(n,this.min),this._tableRange=O0(n,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:n,max:i}=this,l=[],d=[];let f,o,y,E,C;for(f=0,o=e.length;f<o;++f)E=e[f],E>=n&&E<=i&&l.push(E);if(l.length<2)return[{time:n,pos:0},{time:i,pos:1}];for(f=0,o=l.length;f<o;++f)C=l[f+1],y=l[f-1],E=l[f],Math.round((C+y)/2)!==E&&d.push({time:E,pos:f/(o-1)});return d}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const n=this.getDataTimestamps(),i=this.getLabelTimestamps();return n.length&&i.length?e=this.normalize(n.concat(i)):e=n.length?n:i,e=this._cache.all=e,e}getDecimalForValue(e){return(O0(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const n=this._offsets,i=this.getDecimalForPixel(e)/n.factor-n.end;return O0(this._table,i*this._tableRange+this._minPos,!0)}}bx.id="timeseries";bx.defaults=$m.defaults;var Mj=Object.freeze({__proto__:null,CategoryScale:w_,LinearScale:_x,LogarithmicScale:yx,RadialLinearScale:Um,TimeScale:$m,TimeSeriesScale:bx});const Aj=[Z9,EN,lj,Mj];var Ij=typeof global=="object"&&global&&global.Object===Object&&global,vS=Ij,Pj=typeof self=="object"&&self&&self.Object===Object&&self,Lj=vS||Pj||Function("return this")(),El=Lj,zj=El.Symbol,wu=zj,xS=Object.prototype,Oj=xS.hasOwnProperty,Dj=xS.toString,Ip=wu?wu.toStringTag:void 0;function Rj(t){var e=Oj.call(t,Ip),n=t[Ip];try{t[Ip]=void 0;var i=!0}catch{}var l=Dj.call(t);return i&&(e?t[Ip]=n:delete t[Ip]),l}var Bj=Object.prototype,Fj=Bj.toString;function Nj(t){return Fj.call(t)}var jj="[object Null]",Uj="[object Undefined]",cT=wu?wu.toStringTag:void 0;function Vm(t){return t==null?t===void 0?Uj:jj:cT&&cT in Object(t)?Rj(t):Nj(t)}function Bd(t){return t!=null&&typeof t=="object"}var $j=Array.isArray,uf=$j;function Gm(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var Vj="[object AsyncFunction]",Gj="[object Function]",qj="[object GeneratorFunction]",Hj="[object Proxy]";function wS(t){if(!Gm(t))return!1;var e=Vm(t);return e==Gj||e==qj||e==Vj||e==Hj}var Wj=El["__core-js_shared__"],cb=Wj,uT=function(){var t=/[^.]+$/.exec(cb&&cb.keys&&cb.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function Zj(t){return!!uT&&uT in t}var Xj=Function.prototype,Yj=Xj.toString;function Gd(t){if(t!=null){try{return Yj.call(t)}catch{}try{return t+""}catch{}}return""}var Kj=/[\\^$.*+?()[\]{}|]/g,Jj=/^\[object .+?Constructor\]$/,Qj=Function.prototype,tU=Object.prototype,eU=Qj.toString,nU=tU.hasOwnProperty,rU=RegExp("^"+eU.call(nU).replace(Kj,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function iU(t){if(!Gm(t)||Zj(t))return!1;var e=wS(t)?rU:Jj;return e.test(Gd(t))}function oU(t,e){return t==null?void 0:t[e]}function qd(t,e){var n=oU(t,e);return iU(n)?n:void 0}var aU=qd(El,"WeakMap"),sv=aU,dT=Object.create,sU=function(){function t(){}return function(e){if(!Gm(e))return{};if(dT)return dT(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}(),lU=sU;function cU(t,e){var n=-1,i=t.length;for(e||(e=Array(i));++n<i;)e[n]=t[n];return e}var uU=function(){try{var t=qd(Object,"defineProperty");return t({},"",{}),t}catch{}}(),hT=uU;function dU(t,e){for(var n=-1,i=t==null?0:t.length;++n<i&&e(t[n],n,t)!==!1;);return t}var hU=9007199254740991,fU=/^(?:0|[1-9]\d*)$/;function pU(t,e){var n=typeof t;return e=e==null?hU:e,!!e&&(n=="number"||n!="symbol"&&fU.test(t))&&t>-1&&t%1==0&&t<e}function ES(t,e,n){e=="__proto__"&&hT?hT(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function vx(t,e){return t===e||t!==t&&e!==e}var mU=Object.prototype,gU=mU.hasOwnProperty;function TS(t,e,n){var i=t[e];(!(gU.call(t,e)&&vx(i,n))||n===void 0&&!(e in t))&&ES(t,e,n)}function ay(t,e,n,i){var l=!n;n||(n={});for(var d=-1,f=e.length;++d<f;){var o=e[d],y=i?i(n[o],t[o],o,n,t):void 0;y===void 0&&(y=t[o]),l?ES(n,o,y):TS(n,o,y)}return n}var _U=9007199254740991;function kS(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=_U}function xx(t){return t!=null&&kS(t.length)&&!wS(t)}var yU=Object.prototype;function sy(t){var e=t&&t.constructor,n=typeof e=="function"&&e.prototype||yU;return t===n}function bU(t,e){for(var n=-1,i=Array(t);++n<t;)i[n]=e(n);return i}var vU="[object Arguments]";function fT(t){return Bd(t)&&Vm(t)==vU}var CS=Object.prototype,xU=CS.hasOwnProperty,wU=CS.propertyIsEnumerable,EU=fT(function(){return arguments}())?fT:function(t){return Bd(t)&&xU.call(t,"callee")&&!wU.call(t,"callee")},SS=EU;function TU(){return!1}var MS=typeof exports=="object"&&exports&&!exports.nodeType&&exports,pT=MS&&typeof module=="object"&&module&&!module.nodeType&&module,kU=pT&&pT.exports===MS,mT=kU?El.Buffer:void 0,CU=mT?mT.isBuffer:void 0,SU=CU||TU,Tm=SU,MU="[object Arguments]",AU="[object Array]",IU="[object Boolean]",PU="[object Date]",LU="[object Error]",zU="[object Function]",OU="[object Map]",DU="[object Number]",RU="[object Object]",BU="[object RegExp]",FU="[object Set]",NU="[object String]",jU="[object WeakMap]",UU="[object ArrayBuffer]",$U="[object DataView]",VU="[object Float32Array]",GU="[object Float64Array]",qU="[object Int8Array]",HU="[object Int16Array]",WU="[object Int32Array]",ZU="[object Uint8Array]",XU="[object Uint8ClampedArray]",YU="[object Uint16Array]",KU="[object Uint32Array]",ci={};ci[VU]=ci[GU]=ci[qU]=ci[HU]=ci[WU]=ci[ZU]=ci[XU]=ci[YU]=ci[KU]=!0;ci[MU]=ci[AU]=ci[UU]=ci[IU]=ci[$U]=ci[PU]=ci[LU]=ci[zU]=ci[OU]=ci[DU]=ci[RU]=ci[BU]=ci[FU]=ci[NU]=ci[jU]=!1;function JU(t){return Bd(t)&&kS(t.length)&&!!ci[Vm(t)]}function wx(t){return function(e){return t(e)}}var AS=typeof exports=="object"&&exports&&!exports.nodeType&&exports,rm=AS&&typeof module=="object"&&module&&!module.nodeType&&module,QU=rm&&rm.exports===AS,ub=QU&&vS.process,t$=function(){try{var t=rm&&rm.require&&rm.require("util").types;return t||ub&&ub.binding&&ub.binding("util")}catch{}}(),df=t$,gT=df&&df.isTypedArray,e$=gT?wx(gT):JU,Ex=e$,n$=Object.prototype,r$=n$.hasOwnProperty;function IS(t,e){var n=uf(t),i=!n&&SS(t),l=!n&&!i&&Tm(t),d=!n&&!i&&!l&&Ex(t),f=n||i||l||d,o=f?bU(t.length,String):[],y=o.length;for(var E in t)(e||r$.call(t,E))&&!(f&&(E=="length"||l&&(E=="offset"||E=="parent")||d&&(E=="buffer"||E=="byteLength"||E=="byteOffset")||pU(E,y)))&&o.push(E);return o}function PS(t,e){return function(n){return t(e(n))}}var i$=PS(Object.keys,Object),o$=i$,a$=Object.prototype,s$=a$.hasOwnProperty;function LS(t){if(!sy(t))return o$(t);var e=[];for(var n in Object(t))s$.call(t,n)&&n!="constructor"&&e.push(n);return e}function Tx(t){return xx(t)?IS(t):LS(t)}function l$(t){var e=[];if(t!=null)for(var n in Object(t))e.push(n);return e}var c$=Object.prototype,u$=c$.hasOwnProperty;function d$(t){if(!Gm(t))return l$(t);var e=sy(t),n=[];for(var i in t)i=="constructor"&&(e||!u$.call(t,i))||n.push(i);return n}function kx(t){return xx(t)?IS(t,!0):d$(t)}var h$=qd(Object,"create"),km=h$;function f$(){this.__data__=km?km(null):{},this.size=0}function p$(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var m$="__lodash_hash_undefined__",g$=Object.prototype,_$=g$.hasOwnProperty;function y$(t){var e=this.__data__;if(km){var n=e[t];return n===m$?void 0:n}return _$.call(e,t)?e[t]:void 0}var b$=Object.prototype,v$=b$.hasOwnProperty;function x$(t){var e=this.__data__;return km?e[t]!==void 0:v$.call(e,t)}var w$="__lodash_hash_undefined__";function E$(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=km&&e===void 0?w$:e,this}function Fd(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}Fd.prototype.clear=f$;Fd.prototype.delete=p$;Fd.prototype.get=y$;Fd.prototype.has=x$;Fd.prototype.set=E$;function T$(){this.__data__=[],this.size=0}function ly(t,e){for(var n=t.length;n--;)if(vx(t[n][0],e))return n;return-1}var k$=Array.prototype,C$=k$.splice;function S$(t){var e=this.__data__,n=ly(e,t);if(n<0)return!1;var i=e.length-1;return n==i?e.pop():C$.call(e,n,1),--this.size,!0}function M$(t){var e=this.__data__,n=ly(e,t);return n<0?void 0:e[n][1]}function A$(t){return ly(this.__data__,t)>-1}function I$(t,e){var n=this.__data__,i=ly(n,t);return i<0?(++this.size,n.push([t,e])):n[i][1]=e,this}function fc(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}fc.prototype.clear=T$;fc.prototype.delete=S$;fc.prototype.get=M$;fc.prototype.has=A$;fc.prototype.set=I$;var P$=qd(El,"Map"),Cm=P$;function L$(){this.size=0,this.__data__={hash:new Fd,map:new(Cm||fc),string:new Fd}}function z$(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function cy(t,e){var n=t.__data__;return z$(e)?n[typeof e=="string"?"string":"hash"]:n.map}function O$(t){var e=cy(this,t).delete(t);return this.size-=e?1:0,e}function D$(t){return cy(this,t).get(t)}function R$(t){return cy(this,t).has(t)}function B$(t,e){var n=cy(this,t),i=n.size;return n.set(t,e),this.size+=n.size==i?0:1,this}function Hd(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}Hd.prototype.clear=L$;Hd.prototype.delete=O$;Hd.prototype.get=D$;Hd.prototype.has=R$;Hd.prototype.set=B$;function zS(t,e){for(var n=-1,i=e.length,l=t.length;++n<i;)t[l+n]=e[n];return t}var F$=PS(Object.getPrototypeOf,Object),OS=F$;function N$(){this.__data__=new fc,this.size=0}function j$(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}function U$(t){return this.__data__.get(t)}function $$(t){return this.__data__.has(t)}var V$=200;function G$(t,e){var n=this.__data__;if(n instanceof fc){var i=n.__data__;if(!Cm||i.length<V$-1)return i.push([t,e]),this.size=++n.size,this;n=this.__data__=new Hd(i)}return n.set(t,e),this.size=n.size,this}function ac(t){var e=this.__data__=new fc(t);this.size=e.size}ac.prototype.clear=N$;ac.prototype.delete=j$;ac.prototype.get=U$;ac.prototype.has=$$;ac.prototype.set=G$;function q$(t,e){return t&&ay(e,Tx(e),t)}function H$(t,e){return t&&ay(e,kx(e),t)}var DS=typeof exports=="object"&&exports&&!exports.nodeType&&exports,_T=DS&&typeof module=="object"&&module&&!module.nodeType&&module,W$=_T&&_T.exports===DS,yT=W$?El.Buffer:void 0,bT=yT?yT.allocUnsafe:void 0;function Z$(t,e){if(e)return t.slice();var n=t.length,i=bT?bT(n):new t.constructor(n);return t.copy(i),i}function X$(t,e){for(var n=-1,i=t==null?0:t.length,l=0,d=[];++n<i;){var f=t[n];e(f,n,t)&&(d[l++]=f)}return d}function RS(){return[]}var Y$=Object.prototype,K$=Y$.propertyIsEnumerable,vT=Object.getOwnPropertySymbols,J$=vT?function(t){return t==null?[]:(t=Object(t),X$(vT(t),function(e){return K$.call(t,e)}))}:RS,Cx=J$;function Q$(t,e){return ay(t,Cx(t),e)}var tV=Object.getOwnPropertySymbols,eV=tV?function(t){for(var e=[];t;)zS(e,Cx(t)),t=OS(t);return e}:RS,BS=eV;function nV(t,e){return ay(t,BS(t),e)}function FS(t,e,n){var i=e(t);return uf(t)?i:zS(i,n(t))}function lv(t){return FS(t,Tx,Cx)}function rV(t){return FS(t,kx,BS)}var iV=qd(El,"DataView"),cv=iV,oV=qd(El,"Promise"),uv=oV,aV=qd(El,"Set"),dv=aV,xT="[object Map]",sV="[object Object]",wT="[object Promise]",ET="[object Set]",TT="[object WeakMap]",kT="[object DataView]",lV=Gd(cv),cV=Gd(Cm),uV=Gd(uv),dV=Gd(dv),hV=Gd(sv),Ed=Vm;(cv&&Ed(new cv(new ArrayBuffer(1)))!=kT||Cm&&Ed(new Cm)!=xT||uv&&Ed(uv.resolve())!=wT||dv&&Ed(new dv)!=ET||sv&&Ed(new sv)!=TT)&&(Ed=function(t){var e=Vm(t),n=e==sV?t.constructor:void 0,i=n?Gd(n):"";if(i)switch(i){case lV:return kT;case cV:return xT;case uV:return wT;case dV:return ET;case hV:return TT}return e});var hf=Ed,fV=Object.prototype,pV=fV.hasOwnProperty;function mV(t){var e=t.length,n=new t.constructor(e);return e&&typeof t[0]=="string"&&pV.call(t,"index")&&(n.index=t.index,n.input=t.input),n}var gV=El.Uint8Array,T_=gV;function Sx(t){var e=new t.constructor(t.byteLength);return new T_(e).set(new T_(t)),e}function _V(t,e){var n=e?Sx(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}var yV=/\w*$/;function bV(t){var e=new t.constructor(t.source,yV.exec(t));return e.lastIndex=t.lastIndex,e}var CT=wu?wu.prototype:void 0,ST=CT?CT.valueOf:void 0;function vV(t){return ST?Object(ST.call(t)):{}}function xV(t,e){var n=e?Sx(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}var wV="[object Boolean]",EV="[object Date]",TV="[object Map]",kV="[object Number]",CV="[object RegExp]",SV="[object Set]",MV="[object String]",AV="[object Symbol]",IV="[object ArrayBuffer]",PV="[object DataView]",LV="[object Float32Array]",zV="[object Float64Array]",OV="[object Int8Array]",DV="[object Int16Array]",RV="[object Int32Array]",BV="[object Uint8Array]",FV="[object Uint8ClampedArray]",NV="[object Uint16Array]",jV="[object Uint32Array]";function UV(t,e,n){var i=t.constructor;switch(e){case IV:return Sx(t);case wV:case EV:return new i(+t);case PV:return _V(t,n);case LV:case zV:case OV:case DV:case RV:case BV:case FV:case NV:case jV:return xV(t,n);case TV:return new i;case kV:case MV:return new i(t);case CV:return bV(t);case SV:return new i;case AV:return vV(t)}}function $V(t){return typeof t.constructor=="function"&&!sy(t)?lU(OS(t)):{}}var VV="[object Map]";function GV(t){return Bd(t)&&hf(t)==VV}var MT=df&&df.isMap,qV=MT?wx(MT):GV,HV=qV,WV="[object Set]";function ZV(t){return Bd(t)&&hf(t)==WV}var AT=df&&df.isSet,XV=AT?wx(AT):ZV,YV=XV,KV=1,JV=2,QV=4,NS="[object Arguments]",tG="[object Array]",eG="[object Boolean]",nG="[object Date]",rG="[object Error]",jS="[object Function]",iG="[object GeneratorFunction]",oG="[object Map]",aG="[object Number]",US="[object Object]",sG="[object RegExp]",lG="[object Set]",cG="[object String]",uG="[object Symbol]",dG="[object WeakMap]",hG="[object ArrayBuffer]",fG="[object DataView]",pG="[object Float32Array]",mG="[object Float64Array]",gG="[object Int8Array]",_G="[object Int16Array]",yG="[object Int32Array]",bG="[object Uint8Array]",vG="[object Uint8ClampedArray]",xG="[object Uint16Array]",wG="[object Uint32Array]",Jr={};Jr[NS]=Jr[tG]=Jr[hG]=Jr[fG]=Jr[eG]=Jr[nG]=Jr[pG]=Jr[mG]=Jr[gG]=Jr[_G]=Jr[yG]=Jr[oG]=Jr[aG]=Jr[US]=Jr[sG]=Jr[lG]=Jr[cG]=Jr[uG]=Jr[bG]=Jr[vG]=Jr[xG]=Jr[wG]=!0;Jr[rG]=Jr[jS]=Jr[dG]=!1;function X0(t,e,n,i,l,d){var f,o=e&KV,y=e&JV,E=e&QV;if(n&&(f=l?n(t,i,l,d):n(t)),f!==void 0)return f;if(!Gm(t))return t;var C=uf(t);if(C){if(f=mV(t),!o)return cU(t,f)}else{var A=hf(t),P=A==jS||A==iG;if(Tm(t))return Z$(t,o);if(A==US||A==NS||P&&!l){if(f=y||P?{}:$V(t),!o)return y?nV(t,H$(f,t)):Q$(t,q$(f,t))}else{if(!Jr[A])return l?t:{};f=UV(t,A,o)}}d||(d=new ac);var B=d.get(t);if(B)return B;d.set(t,f),YV(t)?t.forEach(function(W){f.add(X0(W,e,n,W,t,d))}):HV(t)&&t.forEach(function(W,H){f.set(H,X0(W,e,n,H,t,d))});var j=E?y?rV:lv:y?kx:Tx,Z=C?void 0:j(t);return dU(Z||t,function(W,H){Z&&(H=W,W=t[H]),TS(f,H,X0(W,e,n,H,t,d))}),f}var EG=1,TG=4;function Pp(t){return X0(t,EG|TG)}var kG="__lodash_hash_undefined__";function CG(t){return this.__data__.set(t,kG),this}function SG(t){return this.__data__.has(t)}function k_(t){var e=-1,n=t==null?0:t.length;for(this.__data__=new Hd;++e<n;)this.add(t[e])}k_.prototype.add=k_.prototype.push=CG;k_.prototype.has=SG;function MG(t,e){for(var n=-1,i=t==null?0:t.length;++n<i;)if(e(t[n],n,t))return!0;return!1}function AG(t,e){return t.has(e)}var IG=1,PG=2;function $S(t,e,n,i,l,d){var f=n&IG,o=t.length,y=e.length;if(o!=y&&!(f&&y>o))return!1;var E=d.get(t),C=d.get(e);if(E&&C)return E==e&&C==t;var A=-1,P=!0,B=n&PG?new k_:void 0;for(d.set(t,e),d.set(e,t);++A<o;){var j=t[A],Z=e[A];if(i)var W=f?i(Z,j,A,e,t,d):i(j,Z,A,t,e,d);if(W!==void 0){if(W)continue;P=!1;break}if(B){if(!MG(e,function(H,V){if(!AG(B,V)&&(j===H||l(j,H,n,i,d)))return B.push(V)})){P=!1;break}}else if(!(j===Z||l(j,Z,n,i,d))){P=!1;break}}return d.delete(t),d.delete(e),P}function LG(t){var e=-1,n=Array(t.size);return t.forEach(function(i,l){n[++e]=[l,i]}),n}function zG(t){var e=-1,n=Array(t.size);return t.forEach(function(i){n[++e]=i}),n}var OG=1,DG=2,RG="[object Boolean]",BG="[object Date]",FG="[object Error]",NG="[object Map]",jG="[object Number]",UG="[object RegExp]",$G="[object Set]",VG="[object String]",GG="[object Symbol]",qG="[object ArrayBuffer]",HG="[object DataView]",IT=wu?wu.prototype:void 0,db=IT?IT.valueOf:void 0;function WG(t,e,n,i,l,d,f){switch(n){case HG:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case qG:return!(t.byteLength!=e.byteLength||!d(new T_(t),new T_(e)));case RG:case BG:case jG:return vx(+t,+e);case FG:return t.name==e.name&&t.message==e.message;case UG:case VG:return t==e+"";case NG:var o=LG;case $G:var y=i&OG;if(o||(o=zG),t.size!=e.size&&!y)return!1;var E=f.get(t);if(E)return E==e;i|=DG,f.set(t,e);var C=$S(o(t),o(e),i,l,d,f);return f.delete(t),C;case GG:if(db)return db.call(t)==db.call(e)}return!1}var ZG=1,XG=Object.prototype,YG=XG.hasOwnProperty;function KG(t,e,n,i,l,d){var f=n&ZG,o=lv(t),y=o.length,E=lv(e),C=E.length;if(y!=C&&!f)return!1;for(var A=y;A--;){var P=o[A];if(!(f?P in e:YG.call(e,P)))return!1}var B=d.get(t),j=d.get(e);if(B&&j)return B==e&&j==t;var Z=!0;d.set(t,e),d.set(e,t);for(var W=f;++A<y;){P=o[A];var H=t[P],V=e[P];if(i)var tt=f?i(V,H,P,e,t,d):i(H,V,P,t,e,d);if(!(tt===void 0?H===V||l(H,V,n,i,d):tt)){Z=!1;break}W||(W=P=="constructor")}if(Z&&!W){var ft=t.constructor,et=e.constructor;ft!=et&&"constructor"in t&&"constructor"in e&&!(typeof ft=="function"&&ft instanceof ft&&typeof et=="function"&&et instanceof et)&&(Z=!1)}return d.delete(t),d.delete(e),Z}var JG=1,PT="[object Arguments]",LT="[object Array]",D0="[object Object]",QG=Object.prototype,zT=QG.hasOwnProperty;function tq(t,e,n,i,l,d){var f=uf(t),o=uf(e),y=f?LT:hf(t),E=o?LT:hf(e);y=y==PT?D0:y,E=E==PT?D0:E;var C=y==D0,A=E==D0,P=y==E;if(P&&Tm(t)){if(!Tm(e))return!1;f=!0,C=!1}if(P&&!C)return d||(d=new ac),f||Ex(t)?$S(t,e,n,i,l,d):WG(t,e,y,n,i,l,d);if(!(n&JG)){var B=C&&zT.call(t,"__wrapped__"),j=A&&zT.call(e,"__wrapped__");if(B||j){var Z=B?t.value():t,W=j?e.value():e;return d||(d=new ac),l(Z,W,n,i,d)}}return P?(d||(d=new ac),KG(t,e,n,i,l,d)):!1}function VS(t,e,n,i,l){return t===e?!0:t==null||e==null||!Bd(t)&&!Bd(e)?t!==t&&e!==e:tq(t,e,n,i,VS,l)}var eq="[object Map]",nq="[object Set]",rq=Object.prototype,iq=rq.hasOwnProperty;function oq(t){if(t==null)return!0;if(xx(t)&&(uf(t)||typeof t=="string"||typeof t.splice=="function"||Tm(t)||Ex(t)||SS(t)))return!t.length;var e=hf(t);if(e==eq||e==nq)return!t.size;if(sy(t))return!LS(t).length;for(var n in t)if(iq.call(t,n))return!1;return!0}function OT(t,e){return VS(t,e)}var aq=Object.defineProperty,sq=Object.defineProperties,lq=Object.getOwnPropertyDescriptors,DT=Object.getOwnPropertySymbols,cq=Object.prototype.hasOwnProperty,uq=Object.prototype.propertyIsEnumerable,RT=(t,e,n)=>e in t?aq(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,dq=(t,e)=>{for(var n in e||(e={}))cq.call(e,n)&&RT(t,n,e[n]);if(DT)for(var n of DT(e))uq.call(e,n)&&RT(t,n,e[n]);return t},hq=(t,e)=>sq(t,lq(e));function fq(t){return(t.match(/[a-zA-Z0-9]+/g)||[]).map(e=>`${e.charAt(0).toUpperCase()}${e.slice(1)}`).join("")}var Iu=(t,e)=>{const n={chartData:{type:Object,required:!0},options:{type:Object,required:!1},chartId:{default:t,type:String},width:{default:400,type:Number},height:{default:400,type:Number},cssClasses:{type:String,default:""},styles:{type:Object},plugins:{type:Array,default:()=>[]},onLabelsUpdate:{type:Function},onChartUpdate:{type:Function},onChartDestroy:{type:Function},onChartRender:{type:Function}},i=fq(t);return gr({name:i,props:n,emits:{"labels:update":()=>!0,"chart:update":l=>!0,"chart:destroy":()=>!0,"chart:render":l=>!0},setup(l,{emit:d,expose:f}){const o=so(null),y=`${l.chartId}`;let E=e_(null);$r(()=>l.chartData,C,{deep:!0}),$r(()=>l.options,W=>{E.value&&W&&(E.value.options=Pp(W),j())},{deep:!0});function C(W){if(E.value){let H=E.value;OT(W.labels,E.value.data.labels)||(H.data.labels=W.labels,P()),OT(W.datasets,E.value.data.datasets)||W.datasets.forEach((V,tt)=>{var ft,et;if(oq(V))H.data.datasets=[];else{const Pt=Pp(H.data),Rt=Object.keys((et=(ft=Pt.datasets)==null?void 0:ft[tt])!=null?et:{}),zt=Object.keys(V);Rt.filter(oe=>oe!=="_meta"&&zt.indexOf(oe)===-1).forEach(oe=>{H.data.datasets[tt]&&delete H.data.datasets[tt][oe]});for(const oe in V){const ge=Pp(V[oe]);H.data.datasets[tt]||(H.data.datasets[tt]={}),V.hasOwnProperty(oe)&&ge!=null&&H&&(H.data.datasets[tt][oe]=ge)}}}),j()}else E.value&&Z(),A()}function A(){o.value?(E.value=new ey(o.value,{data:Pp(l.chartData),type:e,options:Pp(l.options),plugins:l.plugins}),B()):console.error(`Error on component ${i}, canvas cannot be rendered. Check if the render appends server-side`)}function P(){d("labels:update"),l.onLabelsUpdate&&l.onLabelsUpdate()}function B(){E.value&&(d("chart:render",E.value),l.onChartRender&&l.onChartRender(E.value))}function j(){E.value&&(E.value.update(),d("chart:update",E.value),l.onChartUpdate&&l.onChartUpdate(E.value))}function Z(){E.value&&E.value.destroy(),d("chart:destroy"),l.onChartDestroy&&l.onChartDestroy()}return ji(A),Dm(()=>{E.value&&E.value.destroy()}),f({canvasRef:o,renderChart:A,chartInstance:E,canvasId:y,update:j}),()=>Uo("div",{style:hq(dq({maxWidth:"100%"},l.styles),{position:"relative"}),class:l.cssClasses},[Uo("canvas",{style:{maxWidth:"100%",maxHeight:"100%"},id:y,width:l.width,height:l.height,ref:o})])}})};Iu("bar-chart","bar");Iu("doughnut-chart","doughnut");Iu("line-chart","line");Iu("pie-chart","pie");Iu("polar-chart","polarArea");Iu("radar-chart","radar");Iu("bubble-chart","bubble");var pq=Iu("scatter-chart","scatter");ey.register(...Aj);const mq={name:"TwitterUserCard",components:{Card:ex,ScatterChart:pq},props:{user:Object},data(){return{activeDataset:"followers",mode:"raw"}},methods:{formatNumber(t){return Intl.NumberFormat("en-NZ").format(t)}},computed:{formattedDate(){return e7(x7(this.bill.date_modified,"yyyy-MM-dd",new Date),"d.M.yyyy")},displayedDataset(){return this.activeDataset==="followers"?this.followersDataset:this.activeDataset==="following"?this.followingDataset:this.activeDataset==="tweets"?this.tweetsDataset:null},dailyNumberChange(){var t=this.displayedDataset.data,e=[],n=t[0].x,i=t[0].y;t.forEach(d=>{if(d.x-432e5>n){var f=d.y-i,o=d.x-n,y=864e5*f/o;e.push({x:d.x,y}),i=d.y,n=d.x}});var l={label:this.displayedDataset.label+" - Numeric daily change",borderColor:"#58787f",fill:!1,showLine:!0,data:e};return l},dailyPercentChange(){var t=this.displayedDataset.data,e=[],n=t[0].x,i=t[0].y;t.forEach(d=>{if(d.x-432e5>n){var f=d.y-i,o=d.x-n,y=864e5*f/o;e.push({x:d.x,y:y/i*100}),i=d.y,n=d.x}});var l={label:this.displayedDataset.label+" - Percentage daily change",borderColor:"#58787f",fill:!1,showLine:!0,data:e};return l},chartData(){return this.mode==="percent_change"?{datasets:[this.dailyPercentChange]}:this.mode==="number_change"?{datasets:[this.dailyNumberChange]}:{datasets:[this.displayedDataset]}},chartOptions(){return{scales:{x:{ticks:{callback:function(t,e,n){return t}}}},elements:{point:{radius:2}},plugins:{tooltip:{callbacks:{label:function(t){var e=["",""];return t.parsed.y!==null&&(e[0]=Intl.NumberFormat("en-NZ").format(t.parsed.y)),t.parsed.x!==null&&(e[1]=t.parsed.x),e}}},legend:{display:!1}}}},followersDataset(){var t=[];this.user.time_series.forEach(n=>{t.push({x:Date.parse(n.timestamp),y:n.followers_count})});var e={label:"Followers",borderColor:"#58787f",fill:!1,showLine:!0,data:t};return e},followingDataset(){var t=[];this.user.time_series.forEach(n=>{t.push({x:Date.parse(n.timestamp),y:n.following_count})});var e={label:"Following",borderColor:"#58787f",fill:!1,showLine:!0,data:t};return e},tweetsDataset(){var t=[];this.user.time_series.forEach(n=>{t.push({x:Date.parse(n.timestamp),y:n.tweet_count})});var e={label:"Tweets",borderColor:"#58787f",fill:!1,showLine:!0,data:t};return e}}},gq=Ee("h5",null,"Twitter account",-1),_q=["href"],yq=Ee("hr",null,null,-1),bq={class:"row"},vq={class:"col-4 text-center"},xq=Ee("h6",{class:"text-muted text-uppercase"},"Followers",-1),wq={class:"col-4 text-center"},Eq=Ee("h6",{class:"text-muted text-uppercase"},"Following",-1),Tq={class:"col-4 text-center"},kq=Ee("h6",{class:"text-muted text-uppercase"},"Tweets",-1),Cq=Ee("hr",null,null,-1),Sq=Ee("h6",null,"Chart settings",-1),Mq={class:"row"},Aq={class:"col-12 col-md-6"},Iq=Ee("option",{selected:"",value:"followers"},"Followers",-1),Pq=Ee("option",{value:"following"},"Following",-1),Lq=Ee("option",{value:"tweets"},"Tweets",-1),zq=[Iq,Pq,Lq],Oq={class:"col-12 col-md-6 mb-3"},Dq=Ee("option",{selected:"",value:"raw"},"Raw counts",-1),Rq=Ee("option",{value:"percent_change"},"Percentage daily change",-1),Bq=Ee("option",{value:"number_change"},"Numeric daily change",-1),Fq=[Dq,Rq,Bq],Nq={key:1,class:"text-muted"};function jq(t,e,n,i,l,d){const f=ea("font-awesome-icon"),o=ea("ScatterChart"),y=ex;return wn(),_l(y,null,{default:Zr(()=>[gq,Ee("a",{href:n.user.profile_url,target:"_blank"},[Ee("h6",null,[ln(f,{icon:["fab","twitter"]}),Yr(" @"+Mi(n.user.username),1)])],8,_q),yq,Ee("div",bq,[Ee("div",vq,[Ee("h3",null,Mi(d.formatNumber(n.user.followers_count)),1),xq]),Ee("div",wq,[Ee("h3",null,Mi(d.formatNumber(n.user.following_count)),1),Eq]),Ee("div",Tq,[Ee("h3",null,Mi(d.formatNumber(n.user.tweet_count)),1),kq])]),Cq,Sq,Ee("div",Mq,[Ee("div",Aq,[Lb(Ee("select",{class:"form-select col-12 mb-3","aria-label":"Twitter metric type","onUpdate:modelValue":e[0]||(e[0]=E=>l.activeDataset=E)},zq,512),[[c5,l.activeDataset]])]),Ee("div",Oq,[Lb(Ee("select",{class:"form-select col-12","aria-label":"Twitter graph type","onUpdate:modelValue":e[1]||(e[1]=E=>l.mode=E)},Fq,512),[[c5,l.mode]])])]),n.user.time_series.length?(wn(),_l(o,{key:0,chartData:d.chartData,options:d.chartOptions},null,8,["chartData","options"])):es("",!0),l.mode==="number_change"?(wn(),$n("p",Nq,"Since measurements cannot be taken at exactly the same time each day, you may find that daily changes do not show as whole numbers; this is because they are calculated based on the growth over the actual interval between measurements.")):es("",!0)]),_:1})}var Met=ba(mq,[["render",jq]]);const R0=void 0,B0=void 0;const F0=void 0,N0=void 0;const j0=void 0,U0=void 0,Aet=$d("votes",{state(){return{items:[]}},getters:{byID:t=>e=>t.items.find(n=>n.id.toString()===e)},actions:{async fetch(t){if(!this.byID(t)){var e=this;await Di(Ri+"votes/"+t+"/",{onResponse({request:n,response:i,options:l}){e.items.push(i._data)},onResponseError({request:n,response:i,options:l}){useNotificationsStore().postResponseError(i)},onRequestError({request:n,options:i,error:l}){useNotificationsStore().addToast("Error fetching resource (request)",l)}})}}}}),$0=void 0;const V0=void 0;var Uq=[{name:"about",path:"/about",file:"/Users/jcm/Local Documents/GitHub/wheretheystand-client/wts-client/pages/about.vue",children:[],meta:h0,alias:(h0==null?void 0:h0.alias)||[],component:()=>oo(()=>import("./about-0559bf6f.mjs"),["about-0559bf6f.mjs","PageHeader-953c8854.mjs","ExternalLinkButton-793aa0d9.mjs"])},{name:"bills-id",path:"/bills/:id",file:"/Users/jcm/Local Documents/GitHub/wheretheystand-client/wts-client/pages/bills/[id]/index.vue",children:[],meta:f0,alias:(f0==null?void 0:f0.alias)||[],component:()=>oo(()=>import("./index-2d1ef9cb.mjs"),["index-2d1ef9cb.mjs","PageHeader-953c8854.mjs","VoteSummary-88b25d4d.mjs","PersonCard-945796f8.mjs","ColourDot-36430abb.mjs","index-f958d92a.mjs"])},{name:"bills",path:"/bills",file:"/Users/jcm/Local Documents/GitHub/wheretheystand-client/wts-client/pages/bills/index.vue",children:[],meta:p0,alias:(p0==null?void 0:p0.alias)||[],component:()=>oo(()=>import("./index-e769dcdc.mjs"),["index-e769dcdc.mjs","PageHeader-953c8854.mjs","Spinner-dfd0837a.mjs","index-f958d92a.mjs"])},{name:"electorates-id",path:"/electorates/:id",file:"/Users/jcm/Local Documents/GitHub/wheretheystand-client/wts-client/pages/electorates/[id]/index.vue",children:[],meta:m0,alias:(m0==null?void 0:m0.alias)||[],component:()=>oo(()=>import("./index-a7e3f591.mjs"),["index-a7e3f591.mjs","PageHeader-953c8854.mjs","PersonCard-945796f8.mjs","ColourDot-36430abb.mjs"])},{name:"electorates",path:"/electorates",file:"/Users/jcm/Local Documents/GitHub/wheretheystand-client/wts-client/pages/electorates/index.vue",children:[],meta:g0,alias:(g0==null?void 0:g0.alias)||[],component:()=>oo(()=>import("./index-45d24c33.mjs"),["index-45d24c33.mjs","PageHeader-953c8854.mjs","ExternalLinkButton-793aa0d9.mjs"])},{name:"index",path:"/",file:"/Users/jcm/Local Documents/GitHub/wheretheystand-client/wts-client/pages/index.vue",children:[],meta:_0,alias:(_0==null?void 0:_0.alias)||[],component:()=>oo(()=>import("./index-b50342d4.mjs"),["index-b50342d4.mjs","Spinner-dfd0837a.mjs","index-f958d92a.mjs"])},{path:"/parties/:id",file:"/Users/jcm/Local Documents/GitHub/wheretheystand-client/wts-client/pages/parties/[id].vue",children:[{name:"parties-id-documents",path:"documents",file:"/Users/jcm/Local Documents/GitHub/wheretheystand-client/wts-client/pages/parties/[id]/documents.vue",children:[],meta:b0,alias:(b0==null?void 0:b0.alias)||[],component:()=>oo(()=>import("./documents-7763830c.mjs"),[])},{name:"parties-id",path:"",file:"/Users/jcm/Local Documents/GitHub/wheretheystand-client/wts-client/pages/parties/[id]/index.vue",children:[],meta:v0,alias:(v0==null?void 0:v0.alias)||[],component:()=>oo(()=>import("./index-eead6a1a.mjs"),["index-eead6a1a.mjs","PersonList-0925a27a.mjs","ColourDot-36430abb.mjs"])}],meta:y0,alias:(y0==null?void 0:y0.alias)||[],component:()=>oo(()=>import("./_id_-e5773a90.mjs"),["_id_-e5773a90.mjs","PageHeader-953c8854.mjs"])},{name:"parties",path:"/parties",file:"/Users/jcm/Local Documents/GitHub/wheretheystand-client/wts-client/pages/parties/index.vue",children:[],meta:x0,alias:(x0==null?void 0:x0.alias)||[],component:()=>oo(()=>import("./index-9ca56e96.mjs"),["index-9ca56e96.mjs","PageHeader-953c8854.mjs","ExternalLinkButton-793aa0d9.mjs","PartyCard-efa31445.mjs"])},{path:"/people/:id",file:"/Users/jcm/Local Documents/GitHub/wheretheystand-client/wts-client/pages/people/[id].vue",children:[{name:"people-id-details",path:"details",file:"/Users/jcm/Local Documents/GitHub/wheretheystand-client/wts-client/pages/people/[id]/details.vue",children:[],meta:R0,alias:(R0==null?void 0:R0.alias)||[],component:()=>oo(()=>import("./details-a5ba0706.mjs"),["details-a5ba0706.mjs","DisplayControlButton-c07e4965.mjs","ColourDot-36430abb.mjs","ExternalLinkButton-793aa0d9.mjs"])},{name:"people-id-expenses",path:"expenses",file:"/Users/jcm/Local Documents/GitHub/wheretheystand-client/wts-client/pages/people/[id]/expenses.vue",children:[],meta:B0,alias:(B0==null?void 0:B0.alias)||[],component:()=>oo(()=>import("./expenses-e01a5227.mjs"),["expenses-e01a5227.mjs","Grid-054529ee.mjs"])},{name:"people-id",path:"",file:"/Users/jcm/Local Documents/GitHub/wheretheystand-client/wts-client/pages/people/[id]/index.vue",children:[],meta:F0,alias:(F0==null?void 0:F0.alias)||[],component:()=>oo(()=>import("./index-0f9bac25.mjs"),["index-0f9bac25.mjs","Spinner-dfd0837a.mjs","DisplayControlButton-c07e4965.mjs","index-f958d92a.mjs"])},{name:"people-id-interests",path:"interests",file:"/Users/jcm/Local Documents/GitHub/wheretheystand-client/wts-client/pages/people/[id]/interests.vue",children:[],meta:N0,alias:(N0==null?void 0:N0.alias)||[],component:()=>oo(()=>import("./interests-b12aed89.mjs"),["interests-b12aed89.mjs","ExternalLinkButton-793aa0d9.mjs"])}],meta:w0,alias:(w0==null?void 0:w0.alias)||[],component:()=>oo(()=>import("./_id_-65544a43.mjs"),["_id_-65544a43.mjs","PageHeader-953c8854.mjs"])},{name:"people",path:"/people",file:"/Users/jcm/Local Documents/GitHub/wheretheystand-client/wts-client/pages/people/index.vue",children:[],meta:j0,alias:(j0==null?void 0:j0.alias)||[],component:()=>oo(()=>import("./index-b9ac2a38.mjs"),["index-b9ac2a38.mjs","PageHeader-953c8854.mjs","PersonList-0925a27a.mjs","ColourDot-36430abb.mjs"])},{name:"terms",path:"/terms",file:"/Users/jcm/Local Documents/GitHub/wheretheystand-client/wts-client/pages/terms.vue",children:[],meta:U0,alias:(U0==null?void 0:U0.alias)||[],component:()=>oo(()=>import("./terms-fc1e01ea.mjs"),["terms-fc1e01ea.mjs","PageHeader-953c8854.mjs","Grid-054529ee.mjs"])},{name:"votes-id",path:"/votes/:id",file:"/Users/jcm/Local Documents/GitHub/wheretheystand-client/wts-client/pages/votes/[id]/index.vue",children:[],meta:$0,alias:($0==null?void 0:$0.alias)||[],component:()=>oo(()=>import("./index-01d5d22b.mjs"),["index-01d5d22b.mjs","PageHeader-953c8854.mjs","VoteSummary-88b25d4d.mjs","PartyCard-efa31445.mjs","PersonCard-945796f8.mjs","ColourDot-36430abb.mjs","PersonList-0925a27a.mjs","index-f958d92a.mjs"])},{name:"votes",path:"/votes",file:"/Users/jcm/Local Documents/GitHub/wheretheystand-client/wts-client/pages/votes/index.vue",children:[],meta:V0,alias:(V0==null?void 0:V0.alias)||[],component:()=>oo(()=>import("./index-156b919e.mjs"),["index-156b919e.mjs","PageHeader-953c8854.mjs","Spinner-dfd0837a.mjs","index-f958d92a.mjs"])}];const $q={};var Vq={...$q};const Gq=[],hb={};function qq(t,e){const{pathname:n,search:i,hash:l}=e,d=t.indexOf("#");if(d>-1){const o=l.includes(t.slice(d))?t.slice(d).length:1;let y=l.slice(o);return y[0]!=="/"&&(y="/"+y),h5(y,"")}return h5(n,t)+i+l}var Hq=yf(async t=>{t.vueApp.component("NuxtPage",H1),t.vueApp.component("NuxtNestedPage",H1),t.vueApp.component("NuxtChild",H1);const e=K4().app.baseURL,n=cD(e),i=qq(e,window.location),l=HD({...Vq,history:n,routes:Uq});t.vueApp.use(l);const d=e_(l.currentRoute.value);l.afterEach((A,P)=>{d.value=P}),Object.defineProperty(t.vueApp.config.globalProperties,"previousRoute",{get:()=>d.value});const f={};for(const A in l.currentRoute.value)f[A]=mr(()=>l.currentRoute.value[A]);const o=e_(l.resolve(i)),y=()=>{o.value=l.currentRoute.value};t.hook("page:finish",y),l.afterEach((A,P)=>{var B,j,Z,W;((j=(B=A.matched[0])==null?void 0:B.components)==null?void 0:j.default)===((W=(Z=P.matched[0])==null?void 0:Z.components)==null?void 0:W.default)&&y()});const E={};for(const A in o.value)E[A]=mr(()=>o.value[A]);t._route=ya(f),t._activeRoute=ya(E),t._middleware=t._middleware||{global:[],named:{}};const C=_m();try{await l.isReady()}catch(A){Cd(t,W0,[A])}return l.beforeEach(async(A,P)=>{var j;A.meta=ya(A.meta),t._processingMiddleware=!0;const B=new Set([...Gq,...t._middleware.global]);for(const Z of A.matched){const W=Z.meta.middleware;if(!!W)if(Array.isArray(W))for(const H of W)B.add(H);else B.add(W)}for(const Z of B){const W=typeof Z=="string"?t._middleware.named[Z]||await((j=hb[Z])==null?void 0:j.call(hb).then(V=>V.default||V)):Z;if(!W)throw new Error(`Unknown route middleware: '${Z}'.`);const H=await Cd(t,W,[A,P]);if(H||H===!1)return H}}),l.afterEach(async A=>{delete t._processingMiddleware,!t.isHydrating&&C.value&&await Cd(t,QD),A.matched.length===0&&Cd(t,W0,[oR({statusCode:404,statusMessage:`Page not found: ${A.fullPath}`})])}),t.hooks.hookOnce("app:created",async()=>{try{await l.replace({...l.resolve(i),name:void 0,force:!0})}catch(A){Cd(t,W0,[A])}}),{provide:{router:l}}});const Wq=(t,e)=>{const n=D7();t.vueApp.use(n),e("pinia",n),t.pinia=n,Rm(n),n._p.push(({store:i})=>{Object.defineProperty(i,"$nuxt",{value:t})}),t.nuxtState&&t.nuxtState.pinia&&(n.state.value=t.nuxtState.pinia)};var uy=function(){return typeof document!="undefined"&&typeof window!="undefined"},Zq=function(e,n){return new Promise(function(i,l){var d=document.head||document.getElementsByTagName("head")[0],f=document.createElement("script");if(f.async=!0,f.src=e,f.charset="utf-8",n){var o=document.createElement("link");o.href=n,o.rel="preconnect",d.appendChild(o)}d.appendChild(f),f.onload=i,f.onerror=l})},Xq=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Object.keys(n).forEach(function(i){e[i]=n[i]})},GS=ya({property:null,isEnabled:!0,disableScriptLoader:!1,useDebugger:!1,globalObjectName:"gtag",dataLayerName:"dataLayer",resourceURL:"https://www.googletagmanager.com/gtag/js",preconnectOrigin:"https://www.googletagmanager.com",customResource:null,appName:null,appId:null,appVersion:null}),Pu=function(){return jv(GS)},qS=mr(function(){var t=Pu(),e=t.property;if(!!e.value)return Array.isArray(e.value)?e.value.find(function(n){return n.default===!0})||e.value[0]:e.value}),Yq=mr(function(){var t=Pu(),e=t.property;return Boolean(e.value&&e.value.id!==null)}),Sm=mr(function(){var t=Pu(),e=t.property;return Array.isArray(e.value)?e.value:[e.value]}),Kq=mr(function(){var t=Pu(),e=t.isEnabled,n=qS.value;return Boolean(n&&n.id&&e.value)}),qm=function(){var t;if(!!uy()){for(var e=Pu(),n=e.globalObjectName,i=e.useDebugger,l=arguments.length,d=new Array(l),f=0;f<l;f++)d[f]=arguments[f];i.value&&console.warn("[vue-gtag] Debugger:",d),(t=window)[n.value].apply(t,d)}},Mx=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];Sm.value.forEach(function(i){qm.apply(void 0,["config",i.id].concat(e))})},Jq=function(t){Mx({custom_map:t})},Qq=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;!uy()||Sm.value.forEach(function(e){window["ga-disable-".concat(e.id)]=t})},Wd=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=Object.assign({},e);!n.send_to&&Sm.value.length>1&&(n.send_to=Sm.value.map(function(i){return i.id})),qm("event",t,n)},tH=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];Wd.apply(void 0,["exception"].concat(e))},eH=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];Mx.apply(void 0,["linker"].concat(e))},nH=function(t){var e={};typeof t=="string"?e={page_path:t,page_location:window.location.href}:e=t,typeof e.send_page_view=="undefined"&&(e.send_page_view=!0),Wd("page_view",e)},rH=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];Wd.apply(void 0,["purchase"].concat(e))},iH=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];Wd.apply(void 0,["refund"].concat(e))},oH=function(){for(var t=Pu(),e=t.appName,n=t.appId,i=t.appVersion,l=arguments.length,d=new Array(l),f=0;f<l;f++)d[f]=arguments[f];var o=d[0],y={};typeof o=="string"?y={screen_name:o}:y=o,y.app_name==null&&e.value!=null&&(y.app_name=e.value),y.app_id==null&&n.value!=null&&(y.app_id=n.value),y.app_version==null&&i.value!=null&&(y.app_version=i.value),Wd("screen_view",y)},aH=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];qm.apply(void 0,["set"].concat(e))},sH=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];Wd.apply(void 0,["timing_complete"].concat(e))},lH=Object.freeze({__proto__:null,config:Mx,customMap:Jq,disable:Qq,event:Wd,exception:tH,linker:eH,pageview:nH,purchase:rH,query:qm,refund:iH,screenview:oH,set:aH,time:sH}),BT=so(!1),FT=so(!1),cH=function(){var e=Pu(),n=e.disableScriptLoader,i=e.preconnectOrigin,l=e.resourceURL,d=e.dataLayerName;if(!(!uy()||!Yq.value||FT.value)){if(FT.value=!0,Sm.value.forEach(function(o){var y=Object.assign({send_page_view:!1},o.params);qm("config",o.id,y)}),n.value){BT.value=!0;return}var f="".concat(l.value,"?id=").concat(qS.value.id,"&l=").concat(d.value);Zq(f,i.value).then(function(){BT.value=!0})}},uH=function(){$r(function(){return Kq.value},function(e){return e&&cH()},{immediate:!0})},dH=function(){if(!!uy()){var t=Pu(),e=t.globalObjectName,n=t.dataLayerName;window[e.value]==null&&(window[n.value]=window[n.value]||[],window[e.value]=function(){window[n.value].push(arguments)}),window[e.value]("js",new Date)}};ya({template:null,useScreenview:!1,skipSamePath:!0});var hH={install:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Xq(GS,n),dH(),uH(),e.config.globalProperties.$gtag=lH}},NT=yf(t=>{t.vueApp.use(hH,{property:{id:"G-WBR7239726"}})});/*!
 * Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com
 * License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
 * Copyright 2022 Fonticons, Inc.
 */function jT(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),n.push.apply(n,i)}return n}function cn(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?jT(Object(n),!0).forEach(function(i){mH(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):jT(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function C_(t){return C_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},C_(t)}function fH(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function UT(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function pH(t,e,n){return e&&UT(t.prototype,e),n&&UT(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function mH(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ax(t,e){return _H(t)||bH(t,e)||HS(t,e)||xH()}function dy(t){return gH(t)||yH(t)||HS(t)||vH()}function gH(t){if(Array.isArray(t))return hv(t)}function _H(t){if(Array.isArray(t))return t}function yH(t){if(typeof Symbol!="undefined"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function bH(t,e){var n=t==null?null:typeof Symbol!="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var i=[],l=!0,d=!1,f,o;try{for(n=n.call(t);!(l=(f=n.next()).done)&&(i.push(f.value),!(e&&i.length===e));l=!0);}catch(y){d=!0,o=y}finally{try{!l&&n.return!=null&&n.return()}finally{if(d)throw o}}return i}}function HS(t,e){if(!!t){if(typeof t=="string")return hv(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return hv(t,e)}}function hv(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function vH(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xH(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var $T=function(){},Ix={},WS={},ZS=null,XS={mark:$T,measure:$T};try{typeof window!="undefined"&&(Ix=window),typeof document!="undefined"&&(WS=document),typeof MutationObserver!="undefined"&&(ZS=MutationObserver),typeof performance!="undefined"&&(XS=performance)}catch{}var wH=Ix.navigator||{},VT=wH.userAgent,GT=VT===void 0?"":VT,Eu=Ix,ui=WS,qT=ZS,G0=XS;Eu.document;var pc=!!ui.documentElement&&!!ui.head&&typeof ui.addEventListener=="function"&&typeof ui.createElement=="function",YS=~GT.indexOf("MSIE")||~GT.indexOf("Trident/"),cc="___FONT_AWESOME___",fv=16,KS="fa",JS="svg-inline--fa",Nd="data-fa-i2svg",pv="data-fa-pseudo-element",EH="data-fa-pseudo-element-pending",Px="data-prefix",Lx="data-icon",HT="fontawesome-i2svg",TH="async",kH=["HTML","HEAD","STYLE","SCRIPT"],QS=function(){try{return!0}catch{return!1}}(),zx={fas:"solid","fa-solid":"solid",far:"regular","fa-regular":"regular",fal:"light","fa-light":"light",fat:"thin","fa-thin":"thin",fad:"duotone","fa-duotone":"duotone",fab:"brands","fa-brands":"brands",fak:"kit","fa-kit":"kit",fa:"solid"},S_={solid:"fas",regular:"far",light:"fal",thin:"fat",duotone:"fad",brands:"fab",kit:"fak"},tM={fab:"fa-brands",fad:"fa-duotone",fak:"fa-kit",fal:"fa-light",far:"fa-regular",fas:"fa-solid",fat:"fa-thin"},CH={"fa-brands":"fab","fa-duotone":"fad","fa-kit":"fak","fa-light":"fal","fa-regular":"far","fa-solid":"fas","fa-thin":"fat"},SH=/fa[srltdbk\-\ ]/,eM="fa-layers-text",MH=/Font ?Awesome ?([56 ]*)(Solid|Regular|Light|Thin|Duotone|Brands|Free|Pro|Kit)?.*/i,AH={900:"fas",400:"far",normal:"far",300:"fal",100:"fat"},nM=[1,2,3,4,5,6,7,8,9,10],IH=nM.concat([11,12,13,14,15,16,17,18,19,20]),PH=["class","data-prefix","data-icon","data-fa-transform","data-fa-mask"],Md={GROUP:"duotone-group",SWAP_OPACITY:"swap-opacity",PRIMARY:"primary",SECONDARY:"secondary"},LH=[].concat(dy(Object.keys(S_)),["2xs","xs","sm","lg","xl","2xl","beat","border","fade","beat-fade","bounce","flip-both","flip-horizontal","flip-vertical","flip","fw","inverse","layers-counter","layers-text","layers","li","pull-left","pull-right","pulse","rotate-180","rotate-270","rotate-90","rotate-by","shake","spin-pulse","spin-reverse","spin","stack-1x","stack-2x","stack","ul",Md.GROUP,Md.SWAP_OPACITY,Md.PRIMARY,Md.SECONDARY]).concat(nM.map(function(t){return"".concat(t,"x")})).concat(IH.map(function(t){return"w-".concat(t)})),rM=Eu.FontAwesomeConfig||{};function zH(t){var e=ui.querySelector("script["+t+"]");if(e)return e.getAttribute(t)}function OH(t){return t===""?!0:t==="false"?!1:t==="true"?!0:t}if(ui&&typeof ui.querySelector=="function"){var DH=[["data-family-prefix","familyPrefix"],["data-style-default","styleDefault"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]];DH.forEach(function(t){var e=Ax(t,2),n=e[0],i=e[1],l=OH(zH(n));l!=null&&(rM[i]=l)})}var RH={familyPrefix:KS,styleDefault:"solid",replacementClass:JS,autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0},im=cn(cn({},RH),rM);im.autoReplaceSvg||(im.observeMutations=!1);var Sn={};Object.keys(im).forEach(function(t){Object.defineProperty(Sn,t,{enumerable:!0,set:function(n){im[t]=n,Y0.forEach(function(i){return i(Sn)})},get:function(){return im[t]}})});Eu.FontAwesomeConfig=Sn;var Y0=[];function BH(t){return Y0.push(t),function(){Y0.splice(Y0.indexOf(t),1)}}var iu=fv,gl={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1};function FH(t){if(!(!t||!pc)){var e=ui.createElement("style");e.setAttribute("type","text/css"),e.innerHTML=t;for(var n=ui.head.childNodes,i=null,l=n.length-1;l>-1;l--){var d=n[l],f=(d.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(f)>-1&&(i=d)}return ui.head.insertBefore(e,i),t}}var NH="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";function Mm(){for(var t=12,e="";t-- >0;)e+=NH[Math.random()*62|0];return e}function xf(t){for(var e=[],n=(t||[]).length>>>0;n--;)e[n]=t[n];return e}function Ox(t){return t.classList?xf(t.classList):(t.getAttribute("class")||"").split(" ").filter(function(e){return e})}function iM(t){return"".concat(t).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function jH(t){return Object.keys(t||{}).reduce(function(e,n){return e+"".concat(n,'="').concat(iM(t[n]),'" ')},"").trim()}function hy(t){return Object.keys(t||{}).reduce(function(e,n){return e+"".concat(n,": ").concat(t[n].trim(),";")},"")}function Dx(t){return t.size!==gl.size||t.x!==gl.x||t.y!==gl.y||t.rotate!==gl.rotate||t.flipX||t.flipY}function UH(t){var e=t.transform,n=t.containerWidth,i=t.iconWidth,l={transform:"translate(".concat(n/2," 256)")},d="translate(".concat(e.x*32,", ").concat(e.y*32,") "),f="scale(".concat(e.size/16*(e.flipX?-1:1),", ").concat(e.size/16*(e.flipY?-1:1),") "),o="rotate(".concat(e.rotate," 0 0)"),y={transform:"".concat(d," ").concat(f," ").concat(o)},E={transform:"translate(".concat(i/2*-1," -256)")};return{outer:l,inner:y,path:E}}function $H(t){var e=t.transform,n=t.width,i=n===void 0?fv:n,l=t.height,d=l===void 0?fv:l,f=t.startCentered,o=f===void 0?!1:f,y="";return o&&YS?y+="translate(".concat(e.x/iu-i/2,"em, ").concat(e.y/iu-d/2,"em) "):o?y+="translate(calc(-50% + ".concat(e.x/iu,"em), calc(-50% + ").concat(e.y/iu,"em)) "):y+="translate(".concat(e.x/iu,"em, ").concat(e.y/iu,"em) "),y+="scale(".concat(e.size/iu*(e.flipX?-1:1),", ").concat(e.size/iu*(e.flipY?-1:1),") "),y+="rotate(".concat(e.rotate,"deg) "),y}var VH=`:root, :host {
  --fa-font-solid: normal 900 1em/1 "Font Awesome 6 Solid";
  --fa-font-regular: normal 400 1em/1 "Font Awesome 6 Regular";
  --fa-font-light: normal 300 1em/1 "Font Awesome 6 Light";
  --fa-font-thin: normal 100 1em/1 "Font Awesome 6 Thin";
  --fa-font-duotone: normal 900 1em/1 "Font Awesome 6 Duotone";
  --fa-font-brands: normal 400 1em/1 "Font Awesome 6 Brands";
}

svg:not(:root).svg-inline--fa, svg:not(:host).svg-inline--fa {
  overflow: visible;
  box-sizing: content-box;
}

.svg-inline--fa {
  display: var(--fa-display, inline-block);
  height: 1em;
  overflow: visible;
  vertical-align: -0.125em;
}
.svg-inline--fa.fa-2xs {
  vertical-align: 0.1em;
}
.svg-inline--fa.fa-xs {
  vertical-align: 0em;
}
.svg-inline--fa.fa-sm {
  vertical-align: -0.0714285705em;
}
.svg-inline--fa.fa-lg {
  vertical-align: -0.2em;
}
.svg-inline--fa.fa-xl {
  vertical-align: -0.25em;
}
.svg-inline--fa.fa-2xl {
  vertical-align: -0.3125em;
}
.svg-inline--fa.fa-pull-left {
  margin-right: var(--fa-pull-margin, 0.3em);
  width: auto;
}
.svg-inline--fa.fa-pull-right {
  margin-left: var(--fa-pull-margin, 0.3em);
  width: auto;
}
.svg-inline--fa.fa-li {
  width: var(--fa-li-width, 2em);
  top: 0.25em;
}
.svg-inline--fa.fa-fw {
  width: var(--fa-fw-width, 1.25em);
}

.fa-layers svg.svg-inline--fa {
  bottom: 0;
  left: 0;
  margin: auto;
  position: absolute;
  right: 0;
  top: 0;
}

.fa-layers-counter, .fa-layers-text {
  display: inline-block;
  position: absolute;
  text-align: center;
}

.fa-layers {
  display: inline-block;
  height: 1em;
  position: relative;
  text-align: center;
  vertical-align: -0.125em;
  width: 1em;
}
.fa-layers svg.svg-inline--fa {
  -webkit-transform-origin: center center;
          transform-origin: center center;
}

.fa-layers-text {
  left: 50%;
  top: 50%;
  -webkit-transform: translate(-50%, -50%);
          transform: translate(-50%, -50%);
  -webkit-transform-origin: center center;
          transform-origin: center center;
}

.fa-layers-counter {
  background-color: var(--fa-counter-background-color, #ff253a);
  border-radius: var(--fa-counter-border-radius, 1em);
  box-sizing: border-box;
  color: var(--fa-inverse, #fff);
  line-height: var(--fa-counter-line-height, 1);
  max-width: var(--fa-counter-max-width, 5em);
  min-width: var(--fa-counter-min-width, 1.5em);
  overflow: hidden;
  padding: var(--fa-counter-padding, 0.25em 0.5em);
  right: var(--fa-right, 0);
  text-overflow: ellipsis;
  top: var(--fa-top, 0);
  -webkit-transform: scale(var(--fa-counter-scale, 0.25));
          transform: scale(var(--fa-counter-scale, 0.25));
  -webkit-transform-origin: top right;
          transform-origin: top right;
}

.fa-layers-bottom-right {
  bottom: var(--fa-bottom, 0);
  right: var(--fa-right, 0);
  top: auto;
  -webkit-transform: scale(var(--fa-layers-scale, 0.25));
          transform: scale(var(--fa-layers-scale, 0.25));
  -webkit-transform-origin: bottom right;
          transform-origin: bottom right;
}

.fa-layers-bottom-left {
  bottom: var(--fa-bottom, 0);
  left: var(--fa-left, 0);
  right: auto;
  top: auto;
  -webkit-transform: scale(var(--fa-layers-scale, 0.25));
          transform: scale(var(--fa-layers-scale, 0.25));
  -webkit-transform-origin: bottom left;
          transform-origin: bottom left;
}

.fa-layers-top-right {
  top: var(--fa-top, 0);
  right: var(--fa-right, 0);
  -webkit-transform: scale(var(--fa-layers-scale, 0.25));
          transform: scale(var(--fa-layers-scale, 0.25));
  -webkit-transform-origin: top right;
          transform-origin: top right;
}

.fa-layers-top-left {
  left: var(--fa-left, 0);
  right: auto;
  top: var(--fa-top, 0);
  -webkit-transform: scale(var(--fa-layers-scale, 0.25));
          transform: scale(var(--fa-layers-scale, 0.25));
  -webkit-transform-origin: top left;
          transform-origin: top left;
}

.fa-1x {
  font-size: 1em;
}

.fa-2x {
  font-size: 2em;
}

.fa-3x {
  font-size: 3em;
}

.fa-4x {
  font-size: 4em;
}

.fa-5x {
  font-size: 5em;
}

.fa-6x {
  font-size: 6em;
}

.fa-7x {
  font-size: 7em;
}

.fa-8x {
  font-size: 8em;
}

.fa-9x {
  font-size: 9em;
}

.fa-10x {
  font-size: 10em;
}

.fa-2xs {
  font-size: 0.625em;
  line-height: 0.1em;
  vertical-align: 0.225em;
}

.fa-xs {
  font-size: 0.75em;
  line-height: 0.0833333337em;
  vertical-align: 0.125em;
}

.fa-sm {
  font-size: 0.875em;
  line-height: 0.0714285718em;
  vertical-align: 0.0535714295em;
}

.fa-lg {
  font-size: 1.25em;
  line-height: 0.05em;
  vertical-align: -0.075em;
}

.fa-xl {
  font-size: 1.5em;
  line-height: 0.0416666682em;
  vertical-align: -0.125em;
}

.fa-2xl {
  font-size: 2em;
  line-height: 0.03125em;
  vertical-align: -0.1875em;
}

.fa-fw {
  text-align: center;
  width: 1.25em;
}

.fa-ul {
  list-style-type: none;
  margin-left: var(--fa-li-margin, 2.5em);
  padding-left: 0;
}
.fa-ul > li {
  position: relative;
}

.fa-li {
  left: calc(var(--fa-li-width, 2em) * -1);
  position: absolute;
  text-align: center;
  width: var(--fa-li-width, 2em);
  line-height: inherit;
}

.fa-border {
  border-color: var(--fa-border-color, #eee);
  border-radius: var(--fa-border-radius, 0.1em);
  border-style: var(--fa-border-style, solid);
  border-width: var(--fa-border-width, 0.08em);
  padding: var(--fa-border-padding, 0.2em 0.25em 0.15em);
}

.fa-pull-left {
  float: left;
  margin-right: var(--fa-pull-margin, 0.3em);
}

.fa-pull-right {
  float: right;
  margin-left: var(--fa-pull-margin, 0.3em);
}

.fa-beat {
  -webkit-animation-name: fa-beat;
          animation-name: fa-beat;
  -webkit-animation-delay: var(--fa-animation-delay, 0);
          animation-delay: var(--fa-animation-delay, 0);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);
          animation-timing-function: var(--fa-animation-timing, ease-in-out);
}

.fa-bounce {
  -webkit-animation-name: fa-bounce;
          animation-name: fa-bounce;
  -webkit-animation-delay: var(--fa-animation-delay, 0);
          animation-delay: var(--fa-animation-delay, 0);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));
          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));
}

.fa-fade {
  -webkit-animation-name: fa-fade;
          animation-name: fa-fade;
  -webkit-animation-delay: var(--fa-animation-delay, 0);
          animation-delay: var(--fa-animation-delay, 0);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
}

.fa-beat-fade {
  -webkit-animation-name: fa-beat-fade;
          animation-name: fa-beat-fade;
  -webkit-animation-delay: var(--fa-animation-delay, 0);
          animation-delay: var(--fa-animation-delay, 0);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
          animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));
}

.fa-flip {
  -webkit-animation-name: fa-flip;
          animation-name: fa-flip;
  -webkit-animation-delay: var(--fa-animation-delay, 0);
          animation-delay: var(--fa-animation-delay, 0);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, ease-in-out);
          animation-timing-function: var(--fa-animation-timing, ease-in-out);
}

.fa-shake {
  -webkit-animation-name: fa-shake;
          animation-name: fa-shake;
  -webkit-animation-delay: var(--fa-animation-delay, 0);
          animation-delay: var(--fa-animation-delay, 0);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, linear);
          animation-timing-function: var(--fa-animation-timing, linear);
}

.fa-spin {
  -webkit-animation-name: fa-spin;
          animation-name: fa-spin;
  -webkit-animation-delay: var(--fa-animation-delay, 0);
          animation-delay: var(--fa-animation-delay, 0);
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 2s);
          animation-duration: var(--fa-animation-duration, 2s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, linear);
          animation-timing-function: var(--fa-animation-timing, linear);
}

.fa-spin-reverse {
  --fa-animation-direction: reverse;
}

.fa-pulse,
.fa-spin-pulse {
  -webkit-animation-name: fa-spin;
          animation-name: fa-spin;
  -webkit-animation-direction: var(--fa-animation-direction, normal);
          animation-direction: var(--fa-animation-direction, normal);
  -webkit-animation-duration: var(--fa-animation-duration, 1s);
          animation-duration: var(--fa-animation-duration, 1s);
  -webkit-animation-iteration-count: var(--fa-animation-iteration-count, infinite);
          animation-iteration-count: var(--fa-animation-iteration-count, infinite);
  -webkit-animation-timing-function: var(--fa-animation-timing, steps(8));
          animation-timing-function: var(--fa-animation-timing, steps(8));
}

@media (prefers-reduced-motion: reduce) {
  .fa-beat,
.fa-bounce,
.fa-fade,
.fa-beat-fade,
.fa-flip,
.fa-pulse,
.fa-shake,
.fa-spin,
.fa-spin-pulse {
    -webkit-animation-delay: -1ms;
            animation-delay: -1ms;
    -webkit-animation-duration: 1ms;
            animation-duration: 1ms;
    -webkit-animation-iteration-count: 1;
            animation-iteration-count: 1;
    transition-delay: 0s;
    transition-duration: 0s;
  }
}
@-webkit-keyframes fa-beat {
  0%, 90% {
    -webkit-transform: scale(1);
            transform: scale(1);
  }
  45% {
    -webkit-transform: scale(var(--fa-beat-scale, 1.25));
            transform: scale(var(--fa-beat-scale, 1.25));
  }
}
@keyframes fa-beat {
  0%, 90% {
    -webkit-transform: scale(1);
            transform: scale(1);
  }
  45% {
    -webkit-transform: scale(var(--fa-beat-scale, 1.25));
            transform: scale(var(--fa-beat-scale, 1.25));
  }
}
@-webkit-keyframes fa-bounce {
  0% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
  10% {
    -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);
            transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);
  }
  30% {
    -webkit-transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));
            transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));
  }
  50% {
    -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);
            transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);
  }
  57% {
    -webkit-transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));
            transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));
  }
  64% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
  100% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
}
@keyframes fa-bounce {
  0% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
  10% {
    -webkit-transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);
            transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);
  }
  30% {
    -webkit-transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));
            transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));
  }
  50% {
    -webkit-transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);
            transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);
  }
  57% {
    -webkit-transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));
            transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));
  }
  64% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
  100% {
    -webkit-transform: scale(1, 1) translateY(0);
            transform: scale(1, 1) translateY(0);
  }
}
@-webkit-keyframes fa-fade {
  50% {
    opacity: var(--fa-fade-opacity, 0.4);
  }
}
@keyframes fa-fade {
  50% {
    opacity: var(--fa-fade-opacity, 0.4);
  }
}
@-webkit-keyframes fa-beat-fade {
  0%, 100% {
    opacity: var(--fa-beat-fade-opacity, 0.4);
    -webkit-transform: scale(1);
            transform: scale(1);
  }
  50% {
    opacity: 1;
    -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));
            transform: scale(var(--fa-beat-fade-scale, 1.125));
  }
}
@keyframes fa-beat-fade {
  0%, 100% {
    opacity: var(--fa-beat-fade-opacity, 0.4);
    -webkit-transform: scale(1);
            transform: scale(1);
  }
  50% {
    opacity: 1;
    -webkit-transform: scale(var(--fa-beat-fade-scale, 1.125));
            transform: scale(var(--fa-beat-fade-scale, 1.125));
  }
}
@-webkit-keyframes fa-flip {
  50% {
    -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));
            transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));
  }
}
@keyframes fa-flip {
  50% {
    -webkit-transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));
            transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));
  }
}
@-webkit-keyframes fa-shake {
  0% {
    -webkit-transform: rotate(-15deg);
            transform: rotate(-15deg);
  }
  4% {
    -webkit-transform: rotate(15deg);
            transform: rotate(15deg);
  }
  8%, 24% {
    -webkit-transform: rotate(-18deg);
            transform: rotate(-18deg);
  }
  12%, 28% {
    -webkit-transform: rotate(18deg);
            transform: rotate(18deg);
  }
  16% {
    -webkit-transform: rotate(-22deg);
            transform: rotate(-22deg);
  }
  20% {
    -webkit-transform: rotate(22deg);
            transform: rotate(22deg);
  }
  32% {
    -webkit-transform: rotate(-12deg);
            transform: rotate(-12deg);
  }
  36% {
    -webkit-transform: rotate(12deg);
            transform: rotate(12deg);
  }
  40%, 100% {
    -webkit-transform: rotate(0deg);
            transform: rotate(0deg);
  }
}
@keyframes fa-shake {
  0% {
    -webkit-transform: rotate(-15deg);
            transform: rotate(-15deg);
  }
  4% {
    -webkit-transform: rotate(15deg);
            transform: rotate(15deg);
  }
  8%, 24% {
    -webkit-transform: rotate(-18deg);
            transform: rotate(-18deg);
  }
  12%, 28% {
    -webkit-transform: rotate(18deg);
            transform: rotate(18deg);
  }
  16% {
    -webkit-transform: rotate(-22deg);
            transform: rotate(-22deg);
  }
  20% {
    -webkit-transform: rotate(22deg);
            transform: rotate(22deg);
  }
  32% {
    -webkit-transform: rotate(-12deg);
            transform: rotate(-12deg);
  }
  36% {
    -webkit-transform: rotate(12deg);
            transform: rotate(12deg);
  }
  40%, 100% {
    -webkit-transform: rotate(0deg);
            transform: rotate(0deg);
  }
}
@-webkit-keyframes fa-spin {
  0% {
    -webkit-transform: rotate(0deg);
            transform: rotate(0deg);
  }
  100% {
    -webkit-transform: rotate(360deg);
            transform: rotate(360deg);
  }
}
@keyframes fa-spin {
  0% {
    -webkit-transform: rotate(0deg);
            transform: rotate(0deg);
  }
  100% {
    -webkit-transform: rotate(360deg);
            transform: rotate(360deg);
  }
}
.fa-rotate-90 {
  -webkit-transform: rotate(90deg);
          transform: rotate(90deg);
}

.fa-rotate-180 {
  -webkit-transform: rotate(180deg);
          transform: rotate(180deg);
}

.fa-rotate-270 {
  -webkit-transform: rotate(270deg);
          transform: rotate(270deg);
}

.fa-flip-horizontal {
  -webkit-transform: scale(-1, 1);
          transform: scale(-1, 1);
}

.fa-flip-vertical {
  -webkit-transform: scale(1, -1);
          transform: scale(1, -1);
}

.fa-flip-both,
.fa-flip-horizontal.fa-flip-vertical {
  -webkit-transform: scale(-1, -1);
          transform: scale(-1, -1);
}

.fa-rotate-by {
  -webkit-transform: rotate(var(--fa-rotate-angle, none));
          transform: rotate(var(--fa-rotate-angle, none));
}

.fa-stack {
  display: inline-block;
  vertical-align: middle;
  height: 2em;
  position: relative;
  width: 2.5em;
}

.fa-stack-1x,
.fa-stack-2x {
  bottom: 0;
  left: 0;
  margin: auto;
  position: absolute;
  right: 0;
  top: 0;
  z-index: var(--fa-stack-z-index, auto);
}

.svg-inline--fa.fa-stack-1x {
  height: 1em;
  width: 1.25em;
}
.svg-inline--fa.fa-stack-2x {
  height: 2em;
  width: 2.5em;
}

.fa-inverse {
  color: var(--fa-inverse, #fff);
}

.sr-only,
.fa-sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

.sr-only-focusable:not(:focus),
.fa-sr-only-focusable:not(:focus) {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

.svg-inline--fa .fa-primary {
  fill: var(--fa-primary-color, currentColor);
  opacity: var(--fa-primary-opacity, 1);
}

.svg-inline--fa .fa-secondary {
  fill: var(--fa-secondary-color, currentColor);
  opacity: var(--fa-secondary-opacity, 0.4);
}

.svg-inline--fa.fa-swap-opacity .fa-primary {
  opacity: var(--fa-secondary-opacity, 0.4);
}

.svg-inline--fa.fa-swap-opacity .fa-secondary {
  opacity: var(--fa-primary-opacity, 1);
}

.svg-inline--fa mask .fa-primary,
.svg-inline--fa mask .fa-secondary {
  fill: black;
}

.fad.fa-inverse,
.fa-duotone.fa-inverse {
  color: var(--fa-inverse, #fff);
}`;function oM(){var t=KS,e=JS,n=Sn.familyPrefix,i=Sn.replacementClass,l=VH;if(n!==t||i!==e){var d=new RegExp("\\.".concat(t,"\\-"),"g"),f=new RegExp("\\--".concat(t,"\\-"),"g"),o=new RegExp("\\.".concat(e),"g");l=l.replace(d,".".concat(n,"-")).replace(f,"--".concat(n,"-")).replace(o,".".concat(i))}return l}var WT=!1;function fb(){Sn.autoAddCss&&!WT&&(FH(oM()),WT=!0)}var GH={mixout:function(){return{dom:{css:oM,insertCss:fb}}},hooks:function(){return{beforeDOMElementCreation:function(){fb()},beforeI2svg:function(){fb()}}}},uc=Eu||{};uc[cc]||(uc[cc]={});uc[cc].styles||(uc[cc].styles={});uc[cc].hooks||(uc[cc].hooks={});uc[cc].shims||(uc[cc].shims=[]);var Fs=uc[cc],aM=[],qH=function t(){ui.removeEventListener("DOMContentLoaded",t),M_=1,aM.map(function(e){return e()})},M_=!1;pc&&(M_=(ui.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(ui.readyState),M_||ui.addEventListener("DOMContentLoaded",qH));function HH(t){!pc||(M_?setTimeout(t,0):aM.push(t))}function Hm(t){var e=t.tag,n=t.attributes,i=n===void 0?{}:n,l=t.children,d=l===void 0?[]:l;return typeof t=="string"?iM(t):"<".concat(e," ").concat(jH(i),">").concat(d.map(Hm).join(""),"</").concat(e,">")}function ZT(t,e,n){if(t&&t[e]&&t[e][n])return{prefix:e,iconName:n,icon:t[e][n]}}var WH=function(e,n){return function(i,l,d,f){return e.call(n,i,l,d,f)}},pb=function(e,n,i,l){var d=Object.keys(e),f=d.length,o=l!==void 0?WH(n,l):n,y,E,C;for(i===void 0?(y=1,C=e[d[0]]):(y=0,C=i);y<f;y++)E=d[y],C=o(C,e[E],E,e);return C};function ZH(t){for(var e=[],n=0,i=t.length;n<i;){var l=t.charCodeAt(n++);if(l>=55296&&l<=56319&&n<i){var d=t.charCodeAt(n++);(d&64512)==56320?e.push(((l&1023)<<10)+(d&1023)+65536):(e.push(l),n--)}else e.push(l)}return e}function mv(t){var e=ZH(t);return e.length===1?e[0].toString(16):null}function XH(t,e){var n=t.length,i=t.charCodeAt(e),l;return i>=55296&&i<=56319&&n>e+1&&(l=t.charCodeAt(e+1),l>=56320&&l<=57343)?(i-55296)*1024+l-56320+65536:i}function XT(t){return Object.keys(t).reduce(function(e,n){var i=t[n],l=!!i.icon;return l?e[i.iconName]=i.icon:e[n]=i,e},{})}function gv(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=n.skipHooks,l=i===void 0?!1:i,d=XT(e);typeof Fs.hooks.addPack=="function"&&!l?Fs.hooks.addPack(t,XT(e)):Fs.styles[t]=cn(cn({},Fs.styles[t]||{}),d),t==="fas"&&gv("fa",e)}var om=Fs.styles,YH=Fs.shims,KH=Object.values(tM),Rx=null,sM={},lM={},cM={},uM={},dM={},JH=Object.keys(zx);function QH(t){return~LH.indexOf(t)}function tW(t,e){var n=e.split("-"),i=n[0],l=n.slice(1).join("-");return i===t&&l!==""&&!QH(l)?l:null}var hM=function(){var e=function(d){return pb(om,function(f,o,y){return f[y]=pb(o,d,{}),f},{})};sM=e(function(l,d,f){if(d[3]&&(l[d[3]]=f),d[2]){var o=d[2].filter(function(y){return typeof y=="number"});o.forEach(function(y){l[y.toString(16)]=f})}return l}),lM=e(function(l,d,f){if(l[f]=f,d[2]){var o=d[2].filter(function(y){return typeof y=="string"});o.forEach(function(y){l[y]=f})}return l}),dM=e(function(l,d,f){var o=d[2];return l[f]=f,o.forEach(function(y){l[y]=f}),l});var n="far"in om||Sn.autoFetchSvg,i=pb(YH,function(l,d){var f=d[0],o=d[1],y=d[2];return o==="far"&&!n&&(o="fas"),typeof f=="string"&&(l.names[f]={prefix:o,iconName:y}),typeof f=="number"&&(l.unicodes[f.toString(16)]={prefix:o,iconName:y}),l},{names:{},unicodes:{}});cM=i.names,uM=i.unicodes,Rx=fy(Sn.styleDefault)};BH(function(t){Rx=fy(t.styleDefault)});hM();function Bx(t,e){return(sM[t]||{})[e]}function eW(t,e){return(lM[t]||{})[e]}function Vh(t,e){return(dM[t]||{})[e]}function fM(t){return cM[t]||{prefix:null,iconName:null}}function nW(t){var e=uM[t],n=Bx("fas",t);return e||(n?{prefix:"fas",iconName:n}:null)||{prefix:null,iconName:null}}function Tu(){return Rx}var Fx=function(){return{prefix:null,iconName:null,rest:[]}};function fy(t){var e=zx[t],n=S_[t]||S_[e],i=t in Fs.styles?t:null;return n||i||null}function py(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=e.skipLookups,i=n===void 0?!1:n,l=null,d=t.reduce(function(f,o){var y=tW(Sn.familyPrefix,o);if(om[o]?(o=KH.includes(o)?CH[o]:o,l=o,f.prefix=o):JH.indexOf(o)>-1?(l=o,f.prefix=fy(o)):y?f.iconName=y:o!==Sn.replacementClass&&f.rest.push(o),!i&&f.prefix&&f.iconName){var E=l==="fa"?fM(f.iconName):{},C=Vh(f.prefix,f.iconName);E.prefix&&(l=null),f.iconName=E.iconName||C||f.iconName,f.prefix=E.prefix||f.prefix,f.prefix==="far"&&!om.far&&om.fas&&!Sn.autoFetchSvg&&(f.prefix="fas")}return f},Fx());return(d.prefix==="fa"||l==="fa")&&(d.prefix=Tu()||"fas"),d}var rW=function(){function t(){fH(this,t),this.definitions={}}return pH(t,[{key:"add",value:function(){for(var n=this,i=arguments.length,l=new Array(i),d=0;d<i;d++)l[d]=arguments[d];var f=l.reduce(this._pullDefinitions,{});Object.keys(f).forEach(function(o){n.definitions[o]=cn(cn({},n.definitions[o]||{}),f[o]),gv(o,f[o]);var y=tM[o];y&&gv(y,f[o]),hM()})}},{key:"reset",value:function(){this.definitions={}}},{key:"_pullDefinitions",value:function(n,i){var l=i.prefix&&i.iconName&&i.icon?{0:i}:i;return Object.keys(l).map(function(d){var f=l[d],o=f.prefix,y=f.iconName,E=f.icon,C=E[2];n[o]||(n[o]={}),C.length>0&&C.forEach(function(A){typeof A=="string"&&(n[o][A]=E)}),n[o][y]=E}),n}}]),t}(),YT=[],Gh={},Kh={},iW=Object.keys(Kh);function oW(t,e){var n=e.mixoutsTo;return YT=t,Gh={},Object.keys(Kh).forEach(function(i){iW.indexOf(i)===-1&&delete Kh[i]}),YT.forEach(function(i){var l=i.mixout?i.mixout():{};if(Object.keys(l).forEach(function(f){typeof l[f]=="function"&&(n[f]=l[f]),C_(l[f])==="object"&&Object.keys(l[f]).forEach(function(o){n[f]||(n[f]={}),n[f][o]=l[f][o]})}),i.hooks){var d=i.hooks();Object.keys(d).forEach(function(f){Gh[f]||(Gh[f]=[]),Gh[f].push(d[f])})}i.provides&&i.provides(Kh)}),n}function _v(t,e){for(var n=arguments.length,i=new Array(n>2?n-2:0),l=2;l<n;l++)i[l-2]=arguments[l];var d=Gh[t]||[];return d.forEach(function(f){e=f.apply(null,[e].concat(i))}),e}function jd(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];var l=Gh[t]||[];l.forEach(function(d){d.apply(null,n)})}function dc(){var t=arguments[0],e=Array.prototype.slice.call(arguments,1);return Kh[t]?Kh[t].apply(null,e):void 0}function yv(t){t.prefix==="fa"&&(t.prefix="fas");var e=t.iconName,n=t.prefix||Tu();if(!!e)return e=Vh(n,e)||e,ZT(pM.definitions,n,e)||ZT(Fs.styles,n,e)}var pM=new rW,aW=function(){Sn.autoReplaceSvg=!1,Sn.observeMutations=!1,jd("noAuto")},sW={i2svg:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return pc?(jd("beforeI2svg",e),dc("pseudoElements2svg",e),dc("i2svg",e)):Promise.reject("Operation requires a DOM of some kind.")},watch:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.autoReplaceSvgRoot;Sn.autoReplaceSvg===!1&&(Sn.autoReplaceSvg=!0),Sn.observeMutations=!0,HH(function(){cW({autoReplaceSvgRoot:n}),jd("watch",e)})}},lW={icon:function(e){if(e===null)return null;if(C_(e)==="object"&&e.prefix&&e.iconName)return{prefix:e.prefix,iconName:Vh(e.prefix,e.iconName)||e.iconName};if(Array.isArray(e)&&e.length===2){var n=e[1].indexOf("fa-")===0?e[1].slice(3):e[1],i=fy(e[0]);return{prefix:i,iconName:Vh(i,n)||n}}if(typeof e=="string"&&(e.indexOf("".concat(Sn.familyPrefix,"-"))>-1||e.match(SH))){var l=py(e.split(" "),{skipLookups:!0});return{prefix:l.prefix||Tu(),iconName:Vh(l.prefix,l.iconName)||l.iconName}}if(typeof e=="string"){var d=Tu();return{prefix:d,iconName:Vh(d,e)||e}}}},Ba={noAuto:aW,config:Sn,dom:sW,parse:lW,library:pM,findIconDefinition:yv,toHtml:Hm},cW=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.autoReplaceSvgRoot,i=n===void 0?ui:n;(Object.keys(Fs.styles).length>0||Sn.autoFetchSvg)&&pc&&Sn.autoReplaceSvg&&Ba.dom.i2svg({node:i})};function my(t,e){return Object.defineProperty(t,"abstract",{get:e}),Object.defineProperty(t,"html",{get:function(){return t.abstract.map(function(i){return Hm(i)})}}),Object.defineProperty(t,"node",{get:function(){if(!!pc){var i=ui.createElement("div");return i.innerHTML=t.html,i.children}}}),t}function uW(t){var e=t.children,n=t.main,i=t.mask,l=t.attributes,d=t.styles,f=t.transform;if(Dx(f)&&n.found&&!i.found){var o=n.width,y=n.height,E={x:o/y/2,y:.5};l.style=hy(cn(cn({},d),{},{"transform-origin":"".concat(E.x+f.x/16,"em ").concat(E.y+f.y/16,"em")}))}return[{tag:"svg",attributes:l,children:e}]}function dW(t){var e=t.prefix,n=t.iconName,i=t.children,l=t.attributes,d=t.symbol,f=d===!0?"".concat(e,"-").concat(Sn.familyPrefix,"-").concat(n):d;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:cn(cn({},l),{},{id:f}),children:i}]}]}function Nx(t){var e=t.icons,n=e.main,i=e.mask,l=t.prefix,d=t.iconName,f=t.transform,o=t.symbol,y=t.title,E=t.maskId,C=t.titleId,A=t.extra,P=t.watchable,B=P===void 0?!1:P,j=i.found?i:n,Z=j.width,W=j.height,H=l==="fak",V=[Sn.replacementClass,d?"".concat(Sn.familyPrefix,"-").concat(d):""].filter(function(jt){return A.classes.indexOf(jt)===-1}).filter(function(jt){return jt!==""||!!jt}).concat(A.classes).join(" "),tt={children:[],attributes:cn(cn({},A.attributes),{},{"data-prefix":l,"data-icon":d,class:V,role:A.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(Z," ").concat(W)})},ft=H&&!~A.classes.indexOf("fa-fw")?{width:"".concat(Z/W*16*.0625,"em")}:{};B&&(tt.attributes[Nd]=""),y&&(tt.children.push({tag:"title",attributes:{id:tt.attributes["aria-labelledby"]||"title-".concat(C||Mm())},children:[y]}),delete tt.attributes.title);var et=cn(cn({},tt),{},{prefix:l,iconName:d,main:n,mask:i,maskId:E,transform:f,symbol:o,styles:cn(cn({},ft),A.styles)}),Pt=i.found&&n.found?dc("generateAbstractMask",et)||{children:[],attributes:{}}:dc("generateAbstractIcon",et)||{children:[],attributes:{}},Rt=Pt.children,zt=Pt.attributes;return et.children=Rt,et.attributes=zt,o?dW(et):uW(et)}function KT(t){var e=t.content,n=t.width,i=t.height,l=t.transform,d=t.title,f=t.extra,o=t.watchable,y=o===void 0?!1:o,E=cn(cn(cn({},f.attributes),d?{title:d}:{}),{},{class:f.classes.join(" ")});y&&(E[Nd]="");var C=cn({},f.styles);Dx(l)&&(C.transform=$H({transform:l,startCentered:!0,width:n,height:i}),C["-webkit-transform"]=C.transform);var A=hy(C);A.length>0&&(E.style=A);var P=[];return P.push({tag:"span",attributes:E,children:[e]}),d&&P.push({tag:"span",attributes:{class:"sr-only"},children:[d]}),P}function hW(t){var e=t.content,n=t.title,i=t.extra,l=cn(cn(cn({},i.attributes),n?{title:n}:{}),{},{class:i.classes.join(" ")}),d=hy(i.styles);d.length>0&&(l.style=d);var f=[];return f.push({tag:"span",attributes:l,children:[e]}),n&&f.push({tag:"span",attributes:{class:"sr-only"},children:[n]}),f}var mb=Fs.styles;function bv(t){var e=t[0],n=t[1],i=t.slice(4),l=Ax(i,1),d=l[0],f=null;return Array.isArray(d)?f={tag:"g",attributes:{class:"".concat(Sn.familyPrefix,"-").concat(Md.GROUP)},children:[{tag:"path",attributes:{class:"".concat(Sn.familyPrefix,"-").concat(Md.SECONDARY),fill:"currentColor",d:d[0]}},{tag:"path",attributes:{class:"".concat(Sn.familyPrefix,"-").concat(Md.PRIMARY),fill:"currentColor",d:d[1]}}]}:f={tag:"path",attributes:{fill:"currentColor",d}},{found:!0,width:e,height:n,icon:f}}var fW={found:!1,width:512,height:512};function pW(t,e){!QS&&!Sn.showMissingIcons&&t&&console.error('Icon with name "'.concat(t,'" and prefix "').concat(e,'" is missing.'))}function vv(t,e){var n=e;return e==="fa"&&Sn.styleDefault!==null&&(e=Tu()),new Promise(function(i,l){if(dc("missingIconAbstract"),n==="fa"){var d=fM(t)||{};t=d.iconName||t,e=d.prefix||e}if(t&&e&&mb[e]&&mb[e][t]){var f=mb[e][t];return i(bv(f))}pW(t,e),i(cn(cn({},fW),{},{icon:Sn.showMissingIcons&&t?dc("missingIconAbstract")||{}:{}}))})}var JT=function(){},xv=Sn.measurePerformance&&G0&&G0.mark&&G0.measure?G0:{mark:JT,measure:JT},jp='FA "6.1.1"',mW=function(e){return xv.mark("".concat(jp," ").concat(e," begins")),function(){return mM(e)}},mM=function(e){xv.mark("".concat(jp," ").concat(e," ends")),xv.measure("".concat(jp," ").concat(e),"".concat(jp," ").concat(e," begins"),"".concat(jp," ").concat(e," ends"))},jx={begin:mW,end:mM},K0=function(){};function QT(t){var e=t.getAttribute?t.getAttribute(Nd):null;return typeof e=="string"}function gW(t){var e=t.getAttribute?t.getAttribute(Px):null,n=t.getAttribute?t.getAttribute(Lx):null;return e&&n}function _W(t){return t&&t.classList&&t.classList.contains&&t.classList.contains(Sn.replacementClass)}function yW(){if(Sn.autoReplaceSvg===!0)return J0.replace;var t=J0[Sn.autoReplaceSvg];return t||J0.replace}function bW(t){return ui.createElementNS("http://www.w3.org/2000/svg",t)}function vW(t){return ui.createElement(t)}function gM(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=e.ceFn,i=n===void 0?t.tag==="svg"?bW:vW:n;if(typeof t=="string")return ui.createTextNode(t);var l=i(t.tag);Object.keys(t.attributes||[]).forEach(function(f){l.setAttribute(f,t.attributes[f])});var d=t.children||[];return d.forEach(function(f){l.appendChild(gM(f,{ceFn:i}))}),l}function xW(t){var e=" ".concat(t.outerHTML," ");return e="".concat(e,"Font Awesome fontawesome.com "),e}var J0={replace:function(e){var n=e[0];if(n.parentNode)if(e[1].forEach(function(l){n.parentNode.insertBefore(gM(l),n)}),n.getAttribute(Nd)===null&&Sn.keepOriginalSource){var i=ui.createComment(xW(n));n.parentNode.replaceChild(i,n)}else n.remove()},nest:function(e){var n=e[0],i=e[1];if(~Ox(n).indexOf(Sn.replacementClass))return J0.replace(e);var l=new RegExp("".concat(Sn.familyPrefix,"-.*"));if(delete i[0].attributes.id,i[0].attributes.class){var d=i[0].attributes.class.split(" ").reduce(function(o,y){return y===Sn.replacementClass||y.match(l)?o.toSvg.push(y):o.toNode.push(y),o},{toNode:[],toSvg:[]});i[0].attributes.class=d.toSvg.join(" "),d.toNode.length===0?n.removeAttribute("class"):n.setAttribute("class",d.toNode.join(" "))}var f=i.map(function(o){return Hm(o)}).join(`
`);n.setAttribute(Nd,""),n.innerHTML=f}};function tk(t){t()}function _M(t,e){var n=typeof e=="function"?e:K0;if(t.length===0)n();else{var i=tk;Sn.mutateApproach===TH&&(i=Eu.requestAnimationFrame||tk),i(function(){var l=yW(),d=jx.begin("mutate");t.map(l),d(),n()})}}var Ux=!1;function yM(){Ux=!0}function wv(){Ux=!1}var A_=null;function ek(t){if(!!qT&&!!Sn.observeMutations){var e=t.treeCallback,n=e===void 0?K0:e,i=t.nodeCallback,l=i===void 0?K0:i,d=t.pseudoElementsCallback,f=d===void 0?K0:d,o=t.observeMutationsRoot,y=o===void 0?ui:o;A_=new qT(function(E){if(!Ux){var C=Tu();xf(E).forEach(function(A){if(A.type==="childList"&&A.addedNodes.length>0&&!QT(A.addedNodes[0])&&(Sn.searchPseudoElements&&f(A.target),n(A.target)),A.type==="attributes"&&A.target.parentNode&&Sn.searchPseudoElements&&f(A.target.parentNode),A.type==="attributes"&&QT(A.target)&&~PH.indexOf(A.attributeName))if(A.attributeName==="class"&&gW(A.target)){var P=py(Ox(A.target)),B=P.prefix,j=P.iconName;A.target.setAttribute(Px,B||C),j&&A.target.setAttribute(Lx,j)}else _W(A.target)&&l(A.target)})}}),pc&&A_.observe(y,{childList:!0,attributes:!0,characterData:!0,subtree:!0})}}function wW(){!A_||A_.disconnect()}function EW(t){var e=t.getAttribute("style"),n=[];return e&&(n=e.split(";").reduce(function(i,l){var d=l.split(":"),f=d[0],o=d.slice(1);return f&&o.length>0&&(i[f]=o.join(":").trim()),i},{})),n}function TW(t){var e=t.getAttribute("data-prefix"),n=t.getAttribute("data-icon"),i=t.innerText!==void 0?t.innerText.trim():"",l=py(Ox(t));return l.prefix||(l.prefix=Tu()),e&&n&&(l.prefix=e,l.iconName=n),l.iconName&&l.prefix||l.prefix&&i.length>0&&(l.iconName=eW(l.prefix,t.innerText)||Bx(l.prefix,mv(t.innerText))),l}function kW(t){var e=xf(t.attributes).reduce(function(l,d){return l.name!=="class"&&l.name!=="style"&&(l[d.name]=d.value),l},{}),n=t.getAttribute("title"),i=t.getAttribute("data-fa-title-id");return Sn.autoA11y&&(n?e["aria-labelledby"]="".concat(Sn.replacementClass,"-title-").concat(i||Mm()):(e["aria-hidden"]="true",e.focusable="false")),e}function CW(){return{iconName:null,title:null,titleId:null,prefix:null,transform:gl,symbol:!1,mask:{iconName:null,prefix:null,rest:[]},maskId:null,extra:{classes:[],styles:{},attributes:{}}}}function nk(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{styleParser:!0},n=TW(t),i=n.iconName,l=n.prefix,d=n.rest,f=kW(t),o=_v("parseNodeAttributes",{},t),y=e.styleParser?EW(t):[];return cn({iconName:i,title:t.getAttribute("title"),titleId:t.getAttribute("data-fa-title-id"),prefix:l,transform:gl,mask:{iconName:null,prefix:null,rest:[]},maskId:null,symbol:!1,extra:{classes:d,styles:y,attributes:f}},o)}var SW=Fs.styles;function bM(t){var e=Sn.autoReplaceSvg==="nest"?nk(t,{styleParser:!1}):nk(t);return~e.extra.classes.indexOf(eM)?dc("generateLayersText",t,e):dc("generateSvgReplacementMutation",t,e)}function rk(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!pc)return Promise.resolve();var n=ui.documentElement.classList,i=function(A){return n.add("".concat(HT,"-").concat(A))},l=function(A){return n.remove("".concat(HT,"-").concat(A))},d=Sn.autoFetchSvg?Object.keys(zx):Object.keys(SW),f=[".".concat(eM,":not([").concat(Nd,"])")].concat(d.map(function(C){return".".concat(C,":not([").concat(Nd,"])")})).join(", ");if(f.length===0)return Promise.resolve();var o=[];try{o=xf(t.querySelectorAll(f))}catch{}if(o.length>0)i("pending"),l("complete");else return Promise.resolve();var y=jx.begin("onTree"),E=o.reduce(function(C,A){try{var P=bM(A);P&&C.push(P)}catch(B){QS||B.name==="MissingIcon"&&console.error(B)}return C},[]);return new Promise(function(C,A){Promise.all(E).then(function(P){_M(P,function(){i("active"),i("complete"),l("pending"),typeof e=="function"&&e(),y(),C()})}).catch(function(P){y(),A(P)})})}function MW(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;bM(t).then(function(n){n&&_M([n],e)})}function AW(t){return function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=(e||{}).icon?e:yv(e||{}),l=n.mask;return l&&(l=(l||{}).icon?l:yv(l||{})),t(i,cn(cn({},n),{},{mask:l}))}}var IW=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=n.transform,l=i===void 0?gl:i,d=n.symbol,f=d===void 0?!1:d,o=n.mask,y=o===void 0?null:o,E=n.maskId,C=E===void 0?null:E,A=n.title,P=A===void 0?null:A,B=n.titleId,j=B===void 0?null:B,Z=n.classes,W=Z===void 0?[]:Z,H=n.attributes,V=H===void 0?{}:H,tt=n.styles,ft=tt===void 0?{}:tt;if(!!e){var et=e.prefix,Pt=e.iconName,Rt=e.icon;return my(cn({type:"icon"},e),function(){return jd("beforeDOMElementCreation",{iconDefinition:e,params:n}),Sn.autoA11y&&(P?V["aria-labelledby"]="".concat(Sn.replacementClass,"-title-").concat(j||Mm()):(V["aria-hidden"]="true",V.focusable="false")),Nx({icons:{main:bv(Rt),mask:y?bv(y.icon):{found:!1,width:null,height:null,icon:{}}},prefix:et,iconName:Pt,transform:cn(cn({},gl),l),symbol:f,title:P,maskId:C,titleId:j,extra:{attributes:V,styles:ft,classes:W}})})}},PW={mixout:function(){return{icon:AW(IW)}},hooks:function(){return{mutationObserverCallbacks:function(n){return n.treeCallback=rk,n.nodeCallback=MW,n}}},provides:function(e){e.i2svg=function(n){var i=n.node,l=i===void 0?ui:i,d=n.callback,f=d===void 0?function(){}:d;return rk(l,f)},e.generateSvgReplacementMutation=function(n,i){var l=i.iconName,d=i.title,f=i.titleId,o=i.prefix,y=i.transform,E=i.symbol,C=i.mask,A=i.maskId,P=i.extra;return new Promise(function(B,j){Promise.all([vv(l,o),C.iconName?vv(C.iconName,C.prefix):Promise.resolve({found:!1,width:512,height:512,icon:{}})]).then(function(Z){var W=Ax(Z,2),H=W[0],V=W[1];B([n,Nx({icons:{main:H,mask:V},prefix:o,iconName:l,transform:y,symbol:E,maskId:A,title:d,titleId:f,extra:P,watchable:!0})])}).catch(j)})},e.generateAbstractIcon=function(n){var i=n.children,l=n.attributes,d=n.main,f=n.transform,o=n.styles,y=hy(o);y.length>0&&(l.style=y);var E;return Dx(f)&&(E=dc("generateAbstractTransformGrouping",{main:d,transform:f,containerWidth:d.width,iconWidth:d.width})),i.push(E||d.icon),{children:i,attributes:l}}}},LW={mixout:function(){return{layer:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},l=i.classes,d=l===void 0?[]:l;return my({type:"layer"},function(){jd("beforeDOMElementCreation",{assembler:n,params:i});var f=[];return n(function(o){Array.isArray(o)?o.map(function(y){f=f.concat(y.abstract)}):f=f.concat(o.abstract)}),[{tag:"span",attributes:{class:["".concat(Sn.familyPrefix,"-layers")].concat(dy(d)).join(" ")},children:f}]})}}}},zW={mixout:function(){return{counter:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},l=i.title,d=l===void 0?null:l,f=i.classes,o=f===void 0?[]:f,y=i.attributes,E=y===void 0?{}:y,C=i.styles,A=C===void 0?{}:C;return my({type:"counter",content:n},function(){return jd("beforeDOMElementCreation",{content:n,params:i}),hW({content:n.toString(),title:d,extra:{attributes:E,styles:A,classes:["".concat(Sn.familyPrefix,"-layers-counter")].concat(dy(o))}})})}}}},OW={mixout:function(){return{text:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},l=i.transform,d=l===void 0?gl:l,f=i.title,o=f===void 0?null:f,y=i.classes,E=y===void 0?[]:y,C=i.attributes,A=C===void 0?{}:C,P=i.styles,B=P===void 0?{}:P;return my({type:"text",content:n},function(){return jd("beforeDOMElementCreation",{content:n,params:i}),KT({content:n,transform:cn(cn({},gl),d),title:o,extra:{attributes:A,styles:B,classes:["".concat(Sn.familyPrefix,"-layers-text")].concat(dy(E))}})})}}},provides:function(e){e.generateLayersText=function(n,i){var l=i.title,d=i.transform,f=i.extra,o=null,y=null;if(YS){var E=parseInt(getComputedStyle(n).fontSize,10),C=n.getBoundingClientRect();o=C.width/E,y=C.height/E}return Sn.autoA11y&&!l&&(f.attributes["aria-hidden"]="true"),Promise.resolve([n,KT({content:n.innerHTML,width:o,height:y,transform:d,title:l,extra:f,watchable:!0})])}}},DW=new RegExp('"',"ug"),ik=[1105920,1112319];function RW(t){var e=t.replace(DW,""),n=XH(e,0),i=n>=ik[0]&&n<=ik[1],l=e.length===2?e[0]===e[1]:!1;return{value:mv(l?e[0]:e),isSecondary:i||l}}function ok(t,e){var n="".concat(EH).concat(e.replace(":","-"));return new Promise(function(i,l){if(t.getAttribute(n)!==null)return i();var d=xf(t.children),f=d.filter(function(Pt){return Pt.getAttribute(pv)===e})[0],o=Eu.getComputedStyle(t,e),y=o.getPropertyValue("font-family").match(MH),E=o.getPropertyValue("font-weight"),C=o.getPropertyValue("content");if(f&&!y)return t.removeChild(f),i();if(y&&C!=="none"&&C!==""){var A=o.getPropertyValue("content"),P=~["Solid","Regular","Light","Thin","Duotone","Brands","Kit"].indexOf(y[2])?S_[y[2].toLowerCase()]:AH[E],B=RW(A),j=B.value,Z=B.isSecondary,W=y[0].startsWith("FontAwesome"),H=Bx(P,j),V=H;if(W){var tt=nW(j);tt.iconName&&tt.prefix&&(H=tt.iconName,P=tt.prefix)}if(H&&!Z&&(!f||f.getAttribute(Px)!==P||f.getAttribute(Lx)!==V)){t.setAttribute(n,V),f&&t.removeChild(f);var ft=CW(),et=ft.extra;et.attributes[pv]=e,vv(H,P).then(function(Pt){var Rt=Nx(cn(cn({},ft),{},{icons:{main:Pt,mask:Fx()},prefix:P,iconName:V,extra:et,watchable:!0})),zt=ui.createElement("svg");e==="::before"?t.insertBefore(zt,t.firstChild):t.appendChild(zt),zt.outerHTML=Rt.map(function(jt){return Hm(jt)}).join(`
`),t.removeAttribute(n),i()}).catch(l)}else i()}else i()})}function BW(t){return Promise.all([ok(t,"::before"),ok(t,"::after")])}function FW(t){return t.parentNode!==document.head&&!~kH.indexOf(t.tagName.toUpperCase())&&!t.getAttribute(pv)&&(!t.parentNode||t.parentNode.tagName!=="svg")}function ak(t){if(!!pc)return new Promise(function(e,n){var i=xf(t.querySelectorAll("*")).filter(FW).map(BW),l=jx.begin("searchPseudoElements");yM(),Promise.all(i).then(function(){l(),wv(),e()}).catch(function(){l(),wv(),n()})})}var NW={hooks:function(){return{mutationObserverCallbacks:function(n){return n.pseudoElementsCallback=ak,n}}},provides:function(e){e.pseudoElements2svg=function(n){var i=n.node,l=i===void 0?ui:i;Sn.searchPseudoElements&&ak(l)}}},sk=!1,jW={mixout:function(){return{dom:{unwatch:function(){yM(),sk=!0}}}},hooks:function(){return{bootstrap:function(){ek(_v("mutationObserverCallbacks",{}))},noAuto:function(){wW()},watch:function(n){var i=n.observeMutationsRoot;sk?wv():ek(_v("mutationObserverCallbacks",{observeMutationsRoot:i}))}}}},lk=function(e){var n={size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0};return e.toLowerCase().split(" ").reduce(function(i,l){var d=l.toLowerCase().split("-"),f=d[0],o=d.slice(1).join("-");if(f&&o==="h")return i.flipX=!0,i;if(f&&o==="v")return i.flipY=!0,i;if(o=parseFloat(o),isNaN(o))return i;switch(f){case"grow":i.size=i.size+o;break;case"shrink":i.size=i.size-o;break;case"left":i.x=i.x-o;break;case"right":i.x=i.x+o;break;case"up":i.y=i.y-o;break;case"down":i.y=i.y+o;break;case"rotate":i.rotate=i.rotate+o;break}return i},n)},UW={mixout:function(){return{parse:{transform:function(n){return lk(n)}}}},hooks:function(){return{parseNodeAttributes:function(n,i){var l=i.getAttribute("data-fa-transform");return l&&(n.transform=lk(l)),n}}},provides:function(e){e.generateAbstractTransformGrouping=function(n){var i=n.main,l=n.transform,d=n.containerWidth,f=n.iconWidth,o={transform:"translate(".concat(d/2," 256)")},y="translate(".concat(l.x*32,", ").concat(l.y*32,") "),E="scale(".concat(l.size/16*(l.flipX?-1:1),", ").concat(l.size/16*(l.flipY?-1:1),") "),C="rotate(".concat(l.rotate," 0 0)"),A={transform:"".concat(y," ").concat(E," ").concat(C)},P={transform:"translate(".concat(f/2*-1," -256)")},B={outer:o,inner:A,path:P};return{tag:"g",attributes:cn({},B.outer),children:[{tag:"g",attributes:cn({},B.inner),children:[{tag:i.icon.tag,children:i.icon.children,attributes:cn(cn({},i.icon.attributes),B.path)}]}]}}}},gb={x:0,y:0,width:"100%",height:"100%"};function ck(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return t.attributes&&(t.attributes.fill||e)&&(t.attributes.fill="black"),t}function $W(t){return t.tag==="g"?t.children:[t]}var VW={hooks:function(){return{parseNodeAttributes:function(n,i){var l=i.getAttribute("data-fa-mask"),d=l?py(l.split(" ").map(function(f){return f.trim()})):Fx();return d.prefix||(d.prefix=Tu()),n.mask=d,n.maskId=i.getAttribute("data-fa-mask-id"),n}}},provides:function(e){e.generateAbstractMask=function(n){var i=n.children,l=n.attributes,d=n.main,f=n.mask,o=n.maskId,y=n.transform,E=d.width,C=d.icon,A=f.width,P=f.icon,B=UH({transform:y,containerWidth:A,iconWidth:E}),j={tag:"rect",attributes:cn(cn({},gb),{},{fill:"white"})},Z=C.children?{children:C.children.map(ck)}:{},W={tag:"g",attributes:cn({},B.inner),children:[ck(cn({tag:C.tag,attributes:cn(cn({},C.attributes),B.path)},Z))]},H={tag:"g",attributes:cn({},B.outer),children:[W]},V="mask-".concat(o||Mm()),tt="clip-".concat(o||Mm()),ft={tag:"mask",attributes:cn(cn({},gb),{},{id:V,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"}),children:[j,H]},et={tag:"defs",children:[{tag:"clipPath",attributes:{id:tt},children:$W(P)},ft]};return i.push(et,{tag:"rect",attributes:cn({fill:"currentColor","clip-path":"url(#".concat(tt,")"),mask:"url(#".concat(V,")")},gb)}),{children:i,attributes:l}}}},GW={provides:function(e){var n=!1;Eu.matchMedia&&(n=Eu.matchMedia("(prefers-reduced-motion: reduce)").matches),e.missingIconAbstract=function(){var i=[],l={fill:"currentColor"},d={attributeType:"XML",repeatCount:"indefinite",dur:"2s"};i.push({tag:"path",attributes:cn(cn({},l),{},{d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"})});var f=cn(cn({},d),{},{attributeName:"opacity"}),o={tag:"circle",attributes:cn(cn({},l),{},{cx:"256",cy:"364",r:"28"}),children:[]};return n||o.children.push({tag:"animate",attributes:cn(cn({},d),{},{attributeName:"r",values:"28;14;28;28;14;28;"})},{tag:"animate",attributes:cn(cn({},f),{},{values:"1;0;1;1;0;1;"})}),i.push(o),i.push({tag:"path",attributes:cn(cn({},l),{},{opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"}),children:n?[]:[{tag:"animate",attributes:cn(cn({},f),{},{values:"1;0;0;0;0;1;"})}]}),n||i.push({tag:"path",attributes:cn(cn({},l),{},{opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"}),children:[{tag:"animate",attributes:cn(cn({},f),{},{values:"0;0;1;1;0;0;"})}]}),{tag:"g",attributes:{class:"missing"},children:i}}}},qW={hooks:function(){return{parseNodeAttributes:function(n,i){var l=i.getAttribute("data-fa-symbol"),d=l===null?!1:l===""?!0:l;return n.symbol=d,n}}}},HW=[GH,PW,LW,zW,OW,NW,jW,UW,VW,GW,qW];oW(HW,{mixoutsTo:Ba});Ba.noAuto;var vM=Ba.config,WW=Ba.library;Ba.dom;var I_=Ba.parse;Ba.findIconDefinition;Ba.toHtml;var ZW=Ba.icon;Ba.layer;var XW=Ba.text;Ba.counter;/*!
 * Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com
 * License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
 * Copyright 2022 Fonticons, Inc.
 */var YW={prefix:"fas",iconName:"arrow-left",icon:[448,512,[8592],"f060","M447.1 256C447.1 273.7 433.7 288 416 288H109.3l105.4 105.4c12.5 12.5 12.5 32.75 0 45.25C208.4 444.9 200.2 448 192 448s-16.38-3.125-22.62-9.375l-160-160c-12.5-12.5-12.5-32.75 0-45.25l160-160c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25L109.3 224H416C433.7 224 447.1 238.3 447.1 256z"]},KW={prefix:"fas",iconName:"arrow-right",icon:[448,512,[8594],"f061","M438.6 278.6l-160 160C272.4 444.9 264.2 448 256 448s-16.38-3.125-22.62-9.375c-12.5-12.5-12.5-32.75 0-45.25L338.8 288H32C14.33 288 .0016 273.7 .0016 256S14.33 224 32 224h306.8l-105.4-105.4c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0l160 160C451.1 245.9 451.1 266.1 438.6 278.6z"]},JW={prefix:"fas",iconName:"book",icon:[448,512,[128212],"f02d","M448 336v-288C448 21.49 426.5 0 400 0H96C42.98 0 0 42.98 0 96v320c0 53.02 42.98 96 96 96h320c17.67 0 32-14.33 32-31.1c0-11.72-6.607-21.52-16-27.1v-81.36C441.8 362.8 448 350.2 448 336zM143.1 128h192C344.8 128 352 135.2 352 144C352 152.8 344.8 160 336 160H143.1C135.2 160 128 152.8 128 144C128 135.2 135.2 128 143.1 128zM143.1 192h192C344.8 192 352 199.2 352 208C352 216.8 344.8 224 336 224H143.1C135.2 224 128 216.8 128 208C128 199.2 135.2 192 143.1 192zM384 448H96c-17.67 0-32-14.33-32-32c0-17.67 14.33-32 32-32h288V448z"]},QW={prefix:"fas",iconName:"calendar",icon:[448,512,[128198,128197],"f133","M96 32C96 14.33 110.3 0 128 0C145.7 0 160 14.33 160 32V64H288V32C288 14.33 302.3 0 320 0C337.7 0 352 14.33 352 32V64H400C426.5 64 448 85.49 448 112V160H0V112C0 85.49 21.49 64 48 64H96V32zM448 464C448 490.5 426.5 512 400 512H48C21.49 512 0 490.5 0 464V192H448V464z"]},tZ={prefix:"fas",iconName:"check",icon:[448,512,[10004,10003],"f00c","M438.6 105.4C451.1 117.9 451.1 138.1 438.6 150.6L182.6 406.6C170.1 419.1 149.9 419.1 137.4 406.6L9.372 278.6C-3.124 266.1-3.124 245.9 9.372 233.4C21.87 220.9 42.13 220.9 54.63 233.4L159.1 338.7L393.4 105.4C405.9 92.88 426.1 92.88 438.6 105.4H438.6z"]},eZ={prefix:"fas",iconName:"chevron-down",icon:[448,512,[],"f078","M224 416c-8.188 0-16.38-3.125-22.62-9.375l-192-192c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L224 338.8l169.4-169.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-192 192C240.4 412.9 232.2 416 224 416z"]},nZ={prefix:"fas",iconName:"chevron-up",icon:[448,512,[],"f077","M416 352c-8.188 0-16.38-3.125-22.62-9.375L224 173.3l-169.4 169.4c-12.5 12.5-32.75 12.5-45.25 0s-12.5-32.75 0-45.25l192-192c12.5-12.5 32.75-12.5 45.25 0l192 192c12.5 12.5 12.5 32.75 0 45.25C432.4 348.9 424.2 352 416 352z"]},rZ={prefix:"fas",iconName:"circle-info",icon:[512,512,["info-circle"],"f05a","M256 0C114.6 0 0 114.6 0 256s114.6 256 256 256s256-114.6 256-256S397.4 0 256 0zM256 128c17.67 0 32 14.33 32 32c0 17.67-14.33 32-32 32S224 177.7 224 160C224 142.3 238.3 128 256 128zM296 384h-80C202.8 384 192 373.3 192 360s10.75-24 24-24h16v-64H224c-13.25 0-24-10.75-24-24S210.8 224 224 224h32c13.25 0 24 10.75 24 24v88h16c13.25 0 24 10.75 24 24S309.3 384 296 384z"]},iZ=rZ,oZ={prefix:"fas",iconName:"clock-rotate-left",icon:[512,512,["history"],"f1da","M256 0C397.4 0 512 114.6 512 256C512 397.4 397.4 512 256 512C201.7 512 151.2 495 109.7 466.1C95.2 455.1 91.64 436 101.8 421.5C111.9 407 131.8 403.5 146.3 413.6C177.4 435.3 215.2 448 256 448C362 448 448 362 448 256C448 149.1 362 64 256 64C202.1 64 155 85.46 120.2 120.2L151 151C166.1 166.1 155.4 192 134.1 192H24C10.75 192 0 181.3 0 168V57.94C0 36.56 25.85 25.85 40.97 40.97L74.98 74.98C121.3 28.69 185.3 0 255.1 0L256 0zM256 128C269.3 128 280 138.7 280 152V246.1L344.1 311C354.3 320.4 354.3 335.6 344.1 344.1C335.6 354.3 320.4 354.3 311 344.1L239 272.1C234.5 268.5 232 262.4 232 256V152C232 138.7 242.7 128 256 128V128z"]},aZ=oZ,sZ={prefix:"fas",iconName:"file-code",icon:[384,512,[],"f1c9","M224 128L224 0H48C21.49 0 0 21.49 0 48v416C0 490.5 21.49 512 48 512h288c26.51 0 48-21.49 48-48V160h-127.1C238.3 160 224 145.7 224 128zM154.1 353.8c7.812 7.812 7.812 20.5 0 28.31C150.2 386.1 145.1 388 140 388s-10.23-1.938-14.14-5.844l-48-48c-7.812-7.812-7.812-20.5 0-28.31l48-48c7.812-7.812 20.47-7.812 28.28 0s7.812 20.5 0 28.31L120.3 320L154.1 353.8zM306.1 305.8c7.812 7.812 7.812 20.5 0 28.31l-48 48C254.2 386.1 249.1 388 244 388s-10.23-1.938-14.14-5.844c-7.812-7.812-7.812-20.5 0-28.31L263.7 320l-33.86-33.84c-7.812-7.812-7.812-20.5 0-28.31s20.47-7.812 28.28 0L306.1 305.8zM256 0v128h128L256 0z"]},lZ={prefix:"fas",iconName:"file-csv",icon:[384,512,[],"f6dd","M224 0V128C224 145.7 238.3 160 256 160H384V448C384 483.3 355.3 512 320 512H64C28.65 512 0 483.3 0 448V64C0 28.65 28.65 0 64 0H224zM80 224C57.91 224 40 241.9 40 264V344C40 366.1 57.91 384 80 384H96C118.1 384 136 366.1 136 344V336C136 327.2 128.8 320 120 320C111.2 320 104 327.2 104 336V344C104 348.4 100.4 352 96 352H80C75.58 352 72 348.4 72 344V264C72 259.6 75.58 256 80 256H96C100.4 256 104 259.6 104 264V272C104 280.8 111.2 288 120 288C128.8 288 136 280.8 136 272V264C136 241.9 118.1 224 96 224H80zM175.4 310.6L200.8 325.1C205.2 327.7 208 332.5 208 337.6C208 345.6 201.6 352 193.6 352H168C159.2 352 152 359.2 152 368C152 376.8 159.2 384 168 384H193.6C219.2 384 240 363.2 240 337.6C240 320.1 231.1 305.6 216.6 297.4L191.2 282.9C186.8 280.3 184 275.5 184 270.4C184 262.4 190.4 256 198.4 256H216C224.8 256 232 248.8 232 240C232 231.2 224.8 224 216 224H198.4C172.8 224 152 244.8 152 270.4C152 287 160.9 302.4 175.4 310.6zM280 240C280 231.2 272.8 224 264 224C255.2 224 248 231.2 248 240V271.6C248 306.3 258.3 340.3 277.6 369.2L282.7 376.9C285.7 381.3 290.6 384 296 384C301.4 384 306.3 381.3 309.3 376.9L314.4 369.2C333.7 340.3 344 306.3 344 271.6V240C344 231.2 336.8 224 328 224C319.2 224 312 231.2 312 240V271.6C312 294.6 306.5 317.2 296 337.5C285.5 317.2 280 294.6 280 271.6V240zM256 0L384 128H256V0z"]},cZ={prefix:"fas",iconName:"file-excel",icon:[384,512,[],"f1c3","M224 128L224 0H48C21.49 0 0 21.49 0 48v416C0 490.5 21.49 512 48 512h288c26.51 0 48-21.49 48-48V160h-127.1C238.3 160 224 145.7 224 128zM272.1 264.4L224 344l48.99 79.61C279.6 434.3 271.9 448 259.4 448h-26.43c-5.557 0-10.71-2.883-13.63-7.617L192 396l-27.31 44.38C161.8 445.1 156.6 448 151.1 448H124.6c-12.52 0-20.19-13.73-13.63-24.39L160 344L111 264.4C104.4 253.7 112.1 240 124.6 240h26.43c5.557 0 10.71 2.883 13.63 7.613L192 292l27.31-44.39C222.2 242.9 227.4 240 232.9 240h26.43C271.9 240 279.6 253.7 272.1 264.4zM256 0v128h128L256 0z"]},uZ={prefix:"fas",iconName:"file-lines",icon:[384,512,[128462,61686,128441,"file-alt","file-text"],"f15c","M256 0v128h128L256 0zM224 128L224 0H48C21.49 0 0 21.49 0 48v416C0 490.5 21.49 512 48 512h288c26.51 0 48-21.49 48-48V160h-127.1C238.3 160 224 145.7 224 128zM272 416h-160C103.2 416 96 408.8 96 400C96 391.2 103.2 384 112 384h160c8.836 0 16 7.162 16 16C288 408.8 280.8 416 272 416zM272 352h-160C103.2 352 96 344.8 96 336C96 327.2 103.2 320 112 320h160c8.836 0 16 7.162 16 16C288 344.8 280.8 352 272 352zM288 272C288 280.8 280.8 288 272 288h-160C103.2 288 96 280.8 96 272C96 263.2 103.2 256 112 256h160C280.8 256 288 263.2 288 272z"]},dZ={prefix:"fas",iconName:"forward-fast",icon:[512,512,[9197,"fast-forward"],"f050","M512 96.03v319.9c0 17.67-14.33 31.1-31.1 31.1C462.3 447.1 448 433.6 448 415.1V284.1l-171.5 156.5C255.9 457.7 224 443.3 224 415.1V284.1l-171.5 156.5C31.88 457.7 0 443.3 0 415.1V96.03c0-27.37 31.88-41.74 52.5-24.62L224 226.8V96.03c0-27.37 31.88-41.74 52.5-24.62L448 226.8V96.03c0-17.67 14.33-31.1 31.1-31.1C497.7 64.03 512 78.36 512 96.03z"]},hZ={prefix:"fas",iconName:"microphone-lines",icon:[384,512,[127897,"microphone-alt"],"f3c9","M192 352c53.03 0 96-42.97 96-96h-80C199.2 256 192 248.8 192 240S199.2 224 208 224H288V192h-80C199.2 192 192 184.8 192 176S199.2 160 208 160H288V127.1h-80c-8.836 0-16-7.164-16-16s7.164-16 16-16L288 96c0-53.03-42.97-96-96-96s-96 42.97-96 96v160C96 309 138.1 352 192 352zM344 192C330.7 192 320 202.7 320 215.1V256c0 73.33-61.97 132.4-136.3 127.7c-66.08-4.169-119.7-66.59-119.7-132.8L64 215.1C64 202.7 53.25 192 40 192S16 202.7 16 215.1v32.15c0 89.66 63.97 169.6 152 181.7V464H128c-18.19 0-32.84 15.18-31.96 33.57C96.43 505.8 103.8 512 112 512h160c8.222 0 15.57-6.216 15.96-14.43C288.8 479.2 274.2 464 256 464h-40v-33.77C301.7 418.5 368 344.9 368 256V215.1C368 202.7 357.3 192 344 192z"]},fZ={prefix:"fas",iconName:"pen-nib",icon:[512,512,[10001],"f5ad","M368.4 18.34C390.3-3.526 425.7-3.526 447.6 18.34L493.7 64.4C515.5 86.27 515.5 121.7 493.7 143.6L437.9 199.3L312.7 74.06L368.4 18.34zM417.4 224L371.4 377.3C365.4 397.2 350.2 413 330.5 419.6L66.17 508.2C54.83 512 42.32 509.2 33.74 500.9L187.3 347.3C193.6 350.3 200.6 352 207.1 352C234.5 352 255.1 330.5 255.1 304C255.1 277.5 234.5 256 207.1 256C181.5 256 159.1 277.5 159.1 304C159.1 311.4 161.7 318.4 164.7 324.7L11.11 478.3C2.809 469.7-.04 457.2 3.765 445.8L92.39 181.5C98.1 161.8 114.8 146.6 134.7 140.6L287.1 94.6L417.4 224z"]},pZ={prefix:"fas",iconName:"people-group",icon:[640,512,[],"e533","M184 88C184 118.9 158.9 144 128 144C97.07 144 72 118.9 72 88C72 57.07 97.07 32 128 32C158.9 32 184 57.07 184 88zM208.4 196.3C178.7 222.7 160 261.2 160 304C160 338.3 171.1 369.8 192 394.5V416C192 433.7 177.7 448 160 448H96C78.33 448 64 433.7 64 416V389.2C26.16 371.2 0 332.7 0 288C0 226.1 50.14 176 112 176H144C167.1 176 190.2 183.5 208.4 196.3V196.3zM64 245.7C54.04 256.9 48 271.8 48 288C48 304.2 54.04 319.1 64 330.3V245.7zM448 416V394.5C468 369.8 480 338.3 480 304C480 261.2 461.3 222.7 431.6 196.3C449.8 183.5 472 176 496 176H528C589.9 176 640 226.1 640 288C640 332.7 613.8 371.2 576 389.2V416C576 433.7 561.7 448 544 448H480C462.3 448 448 433.7 448 416zM576 330.3C585.1 319.1 592 304.2 592 288C592 271.8 585.1 256.9 576 245.7V330.3zM568 88C568 118.9 542.9 144 512 144C481.1 144 456 118.9 456 88C456 57.07 481.1 32 512 32C542.9 32 568 57.07 568 88zM256 96C256 60.65 284.7 32 320 32C355.3 32 384 60.65 384 96C384 131.3 355.3 160 320 160C284.7 160 256 131.3 256 96zM448 304C448 348.7 421.8 387.2 384 405.2V448C384 465.7 369.7 480 352 480H288C270.3 480 256 465.7 256 448V405.2C218.2 387.2 192 348.7 192 304C192 242.1 242.1 192 304 192H336C397.9 192 448 242.1 448 304zM256 346.3V261.7C246 272.9 240 287.8 240 304C240 320.2 246 335.1 256 346.3zM384 261.7V346.3C393.1 335 400 320.2 400 304C400 287.8 393.1 272.9 384 261.7z"]},mZ={prefix:"fas",iconName:"person",icon:[320,512,[129485,"male"],"f183","M208 48C208 74.51 186.5 96 160 96C133.5 96 112 74.51 112 48C112 21.49 133.5 0 160 0C186.5 0 208 21.49 208 48zM152 352V480C152 497.7 137.7 512 120 512C102.3 512 88 497.7 88 480V256.9L59.43 304.5C50.33 319.6 30.67 324.5 15.52 315.4C.3696 306.3-4.531 286.7 4.573 271.5L62.85 174.6C80.2 145.7 111.4 128 145.1 128H174.9C208.6 128 239.8 145.7 257.2 174.6L315.4 271.5C324.5 286.7 319.6 306.3 304.5 315.4C289.3 324.5 269.7 319.6 260.6 304.5L232 256.9V480C232 497.7 217.7 512 200 512C182.3 512 168 497.7 168 480V352L152 352z"]},gZ={prefix:"fas",iconName:"question",icon:[320,512,[10067,10068,61736],"3f","M204.3 32.01H96c-52.94 0-96 43.06-96 96c0 17.67 14.31 31.1 32 31.1s32-14.32 32-31.1c0-17.64 14.34-32 32-32h108.3C232.8 96.01 256 119.2 256 147.8c0 19.72-10.97 37.47-30.5 47.33L127.8 252.4C117.1 258.2 112 268.7 112 280v40c0 17.67 14.31 31.99 32 31.99s32-14.32 32-31.99V298.3L256 251.3c39.47-19.75 64-59.42 64-103.5C320 83.95 268.1 32.01 204.3 32.01zM144 400c-22.09 0-40 17.91-40 40s17.91 39.1 40 39.1s40-17.9 40-39.1S166.1 400 144 400z"]},_Z={prefix:"fas",iconName:"signs-post",icon:[512,512,["map-signs"],"f277","M223.1 32C223.1 14.33 238.3 0 255.1 0C273.7 0 288 14.33 288 32H441.4C445.6 32 449.7 33.69 452.7 36.69L500.7 84.69C506.9 90.93 506.9 101.1 500.7 107.3L452.7 155.3C449.7 158.3 445.6 160 441.4 160H63.1C46.33 160 31.1 145.7 31.1 128V64C31.1 46.33 46.33 32 63.1 32L223.1 32zM480 320C480 337.7 465.7 352 448 352H70.63C66.38 352 62.31 350.3 59.31 347.3L11.31 299.3C5.065 293.1 5.065 282.9 11.31 276.7L59.31 228.7C62.31 225.7 66.38 223.1 70.63 223.1H223.1V191.1H288V223.1H448C465.7 223.1 480 238.3 480 255.1V320zM255.1 512C238.3 512 223.1 497.7 223.1 480V384H288V480C288 497.7 273.7 512 255.1 512z"]},yZ=_Z,bZ={prefix:"fas",iconName:"up-right-from-square",icon:[512,512,["external-link-alt"],"f35d","M384 320c-17.67 0-32 14.33-32 32v96H64V160h96c17.67 0 32-14.32 32-32s-14.33-32-32-32L64 96c-35.35 0-64 28.65-64 64V448c0 35.34 28.65 64 64 64h288c35.35 0 64-28.66 64-64v-96C416 334.3 401.7 320 384 320zM488 0H352c-12.94 0-24.62 7.797-29.56 19.75c-4.969 11.97-2.219 25.72 6.938 34.88L370.8 96L169.4 297.4c-12.5 12.5-12.5 32.75 0 45.25C175.6 348.9 183.8 352 192 352s16.38-3.125 22.62-9.375L416 141.3l41.38 41.38c9.156 9.141 22.88 11.84 34.88 6.938C504.2 184.6 512 172.9 512 160V24C512 10.74 501.3 0 488 0z"]},vZ=bZ,xZ={prefix:"fas",iconName:"xmark",icon:[320,512,[128473,10005,10006,10060,215,"close","multiply","remove","times"],"f00d","M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"]},wZ=xZ;/*!
 * Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com
 * License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
 * Copyright 2022 Fonticons, Inc.
 */var EZ={prefix:"fab",iconName:"facebook",icon:[512,512,[62e3],"f09a","M504 256C504 119 393 8 256 8S8 119 8 256c0 123.8 90.69 226.4 209.3 245V327.7h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.3 482.4 504 379.8 504 256z"]},TZ={prefix:"fab",iconName:"instagram",icon:[448,512,[],"f16d","M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"]},kZ={prefix:"fab",iconName:"snapchat",icon:[512,512,[62124,"snapchat-ghost"],"f2ab","M496.9 366.6c-3.373-9.176-9.8-14.09-17.11-18.15-1.376-.806-2.641-1.451-3.72-1.947-2.182-1.128-4.414-2.22-6.634-3.373-22.8-12.09-40.61-27.34-52.96-45.42a102.9 102.9 0 0 1 -9.089-16.12c-1.054-3.013-1-4.724-.248-6.287a10.22 10.22 0 0 1 2.914-3.038c3.918-2.591 7.96-5.22 10.7-6.993 4.885-3.162 8.754-5.667 11.25-7.44 9.362-6.547 15.91-13.5 20-21.28a42.37 42.37 0 0 0 2.1-35.19c-6.2-16.32-21.61-26.45-40.29-26.45a55.54 55.54 0 0 0 -11.72 1.24c-1.029 .224-2.059 .459-3.063 .72 .174-11.16-.074-22.94-1.066-34.53-3.522-40.76-17.79-62.12-32.67-79.16A130.2 130.2 0 0 0 332.1 36.44C309.5 23.55 283.9 17 256 17S202.6 23.55 180 36.44a129.7 129.7 0 0 0 -33.28 26.78c-14.88 17.04-29.15 38.44-32.67 79.16-.992 11.59-1.24 23.43-1.079 34.53-1-.26-2.021-.5-3.051-.719a55.46 55.46 0 0 0 -11.72-1.24c-18.69 0-34.13 10.13-40.3 26.45a42.42 42.42 0 0 0 2.046 35.23c4.105 7.774 10.65 14.73 20.01 21.28 2.48 1.736 6.361 4.24 11.25 7.44 2.641 1.711 6.5 4.216 10.28 6.72a11.05 11.05 0 0 1 3.3 3.311c.794 1.624 .818 3.373-.36 6.6a102 102 0 0 1 -8.94 15.78c-12.08 17.67-29.36 32.65-51.43 44.64C32.35 348.6 20.2 352.8 15.07 366.7c-3.868 10.53-1.339 22.51 8.494 32.6a49.14 49.14 0 0 0 12.4 9.387 134.3 134.3 0 0 0 30.34 12.14 20.02 20.02 0 0 1 6.126 2.741c3.583 3.137 3.075 7.861 7.849 14.78a34.47 34.47 0 0 0 8.977 9.127c10.02 6.919 21.28 7.353 33.21 7.811 10.78 .41 22.99 .881 36.94 5.481 5.778 1.91 11.78 5.605 18.74 9.92C194.8 480.1 217.7 495 255.1 495s61.29-14.12 78.12-24.43c6.907-4.24 12.87-7.9 18.49-9.758 13.95-4.613 26.16-5.072 36.94-5.481 11.93-.459 23.19-.893 33.21-7.812a34.58 34.58 0 0 0 10.22-11.16c3.434-5.84 3.348-9.919 6.572-12.77a18.97 18.97 0 0 1 5.753-2.629A134.9 134.9 0 0 0 476 408.7a48.34 48.34 0 0 0 13.02-10.19l.124-.149C498.4 388.5 500.7 376.9 496.9 366.6zm-34.01 18.28c-20.75 11.46-34.53 10.23-45.26 17.14-9.114 5.865-3.72 18.51-10.34 23.08-8.134 5.617-32.18-.4-63.24 9.858-25.62 8.469-41.96 32.82-88.04 32.82s-62.04-24.3-88.08-32.88c-31-10.26-55.09-4.241-63.24-9.858-6.609-4.563-1.24-17.21-10.34-23.08-10.74-6.907-24.53-5.679-45.26-17.08-13.21-7.291-5.716-11.8-1.314-13.94 75.14-36.38 87.13-92.55 87.67-96.72 .645-5.046 1.364-9.014-4.191-14.15-5.369-4.96-29.19-19.7-35.8-24.32-10.94-7.638-15.75-15.26-12.2-24.64 2.48-6.485 8.531-8.928 14.88-8.928a27.64 27.64 0 0 1 5.965 .67c12 2.6 23.66 8.617 30.39 10.24a10.75 10.75 0 0 0 2.48 .335c3.6 0 4.86-1.811 4.612-5.927-.768-13.13-2.628-38.72-.558-62.64 2.84-32.91 13.44-49.22 26.04-63.64 6.051-6.932 34.48-36.98 88.86-36.98s82.88 29.92 88.93 36.83c12.61 14.42 23.23 30.73 26.04 63.64 2.071 23.92 .285 49.53-.558 62.64-.285 4.327 1.017 5.927 4.613 5.927a10.65 10.65 0 0 0 2.48-.335c6.745-1.624 18.4-7.638 30.4-10.24a27.64 27.64 0 0 1 5.964-.67c6.386 0 12.4 2.48 14.88 8.928 3.546 9.374-1.24 17-12.19 24.64-6.609 4.612-30.43 19.34-35.8 24.32-5.568 5.134-4.836 9.1-4.191 14.15 .533 4.228 12.51 60.4 87.67 96.72C468.6 373 476.1 377.5 462.9 384.9z"]},CZ={prefix:"fab",iconName:"twitter",icon:[512,512,[],"f099","M459.4 151.7c.325 4.548 .325 9.097 .325 13.65 0 138.7-105.6 298.6-298.6 298.6-59.45 0-114.7-17.22-161.1-47.11 8.447 .974 16.57 1.299 25.34 1.299 49.06 0 94.21-16.57 130.3-44.83-46.13-.975-84.79-31.19-98.11-72.77 6.498 .974 12.99 1.624 19.82 1.624 9.421 0 18.84-1.3 27.61-3.573-48.08-9.747-84.14-51.98-84.14-102.1v-1.299c13.97 7.797 30.21 12.67 47.43 13.32-28.26-18.84-46.78-51.01-46.78-87.39 0-19.49 5.197-37.36 14.29-52.95 51.65 63.67 129.3 105.3 216.4 109.8-1.624-7.797-2.599-15.92-2.599-24.04 0-57.83 46.78-104.9 104.9-104.9 30.21 0 57.5 12.67 76.67 33.14 23.72-4.548 46.46-13.32 66.6-25.34-7.798 24.37-24.37 44.83-46.13 57.83 21.12-2.273 41.58-8.122 60.43-16.24-14.29 20.79-32.16 39.31-52.63 54.25z"]},SZ={prefix:"fab",iconName:"wikipedia-w",icon:[640,512,[],"f266","M640 51.2l-.3 12.2c-28.1 .8-45 15.8-55.8 40.3-25 57.8-103.3 240-155.3 358.6H415l-81.9-193.1c-32.5 63.6-68.3 130-99.2 193.1-.3 .3-15 0-15-.3C172 352.3 122.8 243.4 75.8 133.4 64.4 106.7 26.4 63.4 .2 63.7c0-3.1-.3-10-.3-14.2h161.9v13.9c-19.2 1.1-52.8 13.3-43.3 34.2 21.9 49.7 103.6 240.3 125.6 288.6 15-29.7 57.8-109.2 75.3-142.8-13.9-28.3-58.6-133.9-72.8-160-9.7-17.8-36.1-19.4-55.8-19.7V49.8l142.5 .3v13.1c-19.4 .6-38.1 7.8-29.4 26.1 18.9 40 30.6 68.1 48.1 104.7 5.6-10.8 34.7-69.4 48.1-100.8 8.9-20.6-3.9-28.6-38.6-29.4 .3-3.6 0-10.3 .3-13.6 44.4-.3 111.1-.3 123.1-.6v13.6c-22.5 .8-45.8 12.8-58.1 31.7l-59.2 122.8c6.4 16.1 63.3 142.8 69.2 156.7L559.2 91.8c-8.6-23.1-36.4-28.1-47.2-28.3V49.6l127.8 1.1 .2 .5z"]};function uk(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),n.push.apply(n,i)}return n}function Rs(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?uk(Object(n),!0).forEach(function(i){ma(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):uk(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function P_(t){return P_=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},P_(t)}function ma(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function MZ(t,e){if(t==null)return{};var n={},i=Object.keys(t),l,d;for(d=0;d<i.length;d++)l=i[d],!(e.indexOf(l)>=0)&&(n[l]=t[l]);return n}function AZ(t,e){if(t==null)return{};var n=MZ(t,e),i,l;if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(t);for(l=0;l<d.length;l++)i=d[l],!(e.indexOf(i)>=0)&&(!Object.prototype.propertyIsEnumerable.call(t,i)||(n[i]=t[i]))}return n}function Ev(t){return IZ(t)||PZ(t)||LZ(t)||zZ()}function IZ(t){if(Array.isArray(t))return Tv(t)}function PZ(t){if(typeof Symbol!="undefined"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function LZ(t,e){if(!!t){if(typeof t=="string")return Tv(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Tv(t,e)}}function Tv(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function zZ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var OZ=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},xM={exports:{}};(function(t){(function(e){var n=function(H,V,tt){if(!E(V)||A(V)||P(V)||B(V)||y(V))return V;var ft,et=0,Pt=0;if(C(V))for(ft=[],Pt=V.length;et<Pt;et++)ft.push(n(H,V[et],tt));else{ft={};for(var Rt in V)Object.prototype.hasOwnProperty.call(V,Rt)&&(ft[H(Rt,tt)]=n(H,V[Rt],tt))}return ft},i=function(H,V){V=V||{};var tt=V.separator||"_",ft=V.split||/(?=[A-Z])/;return H.split(ft).join(tt)},l=function(H){return j(H)?H:(H=H.replace(/[\-_\s]+(.)?/g,function(V,tt){return tt?tt.toUpperCase():""}),H.substr(0,1).toLowerCase()+H.substr(1))},d=function(H){var V=l(H);return V.substr(0,1).toUpperCase()+V.substr(1)},f=function(H,V){return i(H,V).toLowerCase()},o=Object.prototype.toString,y=function(H){return typeof H=="function"},E=function(H){return H===Object(H)},C=function(H){return o.call(H)=="[object Array]"},A=function(H){return o.call(H)=="[object Date]"},P=function(H){return o.call(H)=="[object RegExp]"},B=function(H){return o.call(H)=="[object Boolean]"},j=function(H){return H=H-0,H===H},Z=function(H,V){var tt=V&&"process"in V?V.process:V;return typeof tt!="function"?H:function(ft,et){return tt(ft,H,et)}},W={camelize:l,decamelize:f,pascalize:d,depascalize:f,camelizeKeys:function(H,V){return n(Z(l,V),H)},decamelizeKeys:function(H,V){return n(Z(f,V),H,V)},pascalizeKeys:function(H,V){return n(Z(d,V),H)},depascalizeKeys:function(){return this.decamelizeKeys.apply(this,arguments)}};t.exports?t.exports=W:e.humps=W})(OZ)})(xM);var DZ=xM.exports,RZ=["class","style"];function BZ(t){return t.split(";").map(function(e){return e.trim()}).filter(function(e){return e}).reduce(function(e,n){var i=n.indexOf(":"),l=DZ.camelize(n.slice(0,i)),d=n.slice(i+1).trim();return e[l]=d,e},{})}function FZ(t){return t.split(/\s+/).reduce(function(e,n){return e[n]=!0,e},{})}function $x(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(typeof t=="string")return t;var i=(t.children||[]).map(function(y){return $x(y)}),l=Object.keys(t.attributes||{}).reduce(function(y,E){var C=t.attributes[E];switch(E){case"class":y.class=FZ(C);break;case"style":y.style=BZ(C);break;default:y.attrs[E]=C}return y},{attrs:{},class:{},style:{}});n.class;var d=n.style,f=d===void 0?{}:d,o=AZ(n,RZ);return Uo(t.tag,Rs(Rs(Rs({},e),{},{class:l.class,style:Rs(Rs({},l.style),f)},l.attrs),o),i)}var wM=!1;try{wM=!0}catch{}function NZ(){if(!wM&&console&&typeof console.error=="function"){var t;(t=console).error.apply(t,arguments)}}function am(t,e){return Array.isArray(e)&&e.length>0||!Array.isArray(e)&&e?ma({},t,e):{}}function jZ(t){var e,n=(e={"fa-spin":t.spin,"fa-pulse":t.pulse,"fa-fw":t.fixedWidth,"fa-border":t.border,"fa-li":t.listItem,"fa-inverse":t.inverse,"fa-flip":t.flip===!0,"fa-flip-horizontal":t.flip==="horizontal"||t.flip==="both","fa-flip-vertical":t.flip==="vertical"||t.flip==="both"},ma(e,"fa-".concat(t.size),t.size!==null),ma(e,"fa-rotate-".concat(t.rotation),t.rotation!==null),ma(e,"fa-pull-".concat(t.pull),t.pull!==null),ma(e,"fa-swap-opacity",t.swapOpacity),ma(e,"fa-bounce",t.bounce),ma(e,"fa-shake",t.shake),ma(e,"fa-beat",t.beat),ma(e,"fa-fade",t.fade),ma(e,"fa-beat-fade",t.beatFade),ma(e,"fa-flash",t.flash),ma(e,"fa-spin-pulse",t.spinPulse),ma(e,"fa-spin-reverse",t.spinReverse),e);return Object.keys(n).map(function(i){return n[i]?i:null}).filter(function(i){return i})}function dk(t){if(t&&P_(t)==="object"&&t.prefix&&t.iconName&&t.icon)return t;if(I_.icon)return I_.icon(t);if(t===null)return null;if(P_(t)==="object"&&t.prefix&&t.iconName)return t;if(Array.isArray(t)&&t.length===2)return{prefix:t[0],iconName:t[1]};if(typeof t=="string")return{prefix:"fas",iconName:t}}var UZ=gr({name:"FontAwesomeIcon",props:{border:{type:Boolean,default:!1},fixedWidth:{type:Boolean,default:!1},flip:{type:[Boolean,String],default:!1,validator:function(e){return[!0,!1,"horizontal","vertical","both"].indexOf(e)>-1}},icon:{type:[Object,Array,String],required:!0},mask:{type:[Object,Array,String],default:null},listItem:{type:Boolean,default:!1},pull:{type:String,default:null,validator:function(e){return["right","left"].indexOf(e)>-1}},pulse:{type:Boolean,default:!1},rotation:{type:[String,Number],default:null,validator:function(e){return[90,180,270].indexOf(Number.parseInt(e,10))>-1}},swapOpacity:{type:Boolean,default:!1},size:{type:String,default:null,validator:function(e){return["2xs","xs","sm","lg","xl","2xl","1x","2x","3x","4x","5x","6x","7x","8x","9x","10x"].indexOf(e)>-1}},spin:{type:Boolean,default:!1},transform:{type:[String,Object],default:null},symbol:{type:[Boolean,String],default:!1},title:{type:String,default:null},inverse:{type:Boolean,default:!1},bounce:{type:Boolean,default:!1},shake:{type:Boolean,default:!1},beat:{type:Boolean,default:!1},fade:{type:Boolean,default:!1},beatFade:{type:Boolean,default:!1},flash:{type:Boolean,default:!1},spinPulse:{type:Boolean,default:!1},spinReverse:{type:Boolean,default:!1}},setup:function(e,n){var i=n.attrs,l=mr(function(){return dk(e.icon)}),d=mr(function(){return am("classes",jZ(e))}),f=mr(function(){return am("transform",typeof e.transform=="string"?I_.transform(e.transform):e.transform)}),o=mr(function(){return am("mask",dk(e.mask))}),y=mr(function(){return ZW(l.value,Rs(Rs(Rs(Rs({},d.value),f.value),o.value),{},{symbol:e.symbol,title:e.title}))});$r(y,function(C){if(!C)return NZ("Could not find one or more icon(s)",l.value,o.value)},{immediate:!0});var E=mr(function(){return y.value?$x(y.value.abstract[0],{},i):null});return function(){return E.value}}});gr({name:"FontAwesomeLayers",props:{fixedWidth:{type:Boolean,default:!1}},setup:function(e,n){var i=n.slots,l=vM.familyPrefix,d=mr(function(){return["".concat(l,"-layers")].concat(Ev(e.fixedWidth?["".concat(l,"-fw")]:[]))});return function(){return Uo("div",{class:d.value},i.default?i.default():[])}}});gr({name:"FontAwesomeLayersText",props:{value:{type:[String,Number],default:""},transform:{type:[String,Object],default:null},counter:{type:Boolean,default:!1},position:{type:String,default:null,validator:function(e){return["bottom-left","bottom-right","top-left","top-right"].indexOf(e)>-1}}},setup:function(e,n){var i=n.attrs,l=vM.familyPrefix,d=mr(function(){return am("classes",[].concat(Ev(e.counter?["".concat(l,"-layers-counter")]:[]),Ev(e.position?["".concat(l,"-layers-").concat(e.position)]:[])))}),f=mr(function(){return am("transform",typeof e.transform=="string"?I_.transform(e.transform):e.transform)}),o=mr(function(){var E=XW(e.value.toString(),Rs(Rs({},f.value),d.value)),C=E.abstract;return e.counter&&(C[0].attributes.class=C[0].attributes.class.replace("fa-layers-text","")),C[0]}),y=mr(function(){return $x(o.value,{},i)});return function(){return y.value}}});WW.add(aZ,wZ,tZ,yZ,gZ,nZ,eZ,vZ,CZ,EZ,TZ,kZ,SZ,iZ,KW,pZ,mZ,YW,lZ,sZ,cZ,JW,uZ,dZ,QW,fZ,hZ);var hk=yf(t=>{t.vueApp.component("FontAwesomeIcon",UZ)});var Vx={},Gx={};Object.defineProperty(Gx,"__esModule",{value:!0});class $Z{constructor(e=null){this.state="pending",this.fate="unresolved",this._val=e||null,this.promise=new Promise((n,i)=>{this._resolve=n,this._reject=i}),this.promise.then(n=>{this.state="fulfilled",this._val=n},()=>{this.state="rejected",this._val=null})}resolve(e){if(this.fate==="resolved")throw"Deferred cannot be resolved twice";this.fate="resolved",this._resolve(e)}reject(e){if(this.fate==="resolved")throw"Deferred cannot be resolved twice";this.fate="resolved",this._reject(e)}isResolved(){return this.fate==="resolved"}isPending(){return this.state==="pending"}isFulfilled(){return this.state==="fulfilled"}isRejected(){return this.state==="rejected"}get val(){return this._val}}Gx.default=$Z;var VZ=bo&&bo.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Vx,"__esModule",{value:!0});const GZ=VZ(Gx);var Zd=Vx.default=GZ.default,gy={exports:{}};(function(t,e){(function(n,i){t.exports=i()})(bo,function(){var n,i,l;function d(o,y){if(!n)n=y;else if(!i)i=y;else{var E="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+n+")(sharedChunk); ("+i+")(sharedChunk); self.onerror = null;",C={};n(C),l=y(C),typeof window!="undefined"&&window&&window.URL&&window.URL.createObjectURL&&(l.workerUrl=window.URL.createObjectURL(new Blob([E],{type:"text/javascript"})))}}d(["exports"],function(o){var y=typeof self!="undefined"?self:{},E="2.13.0";let C;const A={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(C==null){const a=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{C={}.API_URL_REGEX!=null?new RegExp({}.API_URL_REGEX):a}catch{C=a}}return C},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},P={supported:!1,testSupport:function(a){!Z&&j&&(W?H(a):B=a)}};let B,j,Z=!1,W=!1;function H(a){const r=a.createTexture();a.bindTexture(a.TEXTURE_2D,r);try{if(a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,j),a.isContextLost())return;P.supported=!0}catch{}a.deleteTexture(r),Z=!0}y.document&&(j=y.document.createElement("img"),j.onload=function(){B&&H(B),B=null,W=!0},j.onerror=function(){Z=!0,B=null},j.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const V="01";var tt=ft;function ft(a,r,s,u){this.cx=3*a,this.bx=3*(s-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(u-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=r,this.p2x=s,this.p2y=u}ft.prototype={sampleCurveX:function(a){return((this.ax*a+this.bx)*a+this.cx)*a},sampleCurveY:function(a){return((this.ay*a+this.by)*a+this.cy)*a},sampleCurveDerivativeX:function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},solveCurveX:function(a,r){if(r===void 0&&(r=1e-6),a<0)return 0;if(a>1)return 1;for(var s=a,u=0;u<8;u++){var p=this.sampleCurveX(s)-a;if(Math.abs(p)<r)return s;var g=this.sampleCurveDerivativeX(s);if(Math.abs(g)<1e-6)break;s-=p/g}var b=0,x=1;for(s=a,u=0;u<20&&(p=this.sampleCurveX(s),!(Math.abs(p-a)<r));u++)a>p?b=s:x=s,s=.5*(x-b)+b;return s},solve:function(a,r){return this.sampleCurveY(this.solveCurveX(a,r))}};var et=Pt;function Pt(a,r){this.x=a,this.y=r}Pt.prototype={clone:function(){return new Pt(this.x,this.y)},add:function(a){return this.clone()._add(a)},sub:function(a){return this.clone()._sub(a)},multByPoint:function(a){return this.clone()._multByPoint(a)},divByPoint:function(a){return this.clone()._divByPoint(a)},mult:function(a){return this.clone()._mult(a)},div:function(a){return this.clone()._div(a)},rotate:function(a){return this.clone()._rotate(a)},rotateAround:function(a,r){return this.clone()._rotateAround(a,r)},matMult:function(a){return this.clone()._matMult(a)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(a){return this.x===a.x&&this.y===a.y},dist:function(a){return Math.sqrt(this.distSqr(a))},distSqr:function(a){var r=a.x-this.x,s=a.y-this.y;return r*r+s*s},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(a){return Math.atan2(this.y-a.y,this.x-a.x)},angleWith:function(a){return this.angleWithSep(a.x,a.y)},angleWithSep:function(a,r){return Math.atan2(this.x*r-this.y*a,this.x*a+this.y*r)},_matMult:function(a){var r=a[2]*this.x+a[3]*this.y;return this.x=a[0]*this.x+a[1]*this.y,this.y=r,this},_add:function(a){return this.x+=a.x,this.y+=a.y,this},_sub:function(a){return this.x-=a.x,this.y-=a.y,this},_mult:function(a){return this.x*=a,this.y*=a,this},_div:function(a){return this.x/=a,this.y/=a,this},_multByPoint:function(a){return this.x*=a.x,this.y*=a.y,this},_divByPoint:function(a){return this.x/=a.x,this.y/=a.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var a=this.y;return this.y=this.x,this.x=-a,this},_rotate:function(a){var r=Math.cos(a),s=Math.sin(a),u=s*this.x+r*this.y;return this.x=r*this.x-s*this.y,this.y=u,this},_rotateAround:function(a,r){var s=Math.cos(a),u=Math.sin(a),p=r.y+u*(this.x-r.x)+s*(this.y-r.y);return this.x=r.x+s*(this.x-r.x)-u*(this.y-r.y),this.y=p,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Pt.convert=function(a){return a instanceof Pt?a:Array.isArray(a)?new Pt(a[0],a[1]):a};const Rt=Math.PI/180,zt=180/Math.PI;function jt(a){return a*Rt}function oe(a){return a*zt}const ge=[[0,0],[1,0],[1,1],[0,1]];function ce(a){if(a<=0)return 0;if(a>=1)return 1;const r=a*a,s=r*a;return 4*(a<.5?s:3*(a-r)+s-.75)}function Ue(a,r,s,u){const p=new tt(a,r,s,u);return function(g){return p.solve(g)}}const Ae=Ue(.25,.1,.25,1);function se(a,r,s){return Math.min(s,Math.max(r,a))}function Ze(a,r,s){return(s=se((s-a)/(r-a),0,1))*s*(3-2*s)}function gn(a,r,s){const u=s-r,p=((a-r)%u+u)%u+r;return p===r?s:p}function _n(a,r,s){if(!a.length)return s(null,[]);let u=a.length;const p=new Array(a.length);let g=null;a.forEach((b,x)=>{r(b,(T,k)=>{T&&(g=T),p[x]=k,--u==0&&s(g,p)})})}function Gn(a){const r=[];for(const s in a)r.push(a[s]);return r}function Jn(a,...r){for(const s of r)for(const u in s)a[u]=s[u];return a}let Wn=1;function ur(){return Wn++}function Zn(){return function a(r){return r?(r^Math.random()*(16>>r/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,a)}()}function _r(a){return a<=1?1:Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))}function he(a){return!!a&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(a)}function He(a,r){a.forEach(s=>{r[s]&&(r[s]=r[s].bind(r))})}function Ce(a,r){return a.indexOf(r,a.length-r.length)!==-1}function Te(a,r,s){const u={};for(const p in a)u[p]=r.call(s||this,a[p],p,a);return u}function Qn(a,r,s){const u={};for(const p in a)r.call(s||this,a[p],p,a)&&(u[p]=a[p]);return u}function Bn(a){return Array.isArray(a)?a.map(Bn):typeof a=="object"&&a?Te(a,Bn):a}const Ln={};function Qe(a){Ln[a]||(typeof console!="undefined"&&console.warn(a),Ln[a]=!0)}function bt(a,r,s){return(s.y-a.y)*(r.x-a.x)>(r.y-a.y)*(s.x-a.x)}function vt(a){let r=0;for(let s,u,p=0,g=a.length,b=g-1;p<g;b=p++)s=a[p],u=a[b],r+=(u.x-s.x)*(s.y+u.y);return r}function Jt(){return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope}function fe(a){const r={};if(a.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(s,u,p,g)=>{const b=p||g;return r[u]=!b||b.toLowerCase(),""}),r["max-age"]){const s=parseInt(r["max-age"],10);isNaN(s)?delete r["max-age"]:r["max-age"]=s}return r}let be=null;function Ie(a){if(be==null){const r=a.navigator?a.navigator.userAgent:null;be=!!a.safari||!(!r||!(/\b(iPad|iPhone|iPod)\b/.test(r)||r.match("Safari")&&!r.match("Chrome")))}return be}function Ge(a){try{const r=y[a];return r.setItem("_mapbox_test_",1),r.removeItem("_mapbox_test_"),!0}catch{return!1}}function Me(a,r){return[a[4*r],a[4*r+1],a[4*r+2],a[4*r+3]]}const ze="mapbox-tiles";let ve,Ye,Ke=500,on=50;function vn(){try{return y.caches}catch{}}function Mn(){vn()&&!ve&&(ve=y.caches.open(ze))}function Xn(a){const r=a.indexOf("?");if(r<0)return a;const s=function(p){const g=p.indexOf("?");return g>0?p.slice(g+1).split("&"):[]}(a),u=s.filter(p=>{const g=p.split("=");return g[0]==="language"||g[0]==="worldview"});return u.length?`${a.slice(0,r)}?${u.join("&")}`:a.slice(0,r)}let Yn=1/0;const nr={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(nr);class Rr extends Error{constructor(r,s,u){s===401&&ds(u)&&(r+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(r),this.status=s,this.url=u}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Io=Jt()?()=>self.worker&&self.worker.referrer:()=>(y.location.protocol==="blob:"?y.parent:y).location.href,Ui=function(a,r){if(!(/^file:/.test(s=a.url)||/^file:/.test(Io())&&!/^\w+:/.test(s))){if(y.fetch&&y.Request&&y.AbortController&&y.Request.prototype.hasOwnProperty("signal"))return function(u,p){const g=new y.AbortController,b=new y.Request(u.url,{method:u.method||"GET",body:u.body,credentials:u.credentials,headers:u.headers,referrer:Io(),signal:g.signal});let x=!1,T=!1;const k=(L=b.url).indexOf("sku=")>0&&ds(L);var L;u.type==="json"&&b.headers.set("Accept","application/json");const O=(U,$,X)=>{if(T)return;if(U&&U.message!=="SecurityError"&&Qe(U),$&&X)return R($);const nt=Date.now();y.fetch(b).then(dt=>{if(dt.ok){const yt=k?dt.clone():null;return R(dt,yt,nt)}return p(new Rr(dt.statusText,dt.status,u.url))}).catch(dt=>{dt.name!=="AbortError"&&p(new Error(`${dt.message} ${u.url}`))})},R=(U,$,X)=>{(u.type==="arrayBuffer"?U.arrayBuffer():u.type==="json"?U.json():U.text()).then(nt=>{T||($&&X&&function(dt,yt,lt){if(Mn(),!ve)return;const _t={status:yt.status,statusText:yt.statusText,headers:new y.Headers};yt.headers.forEach((qt,$t)=>_t.headers.set($t,qt));const Et=fe(yt.headers.get("Cache-Control")||"");if(Et["no-store"])return;Et["max-age"]&&_t.headers.set("Expires",new Date(lt+1e3*Et["max-age"]).toUTCString());const xt=_t.headers.get("Expires");xt&&(new Date(xt).getTime()-lt<42e4||function(qt,$t){if(Ye===void 0)try{new Response(new ReadableStream),Ye=!0}catch{Ye=!1}Ye?$t(qt.body):qt.blob().then($t)}(yt,qt=>{const $t=new y.Response(qt,_t);Mn(),ve&&ve.then(Qt=>Qt.put(Xn(dt.url),$t)).catch(Qt=>Qe(Qt.message))}))}(b,$,X),x=!0,p(null,nt,U.headers.get("Cache-Control"),U.headers.get("Expires")))}).catch(nt=>{T||p(new Error(nt.message))})};return k?function(U,$){if(Mn(),!ve)return $(null);const X=Xn(U.url);ve.then(nt=>{nt.match(X).then(dt=>{const yt=function(lt){if(!lt)return!1;const _t=new Date(lt.headers.get("Expires")||0),Et=fe(lt.headers.get("Cache-Control")||"");return _t>Date.now()&&!Et["no-cache"]}(dt);nt.delete(X),yt&&nt.put(X,dt.clone()),$(null,dt,yt)}).catch($)}).catch($)}(b,O):O(null,null),{cancel:()=>{T=!0,x||g.abort()}}}(a,r);if(Jt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",a,r,void 0,!0)}var s;return function(u,p){const g=new y.XMLHttpRequest;g.open(u.method||"GET",u.url,!0),u.type==="arrayBuffer"&&(g.responseType="arraybuffer");for(const b in u.headers)g.setRequestHeader(b,u.headers[b]);return u.type==="json"&&(g.responseType="text",g.setRequestHeader("Accept","application/json")),g.withCredentials=u.credentials==="include",g.onerror=()=>{p(new Error(g.statusText))},g.onload=()=>{if((g.status>=200&&g.status<300||g.status===0)&&g.response!==null){let b=g.response;if(u.type==="json")try{b=JSON.parse(g.response)}catch(x){return p(x)}p(null,b,g.getResponseHeader("Cache-Control"),g.getResponseHeader("Expires"))}else p(new Rr(g.statusText,g.status,u.url))},g.send(u.body),{cancel:()=>g.abort()}}(a,r)},Zi=function(a,r){return Ui(Jn(a,{type:"arrayBuffer"}),r)};function xo(a){const r=y.document.createElement("a");return r.href=a,r.protocol===y.document.location.protocol&&r.host===y.document.location.host}const ni="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let di,hi;di=[],hi=0;const xa=function(a,r){if(P.supported&&(a.headers||(a.headers={}),a.headers.accept="image/webp,*/*"),hi>=A.MAX_PARALLEL_IMAGE_REQUESTS){const g={requestParameters:a,callback:r,cancelled:!1,cancel(){this.cancelled=!0}};return di.push(g),g}hi++;let s=!1;const u=()=>{if(!s)for(s=!0,hi--;di.length&&hi<A.MAX_PARALLEL_IMAGE_REQUESTS;){const g=di.shift(),{requestParameters:b,callback:x,cancelled:T}=g;T||(g.cancel=xa(b,x).cancel)}},p=Zi(a,(g,b,x,T)=>{u(),g?r(g):b&&(y.createImageBitmap?function(k,L){const O=new y.Blob([new Uint8Array(k)],{type:"image/png"});y.createImageBitmap(O).then(R=>{L(null,R)}).catch(R=>{L(new Error(`Could not load image because of ${R.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(b,(k,L)=>r(k,L,x,T)):function(k,L){const O=new y.Image,R=y.URL;O.onload=()=>{L(null,O),R.revokeObjectURL(O.src),O.onload=null,y.requestAnimationFrame(()=>{O.src=ni})},O.onerror=()=>L(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const U=new y.Blob([new Uint8Array(k)],{type:"image/png"});O.src=k.byteLength?R.createObjectURL(U):ni}(b,(k,L)=>r(k,L,x,T)))});return{cancel:()=>{p.cancel(),u()}}},us="NO_ACCESS_TOKEN";function Po(a){return a.indexOf("mapbox:")===0}function ds(a){return A.API_URL_REGEX.test(a)}function mc(a){return A.API_CDN_URL_REGEX.test(a)}function gc(a){return A.API_STYLE_REGEX.test(a)&&!wa(a)}function wa(a){return A.API_SPRITE_REGEX.test(a)}const hs=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Xi(a){const r=a.match(hs);if(!r)throw new Error("Unable to parse URL object");return{protocol:r[1],authority:r[2],path:r[3]||"/",params:r[4]?r[4].split("&"):[]}}function Fa(a){const r=a.params.length?`?${a.params.join("&")}`:"";return`${a.protocol}://${a.authority}${a.path}${r}`}function Yi(a){if(!a)return null;const r=a.split(".");if(!r||r.length!==3)return null;try{return JSON.parse(decodeURIComponent(y.atob(r[1]).split("").map(s=>"%"+("00"+s.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class Na{constructor(r){this.type=r,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(r){const s=Yi(A.ACCESS_TOKEN);let u="";return u=s&&s.u?y.btoa(encodeURIComponent(s.u).replace(/%([0-9A-F]{2})/g,(p,g)=>String.fromCharCode(Number("0x"+g)))):A.ACCESS_TOKEN||"",r?`mapbox.eventData.${r}:${u}`:`mapbox.eventData:${u}`}fetchEventData(){const r=Ge("localStorage"),s=this.getStorageKey(),u=this.getStorageKey("uuid");if(r)try{const p=y.localStorage.getItem(s);p&&(this.eventData=JSON.parse(p));const g=y.localStorage.getItem(u);g&&(this.anonId=g)}catch{Qe("Unable to read from LocalStorage")}}saveEventData(){const r=Ge("localStorage"),s=this.getStorageKey(),u=this.getStorageKey("uuid");if(r)try{y.localStorage.setItem(u,this.anonId),Object.keys(this.eventData).length>=1&&y.localStorage.setItem(s,JSON.stringify(this.eventData))}catch{Qe("Unable to write to LocalStorage")}}processRequests(r){}postEvent(r,s,u,p){if(!A.EVENTS_URL)return;const g=Xi(A.EVENTS_URL);g.params.push(`access_token=${p||A.ACCESS_TOKEN||""}`);const b={event:this.type,created:new Date(r).toISOString()},x=s?Jn(b,s):b,T={url:Fa(g),headers:{"Content-Type":"text/plain"},body:JSON.stringify([x])};this.pendingRequest=function(k,L){return Ui(Jn(k,{method:"POST"}),L)}(T,k=>{this.pendingRequest=null,u(k),this.saveEventData(),this.processRequests(p)})}queueRequest(r,s){this.queue.push(r),this.processRequests(s)}}const ct=new class extends Na{constructor(a){super("appUserTurnstile"),this._customAccessToken=a}postTurnstileEvent(a,r){A.EVENTS_URL&&A.ACCESS_TOKEN&&Array.isArray(a)&&a.some(s=>Po(s)||ds(s))&&this.queueRequest(Date.now(),r)}processRequests(a){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const r=Yi(A.ACCESS_TOKEN),s=r?r.u:A.ACCESS_TOKEN;let u=s!==this.eventData.tokenU;he(this.anonId)||(this.anonId=Zn(),u=!0);const p=this.queue.shift();if(this.eventData.lastSuccess){const g=new Date(this.eventData.lastSuccess),b=new Date(p),x=(p-this.eventData.lastSuccess)/864e5;u=u||x>=1||x<-1||g.getDate()!==b.getDate()}else u=!0;u?this.postEvent(p,{sdkIdentifier:"mapbox-gl-js",sdkVersion:E,skuId:V,"enabled.telemetry":!1,userId:this.anonId},g=>{g||(this.eventData.lastSuccess=p,this.eventData.tokenU=s)},a):this.processRequests()}},G=ct.postTurnstileEvent.bind(ct),Y=new class extends Na{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(a,r,s,u){this.skuToken=r,this.errorCb=u,A.EVENTS_URL&&(s||A.ACCESS_TOKEN?this.queueRequest({id:a,timestamp:Date.now()},s):this.errorCb(new Error(us)))}processRequests(a){if(this.pendingRequest||this.queue.length===0)return;const{id:r,timestamp:s}=this.queue.shift();r&&this.success[r]||(this.anonId||this.fetchEventData(),he(this.anonId)||(this.anonId=Zn()),this.postEvent(s,{sdkIdentifier:"mapbox-gl-js",sdkVersion:E,skuId:V,skuToken:this.skuToken,userId:this.anonId},u=>{u?this.errorCb(u):r&&(this.success[r]=!0)},a))}},st=Y.postMapLoadEvent.bind(Y),pt=new class extends Na{constructor(){super("gljs.performance")}postPerformanceEvent(a,r){A.EVENTS_URL&&(a||A.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:r},a)}processRequests(a){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:r,performanceData:s}=this.queue.shift(),u=function(p){const g=y.performance.getEntriesByType("resource"),b=y.performance.getEntriesByType("mark"),x=function(R){const U={};if(R){for(const $ in R)if($!=="other")for(const X of R[$]){const nt=`${$}ResolveRangeMin`,dt=`${$}ResolveRangeMax`,yt=`${$}RequestCount`,lt=`${$}RequestCachedCount`;U[nt]=Math.min(U[nt]||1/0,X.startTime),U[dt]=Math.max(U[dt]||-1/0,X.responseEnd);const _t=Et=>{U[Et]===void 0&&(U[Et]=0),++U[Et]};X.transferSize!==void 0&&X.transferSize===0&&_t(lt),_t(yt)}}return U}(function(R,U){const $={};if(R)for(const X of R){const nt=U(X);$[nt]===void 0&&($[nt]=[]),$[nt].push(X)}return $}(g,Oe)),T=y.devicePixelRatio,k=y.navigator.connection||y.navigator.mozConnection||y.navigator.webkitConnection,L={counters:[],metadata:[],attributes:[]},O=(R,U,$)=>{$!=null&&R.push({name:U,value:$.toString()})};for(const R in x)O(L.counters,R,x[R]);if(p.interactionRange[0]!==1/0&&p.interactionRange[1]!==-1/0&&(O(L.counters,"interactionRangeMin",p.interactionRange[0]),O(L.counters,"interactionRangeMax",p.interactionRange[1])),b)for(const R of Object.keys(Ut)){const U=Ut[R],$=b.find(X=>X.name===U);$&&O(L.counters,U,$.startTime)}return O(L.counters,"visibilityHidden",p.visibilityHidden),O(L.attributes,"style",function(R){if(R)for(const U of R){const $=U.name.split("?")[0];if(gc($)){const X=$.split("/").slice(-2);if(X.length===2)return`mapbox://styles/${X[0]}/${X[1]}`}}}(g)),O(L.attributes,"terrainEnabled",p.terrainEnabled?"true":"false"),O(L.attributes,"fogEnabled",p.fogEnabled?"true":"false"),O(L.attributes,"projection",p.projection),O(L.attributes,"zoom",p.zoom),O(L.metadata,"devicePixelRatio",T),O(L.metadata,"connectionEffectiveType",k?k.effectiveType:void 0),O(L.metadata,"navigatorUserAgent",y.navigator.userAgent),O(L.metadata,"screenWidth",y.screen.width),O(L.metadata,"screenHeight",y.screen.height),O(L.metadata,"windowWidth",y.innerWidth),O(L.metadata,"windowHeight",y.innerHeight),O(L.metadata,"mapWidth",p.width/T),O(L.metadata,"mapHeight",p.height/T),O(L.metadata,"webglRenderer",p.renderer),O(L.metadata,"webglVendor",p.vendor),O(L.metadata,"sdkVersion",E),O(L.metadata,"sdkIdentifier","mapbox-gl-js"),L}(s);for(const p of u.metadata);for(const p of u.counters);for(const p of u.attributes);this.postEvent(r,u,()=>{},a)}},kt=pt.postPerformanceEvent.bind(pt),Bt=new class extends Na{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(a,r,s,u){if(!A.API_URL||!A.SESSION_PATH)return;const p=Xi(A.API_URL+A.SESSION_PATH);p.params.push(`sku=${r||""}`),p.params.push(`access_token=${u||A.ACCESS_TOKEN||""}`);const g={url:Fa(p),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(b,x){return Ui(Jn(b,{method:"GET"}),x)}(g,b=>{this.pendingRequest=null,s(b),this.saveEventData(),this.processRequests(u)})}getSessionAPI(a,r,s,u){this.skuToken=r,this.errorCb=u,A.SESSION_PATH&&A.API_URL&&(s||A.ACCESS_TOKEN?this.queueRequest({id:a,timestamp:Date.now()},s):this.errorCb(new Error(us)))}processRequests(a){if(this.pendingRequest||this.queue.length===0)return;const{id:r,timestamp:s}=this.queue.shift();r&&this.success[r]||this.getSession(s,this.skuToken,u=>{u?this.errorCb(u):r&&(this.success[r]=!0)},a)}},Lt=Bt.getSessionAPI.bind(Bt),At=new Set,Ut={create:"create",load:"load",fullLoad:"fullLoad"},ae={mark(a){y.performance.mark(a)},measure(a,r,s){y.performance.measure(a,r,s)}};function Oe(a){const r=a.name.split("?")[0];return mc(r)&&r.includes("mapbox-gl.js")?"javascript":mc(r)&&r.includes("mapbox-gl.css")?"css":function(s){return A.API_FONTS_REGEX.test(s)}(r)?"fontRange":wa(r)?"sprite":gc(r)?"style":function(s){return A.API_TILEJSON_REGEX.test(s)}(r)?"tilejson":"other"}const me=y.performance;function rn(a){const r=a?a.url.toString():void 0;return me.getEntriesByName(r)}let tn,en,dn,an;const tr={now:()=>dn!==void 0?dn:y.performance.now(),setNow(a){dn=a},restoreNow(){dn=void 0},frame(a){const r=y.requestAnimationFrame(a);return{cancel:()=>y.cancelAnimationFrame(r)}},getImageData(a,r=0){const{width:s,height:u}=a;an||(an=y.document.createElement("canvas"));const p=an.getContext("2d",{willReadFrequently:!0});if(!p)throw new Error("failed to create canvas 2d context");return(s>an.width||u>an.height)&&(an.width=s,an.height=u),p.clearRect(-r,-r,s+2*r,u+2*r),p.drawImage(a,0,0,s,u),p.getImageData(-r,-r,s+2*r,u+2*r)},resolveURL:a=>(tn||(tn=y.document.createElement("a")),tn.href=a,tn.href),get devicePixelRatio(){return y.devicePixelRatio},get prefersReducedMotion(){return!!y.matchMedia&&(en==null&&(en=y.matchMedia("(prefers-reduced-motion: reduce)")),en.matches)}};function hn(a,r,s){s[a]&&s[a].indexOf(r)!==-1||(s[a]=s[a]||[],s[a].push(r))}function qn(a,r,s){if(s&&s[a]){const u=s[a].indexOf(r);u!==-1&&s[a].splice(u,1)}}class Fn{constructor(r,s={}){Jn(this,s),this.type=r}}class Wo extends Fn{constructor(r,s={}){super("error",Jn({error:r},s))}}class Ki{on(r,s){return this._listeners=this._listeners||{},hn(r,s,this._listeners),this}off(r,s){return qn(r,s,this._listeners),qn(r,s,this._oneTimeListeners),this}once(r,s){return s?(this._oneTimeListeners=this._oneTimeListeners||{},hn(r,s,this._oneTimeListeners),this):new Promise(u=>this.once(r,u))}fire(r,s){typeof r=="string"&&(r=new Fn(r,s||{}));const u=r.type;if(this.listens(u)){r.target=this;const p=this._listeners&&this._listeners[u]?this._listeners[u].slice():[];for(const x of p)x.call(this,r);const g=this._oneTimeListeners&&this._oneTimeListeners[u]?this._oneTimeListeners[u].slice():[];for(const x of g)qn(u,x,this._oneTimeListeners),x.call(this,r);const b=this._eventedParent;b&&(Jn(r,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),b.fire(r))}else r instanceof Wo&&console.error(r.error);return this}listens(r){return!!(this._listeners&&this._listeners[r]&&this._listeners[r].length>0||this._oneTimeListeners&&this._oneTimeListeners[r]&&this._oneTimeListeners[r].length>0||this._eventedParent&&this._eventedParent.listens(r))}setEventedParent(r,s){return this._eventedParent=r,this._eventedParentData=s,this}}var Kt=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function ia(a,...r){for(const s of r)for(const u in s)a[u]=s[u];return a}function ri(a){return a instanceof Number||a instanceof String||a instanceof Boolean?a.valueOf():a}function ja(a){if(Array.isArray(a))return a.map(ja);if(a instanceof Object&&!(a instanceof Number||a instanceof String||a instanceof Boolean)){const r={};for(const s in a)r[s]=ja(a[s]);return r}return ri(a)}class Xd extends Error{constructor(r,s){super(s),this.message=s,this.key=r}}var Zo=Xd;class Ea{constructor(r,s=[]){this.parent=r,this.bindings={};for(const[u,p]of s)this.bindings[u]=p}concat(r){return new Ea(this,r)}get(r){if(this.bindings[r])return this.bindings[r];if(this.parent)return this.parent.get(r);throw new Error(`${r} not found in scope.`)}has(r){return!!this.bindings[r]||!!this.parent&&this.parent.has(r)}}var Yd=Ea;const fs={kind:"null"},Se={kind:"number"},Dn={kind:"string"},zn={kind:"boolean"},wo={kind:"color"},M={kind:"object"},D={kind:"value"},J={kind:"collator"},gt={kind:"formatted"},Ct={kind:"resolvedImage"};function St(a,r){return{kind:"array",itemType:a,N:r}}function It(a){if(a.kind==="array"){const r=It(a.itemType);return typeof a.N=="number"?`array<${r}, ${a.N}>`:a.itemType.kind==="value"?"array":`array<${r}>`}return a.kind}const xe=[fs,Se,Dn,zn,wo,gt,M,St(D),Ct];function we(a,r){if(r.kind==="error")return null;if(a.kind==="array"){if(r.kind==="array"&&(r.N===0&&r.itemType.kind==="value"||!we(a.itemType,r.itemType))&&(typeof a.N!="number"||a.N===r.N))return null}else{if(a.kind===r.kind)return null;if(a.kind==="value"){for(const s of xe)if(!we(s,r))return null}}return`Expected ${It(a)} but found ${It(r)} instead.`}function $e(a,r){return r.some(s=>s.kind===a.kind)}function Re(a,r){return r.some(s=>s==="null"?a===null:s==="array"?Array.isArray(a):s==="object"?a&&!Array.isArray(a)&&typeof a=="object":s===typeof a)}var De,xn={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Cr(a){return(a=Math.round(a))<0?0:a>255?255:a}function Tn(a){return Cr(a[a.length-1]==="%"?parseFloat(a)/100*255:parseInt(a))}function Br(a){return(r=a[a.length-1]==="%"?parseFloat(a)/100:parseFloat(a))<0?0:r>1?1:r;var r}function le(a,r,s){return s<0?s+=1:s>1&&(s-=1),6*s<1?a+(r-a)*s*6:2*s<1?r:3*s<2?a+(r-a)*(2/3-s)*6:a}try{De={}.parseCSSColor=function(a){var r,s=a.replace(/ /g,"").toLowerCase();if(s in xn)return xn[s].slice();if(s[0]==="#")return s.length===4?(r=parseInt(s.substr(1),16))>=0&&r<=4095?[(3840&r)>>4|(3840&r)>>8,240&r|(240&r)>>4,15&r|(15&r)<<4,1]:null:s.length===7&&(r=parseInt(s.substr(1),16))>=0&&r<=16777215?[(16711680&r)>>16,(65280&r)>>8,255&r,1]:null;var u=s.indexOf("("),p=s.indexOf(")");if(u!==-1&&p+1===s.length){var g=s.substr(0,u),b=s.substr(u+1,p-(u+1)).split(","),x=1;switch(g){case"rgba":if(b.length!==4)return null;x=Br(b.pop());case"rgb":return b.length!==3?null:[Tn(b[0]),Tn(b[1]),Tn(b[2]),x];case"hsla":if(b.length!==4)return null;x=Br(b.pop());case"hsl":if(b.length!==3)return null;var T=(parseFloat(b[0])%360+360)%360/360,k=Br(b[1]),L=Br(b[2]),O=L<=.5?L*(k+1):L+k-L*k,R=2*L-O;return[Cr(255*le(R,O,T+1/3)),Cr(255*le(R,O,T)),Cr(255*le(R,O,T-1/3)),x];default:return null}}return null}}catch{}class Ve{constructor(r,s,u,p=1){this.r=r,this.g=s,this.b=u,this.a=p}static parse(r){if(!r)return;if(r instanceof Ve)return r;if(typeof r!="string")return;const s=De(r);return s?new Ve(s[0]/255*s[3],s[1]/255*s[3],s[2]/255*s[3],s[3]):void 0}toString(){const[r,s,u,p]=this.toArray();return`rgba(${Math.round(r)},${Math.round(s)},${Math.round(u)},${p})`}toArray(){const{r,g:s,b:u,a:p}=this;return p===0?[0,0,0,0]:[255*r/p,255*s/p,255*u/p,p]}toArray01(){const{r,g:s,b:u,a:p}=this;return p===0?[0,0,0,0]:[r/p,s/p,u/p,p]}toArray01PremultipliedAlpha(){const{r,g:s,b:u,a:p}=this;return[r,s,u,p]}}Ve.black=new Ve(0,0,0,1),Ve.white=new Ve(1,1,1,1),Ve.transparent=new Ve(0,0,0,0),Ve.red=new Ve(1,0,0,1),Ve.blue=new Ve(0,0,1,1);var kn=Ve;class ii{constructor(r,s,u){this.sensitivity=r?s?"variant":"case":s?"accent":"base",this.locale=u,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(r,s){return this.collator.compare(r,s)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Vr{constructor(r,s,u,p,g){this.text=r.normalize?r.normalize():r,this.image=s,this.scale=u,this.fontStack=p,this.textColor=g}}class $i{constructor(r){this.sections=r}static fromString(r){return new $i([new Vr(r,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(r=>r.text.length!==0||r.image&&r.image.name.length!==0)}static factory(r){return r instanceof $i?r:$i.fromString(r)}toString(){return this.sections.length===0?"":this.sections.map(r=>r.text).join("")}serialize(){const r=["format"];for(const s of this.sections){if(s.image){r.push(["image",s.image.name]);continue}r.push(s.text);const u={};s.fontStack&&(u["text-font"]=["literal",s.fontStack.split(",")]),s.scale&&(u["font-scale"]=s.scale),s.textColor&&(u["text-color"]=["rgba"].concat(s.textColor.toArray())),r.push(u)}return r}}class Ji{constructor(r){this.name=r.name,this.available=r.available}toString(){return this.name}static fromString(r){return r?new Ji({name:r,available:!1}):null}serialize(){return["image",this.name]}}function Lr(a,r,s,u){return typeof a=="number"&&a>=0&&a<=255&&typeof r=="number"&&r>=0&&r<=255&&typeof s=="number"&&s>=0&&s<=255?u===void 0||typeof u=="number"&&u>=0&&u<=1?null:`Invalid rgba value [${[a,r,s,u].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof u=="number"?[a,r,s,u]:[a,r,s]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Tl(a){if(a===null||typeof a=="string"||typeof a=="boolean"||typeof a=="number"||a instanceof kn||a instanceof ii||a instanceof $i||a instanceof Ji)return!0;if(Array.isArray(a)){for(const r of a)if(!Tl(r))return!1;return!0}if(typeof a=="object"){for(const r in a)if(!Tl(a[r]))return!1;return!0}return!1}function fi(a){if(a===null)return fs;if(typeof a=="string")return Dn;if(typeof a=="boolean")return zn;if(typeof a=="number")return Se;if(a instanceof kn)return wo;if(a instanceof ii)return J;if(a instanceof $i)return gt;if(a instanceof Ji)return Ct;if(Array.isArray(a)){const r=a.length;let s;for(const u of a){const p=fi(u);if(s){if(s===p)continue;s=D;break}s=p}return St(s||D,r)}return M}function Eo(a){const r=typeof a;return a===null?"":r==="string"||r==="number"||r==="boolean"?String(a):a instanceof kn||a instanceof $i||a instanceof Ji?a.toString():JSON.stringify(a)}class _c{constructor(r,s){this.type=r,this.value=s}static parse(r,s){if(r.length!==2)return s.error(`'literal' expression requires exactly one argument, but found ${r.length-1} instead.`);if(!Tl(r[1]))return s.error("invalid value");const u=r[1];let p=fi(u);const g=s.expectedType;return p.kind!=="array"||p.N!==0||!g||g.kind!=="array"||typeof g.N=="number"&&g.N!==0||(p=g),new _c(p,u)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof kn?["rgba"].concat(this.value.toArray()):this.value instanceof $i?this.value.serialize():this.value}}var Us=_c,ki=class{constructor(a){this.name="ExpressionEvaluationError",this.message=a}toJSON(){return this.message}};const $s={string:Dn,number:Se,boolean:zn,object:M};class ps{constructor(r,s){this.type=r,this.args=s}static parse(r,s){if(r.length<2)return s.error("Expected at least one argument.");let u,p=1;const g=r[0];if(g==="array"){let x,T;if(r.length>2){const k=r[1];if(typeof k!="string"||!(k in $s)||k==="object")return s.error('The item type argument of "array" must be one of string, number, boolean',1);x=$s[k],p++}else x=D;if(r.length>3){if(r[2]!==null&&(typeof r[2]!="number"||r[2]<0||r[2]!==Math.floor(r[2])))return s.error('The length argument to "array" must be a positive integer literal',2);T=r[2],p++}u=St(x,T)}else u=$s[g];const b=[];for(;p<r.length;p++){const x=s.parse(r[p],p,D);if(!x)return null;b.push(x)}return new ps(u,b)}evaluate(r){for(let s=0;s<this.args.length;s++){const u=this.args[s].evaluate(r);if(!we(this.type,fi(u)))return u;if(s===this.args.length-1)throw new ki(`Expected value to be of type ${It(this.type)}, but found ${It(fi(u))} instead.`)}return null}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}serialize(){const r=this.type,s=[r.kind];if(r.kind==="array"){const u=r.itemType;if(u.kind==="string"||u.kind==="number"||u.kind==="boolean"){s.push(u.kind);const p=r.N;(typeof p=="number"||this.args.length>1)&&s.push(p)}}return s.concat(this.args.map(u=>u.serialize()))}}var oa=ps;class kl{constructor(r){this.type=gt,this.sections=r}static parse(r,s){if(r.length<2)return s.error("Expected at least one argument.");const u=r[1];if(!Array.isArray(u)&&typeof u=="object")return s.error("First argument must be an image or text section.");const p=[];let g=!1;for(let b=1;b<=r.length-1;++b){const x=r[b];if(g&&typeof x=="object"&&!Array.isArray(x)){g=!1;let T=null;if(x["font-scale"]&&(T=s.parse(x["font-scale"],1,Se),!T))return null;let k=null;if(x["text-font"]&&(k=s.parse(x["text-font"],1,St(Dn)),!k))return null;let L=null;if(x["text-color"]&&(L=s.parse(x["text-color"],1,wo),!L))return null;const O=p[p.length-1];O.scale=T,O.font=k,O.textColor=L}else{const T=s.parse(r[b],1,D);if(!T)return null;const k=T.type.kind;if(k!=="string"&&k!=="value"&&k!=="null"&&k!=="resolvedImage")return s.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");g=!0,p.push({content:T,scale:null,font:null,textColor:null})}}return new kl(p)}evaluate(r){return new $i(this.sections.map(s=>{const u=s.content.evaluate(r);return fi(u)===Ct?new Vr("",u,null,null,null):new Vr(Eo(u),null,s.scale?s.scale.evaluate(r):null,s.font?s.font.evaluate(r).join(","):null,s.textColor?s.textColor.evaluate(r):null)}))}eachChild(r){for(const s of this.sections)r(s.content),s.scale&&r(s.scale),s.font&&r(s.font),s.textColor&&r(s.textColor)}outputDefined(){return!1}serialize(){const r=["format"];for(const s of this.sections){r.push(s.content.serialize());const u={};s.scale&&(u["font-scale"]=s.scale.serialize()),s.font&&(u["text-font"]=s.font.serialize()),s.textColor&&(u["text-color"]=s.textColor.serialize()),r.push(u)}return r}}class yc{constructor(r){this.type=Ct,this.input=r}static parse(r,s){if(r.length!==2)return s.error("Expected two arguments.");const u=s.parse(r[1],1,Dn);return u?new yc(u):s.error("No image name provided.")}evaluate(r){const s=this.input.evaluate(r),u=Ji.fromString(s);return u&&r.availableImages&&(u.available=r.availableImages.indexOf(s)>-1),u}eachChild(r){r(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const Tf={"to-boolean":zn,"to-color":wo,"to-number":Se,"to-string":Dn};class bc{constructor(r,s){this.type=r,this.args=s}static parse(r,s){if(r.length<2)return s.error("Expected at least one argument.");const u=r[0];if((u==="to-boolean"||u==="to-string")&&r.length!==2)return s.error("Expected one argument.");const p=Tf[u],g=[];for(let b=1;b<r.length;b++){const x=s.parse(r[b],b,D);if(!x)return null;g.push(x)}return new bc(p,g)}evaluate(r){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(r));if(this.type.kind==="color"){let s,u;for(const p of this.args){if(s=p.evaluate(r),u=null,s instanceof kn)return s;if(typeof s=="string"){const g=r.parseColor(s);if(g)return g}else if(Array.isArray(s)&&(u=s.length<3||s.length>4?`Invalid rbga value ${JSON.stringify(s)}: expected an array containing either three or four numeric values.`:Lr(s[0],s[1],s[2],s[3]),!u))return new kn(s[0]/255,s[1]/255,s[2]/255,s[3])}throw new ki(u||`Could not parse color from value '${typeof s=="string"?s:String(JSON.stringify(s))}'`)}if(this.type.kind==="number"){let s=null;for(const u of this.args){if(s=u.evaluate(r),s===null)return 0;const p=Number(s);if(!isNaN(p))return p}throw new ki(`Could not convert ${JSON.stringify(s)} to number.`)}return this.type.kind==="formatted"?$i.fromString(Eo(this.args[0].evaluate(r))):this.type.kind==="resolvedImage"?Ji.fromString(Eo(this.args[0].evaluate(r))):Eo(this.args[0].evaluate(r))}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}serialize(){if(this.type.kind==="formatted")return new kl([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new yc(this.args[0]).serialize();const r=[`to-${this.type.kind}`];return this.eachChild(s=>{r.push(s.serialize())}),r}}var ms=bc;const Lu=["Unknown","Point","LineString","Polygon"];var Cl=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Lu[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const a=this.featureDistanceData.center,r=this.featureDistanceData.scale,{x:s,y:u}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(s*r-a[0])+this.featureDistanceData.bearing[1]*(u*r-a[1])}return 0}parseColor(a){let r=this._parseColorCache[a];return r||(r=this._parseColorCache[a]=kn.parse(a)),r}};class Vs{constructor(r,s,u,p){this.name=r,this.type=s,this._evaluate=u,this.args=p}evaluate(r){return this._evaluate(r,this.args)}eachChild(r){this.args.forEach(r)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(r=>r.serialize()))}static parse(r,s){const u=r[0],p=Vs.definitions[u];if(!p)return s.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0);const g=Array.isArray(p)?p[0]:p.type,b=Array.isArray(p)?[[p[1],p[2]]]:p.overloads,x=b.filter(([k])=>!Array.isArray(k)||k.length===r.length-1);let T=null;for(const[k,L]of x){T=new Ru(s.registry,s.path,null,s.scope);const O=[];let R=!1;for(let U=1;U<r.length;U++){const $=r[U],X=Array.isArray(k)?k[U-1]:k.type,nt=T.parse($,1+O.length,X);if(!nt){R=!0;break}O.push(nt)}if(!R)if(Array.isArray(k)&&k.length!==O.length)T.error(`Expected ${k.length} arguments, but found ${O.length} instead.`);else{for(let U=0;U<O.length;U++){const $=Array.isArray(k)?k[U]:k.type,X=O[U];T.concat(U+1).checkSubtype($,X.type)}if(T.errors.length===0)return new Vs(u,g,L,O)}}if(x.length===1)s.errors.push(...T.errors);else{const k=(x.length?x:b).map(([O])=>{return R=O,Array.isArray(R)?`(${R.map(It).join(", ")})`:`(${It(R.type)}...)`;var R}).join(" | "),L=[];for(let O=1;O<r.length;O++){const R=s.parse(r[O],1+L.length);if(!R)return null;L.push(It(R.type))}s.error(`Expected arguments of type ${k}, but found (${L.join(", ")}) instead.`)}return null}static register(r,s){Vs.definitions=s;for(const u in s)r[u]=Vs}}var Xo=Vs;class Gs{constructor(r,s,u){this.type=J,this.locale=u,this.caseSensitive=r,this.diacriticSensitive=s}static parse(r,s){if(r.length!==2)return s.error("Expected one argument.");const u=r[1];if(typeof u!="object"||Array.isArray(u))return s.error("Collator options argument must be an object.");const p=s.parse(u["case-sensitive"]!==void 0&&u["case-sensitive"],1,zn);if(!p)return null;const g=s.parse(u["diacritic-sensitive"]!==void 0&&u["diacritic-sensitive"],1,zn);if(!g)return null;let b=null;return u.locale&&(b=s.parse(u.locale,1,Dn),!b)?null:new Gs(p,g,b)}evaluate(r){return new ii(this.caseSensitive.evaluate(r),this.diacriticSensitive.evaluate(r),this.locale?this.locale.evaluate(r):null)}eachChild(r){r(this.caseSensitive),r(this.diacriticSensitive),this.locale&&r(this.locale)}outputDefined(){return!1}serialize(){const r={};return r["case-sensitive"]=this.caseSensitive.serialize(),r["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(r.locale=this.locale.serialize()),["collator",r]}}const Ta=8192;function oi(a,r){a[0]=Math.min(a[0],r[0]),a[1]=Math.min(a[1],r[1]),a[2]=Math.max(a[2],r[0]),a[3]=Math.max(a[3],r[1])}function qs(a,r){return!(a[0]<=r[0]||a[2]>=r[2]||a[1]<=r[1]||a[3]>=r[3])}function zu(a,r){const s=(180+a[0])/360,u=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a[1]*Math.PI/360)))/360,p=Math.pow(2,r.z);return[Math.round(s*p*Ta),Math.round(u*p*Ta)]}function Kd(a,r,s){const u=a[0]-r[0],p=a[1]-r[1],g=a[0]-s[0],b=a[1]-s[1];return u*b-g*p==0&&u*g<=0&&p*b<=0}function Sl(a,r){let s=!1;for(let b=0,x=r.length;b<x;b++){const T=r[b];for(let k=0,L=T.length;k<L-1;k++){if(Kd(a,T[k],T[k+1]))return!1;(p=T[k])[1]>(u=a)[1]!=(g=T[k+1])[1]>u[1]&&u[0]<(g[0]-p[0])*(u[1]-p[1])/(g[1]-p[1])+p[0]&&(s=!s)}}var u,p,g;return s}function Ml(a,r){for(let s=0;s<r.length;s++)if(Sl(a,r[s]))return!0;return!1}function vc(a,r,s,u){const p=u[0]-s[0],g=u[1]-s[1],b=(a[0]-s[0])*g-p*(a[1]-s[1]),x=(r[0]-s[0])*g-p*(r[1]-s[1]);return b>0&&x<0||b<0&&x>0}function xc(a,r,s){for(const k of s)for(let L=0;L<k.length-1;++L)if((x=[(b=k[L+1])[0]-(g=k[L])[0],b[1]-g[1]])[0]*(T=[(p=r)[0]-(u=a)[0],p[1]-u[1]])[1]-x[1]*T[0]!=0&&vc(u,p,g,b)&&vc(g,b,u,p))return!0;var u,p,g,b,x,T;return!1}function Hs(a,r){for(let s=0;s<a.length;++s)if(!Sl(a[s],r))return!1;for(let s=0;s<a.length-1;++s)if(xc(a[s],a[s+1],r))return!1;return!0}function Ua(a,r){for(let s=0;s<r.length;s++)if(Hs(a,r[s]))return!0;return!1}function Al(a,r,s){const u=[];for(let p=0;p<a.length;p++){const g=[];for(let b=0;b<a[p].length;b++){const x=zu(a[p][b],s);oi(r,x),g.push(x)}u.push(g)}return u}function wc(a,r,s){const u=[];for(let p=0;p<a.length;p++){const g=Al(a[p],r,s);u.push(g)}return u}function Ou(a,r,s,u){if(a[0]<s[0]||a[0]>s[2]){const p=.5*u;let g=a[0]-s[0]>p?-u:s[0]-a[0]>p?u:0;g===0&&(g=a[0]-s[2]>p?-u:s[2]-a[0]>p?u:0),a[0]+=g}oi(r,a)}function ka(a,r,s,u){const p=Math.pow(2,u.z)*Ta,g=[u.x*Ta,u.y*Ta],b=[];if(!a)return b;for(const x of a)for(const T of x){const k=[T.x+g[0],T.y+g[1]];Ou(k,r,s,p),b.push(k)}return b}function Hn(a,r,s,u){const p=Math.pow(2,u.z)*Ta,g=[u.x*Ta,u.y*Ta],b=[];if(!a)return b;for(const T of a){const k=[];for(const L of T){const O=[L.x+g[0],L.y+g[1]];oi(r,O),k.push(O)}b.push(k)}if(r[2]-r[0]<=p/2){(x=r)[0]=x[1]=1/0,x[2]=x[3]=-1/0;for(const T of b)for(const k of T)Ou(k,r,s,p)}var x;return b}class gs{constructor(r,s){this.type=zn,this.geojson=r,this.geometries=s}static parse(r,s){if(r.length!==2)return s.error(`'within' expression requires exactly one argument, but found ${r.length-1} instead.`);if(Tl(r[1])){const u=r[1];if(u.type==="FeatureCollection")for(let p=0;p<u.features.length;++p){const g=u.features[p].geometry.type;if(g==="Polygon"||g==="MultiPolygon")return new gs(u,u.features[p].geometry)}else if(u.type==="Feature"){const p=u.geometry.type;if(p==="Polygon"||p==="MultiPolygon")return new gs(u,u.geometry)}else if(u.type==="Polygon"||u.type==="MultiPolygon")return new gs(u,u)}return s.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(r){if(r.geometry()!=null&&r.canonicalID()!=null){if(r.geometryType()==="Point")return function(s,u){const p=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],b=s.canonicalID();if(!b)return!1;if(u.type==="Polygon"){const x=Al(u.coordinates,g,b),T=ka(s.geometry(),p,g,b);if(!qs(p,g))return!1;for(const k of T)if(!Sl(k,x))return!1}if(u.type==="MultiPolygon"){const x=wc(u.coordinates,g,b),T=ka(s.geometry(),p,g,b);if(!qs(p,g))return!1;for(const k of T)if(!Ml(k,x))return!1}return!0}(r,this.geometries);if(r.geometryType()==="LineString")return function(s,u){const p=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],b=s.canonicalID();if(!b)return!1;if(u.type==="Polygon"){const x=Al(u.coordinates,g,b),T=Hn(s.geometry(),p,g,b);if(!qs(p,g))return!1;for(const k of T)if(!Hs(k,x))return!1}if(u.type==="MultiPolygon"){const x=wc(u.coordinates,g,b),T=Hn(s.geometry(),p,g,b);if(!qs(p,g))return!1;for(const k of T)if(!Ua(k,x))return!1}return!0}(r,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var Il=gs;function _s(a){if(a instanceof Xo&&(a.name==="get"&&a.args.length===1||a.name==="feature-state"||a.name==="has"&&a.args.length===1||a.name==="properties"||a.name==="geometry-type"||a.name==="id"||/^filter-/.test(a.name))||a instanceof Il)return!1;let r=!0;return a.eachChild(s=>{r&&!_s(s)&&(r=!1)}),r}function Ca(a){if(a instanceof Xo&&a.name==="feature-state")return!1;let r=!0;return a.eachChild(s=>{r&&!Ca(s)&&(r=!1)}),r}function Ec(a,r){if(a instanceof Xo&&r.indexOf(a.name)>=0)return!1;let s=!0;return a.eachChild(u=>{s&&!Ec(u,r)&&(s=!1)}),s}class Tc{constructor(r,s){this.type=s.type,this.name=r,this.boundExpression=s}static parse(r,s){if(r.length!==2||typeof r[1]!="string")return s.error("'var' expression requires exactly one string literal argument.");const u=r[1];return s.scope.has(u)?new Tc(u,s.scope.get(u)):s.error(`Unknown variable "${u}". Make sure "${u}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(r){return this.boundExpression.evaluate(r)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var Du=Tc;class kc{constructor(r,s=[],u,p=new Yd,g=[]){this.registry=r,this.path=s,this.key=s.map(b=>`[${b}]`).join(""),this.scope=p,this.errors=g,this.expectedType=u}parse(r,s,u,p,g={}){return s?this.concat(s,u,p)._parse(r,g):this._parse(r,g)}_parse(r,s){function u(p,g,b){return b==="assert"?new oa(g,[p]):b==="coerce"?new ms(g,[p]):p}if(r!==null&&typeof r!="string"&&typeof r!="boolean"&&typeof r!="number"||(r=["literal",r]),Array.isArray(r)){if(r.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const p=r[0];if(typeof p!="string")return this.error(`Expression name must be a string, but found ${typeof p} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const g=this.registry[p];if(g){let b=g.parse(r,this);if(!b)return null;if(this.expectedType){const x=this.expectedType,T=b.type;if(x.kind!=="string"&&x.kind!=="number"&&x.kind!=="boolean"&&x.kind!=="object"&&x.kind!=="array"||T.kind!=="value")if(x.kind!=="color"&&x.kind!=="formatted"&&x.kind!=="resolvedImage"||T.kind!=="value"&&T.kind!=="string"){if(this.checkSubtype(x,T))return null}else b=u(b,x,s.typeAnnotation||"coerce");else b=u(b,x,s.typeAnnotation||"assert")}if(!(b instanceof Us)&&b.type.kind!=="resolvedImage"&&Sa(b)){const x=new Cl;try{b=new Us(b.type,b.evaluate(x))}catch(T){return this.error(T.message),null}}return b}return this.error(`Unknown expression "${p}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(r===void 0?"'undefined' value invalid. Use null instead.":typeof r=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof r} instead.`)}concat(r,s,u){const p=typeof r=="number"?this.path.concat(r):this.path,g=u?this.scope.concat(u):this.scope;return new kc(this.registry,p,s||null,g,this.errors)}error(r,...s){const u=`${this.key}${s.map(p=>`[${p}]`).join("")}`;this.errors.push(new Zo(u,r))}checkSubtype(r,s){const u=we(r,s);return u&&this.error(u),u}}var Ru=kc;function Sa(a){if(a instanceof Du)return Sa(a.boundExpression);if(a instanceof Xo&&a.name==="error"||a instanceof Gs||a instanceof Il)return!1;const r=a instanceof ms||a instanceof oa;let s=!0;return a.eachChild(u=>{s=r?s&&Sa(u):s&&u instanceof Us}),!!s&&_s(a)&&Ec(a,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function Ma(a,r){const s=a.length-1;let u,p,g=0,b=s,x=0;for(;g<=b;)if(x=Math.floor((g+b)/2),u=a[x],p=a[x+1],u<=r){if(x===s||r<p)return x;g=x+1}else{if(!(u>r))throw new ki("Input is not a number.");b=x-1}return 0}class aa{constructor(r,s,u){this.type=r,this.input=s,this.labels=[],this.outputs=[];for(const[p,g]of u)this.labels.push(p),this.outputs.push(g)}static parse(r,s){if(r.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!=0)return s.error("Expected an even number of arguments.");const u=s.parse(r[1],1,Se);if(!u)return null;const p=[];let g=null;s.expectedType&&s.expectedType.kind!=="value"&&(g=s.expectedType);for(let b=1;b<r.length;b+=2){const x=b===1?-1/0:r[b],T=r[b+1],k=b,L=b+1;if(typeof x!="number")return s.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',k);if(p.length&&p[p.length-1][0]>=x)return s.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',k);const O=s.parse(T,L,g);if(!O)return null;g=g||O.type,p.push([x,O])}return new aa(g,u,p)}evaluate(r){const s=this.labels,u=this.outputs;if(s.length===1)return u[0].evaluate(r);const p=this.input.evaluate(r);if(p<=s[0])return u[0].evaluate(r);const g=s.length;return p>=s[g-1]?u[g-1].evaluate(r):u[Ma(s,p)].evaluate(r)}eachChild(r){r(this.input);for(const s of this.outputs)r(s)}outputDefined(){return this.outputs.every(r=>r.outputDefined())}serialize(){const r=["step",this.input.serialize()];for(let s=0;s<this.labels.length;s++)s>0&&r.push(this.labels[s]),r.push(this.outputs[s].serialize());return r}}var Yo=aa;function An(a,r,s){return a*(1-s)+r*s}var $a=Object.freeze({__proto__:null,number:An,color:function(a,r,s){return new kn(An(a.r,r.r,s),An(a.g,r.g,s),An(a.b,r.b,s),An(a.a,r.a,s))},array:function(a,r,s){return a.map((u,p)=>An(u,r[p],s))}});const Aa=.95047,Jd=1.08883,Ws=4/29,ys=6/29,Cc=3*ys*ys,Bu=Math.PI/180,kf=180/Math.PI;function Sc(a){return a>.008856451679035631?Math.pow(a,1/3):a/Cc+Ws}function Mc(a){return a>ys?a*a*a:Cc*(a-Ws)}function Pl(a){return 255*(a<=.0031308?12.92*a:1.055*Math.pow(a,1/2.4)-.055)}function bs(a){return(a/=255)<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function vs(a){const r=bs(a.r),s=bs(a.g),u=bs(a.b),p=Sc((.4124564*r+.3575761*s+.1804375*u)/Aa),g=Sc((.2126729*r+.7151522*s+.072175*u)/1);return{l:116*g-16,a:500*(p-g),b:200*(g-Sc((.0193339*r+.119192*s+.9503041*u)/Jd)),alpha:a.a}}function Qd(a){let r=(a.l+16)/116,s=isNaN(a.a)?r:r+a.a/500,u=isNaN(a.b)?r:r-a.b/200;return r=1*Mc(r),s=Aa*Mc(s),u=Jd*Mc(u),new kn(Pl(3.2404542*s-1.5371385*r-.4985314*u),Pl(-.969266*s+1.8760108*r+.041556*u),Pl(.0556434*s-.2040259*r+1.0572252*u),a.alpha)}function Va(a,r,s){const u=r-a;return a+s*(u>180||u<-180?u-360*Math.round(u/360):u)}const Ll={forward:vs,reverse:Qd,interpolate:function(a,r,s){return{l:An(a.l,r.l,s),a:An(a.a,r.a,s),b:An(a.b,r.b,s),alpha:An(a.alpha,r.alpha,s)}}},Ko={forward:function(a){const{l:r,a:s,b:u}=vs(a),p=Math.atan2(u,s)*kf;return{h:p<0?p+360:p,c:Math.sqrt(s*s+u*u),l:r,alpha:a.a}},reverse:function(a){const r=a.h*Bu,s=a.c;return Qd({l:a.l,a:Math.cos(r)*s,b:Math.sin(r)*s,alpha:a.alpha})},interpolate:function(a,r,s){return{h:Va(a.h,r.h,s),c:An(a.c,r.c,s),l:An(a.l,r.l,s),alpha:An(a.alpha,r.alpha,s)}}};var Fu=Object.freeze({__proto__:null,lab:Ll,hcl:Ko});class zl{constructor(r,s,u,p,g){this.type=r,this.operator=s,this.interpolation=u,this.input=p,this.labels=[],this.outputs=[];for(const[b,x]of g)this.labels.push(b),this.outputs.push(x)}static interpolationFactor(r,s,u,p){let g=0;if(r.name==="exponential")g=Zs(s,r.base,u,p);else if(r.name==="linear")g=Zs(s,1,u,p);else if(r.name==="cubic-bezier"){const b=r.controlPoints;g=new tt(b[0],b[1],b[2],b[3]).solve(Zs(s,1,u,p))}return g}static parse(r,s){let[u,p,g,...b]=r;if(!Array.isArray(p)||p.length===0)return s.error("Expected an interpolation type expression.",1);if(p[0]==="linear")p={name:"linear"};else if(p[0]==="exponential"){const k=p[1];if(typeof k!="number")return s.error("Exponential interpolation requires a numeric base.",1,1);p={name:"exponential",base:k}}else{if(p[0]!=="cubic-bezier")return s.error(`Unknown interpolation type ${String(p[0])}`,1,0);{const k=p.slice(1);if(k.length!==4||k.some(L=>typeof L!="number"||L<0||L>1))return s.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);p={name:"cubic-bezier",controlPoints:k}}}if(r.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!=0)return s.error("Expected an even number of arguments.");if(g=s.parse(g,2,Se),!g)return null;const x=[];let T=null;u==="interpolate-hcl"||u==="interpolate-lab"?T=wo:s.expectedType&&s.expectedType.kind!=="value"&&(T=s.expectedType);for(let k=0;k<b.length;k+=2){const L=b[k],O=b[k+1],R=k+3,U=k+4;if(typeof L!="number")return s.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',R);if(x.length&&x[x.length-1][0]>=L)return s.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',R);const $=s.parse(O,U,T);if(!$)return null;T=T||$.type,x.push([L,$])}return T.kind==="number"||T.kind==="color"||T.kind==="array"&&T.itemType.kind==="number"&&typeof T.N=="number"?new zl(T,u,p,g,x):s.error(`Type ${It(T)} is not interpolatable.`)}evaluate(r){const s=this.labels,u=this.outputs;if(s.length===1)return u[0].evaluate(r);const p=this.input.evaluate(r);if(p<=s[0])return u[0].evaluate(r);const g=s.length;if(p>=s[g-1])return u[g-1].evaluate(r);const b=Ma(s,p),x=zl.interpolationFactor(this.interpolation,p,s[b],s[b+1]),T=u[b].evaluate(r),k=u[b+1].evaluate(r);return this.operator==="interpolate"?$a[this.type.kind.toLowerCase()](T,k,x):this.operator==="interpolate-hcl"?Ko.reverse(Ko.interpolate(Ko.forward(T),Ko.forward(k),x)):Ll.reverse(Ll.interpolate(Ll.forward(T),Ll.forward(k),x))}eachChild(r){r(this.input);for(const s of this.outputs)r(s)}outputDefined(){return this.outputs.every(r=>r.outputDefined())}serialize(){let r;r=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const s=[this.operator,r,this.input.serialize()];for(let u=0;u<this.labels.length;u++)s.push(this.labels[u],this.outputs[u].serialize());return s}}function Zs(a,r,s,u){const p=u-s,g=a-s;return p===0?0:r===1?g/p:(Math.pow(r,g)-1)/(Math.pow(r,p)-1)}var Lo=zl;class Ac{constructor(r,s){this.type=r,this.args=s}static parse(r,s){if(r.length<2)return s.error("Expectected at least one argument.");let u=null;const p=s.expectedType;p&&p.kind!=="value"&&(u=p);const g=[];for(const x of r.slice(1)){const T=s.parse(x,1+g.length,u,void 0,{typeAnnotation:"omit"});if(!T)return null;u=u||T.type,g.push(T)}const b=p&&g.some(x=>we(p,x.type));return new Ac(b?D:u,g)}evaluate(r){let s,u=null,p=0;for(const g of this.args){if(p++,u=g.evaluate(r),u&&u instanceof Ji&&!u.available&&(s||(s=u),u=null,p===this.args.length))return s;if(u!==null)break}return u}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}serialize(){const r=["coalesce"];return this.eachChild(s=>{r.push(s.serialize())}),r}}var Nu=Ac;class Ol{constructor(r,s){this.type=s.type,this.bindings=[].concat(r),this.result=s}evaluate(r){return this.result.evaluate(r)}eachChild(r){for(const s of this.bindings)r(s[1]);r(this.result)}static parse(r,s){if(r.length<4)return s.error(`Expected at least 3 arguments, but found ${r.length-1} instead.`);const u=[];for(let g=1;g<r.length-1;g+=2){const b=r[g];if(typeof b!="string")return s.error(`Expected string, but found ${typeof b} instead.`,g);if(/[^a-zA-Z0-9_]/.test(b))return s.error("Variable names must contain only alphanumeric characters or '_'.",g);const x=s.parse(r[g+1],g+1);if(!x)return null;u.push([b,x])}const p=s.parse(r[r.length-1],r.length-1,s.expectedType,u);return p?new Ol(u,p):null}outputDefined(){return this.result.outputDefined()}serialize(){const r=["let"];for(const[s,u]of this.bindings)r.push(s,u.serialize());return r.push(this.result.serialize()),r}}var xs=Ol;class Dl{constructor(r,s,u){this.type=r,this.index=s,this.input=u}static parse(r,s){if(r.length!==3)return s.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const u=s.parse(r[1],1,Se),p=s.parse(r[2],2,St(s.expectedType||D));return u&&p?new Dl(p.type.itemType,u,p):null}evaluate(r){const s=this.index.evaluate(r),u=this.input.evaluate(r);if(s<0)throw new ki(`Array index out of bounds: ${s} < 0.`);if(s>=u.length)throw new ki(`Array index out of bounds: ${s} > ${u.length-1}.`);if(s!==Math.floor(s))throw new ki(`Array index must be an integer, but found ${s} instead.`);return u[s]}eachChild(r){r(this.index),r(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var Cf=Dl;class Dt{constructor(r,s){this.type=zn,this.needle=r,this.haystack=s}static parse(r,s){if(r.length!==3)return s.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const u=s.parse(r[1],1,D),p=s.parse(r[2],2,D);return u&&p?$e(u.type,[zn,Dn,Se,fs,D])?new Dt(u,p):s.error(`Expected first argument to be of type boolean, string, number or null, but found ${It(u.type)} instead`):null}evaluate(r){const s=this.needle.evaluate(r),u=this.haystack.evaluate(r);if(u==null)return!1;if(!Re(s,["boolean","string","number","null"]))throw new ki(`Expected first argument to be of type boolean, string, number or null, but found ${It(fi(s))} instead.`);if(!Re(u,["string","array"]))throw new ki(`Expected second argument to be of type array or string, but found ${It(fi(u))} instead.`);return u.indexOf(s)>=0}eachChild(r){r(this.needle),r(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var te=Dt;class Be{constructor(r,s,u){this.type=Se,this.needle=r,this.haystack=s,this.fromIndex=u}static parse(r,s){if(r.length<=2||r.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${r.length-1} instead.`);const u=s.parse(r[1],1,D),p=s.parse(r[2],2,D);if(!u||!p)return null;if(!$e(u.type,[zn,Dn,Se,fs,D]))return s.error(`Expected first argument to be of type boolean, string, number or null, but found ${It(u.type)} instead`);if(r.length===4){const g=s.parse(r[3],3,Se);return g?new Be(u,p,g):null}return new Be(u,p)}evaluate(r){const s=this.needle.evaluate(r),u=this.haystack.evaluate(r);if(!Re(s,["boolean","string","number","null"]))throw new ki(`Expected first argument to be of type boolean, string, number or null, but found ${It(fi(s))} instead.`);if(!Re(u,["string","array"]))throw new ki(`Expected second argument to be of type array or string, but found ${It(fi(u))} instead.`);if(this.fromIndex){const p=this.fromIndex.evaluate(r);return u.indexOf(s,p)}return u.indexOf(s)}eachChild(r){r(this.needle),r(this.haystack),this.fromIndex&&r(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const r=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),r]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var pn=Be;class Sr{constructor(r,s,u,p,g,b){this.inputType=r,this.type=s,this.input=u,this.cases=p,this.outputs=g,this.otherwise=b}static parse(r,s){if(r.length<5)return s.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if(r.length%2!=1)return s.error("Expected an even number of arguments.");let u,p;s.expectedType&&s.expectedType.kind!=="value"&&(p=s.expectedType);const g={},b=[];for(let k=2;k<r.length-1;k+=2){let L=r[k];const O=r[k+1];Array.isArray(L)||(L=[L]);const R=s.concat(k);if(L.length===0)return R.error("Expected at least one branch label.");for(const $ of L){if(typeof $!="number"&&typeof $!="string")return R.error("Branch labels must be numbers or strings.");if(typeof $=="number"&&Math.abs($)>Number.MAX_SAFE_INTEGER)return R.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof $=="number"&&Math.floor($)!==$)return R.error("Numeric branch labels must be integer values.");if(u){if(R.checkSubtype(u,fi($)))return null}else u=fi($);if(g[String($)]!==void 0)return R.error("Branch labels must be unique.");g[String($)]=b.length}const U=s.parse(O,k,p);if(!U)return null;p=p||U.type,b.push(U)}const x=s.parse(r[1],1,D);if(!x)return null;const T=s.parse(r[r.length-1],r.length-1,p);return T?x.type.kind!=="value"&&s.concat(1).checkSubtype(u,x.type)?null:new Sr(u,p,x,g,b,T):null}evaluate(r){const s=this.input.evaluate(r);return(fi(s)===this.inputType&&this.outputs[this.cases[s]]||this.otherwise).evaluate(r)}eachChild(r){r(this.input),this.outputs.forEach(r),r(this.otherwise)}outputDefined(){return this.outputs.every(r=>r.outputDefined())&&this.otherwise.outputDefined()}serialize(){const r=["match",this.input.serialize()],s=Object.keys(this.cases).sort(),u=[],p={};for(const b of s){const x=p[this.cases[b]];x===void 0?(p[this.cases[b]]=u.length,u.push([this.cases[b],[b]])):u[x][1].push(b)}const g=b=>this.inputType.kind==="number"?Number(b):b;for(const[b,x]of u)r.push(x.length===1?g(x[0]):x.map(g)),r.push(this.outputs[b].serialize());return r.push(this.otherwise.serialize()),r}}var er=Sr;class Gr{constructor(r,s,u){this.type=r,this.branches=s,this.otherwise=u}static parse(r,s){if(r.length<4)return s.error(`Expected at least 3 arguments, but found only ${r.length-1}.`);if(r.length%2!=0)return s.error("Expected an odd number of arguments.");let u;s.expectedType&&s.expectedType.kind!=="value"&&(u=s.expectedType);const p=[];for(let b=1;b<r.length-1;b+=2){const x=s.parse(r[b],b,zn);if(!x)return null;const T=s.parse(r[b+1],b+1,u);if(!T)return null;p.push([x,T]),u=u||T.type}const g=s.parse(r[r.length-1],r.length-1,u);return g?new Gr(u,p,g):null}evaluate(r){for(const[s,u]of this.branches)if(s.evaluate(r))return u.evaluate(r);return this.otherwise.evaluate(r)}eachChild(r){for(const[s,u]of this.branches)r(s),r(u);r(this.otherwise)}outputDefined(){return this.branches.every(([r,s])=>s.outputDefined())&&this.otherwise.outputDefined()}serialize(){const r=["case"];return this.eachChild(s=>{r.push(s.serialize())}),r}}var pi=Gr;class Li{constructor(r,s,u,p){this.type=r,this.input=s,this.beginIndex=u,this.endIndex=p}static parse(r,s){if(r.length<=2||r.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${r.length-1} instead.`);const u=s.parse(r[1],1,D),p=s.parse(r[2],2,Se);if(!u||!p)return null;if(!$e(u.type,[St(D),Dn,D]))return s.error(`Expected first argument to be of type array or string, but found ${It(u.type)} instead`);if(r.length===4){const g=s.parse(r[3],3,Se);return g?new Li(u.type,u,p,g):null}return new Li(u.type,u,p)}evaluate(r){const s=this.input.evaluate(r),u=this.beginIndex.evaluate(r);if(!Re(s,["string","array"]))throw new ki(`Expected first argument to be of type array or string, but found ${It(fi(s))} instead.`);if(this.endIndex){const p=this.endIndex.evaluate(r);return s.slice(u,p)}return s.slice(u)}eachChild(r){r(this.input),r(this.beginIndex),this.endIndex&&r(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const r=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),r]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var mi=Li;function ai(a,r){return a==="=="||a==="!="?r.kind==="boolean"||r.kind==="string"||r.kind==="number"||r.kind==="null"||r.kind==="value":r.kind==="string"||r.kind==="number"||r.kind==="value"}function Jo(a,r,s,u){return u.compare(r,s)===0}function lo(a,r,s){const u=a!=="=="&&a!=="!=";return class EM{constructor(g,b,x){this.type=zn,this.lhs=g,this.rhs=b,this.collator=x,this.hasUntypedArgument=g.type.kind==="value"||b.type.kind==="value"}static parse(g,b){if(g.length!==3&&g.length!==4)return b.error("Expected two or three arguments.");const x=g[0];let T=b.parse(g[1],1,D);if(!T)return null;if(!ai(x,T.type))return b.concat(1).error(`"${x}" comparisons are not supported for type '${It(T.type)}'.`);let k=b.parse(g[2],2,D);if(!k)return null;if(!ai(x,k.type))return b.concat(2).error(`"${x}" comparisons are not supported for type '${It(k.type)}'.`);if(T.type.kind!==k.type.kind&&T.type.kind!=="value"&&k.type.kind!=="value")return b.error(`Cannot compare types '${It(T.type)}' and '${It(k.type)}'.`);u&&(T.type.kind==="value"&&k.type.kind!=="value"?T=new oa(k.type,[T]):T.type.kind!=="value"&&k.type.kind==="value"&&(k=new oa(T.type,[k])));let L=null;if(g.length===4){if(T.type.kind!=="string"&&k.type.kind!=="string"&&T.type.kind!=="value"&&k.type.kind!=="value")return b.error("Cannot use collator to compare non-string types.");if(L=b.parse(g[3],3,J),!L)return null}return new EM(T,k,L)}evaluate(g){const b=this.lhs.evaluate(g),x=this.rhs.evaluate(g);if(u&&this.hasUntypedArgument){const T=fi(b),k=fi(x);if(T.kind!==k.kind||T.kind!=="string"&&T.kind!=="number")throw new ki(`Expected arguments for "${a}" to be (string, string) or (number, number), but found (${T.kind}, ${k.kind}) instead.`)}if(this.collator&&!u&&this.hasUntypedArgument){const T=fi(b),k=fi(x);if(T.kind!=="string"||k.kind!=="string")return r(g,b,x)}return this.collator?s(g,b,x,this.collator.evaluate(g)):r(g,b,x)}eachChild(g){g(this.lhs),g(this.rhs),this.collator&&g(this.collator)}outputDefined(){return!0}serialize(){const g=[a];return this.eachChild(b=>{g.push(b.serialize())}),g}}}const Qi=lo("==",function(a,r,s){return r===s},Jo),sa=lo("!=",function(a,r,s){return r!==s},function(a,r,s,u){return!Jo(0,r,s,u)}),ws=lo("<",function(a,r,s){return r<s},function(a,r,s,u){return u.compare(r,s)<0}),Rl=lo(">",function(a,r,s){return r>s},function(a,r,s,u){return u.compare(r,s)>0}),Ga=lo("<=",function(a,r,s){return r<=s},function(a,r,s,u){return u.compare(r,s)<=0}),Bl=lo(">=",function(a,r,s){return r>=s},function(a,r,s,u){return u.compare(r,s)>=0});class Ic{constructor(r,s,u,p,g,b){this.type=Dn,this.number=r,this.locale=s,this.currency=u,this.unit=p,this.minFractionDigits=g,this.maxFractionDigits=b}static parse(r,s){if(r.length!==3)return s.error("Expected two arguments.");const u=s.parse(r[1],1,Se);if(!u)return null;const p=r[2];if(typeof p!="object"||Array.isArray(p))return s.error("NumberFormat options argument must be an object.");let g=null;if(p.locale&&(g=s.parse(p.locale,1,Dn),!g))return null;let b=null;if(p.currency&&(b=s.parse(p.currency,1,Dn),!b))return null;let x=null;if(p.unit&&(x=s.parse(p.unit,1,Dn),!x))return null;let T=null;if(p["min-fraction-digits"]&&(T=s.parse(p["min-fraction-digits"],1,Se),!T))return null;let k=null;return p["max-fraction-digits"]&&(k=s.parse(p["max-fraction-digits"],1,Se),!k)?null:new Ic(u,g,b,x,T,k)}evaluate(r){return new Intl.NumberFormat(this.locale?this.locale.evaluate(r):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(r):void 0,unit:this.unit?this.unit.evaluate(r):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(r):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(r):void 0}).format(this.number.evaluate(r))}eachChild(r){r(this.number),this.locale&&r(this.locale),this.currency&&r(this.currency),this.unit&&r(this.unit),this.minFractionDigits&&r(this.minFractionDigits),this.maxFractionDigits&&r(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const r={};return this.locale&&(r.locale=this.locale.serialize()),this.currency&&(r.currency=this.currency.serialize()),this.unit&&(r.unit=this.unit.serialize()),this.minFractionDigits&&(r["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(r["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),r]}}class ju{constructor(r){this.type=Se,this.input=r}static parse(r,s){if(r.length!==2)return s.error(`Expected 1 argument, but found ${r.length-1} instead.`);const u=s.parse(r[1],1);return u?u.type.kind!=="array"&&u.type.kind!=="string"&&u.type.kind!=="value"?s.error(`Expected argument of type string or array, but found ${It(u.type)} instead.`):new ju(u):null}evaluate(r){const s=this.input.evaluate(r);if(typeof s=="string"||Array.isArray(s))return s.length;throw new ki(`Expected value to be of type string or array, but found ${It(fi(s))} instead.`)}eachChild(r){r(this.input)}outputDefined(){return!1}serialize(){const r=["length"];return this.eachChild(s=>{r.push(s.serialize())}),r}}const th={"==":Qi,"!=":sa,">":Rl,"<":ws,">=":Bl,"<=":Ga,array:oa,at:Cf,boolean:oa,case:pi,coalesce:Nu,collator:Gs,format:kl,image:yc,in:te,"index-of":pn,interpolate:Lo,"interpolate-hcl":Lo,"interpolate-lab":Lo,length:ju,let:xs,literal:Us,match:er,number:oa,"number-format":Ic,object:oa,slice:mi,step:Yo,string:oa,"to-boolean":ms,"to-color":ms,"to-number":ms,"to-string":ms,var:Du,within:Il};function xr(a,[r,s,u,p]){r=r.evaluate(a),s=s.evaluate(a),u=u.evaluate(a);const g=p?p.evaluate(a):1,b=Lr(r,s,u,g);if(b)throw new ki(b);return new kn(r/255*g,s/255*g,u/255*g,g)}function dr(a,r){return a in r}function Xs(a,r){const s=r[a];return s===void 0?null:s}function to(a){return{type:a}}Xo.register(th,{error:[{kind:"error"},[Dn],(a,[r])=>{throw new ki(r.evaluate(a))}],typeof:[Dn,[D],(a,[r])=>It(fi(r.evaluate(a)))],"to-rgba":[St(Se,4),[wo],(a,[r])=>r.evaluate(a).toArray()],rgb:[wo,[Se,Se,Se],xr],rgba:[wo,[Se,Se,Se,Se],xr],has:{type:zn,overloads:[[[Dn],(a,[r])=>dr(r.evaluate(a),a.properties())],[[Dn,M],(a,[r,s])=>dr(r.evaluate(a),s.evaluate(a))]]},get:{type:D,overloads:[[[Dn],(a,[r])=>Xs(r.evaluate(a),a.properties())],[[Dn,M],(a,[r,s])=>Xs(r.evaluate(a),s.evaluate(a))]]},"feature-state":[D,[Dn],(a,[r])=>Xs(r.evaluate(a),a.featureState||{})],properties:[M,[],a=>a.properties()],"geometry-type":[Dn,[],a=>a.geometryType()],id:[D,[],a=>a.id()],zoom:[Se,[],a=>a.globals.zoom],pitch:[Se,[],a=>a.globals.pitch||0],"distance-from-center":[Se,[],a=>a.distanceFromCenter()],"heatmap-density":[Se,[],a=>a.globals.heatmapDensity||0],"line-progress":[Se,[],a=>a.globals.lineProgress||0],"sky-radial-progress":[Se,[],a=>a.globals.skyRadialProgress||0],accumulated:[D,[],a=>a.globals.accumulated===void 0?null:a.globals.accumulated],"+":[Se,to(Se),(a,r)=>{let s=0;for(const u of r)s+=u.evaluate(a);return s}],"*":[Se,to(Se),(a,r)=>{let s=1;for(const u of r)s*=u.evaluate(a);return s}],"-":{type:Se,overloads:[[[Se,Se],(a,[r,s])=>r.evaluate(a)-s.evaluate(a)],[[Se],(a,[r])=>-r.evaluate(a)]]},"/":[Se,[Se,Se],(a,[r,s])=>r.evaluate(a)/s.evaluate(a)],"%":[Se,[Se,Se],(a,[r,s])=>r.evaluate(a)%s.evaluate(a)],ln2:[Se,[],()=>Math.LN2],pi:[Se,[],()=>Math.PI],e:[Se,[],()=>Math.E],"^":[Se,[Se,Se],(a,[r,s])=>Math.pow(r.evaluate(a),s.evaluate(a))],sqrt:[Se,[Se],(a,[r])=>Math.sqrt(r.evaluate(a))],log10:[Se,[Se],(a,[r])=>Math.log(r.evaluate(a))/Math.LN10],ln:[Se,[Se],(a,[r])=>Math.log(r.evaluate(a))],log2:[Se,[Se],(a,[r])=>Math.log(r.evaluate(a))/Math.LN2],sin:[Se,[Se],(a,[r])=>Math.sin(r.evaluate(a))],cos:[Se,[Se],(a,[r])=>Math.cos(r.evaluate(a))],tan:[Se,[Se],(a,[r])=>Math.tan(r.evaluate(a))],asin:[Se,[Se],(a,[r])=>Math.asin(r.evaluate(a))],acos:[Se,[Se],(a,[r])=>Math.acos(r.evaluate(a))],atan:[Se,[Se],(a,[r])=>Math.atan(r.evaluate(a))],min:[Se,to(Se),(a,r)=>Math.min(...r.map(s=>s.evaluate(a)))],max:[Se,to(Se),(a,r)=>Math.max(...r.map(s=>s.evaluate(a)))],abs:[Se,[Se],(a,[r])=>Math.abs(r.evaluate(a))],round:[Se,[Se],(a,[r])=>{const s=r.evaluate(a);return s<0?-Math.round(-s):Math.round(s)}],floor:[Se,[Se],(a,[r])=>Math.floor(r.evaluate(a))],ceil:[Se,[Se],(a,[r])=>Math.ceil(r.evaluate(a))],"filter-==":[zn,[Dn,D],(a,[r,s])=>a.properties()[r.value]===s.value],"filter-id-==":[zn,[D],(a,[r])=>a.id()===r.value],"filter-type-==":[zn,[Dn],(a,[r])=>a.geometryType()===r.value],"filter-<":[zn,[Dn,D],(a,[r,s])=>{const u=a.properties()[r.value],p=s.value;return typeof u==typeof p&&u<p}],"filter-id-<":[zn,[D],(a,[r])=>{const s=a.id(),u=r.value;return typeof s==typeof u&&s<u}],"filter->":[zn,[Dn,D],(a,[r,s])=>{const u=a.properties()[r.value],p=s.value;return typeof u==typeof p&&u>p}],"filter-id->":[zn,[D],(a,[r])=>{const s=a.id(),u=r.value;return typeof s==typeof u&&s>u}],"filter-<=":[zn,[Dn,D],(a,[r,s])=>{const u=a.properties()[r.value],p=s.value;return typeof u==typeof p&&u<=p}],"filter-id-<=":[zn,[D],(a,[r])=>{const s=a.id(),u=r.value;return typeof s==typeof u&&s<=u}],"filter->=":[zn,[Dn,D],(a,[r,s])=>{const u=a.properties()[r.value],p=s.value;return typeof u==typeof p&&u>=p}],"filter-id->=":[zn,[D],(a,[r])=>{const s=a.id(),u=r.value;return typeof s==typeof u&&s>=u}],"filter-has":[zn,[D],(a,[r])=>r.value in a.properties()],"filter-has-id":[zn,[],a=>a.id()!==null&&a.id()!==void 0],"filter-type-in":[zn,[St(Dn)],(a,[r])=>r.value.indexOf(a.geometryType())>=0],"filter-id-in":[zn,[St(D)],(a,[r])=>r.value.indexOf(a.id())>=0],"filter-in-small":[zn,[Dn,St(D)],(a,[r,s])=>s.value.indexOf(a.properties()[r.value])>=0],"filter-in-large":[zn,[Dn,St(D)],(a,[r,s])=>function(u,p,g,b){for(;g<=b;){const x=g+b>>1;if(p[x]===u)return!0;p[x]>u?b=x-1:g=x+1}return!1}(a.properties()[r.value],s.value,0,s.value.length-1)],all:{type:zn,overloads:[[[zn,zn],(a,[r,s])=>r.evaluate(a)&&s.evaluate(a)],[to(zn),(a,r)=>{for(const s of r)if(!s.evaluate(a))return!1;return!0}]]},any:{type:zn,overloads:[[[zn,zn],(a,[r,s])=>r.evaluate(a)||s.evaluate(a)],[to(zn),(a,r)=>{for(const s of r)if(s.evaluate(a))return!0;return!1}]]},"!":[zn,[zn],(a,[r])=>!r.evaluate(a)],"is-supported-script":[zn,[Dn],(a,[r])=>{const s=a.globals&&a.globals.isSupportedScript;return!s||s(r.evaluate(a))}],upcase:[Dn,[Dn],(a,[r])=>r.evaluate(a).toUpperCase()],downcase:[Dn,[Dn],(a,[r])=>r.evaluate(a).toLowerCase()],concat:[Dn,to(D),(a,r)=>r.map(s=>Eo(s.evaluate(a))).join("")],"resolved-locale":[Dn,[J],(a,[r])=>r.evaluate(a).resolvedLocale()]});var qa=th;function Vi(a){return{result:"success",value:a}}function co(a){return{result:"error",value:a}}function To(a){return a["property-type"]==="data-driven"}function ko(a){return!!a.expression&&a.expression.parameters.indexOf("zoom")>-1}function Es(a){return!!a.expression&&a.expression.interpolated}function In(a){return a instanceof Number?"number":a instanceof String?"string":a instanceof Boolean?"boolean":Array.isArray(a)?"array":a===null?"null":typeof a}function la(a){return typeof a=="object"&&a!==null&&!Array.isArray(a)}function eh(a){return a}function Ys(a,r){const s=r.type==="color",u=a.stops&&typeof a.stops[0][0]=="object",p=u||!(u||a.property!==void 0),g=a.type||(Es(r)?"exponential":"interval");if(s&&((a=ia({},a)).stops&&(a.stops=a.stops.map(k=>[k[0],kn.parse(k[1])])),a.default=kn.parse(a.default?a.default:r.default)),a.colorSpace&&a.colorSpace!=="rgb"&&!Fu[a.colorSpace])throw new Error(`Unknown color space: ${a.colorSpace}`);let b,x,T;if(g==="exponential")b=Nl;else if(g==="interval")b=Fl;else if(g==="categorical"){b=Ks,x=Object.create(null);for(const k of a.stops)x[k[0]]=k[1];T=typeof a.stops[0][0]}else{if(g!=="identity")throw new Error(`Unknown function type "${g}"`);b=jl}if(u){const k={},L=[];for(let U=0;U<a.stops.length;U++){const $=a.stops[U],X=$[0].zoom;k[X]===void 0&&(k[X]={zoom:X,type:a.type,property:a.property,default:a.default,stops:[]},L.push(X)),k[X].stops.push([$[0].value,$[1]])}const O=[];for(const U of L)O.push([k[U].zoom,Ys(k[U],r)]);const R={name:"linear"};return{kind:"composite",interpolationType:R,interpolationFactor:Lo.interpolationFactor.bind(void 0,R),zoomStops:O.map(U=>U[0]),evaluate:({zoom:U},$)=>Nl({stops:O,base:a.base},r,U).evaluate(U,$)}}if(p){const k=g==="exponential"?{name:"exponential",base:a.base!==void 0?a.base:1}:null;return{kind:"camera",interpolationType:k,interpolationFactor:Lo.interpolationFactor.bind(void 0,k),zoomStops:a.stops.map(L=>L[0]),evaluate:({zoom:L})=>b(a,r,L,x,T)}}return{kind:"source",evaluate(k,L){const O=L&&L.properties?L.properties[a.property]:void 0;return O===void 0?Ts(a.default,r.default):b(a,r,O,x,T)}}}function Ts(a,r,s){return a!==void 0?a:r!==void 0?r:s!==void 0?s:void 0}function Ks(a,r,s,u,p){return Ts(typeof s===p?u[s]:void 0,a.default,r.default)}function Fl(a,r,s){if(In(s)!=="number")return Ts(a.default,r.default);const u=a.stops.length;if(u===1||s<=a.stops[0][0])return a.stops[0][1];if(s>=a.stops[u-1][0])return a.stops[u-1][1];const p=Ma(a.stops.map(g=>g[0]),s);return a.stops[p][1]}function Nl(a,r,s){const u=a.base!==void 0?a.base:1;if(In(s)!=="number")return Ts(a.default,r.default);const p=a.stops.length;if(p===1||s<=a.stops[0][0])return a.stops[0][1];if(s>=a.stops[p-1][0])return a.stops[p-1][1];const g=Ma(a.stops.map(L=>L[0]),s),b=function(L,O,R,U){const $=U-R,X=L-R;return $===0?0:O===1?X/$:(Math.pow(O,X)-1)/(Math.pow(O,$)-1)}(s,u,a.stops[g][0],a.stops[g+1][0]),x=a.stops[g][1],T=a.stops[g+1][1];let k=$a[r.type]||eh;if(a.colorSpace&&a.colorSpace!=="rgb"){const L=Fu[a.colorSpace];k=(O,R)=>L.reverse(L.interpolate(L.forward(O),L.forward(R),b))}return typeof x.evaluate=="function"?{evaluate(...L){const O=x.evaluate.apply(void 0,L),R=T.evaluate.apply(void 0,L);if(O!==void 0&&R!==void 0)return k(O,R,b)}}:k(x,T,b)}function jl(a,r,s){return r.type==="color"?s=kn.parse(s):r.type==="formatted"?s=$i.fromString(s.toString()):r.type==="resolvedImage"?s=Ji.fromString(s.toString()):In(s)===r.type||r.type==="enum"&&r.values[s]||(s=void 0),Ts(s,a.default,r.default)}class ks{constructor(r,s){this.expression=r,this._warningHistory={},this._evaluator=new Cl,this._defaultValue=s?function(u){return u.type==="color"&&(la(u.default)||Array.isArray(u.default))?new kn(0,0,0,0):u.type==="color"?kn.parse(u.default)||null:u.default===void 0?null:u.default}(s):null,this._enumValues=s&&s.type==="enum"?s.values:null}evaluateWithoutErrorHandling(r,s,u,p,g,b,x,T){return this._evaluator.globals=r,this._evaluator.feature=s,this._evaluator.featureState=u,this._evaluator.canonical=p||null,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=b,this._evaluator.featureTileCoord=x||null,this._evaluator.featureDistanceData=T||null,this.expression.evaluate(this._evaluator)}evaluate(r,s,u,p,g,b,x,T){this._evaluator.globals=r,this._evaluator.feature=s||null,this._evaluator.featureState=u||null,this._evaluator.canonical=p||null,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=b||null,this._evaluator.featureTileCoord=x||null,this._evaluator.featureDistanceData=T||null;try{const k=this.expression.evaluate(this._evaluator);if(k==null||typeof k=="number"&&k!=k)return this._defaultValue;if(this._enumValues&&!(k in this._enumValues))throw new ki(`Expected value to be one of ${Object.keys(this._enumValues).map(L=>JSON.stringify(L)).join(", ")}, but found ${JSON.stringify(k)} instead.`);return k}catch(k){return this._warningHistory[k.message]||(this._warningHistory[k.message]=!0,typeof console!="undefined"&&console.warn(k.message)),this._defaultValue}}}function Pc(a){return Array.isArray(a)&&a.length>0&&typeof a[0]=="string"&&a[0]in qa}function Lc(a,r){const s=new Ru(qa,[],r?function(p){const g={color:wo,string:Dn,number:Se,enum:Dn,boolean:zn,formatted:gt,resolvedImage:Ct};return p.type==="array"?St(g[p.value]||D,p.length):g[p.type]}(r):void 0),u=s.parse(a,void 0,void 0,void 0,r&&r.type==="string"?{typeAnnotation:"coerce"}:void 0);return u?Vi(new ks(u,r)):co(s.errors)}class nh{constructor(r,s){this.kind=r,this._styleExpression=s,this.isStateDependent=r!=="constant"&&!Ca(s.expression)}evaluateWithoutErrorHandling(r,s,u,p,g,b){return this._styleExpression.evaluateWithoutErrorHandling(r,s,u,p,g,b)}evaluate(r,s,u,p,g,b){return this._styleExpression.evaluate(r,s,u,p,g,b)}}class Ul{constructor(r,s,u,p){this.kind=r,this.zoomStops=u,this._styleExpression=s,this.isStateDependent=r!=="camera"&&!Ca(s.expression),this.interpolationType=p}evaluateWithoutErrorHandling(r,s,u,p,g,b){return this._styleExpression.evaluateWithoutErrorHandling(r,s,u,p,g,b)}evaluate(r,s,u,p,g,b){return this._styleExpression.evaluate(r,s,u,p,g,b)}interpolationFactor(r,s,u){return this.interpolationType?Lo.interpolationFactor(this.interpolationType,r,s,u):0}}function $l(a,r){if((a=Lc(a,r)).result==="error")return a;const s=a.value.expression,u=_s(s);if(!u&&!To(r))return co([new Zo("","data expressions not supported")]);const p=Ec(s,["zoom","pitch","distance-from-center"]);if(!p&&!ko(r))return co([new Zo("","zoom expressions not supported")]);const g=$u(s);return g||p?g instanceof Zo?co([g]):g instanceof Lo&&!Es(r)?co([new Zo("",'"interpolate" expressions cannot be used with this property')]):Vi(g?new Ul(u?"camera":"composite",a.value,g.labels,g instanceof Lo?g.interpolation:void 0):new nh(u?"constant":"source",a.value)):co([new Zo("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Uu{constructor(r,s){this._parameters=r,this._specification=s,ia(this,Ys(this._parameters,this._specification))}static deserialize(r){return new Uu(r._parameters,r._specification)}static serialize(r){return{_parameters:r._parameters,_specification:r._specification}}}function $u(a){let r=null;if(a instanceof xs)r=$u(a.result);else if(a instanceof Nu){for(const s of a.args)if(r=$u(s),r)break}else(a instanceof Yo||a instanceof Lo)&&a.input instanceof Xo&&a.input.name==="zoom"&&(r=a);return r instanceof Zo||a.eachChild(s=>{const u=$u(s);u instanceof Zo?r=u:!r&&u?r=new Zo("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):r&&u&&r!==u&&(r=new Zo("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),r}class Ne{constructor(r,s,u,p){this.message=(r?`${r}: `:"")+u,p&&(this.identifier=p),s!=null&&s.__line__&&(this.line=s.__line__)}}function ca(a){const r=a.key,s=a.value,u=a.valueSpec||{},p=a.objectElementValidators||{},g=a.style,b=a.styleSpec;let x=[];const T=In(s);if(T!=="object")return[new Ne(r,s,`object expected, ${T} found`)];for(const k in s){const L=k.split(".")[0],O=u[L]||u["*"];let R;p[L]?R=p[L]:u[L]?R=uo:p["*"]?R=p["*"]:u["*"]&&(R=uo),R?x=x.concat(R({key:(r&&`${r}.`)+k,value:s[k],valueSpec:O,style:g,styleSpec:b,object:s,objectKey:k},s)):x.push(new Ne(r,s[k],`unknown property "${k}"`))}for(const k in u)p[k]||u[k].required&&u[k].default===void 0&&s[k]===void 0&&x.push(new Ne(r,s,`missing required property "${k}"`));return x}function Wm(a){const r=a.value,s=a.valueSpec,u=a.style,p=a.styleSpec,g=a.key,b=a.arrayElementValidator||uo;if(In(r)!=="array")return[new Ne(g,r,`array expected, ${In(r)} found`)];if(s.length&&r.length!==s.length)return[new Ne(g,r,`array length ${s.length} expected, length ${r.length} found`)];if(s["min-length"]&&r.length<s["min-length"])return[new Ne(g,r,`array length at least ${s["min-length"]} expected, length ${r.length} found`)];let x={type:s.value,values:s.values,minimum:s.minimum,maximum:s.maximum,function:void 0};p.$version<7&&(x.function=s.function),In(s.value)==="object"&&(x=s.value);let T=[];for(let k=0;k<r.length;k++)T=T.concat(b({array:r,arrayIndex:k,value:r[k],valueSpec:x,style:u,styleSpec:p,key:`${g}[${k}]`}));return T}function Sf(a){const r=a.key,s=a.value,u=a.valueSpec;let p=In(s);if(p==="number"&&s!=s&&(p="NaN"),p!=="number")return[new Ne(r,s,`number expected, ${p} found`)];if("minimum"in u){let g=u.minimum;if(In(u.minimum)==="array"&&(g=u.minimum[a.arrayIndex]),s<g)return[new Ne(r,s,`${s} is less than the minimum value ${g}`)]}if("maximum"in u){let g=u.maximum;if(In(u.maximum)==="array"&&(g=u.maximum[a.arrayIndex]),s>g)return[new Ne(r,s,`${s} is greater than the maximum value ${g}`)]}return[]}function Vu(a){const r=a.valueSpec,s=ri(a.value.type);let u,p,g,b={};const x=s!=="categorical"&&a.value.property===void 0,T=!x,k=In(a.value.stops)==="array"&&In(a.value.stops[0])==="array"&&In(a.value.stops[0][0])==="object",L=ca({key:a.key,value:a.value,valueSpec:a.styleSpec.function,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{stops:function(U){if(s==="identity")return[new Ne(U.key,U.value,'identity function may not have a "stops" property')];let $=[];const X=U.value;return $=$.concat(Wm({key:U.key,value:X,valueSpec:U.valueSpec,style:U.style,styleSpec:U.styleSpec,arrayElementValidator:O})),In(X)==="array"&&X.length===0&&$.push(new Ne(U.key,X,"array must have at least one stop")),$},default:function(U){return uo({key:U.key,value:U.value,valueSpec:r,style:U.style,styleSpec:U.styleSpec})}}});return s==="identity"&&x&&L.push(new Ne(a.key,a.value,'missing required property "property"')),s==="identity"||a.value.stops||L.push(new Ne(a.key,a.value,'missing required property "stops"')),s==="exponential"&&a.valueSpec.expression&&!Es(a.valueSpec)&&L.push(new Ne(a.key,a.value,"exponential functions not supported")),a.styleSpec.$version>=8&&(T&&!To(a.valueSpec)?L.push(new Ne(a.key,a.value,"property functions not supported")):x&&!ko(a.valueSpec)&&L.push(new Ne(a.key,a.value,"zoom functions not supported"))),s!=="categorical"&&!k||a.value.property!==void 0||L.push(new Ne(a.key,a.value,'"property" property is required')),L;function O(U){let $=[];const X=U.value,nt=U.key;if(In(X)!=="array")return[new Ne(nt,X,`array expected, ${In(X)} found`)];if(X.length!==2)return[new Ne(nt,X,`array length 2 expected, length ${X.length} found`)];if(k){if(In(X[0])!=="object")return[new Ne(nt,X,`object expected, ${In(X[0])} found`)];if(X[0].zoom===void 0)return[new Ne(nt,X,"object stop key must have zoom")];if(X[0].value===void 0)return[new Ne(nt,X,"object stop key must have value")];const dt=ri(X[0].zoom);if(typeof dt!="number")return[new Ne(nt,X[0].zoom,"stop zoom values must be numbers")];if(g&&g>dt)return[new Ne(nt,X[0].zoom,"stop zoom values must appear in ascending order")];dt!==g&&(g=dt,p=void 0,b={}),$=$.concat(ca({key:`${nt}[0]`,value:X[0],valueSpec:{zoom:{}},style:U.style,styleSpec:U.styleSpec,objectElementValidators:{zoom:Sf,value:R}}))}else $=$.concat(R({key:`${nt}[0]`,value:X[0],valueSpec:{},style:U.style,styleSpec:U.styleSpec},X));return Pc(ja(X[1]))?$.concat([new Ne(`${nt}[1]`,X[1],"expressions are not allowed in function stops.")]):$.concat(uo({key:`${nt}[1]`,value:X[1],valueSpec:r,style:U.style,styleSpec:U.styleSpec}))}function R(U,$){const X=In(U.value),nt=ri(U.value),dt=U.value!==null?U.value:$;if(u){if(X!==u)return[new Ne(U.key,dt,`${X} stop domain type must match previous stop domain type ${u}`)]}else u=X;if(X!=="number"&&X!=="string"&&X!=="boolean"&&typeof nt!="number"&&typeof nt!="string"&&typeof nt!="boolean")return[new Ne(U.key,dt,"stop domain value must be a number, string, or boolean")];if(X!=="number"&&s!=="categorical"){let yt=`number expected, ${X} found`;return To(r)&&s===void 0&&(yt+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ne(U.key,dt,yt)]}return s!=="categorical"||X!=="number"||typeof nt=="number"&&isFinite(nt)&&Math.floor(nt)===nt?s!=="categorical"&&X==="number"&&typeof nt=="number"&&typeof p=="number"&&p!==void 0&&nt<p?[new Ne(U.key,dt,"stop domain values must appear in ascending order")]:(p=nt,s==="categorical"&&nt in b?[new Ne(U.key,dt,"stop domain values must be unique")]:(b[nt]=!0,[])):[new Ne(U.key,dt,`integer expected, found ${String(nt)}`)]}}function zc(a){const r=(a.expressionContext==="property"?$l:Lc)(ja(a.value),a.valueSpec);if(r.result==="error")return r.value.map(u=>new Ne(`${a.key}${u.key}`,a.value,u.message));const s=r.value.expression||r.value._styleExpression.expression;if(a.expressionContext==="property"&&a.propertyKey==="text-font"&&!s.outputDefined())return[new Ne(a.key,a.value,`Invalid data expression for "${a.propertyKey}". Output values must be contained as literals within the expression.`)];if(a.expressionContext==="property"&&a.propertyType==="layout"&&!Ca(s))return[new Ne(a.key,a.value,'"feature-state" data expressions are not supported with layout properties.')];if(a.expressionContext==="filter")return Zm(s,a);if(a.expressionContext&&a.expressionContext.indexOf("cluster")===0){if(!Ec(s,["zoom","feature-state"]))return[new Ne(a.key,a.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(a.expressionContext==="cluster-initial"&&!_s(s))return[new Ne(a.key,a.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Zm(a,r){const s=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(r.valueSpec&&r.valueSpec.expression)for(const p of r.valueSpec.expression.parameters)s.delete(p);if(s.size===0)return[];const u=[];return a instanceof Xo&&s.has(a.name)?[new Ne(r.key,r.value,`["${a.name}"] expression is not supported in a filter for a ${r.object.type} layer with id: ${r.object.id}`)]:(a.eachChild(p=>{u.push(...Zm(p,r))}),u)}function rh(a){const r=a.key,s=a.value,u=a.valueSpec,p=[];return Array.isArray(u.values)?u.values.indexOf(ri(s))===-1&&p.push(new Ne(r,s,`expected one of [${u.values.join(", ")}], ${JSON.stringify(s)} found`)):Object.keys(u.values).indexOf(ri(s))===-1&&p.push(new Ne(r,s,`expected one of [${Object.keys(u.values).join(", ")}], ${JSON.stringify(s)} found`)),p}function Mf(a){if(a===!0||a===!1)return!0;if(!Array.isArray(a)||a.length===0)return!1;switch(a[0]){case"has":return a.length>=2&&a[1]!=="$id"&&a[1]!=="$type";case"in":return a.length>=3&&(typeof a[1]!="string"||Array.isArray(a[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return a.length!==3||Array.isArray(a[1])||Array.isArray(a[2]);case"any":case"all":for(const r of a.slice(1))if(!Mf(r)&&typeof r!="boolean")return!1;return!0;default:return!0}}function ih(a,r="fill"){if(a==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Mf(a)||(a=ah(a));const s=a;let u=!0;try{u=function(k){if(!Gi(k))return k;let L=ja(k);return qu(L),L=Gu(L),L}(s)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(s,null,2)}
        `)}const p=Kt[`filter_${r}`],g=Lc(u,p);let b=null;if(g.result==="error")throw new Error(g.value.map(k=>`${k.key}: ${k.message}`).join(", "));b=(k,L,O)=>g.value.evaluate(k,L,{},O);let x=null,T=null;if(u!==s){const k=Lc(s,p);if(k.result==="error")throw new Error(k.value.map(L=>`${L.key}: ${L.message}`).join(", "));x=(L,O,R,U,$)=>k.value.evaluate(L,O,{},R,void 0,void 0,U,$),T=!_s(k.value.expression)}return{filter:b,dynamicFilter:x||void 0,needGeometry:Xm(u),needFeature:!!T}}function Gu(a){if(!Array.isArray(a))return a;const r=function(s){if(oh.has(s[0])){for(let u=1;u<s.length;u++)if(Gi(s[u]))return!0}return s}(a);return r===!0?r:r.map(s=>Gu(s))}function qu(a){let r=!1;const s=[];if(a[0]==="case"){for(let u=1;u<a.length-1;u+=2)r=r||Gi(a[u]),s.push(a[u+1]);s.push(a[a.length-1])}else if(a[0]==="match"){r=r||Gi(a[1]);for(let u=2;u<a.length-1;u+=2)s.push(a[u+1]);s.push(a[a.length-1])}else if(a[0]==="step"){r=r||Gi(a[1]);for(let u=1;u<a.length-1;u+=2)s.push(a[u+1])}r&&(a.length=0,a.push("any",...s));for(let u=1;u<a.length;u++)qu(a[u])}function Gi(a){if(!Array.isArray(a))return!1;if((r=a[0])==="pitch"||r==="distance-from-center")return!0;var r;for(let s=1;s<a.length;s++)if(Gi(a[s]))return!0;return!1}const oh=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Ey(a,r){return a<r?-1:a>r?1:0}function Xm(a){if(!Array.isArray(a))return!1;if(a[0]==="within")return!0;for(let r=1;r<a.length;r++)if(Xm(a[r]))return!0;return!1}function ah(a){if(!a)return!0;const r=a[0];return a.length<=1?r!=="any":r==="=="?Af(a[1],a[2],"=="):r==="!="?Oc(Af(a[1],a[2],"==")):r==="<"||r===">"||r==="<="||r===">="?Af(a[1],a[2],r):r==="any"?(s=a.slice(1),["any"].concat(s.map(ah))):r==="all"?["all"].concat(a.slice(1).map(ah)):r==="none"?["all"].concat(a.slice(1).map(ah).map(Oc)):r==="in"?sh(a[1],a.slice(2)):r==="!in"?Oc(sh(a[1],a.slice(2))):r==="has"?Ym(a[1]):r==="!has"?Oc(Ym(a[1])):r!=="within"||a;var s}function Af(a,r,s){switch(a){case"$type":return[`filter-type-${s}`,r];case"$id":return[`filter-id-${s}`,r];default:return[`filter-${s}`,a,r]}}function sh(a,r){if(r.length===0)return!1;switch(a){case"$type":return["filter-type-in",["literal",r]];case"$id":return["filter-id-in",["literal",r]];default:return r.length>200&&!r.some(s=>typeof s!=typeof r[0])?["filter-in-large",a,["literal",r.sort(Ey)]]:["filter-in-small",a,["literal",r]]}}function Ym(a){switch(a){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",a]}}function Oc(a){return["!",a]}function If(a){return Mf(ja(a.value))?zc(ia({},a,{expressionContext:"filter",valueSpec:a.styleSpec[`filter_${a.layerType||"fill"}`]})):Km(a)}function Km(a){const r=a.value,s=a.key;if(In(r)!=="array")return[new Ne(s,r,`array expected, ${In(r)} found`)];const u=a.styleSpec;let p,g=[];if(r.length<1)return[new Ne(s,r,"filter array must have at least 1 element")];switch(g=g.concat(rh({key:`${s}[0]`,value:r[0],valueSpec:u.filter_operator,style:a.style,styleSpec:a.styleSpec})),ri(r[0])){case"<":case"<=":case">":case">=":r.length>=2&&ri(r[1])==="$type"&&g.push(new Ne(s,r,`"$type" cannot be use with operator "${r[0]}"`));case"==":case"!=":r.length!==3&&g.push(new Ne(s,r,`filter array for operator "${r[0]}" must have 3 elements`));case"in":case"!in":r.length>=2&&(p=In(r[1]),p!=="string"&&g.push(new Ne(`${s}[1]`,r[1],`string expected, ${p} found`)));for(let b=2;b<r.length;b++)p=In(r[b]),ri(r[1])==="$type"?g=g.concat(rh({key:`${s}[${b}]`,value:r[b],valueSpec:u.geometry_type,style:a.style,styleSpec:a.styleSpec})):p!=="string"&&p!=="number"&&p!=="boolean"&&g.push(new Ne(`${s}[${b}]`,r[b],`string, number, or boolean expected, ${p} found`));break;case"any":case"all":case"none":for(let b=1;b<r.length;b++)g=g.concat(Km({key:`${s}[${b}]`,value:r[b],style:a.style,styleSpec:a.styleSpec}));break;case"has":case"!has":p=In(r[1]),r.length!==2?g.push(new Ne(s,r,`filter array for "${r[0]}" operator must have 2 elements`)):p!=="string"&&g.push(new Ne(`${s}[1]`,r[1],`string expected, ${p} found`));break;case"within":p=In(r[1]),r.length!==2?g.push(new Ne(s,r,`filter array for "${r[0]}" operator must have 2 elements`)):p!=="object"&&g.push(new Ne(`${s}[1]`,r[1],`object expected, ${p} found`))}return g}function lh(a,r){const s=a.key,u=a.style,p=a.styleSpec,g=a.value,b=a.objectKey,x=p[`${r}_${a.layerType}`];if(!x)return[];const T=b.match(/^(.*)-transition$/);if(r==="paint"&&T&&x[T[1]]&&x[T[1]].transition)return uo({key:s,value:g,valueSpec:p.transition,style:u,styleSpec:p});const k=a.valueSpec||x[b];if(!k)return[new Ne(s,g,`unknown property "${b}"`)];let L;if(In(g)==="string"&&To(k)&&!k.tokens&&(L=/^{([^}]+)}$/.exec(g)))return[new Ne(s,g,`"${b}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(L[1])} }\`.`)];const O=[];return a.layerType==="symbol"&&(b==="text-field"&&u&&!u.glyphs&&O.push(new Ne(s,g,'use of "text-field" requires a style "glyphs" property')),b==="text-font"&&la(ja(g))&&ri(g.type)==="identity"&&O.push(new Ne(s,g,'"text-font" does not support identity functions'))),O.concat(uo({key:a.key,value:g,valueSpec:k,style:u,styleSpec:p,expressionContext:"property",propertyType:r,propertyKey:b}))}function Jm(a){return lh(a,"paint")}function Pf(a){return lh(a,"layout")}function Lf(a){let r=[];const s=a.value,u=a.key,p=a.style,g=a.styleSpec;s.type||s.ref||r.push(new Ne(u,s,'either "type" or "ref" is required'));let b=ri(s.type);const x=ri(s.ref);if(s.id){const T=ri(s.id);for(let k=0;k<a.arrayIndex;k++){const L=p.layers[k];ri(L.id)===T&&r.push(new Ne(u,s.id,`duplicate layer id "${s.id}", previously used at line ${L.id.__line__}`))}}if("ref"in s){let T;["type","source","source-layer","filter","layout"].forEach(k=>{k in s&&r.push(new Ne(u,s[k],`"${k}" is prohibited for ref layers`))}),p.layers.forEach(k=>{ri(k.id)===x&&(T=k)}),T?T.ref?r.push(new Ne(u,s.ref,"ref cannot reference another ref layer")):b=ri(T.type):typeof x=="string"&&r.push(new Ne(u,s.ref,`ref layer "${x}" not found`))}else if(b!=="background"&&b!=="sky")if(s.source){const T=p.sources&&p.sources[s.source],k=T&&ri(T.type);T?k==="vector"&&b==="raster"?r.push(new Ne(u,s.source,`layer "${s.id}" requires a raster source`)):k==="raster"&&b!=="raster"?r.push(new Ne(u,s.source,`layer "${s.id}" requires a vector source`)):k!=="vector"||s["source-layer"]?k==="raster-dem"&&b!=="hillshade"?r.push(new Ne(u,s.source,"raster-dem source can only be used with layer type 'hillshade'.")):b!=="line"||!s.paint||!s.paint["line-gradient"]&&!s.paint["line-trim-offset"]||k==="geojson"&&T.lineMetrics||r.push(new Ne(u,s,`layer "${s.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):r.push(new Ne(u,s,`layer "${s.id}" must specify a "source-layer"`)):r.push(new Ne(u,s.source,`source "${s.source}" not found`))}else r.push(new Ne(u,s,'missing required property "source"'));return r=r.concat(ca({key:u,value:s,valueSpec:g.layer,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{"*":()=>[],type:()=>uo({key:`${u}.type`,value:s.type,valueSpec:g.layer.type,style:a.style,styleSpec:a.styleSpec,object:s,objectKey:"type"}),filter:T=>If(ia({layerType:b},T)),layout:T=>ca({layer:s,key:T.key,value:T.value,valueSpec:{},style:T.style,styleSpec:T.styleSpec,objectElementValidators:{"*":k=>Pf(ia({layerType:b},k))}}),paint:T=>ca({layer:s,key:T.key,value:T.value,valueSpec:{},style:T.style,styleSpec:T.styleSpec,objectElementValidators:{"*":k=>Jm(ia({layerType:b},k))}})}})),r}function Dc(a){const r=a.value,s=a.key,u=In(r);return u!=="string"?[new Ne(s,r,`string expected, ${u} found`)]:[]}const ch={promoteId:function({key:a,value:r}){if(In(r)==="string")return Dc({key:a,value:r});{const s=[];for(const u in r)s.push(...Dc({key:`${a}.${u}`,value:r[u]}));return s}}};function Hu(a){const r=a.value,s=a.key,u=a.styleSpec,p=a.style;if(!r.type)return[new Ne(s,r,'"type" is required')];const g=ri(r.type);let b;switch(g){case"vector":case"raster":case"raster-dem":return b=ca({key:s,value:r,valueSpec:u[`source_${g.replace("-","_")}`],style:a.style,styleSpec:u,objectElementValidators:ch}),b;case"geojson":if(b=ca({key:s,value:r,valueSpec:u.source_geojson,style:p,styleSpec:u,objectElementValidators:ch}),r.cluster)for(const x in r.clusterProperties){const[T,k]=r.clusterProperties[x],L=typeof T=="string"?[T,["accumulated"],["get",x]]:T;b.push(...zc({key:`${s}.${x}.map`,value:k,expressionContext:"cluster-map"})),b.push(...zc({key:`${s}.${x}.reduce`,value:L,expressionContext:"cluster-reduce"}))}return b;case"video":return ca({key:s,value:r,valueSpec:u.source_video,style:p,styleSpec:u});case"image":return ca({key:s,value:r,valueSpec:u.source_image,style:p,styleSpec:u});case"canvas":return[new Ne(s,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return rh({key:`${s}.type`,value:r.type,valueSpec:{values:Qm(u)},style:p,styleSpec:u})}}function Qm(a){return a.source.reduce((r,s)=>{const u=a[s];return u.type.type==="enum"&&(r=r.concat(Object.keys(u.type.values))),r},[])}function tg(a){const r=a.value,s=a.styleSpec,u=s.light,p=a.style;let g=[];const b=In(r);if(r===void 0)return g;if(b!=="object")return g=g.concat([new Ne("light",r,`object expected, ${b} found`)]),g;for(const x in r){const T=x.match(/^(.*)-transition$/);g=g.concat(T&&u[T[1]]&&u[T[1]].transition?uo({key:x,value:r[x],valueSpec:s.transition,style:p,styleSpec:s}):u[x]?uo({key:x,value:r[x],valueSpec:u[x],style:p,styleSpec:s}):[new Ne(x,r[x],`unknown property "${x}"`)])}return g}function zf(a){const r=a.value,s=a.key,u=a.style,p=a.styleSpec,g=p.terrain;let b=[];const x=In(r);if(r===void 0)return b;if(x!=="object")return b=b.concat([new Ne("terrain",r,`object expected, ${x} found`)]),b;for(const T in r){const k=T.match(/^(.*)-transition$/);b=b.concat(k&&g[k[1]]&&g[k[1]].transition?uo({key:T,value:r[T],valueSpec:p.transition,style:u,styleSpec:p}):g[T]?uo({key:T,value:r[T],valueSpec:g[T],style:u,styleSpec:p}):[new Ne(T,r[T],`unknown property "${T}"`)])}if(r.source){const T=u.sources&&u.sources[r.source],k=T&&ri(T.type);T?k!=="raster-dem"&&b.push(new Ne(s,r.source,`terrain cannot be used with a source of type ${String(k)}, it only be used with a "raster-dem" source type`)):b.push(new Ne(s,r.source,`source "${r.source}" not found`))}else b.push(new Ne(s,r,'terrain is missing required property "source"'));return b}function eg(a){const r=a.value,s=a.style,u=a.styleSpec,p=u.fog;let g=[];const b=In(r);if(r===void 0)return g;if(b!=="object")return g=g.concat([new Ne("fog",r,`object expected, ${b} found`)]),g;for(const x in r){const T=x.match(/^(.*)-transition$/);g=g.concat(T&&p[T[1]]&&p[T[1]].transition?uo({key:x,value:r[x],valueSpec:u.transition,style:s,styleSpec:u}):p[x]?uo({key:x,value:r[x],valueSpec:p[x],style:s,styleSpec:u}):[new Ne(x,r[x],`unknown property "${x}"`)])}return g}const uh={"*":()=>[],array:Wm,boolean:function(a){const r=a.value,s=a.key,u=In(r);return u!=="boolean"?[new Ne(s,r,`boolean expected, ${u} found`)]:[]},number:Sf,color:function(a){const r=a.key,s=a.value,u=In(s);return u!=="string"?[new Ne(r,s,`color expected, ${u} found`)]:De(s)===null?[new Ne(r,s,`color expected, "${s}" found`)]:[]},enum:rh,filter:If,function:Vu,layer:Lf,object:ca,source:Hu,light:tg,terrain:zf,fog:eg,string:Dc,formatted:function(a){return Dc(a).length===0?[]:zc(a)},resolvedImage:function(a){return Dc(a).length===0?[]:zc(a)},projection:function(a){const r=a.value,s=a.styleSpec,u=s.projection,p=a.style;let g=[];const b=In(r);if(b==="object")for(const x in r)g=g.concat(uo({key:x,value:r[x],valueSpec:u[x],style:p,styleSpec:s}));else b!=="string"&&(g=g.concat([new Ne("projection",r,`object or string expected, ${b} found`)]));return g}};function uo(a){const r=a.value,s=a.valueSpec,u=a.styleSpec;return s.expression&&la(ri(r))?Vu(a):s.expression&&Pc(ja(r))?zc(a):s.type&&uh[s.type]?uh[s.type](a):ca(ia({},a,{valueSpec:s.type?u[s.type]:s}))}function Ty(a){const r=a.value,s=a.key,u=Dc(a);return u.length||(r.indexOf("{fontstack}")===-1&&u.push(new Ne(s,r,'"glyphs" url must include a "{fontstack}" token')),r.indexOf("{range}")===-1&&u.push(new Ne(s,r,'"glyphs" url must include a "{range}" token'))),u}function ng(a,r=Kt){return Cs(uo({key:"",value:a,valueSpec:r.$root,styleSpec:r,style:a,objectElementValidators:{glyphs:Ty,"*":()=>[]}}))}const ky=a=>Cs(Jm(a)),rg=a=>Cs(Pf(a));function Cs(a){return a.slice().sort((r,s)=>r.line&&s.line?r.line-s.line:0)}function ig(a,r){let s=!1;if(r&&r.length)for(const u of r)a.fire(new Wo(new Error(u.message))),s=!0;return s}var Rc=Ha;function Ha(a,r,s){var u=this.cells=[];if(a instanceof ArrayBuffer){this.arrayBuffer=a;var p=new Int32Array(this.arrayBuffer);a=p[0],this.d=(r=p[1])+2*(s=p[2]);for(var g=0;g<this.d*this.d;g++){var b=p[3+g],x=p[3+g+1];u.push(b===x?null:p.subarray(b,x))}var T=p[3+u.length+1];this.keys=p.subarray(p[3+u.length],T),this.bboxes=p.subarray(T),this.insert=this._insertReadonly}else{this.d=r+2*s;for(var k=0;k<this.d*this.d;k++)u.push([]);this.keys=[],this.bboxes=[]}this.n=r,this.extent=a,this.padding=s,this.scale=r/a,this.uid=0;var L=s/r*a;this.min=-L,this.max=a+L}Ha.prototype.insert=function(a,r,s,u,p){this._forEachCell(r,s,u,p,this._insertCell,this.uid++),this.keys.push(a),this.bboxes.push(r),this.bboxes.push(s),this.bboxes.push(u),this.bboxes.push(p)},Ha.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Ha.prototype._insertCell=function(a,r,s,u,p,g){this.cells[p].push(g)},Ha.prototype.query=function(a,r,s,u,p){var g=this.min,b=this.max;if(a<=g&&r<=g&&b<=s&&b<=u&&!p)return Array.prototype.slice.call(this.keys);var x=[];return this._forEachCell(a,r,s,u,this._queryCell,x,{},p),x},Ha.prototype._queryCell=function(a,r,s,u,p,g,b,x){var T=this.cells[p];if(T!==null)for(var k=this.keys,L=this.bboxes,O=0;O<T.length;O++){var R=T[O];if(b[R]===void 0){var U=4*R;(x?x(L[U+0],L[U+1],L[U+2],L[U+3]):a<=L[U+2]&&r<=L[U+3]&&s>=L[U+0]&&u>=L[U+1])?(b[R]=!0,g.push(k[R])):b[R]=!1}}},Ha.prototype._forEachCell=function(a,r,s,u,p,g,b,x){for(var T=this._convertToCellCoord(a),k=this._convertToCellCoord(r),L=this._convertToCellCoord(s),O=this._convertToCellCoord(u),R=T;R<=L;R++)for(var U=k;U<=O;U++){var $=this.d*U+R;if((!x||x(this._convertFromCellCoord(R),this._convertFromCellCoord(U),this._convertFromCellCoord(R+1),this._convertFromCellCoord(U+1)))&&p.call(this,a,r,s,u,$,g,b,x))return}},Ha.prototype._convertFromCellCoord=function(a){return(a-this.padding)/this.scale},Ha.prototype._convertToCellCoord=function(a){return Math.max(0,Math.min(this.d-1,Math.floor(a*this.scale)+this.padding))},Ha.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var a=this.cells,r=3+this.cells.length+1+1,s=0,u=0;u<this.cells.length;u++)s+=this.cells[u].length;var p=new Int32Array(r+s+this.keys.length+this.bboxes.length);p[0]=this.extent,p[1]=this.n,p[2]=this.padding;for(var g=r,b=0;b<a.length;b++){var x=a[b];p[3+b]=g,p.set(x,g),g+=x.length}return p[3+a.length]=g,p.set(this.keys,g),p[3+a.length+1]=g+=this.keys.length,p.set(this.bboxes,g),g+=this.bboxes.length,p.buffer};const dh={};function qe(a,r,s={}){Object.defineProperty(a,"_classRegistryKey",{value:r,writeable:!1}),dh[r]={klass:a,omit:s.omit||[]}}qe(Object,"Object"),Rc.serialize=function(a,r){const s=a.toArrayBuffer();return r&&r.push(s),{buffer:s}},Rc.deserialize=function(a){return new Rc(a.buffer)},Object.defineProperty(Rc,"name",{value:"Grid"}),qe(Rc,"Grid"),qe(kn,"Color"),qe(Error,"Error"),qe(Rr,"AJAXError"),qe(Ji,"ResolvedImage"),qe(Uu,"StylePropertyFunction"),qe(ks,"StyleExpression",{omit:["_evaluator"]}),qe(Ul,"ZoomDependentExpression"),qe(nh,"ZoomConstantExpression"),qe(Xo,"CompoundExpression",{omit:["_evaluate"]});for(const a in qa)dh[qa[a]._classRegistryKey]||qe(qa[a],`Expression${a}`);function og(a){return a&&typeof ArrayBuffer!="undefined"&&(a instanceof ArrayBuffer||a.constructor&&a.constructor.name==="ArrayBuffer")}function Wu(a){return y.ImageBitmap&&a instanceof y.ImageBitmap}function Zu(a,r){if(a==null||typeof a=="boolean"||typeof a=="number"||typeof a=="string"||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp)return a;if(og(a)||Wu(a))return r&&r.push(a),a;if(ArrayBuffer.isView(a)){const s=a;return r&&r.push(s.buffer),s}if(a instanceof y.ImageData)return r&&r.push(a.data.buffer),a;if(Array.isArray(a)){const s=[];for(const u of a)s.push(Zu(u,r));return s}if(typeof a=="object"){const s=a.constructor,u=s._classRegistryKey;if(!u)throw new Error(`can't serialize object of unregistered class ${u}`);const p=s.serialize?s.serialize(a,r):{};if(!s.serialize){for(const g in a)a.hasOwnProperty(g)&&(dh[u].omit.indexOf(g)>=0||(p[g]=Zu(a[g],r)));a instanceof Error&&(p.message=a.message)}if(p.$name)throw new Error("$name property is reserved for worker serialization logic.");return u!=="Object"&&(p.$name=u),p}throw new Error("can't serialize object of type "+typeof a)}function Xu(a){if(a==null||typeof a=="boolean"||typeof a=="number"||typeof a=="string"||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||og(a)||Wu(a)||ArrayBuffer.isView(a)||a instanceof y.ImageData)return a;if(Array.isArray(a))return a.map(Xu);if(typeof a=="object"){const r=a.$name||"Object",{klass:s}=dh[r];if(!s)throw new Error(`can't deserialize unregistered class ${r}`);if(s.deserialize)return s.deserialize(a);const u=Object.create(s.prototype);for(const p of Object.keys(a))p!=="$name"&&(u[p]=Xu(a[p]));return u}throw new Error("can't deserialize object of type "+typeof a)}const Yu=a=>a>=1536&&a<=1791,ag=a=>a>=1872&&a<=1919,Of=a=>a>=2208&&a<=2303,sg=a=>a>=11904&&a<=12031,Df=a=>a>=12032&&a<=12255,Rf=a=>a>=12272&&a<=12287,Ku=a=>a>=12288&&a<=12351,hh=a=>a>=12352&&a<=12447,Bc=a=>a>=12448&&a<=12543,fh=a=>a>=12544&&a<=12591,lg=a=>a>=12704&&a<=12735,cg=a=>a>=12736&&a<=12783,Bf=a=>a>=12784&&a<=12799,ug=a=>a>=12800&&a<=13055,dg=a=>a>=13056&&a<=13311,hg=a=>a>=13312&&a<=19903,Ff=a=>a>=19968&&a<=40959,fg=a=>a>=40960&&a<=42127,pg=a=>a>=42128&&a<=42191,mg=a=>a>=44032&&a<=55215,gg=a=>a>=63744&&a<=64255,ph=a=>a>=64336&&a<=65023,Ju=a=>a>=65040&&a<=65055,m=a=>a>=65072&&a<=65103,c=a=>a>=65104&&a<=65135,h=a=>a>=65136&&a<=65279,_=a=>a>=65280&&a<=65519;function v(a){for(const r of a)if(I(r.charCodeAt(0)))return!0;return!1}function w(a){for(const r of a)if(!S(r.charCodeAt(0)))return!1;return!0}function S(a){return!(Yu(a)||ag(a)||Of(a)||ph(a)||h(a))}function I(a){return!(a!==746&&a!==747&&(a<4352||!(lg(a)||fh(a)||m(a)&&!(a>=65097&&a<=65103)||gg(a)||dg(a)||sg(a)||cg(a)||!(!Ku(a)||a>=12296&&a<=12305||a>=12308&&a<=12319||a===12336)||hg(a)||Ff(a)||ug(a)||(r=>r>=12592&&r<=12687)(a)||(r=>r>=43360&&r<=43391)(a)||(r=>r>=55216&&r<=55295)(a)||(r=>r>=4352&&r<=4607)(a)||mg(a)||hh(a)||Rf(a)||(r=>r>=12688&&r<=12703)(a)||Df(a)||Bf(a)||Bc(a)&&a!==12540||!(!_(a)||a===65288||a===65289||a===65293||a>=65306&&a<=65310||a===65339||a===65341||a===65343||a>=65371&&a<=65503||a===65507||a>=65512&&a<=65519)||!(!c(a)||a>=65112&&a<=65118||a>=65123&&a<=65126)||(r=>r>=5120&&r<=5759)(a)||(r=>r>=6320&&r<=6399)(a)||Ju(a)||(r=>r>=19904&&r<=19967)(a)||fg(a)||pg(a))))}function z(a){return!(I(a)||function(r){return!!((s=>s>=128&&s<=255)(r)&&(r===167||r===169||r===174||r===177||r===188||r===189||r===190||r===215||r===247)||(s=>s>=8192&&s<=8303)(r)&&(r===8214||r===8224||r===8225||r===8240||r===8241||r===8251||r===8252||r===8258||r===8263||r===8264||r===8265||r===8273)||(s=>s>=8448&&s<=8527)(r)||(s=>s>=8528&&s<=8591)(r)||(s=>s>=8960&&s<=9215)(r)&&(r>=8960&&r<=8967||r>=8972&&r<=8991||r>=8996&&r<=9e3||r===9003||r>=9085&&r<=9114||r>=9150&&r<=9165||r===9167||r>=9169&&r<=9179||r>=9186&&r<=9215)||(s=>s>=9216&&s<=9279)(r)&&r!==9251||(s=>s>=9280&&s<=9311)(r)||(s=>s>=9312&&s<=9471)(r)||(s=>s>=9632&&s<=9727)(r)||(s=>s>=9728&&s<=9983)(r)&&!(r>=9754&&r<=9759)||(s=>s>=11008&&s<=11263)(r)&&(r>=11026&&r<=11055||r>=11088&&r<=11097||r>=11192&&r<=11243)||Ku(r)||Bc(r)||(s=>s>=57344&&s<=63743)(r)||m(r)||c(r)||_(r)||r===8734||r===8756||r===8757||r>=9984&&r<=10087||r>=10102&&r<=10131||r===65532||r===65533)}(a))}function F(a){return a>=1424&&a<=2303||ph(a)||h(a)}function N(a,r){return!(!r&&F(a)||a>=2304&&a<=3583||a>=3840&&a<=4255||(s=>s>=6016&&s<=6143)(a))}function q(a){for(const r of a)if(F(r.charCodeAt(0)))return!0;return!1}const Q="deferred",it="loading",rt="loaded";let ot=null,at="unavailable",K=null;const ht=function(a){a&&typeof a=="string"&&a.indexOf("NetworkError")>-1&&(at="error"),ot&&ot(a)};function ut(){mt.fire(new Fn("pluginStateChange",{pluginStatus:at,pluginURL:K}))}const mt=new Ki,Tt=function(){return at},wt=function(){if(at!==Q||!K)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");at=it,ut(),K&&Zi({url:K},a=>{a?ht(a):(at=rt,ut())})},Mt={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>at===rt||Mt.applyArabicShaping!=null,isLoading:()=>at===it,setState(a){at=a.pluginStatus,K=a.pluginURL},isParsed:()=>Mt.applyArabicShaping!=null&&Mt.processBidirectionalText!=null&&Mt.processStyledBidirectionalText!=null,getPluginURL:()=>K};class Ft{constructor(r,s){this.zoom=r,s?(this.now=s.now,this.fadeDuration=s.fadeDuration,this.transition=s.transition,this.pitch=s.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(r){return function(s,u){for(const p of s)if(!N(p.charCodeAt(0),u))return!1;return!0}(r,Mt.isLoaded())}}class Vt{constructor(r,s){this.property=r,this.value=s,this.expression=function(u,p){if(la(u))return new Uu(u,p);if(Pc(u)){const g=$l(u,p);if(g.result==="error")throw new Error(g.value.map(b=>`${b.key}: ${b.message}`).join(", "));return g.value}{let g=u;return typeof u=="string"&&p.type==="color"&&(g=kn.parse(u)),{kind:"constant",evaluate:()=>g}}}(s===void 0?r.specification.default:s,r.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(r,s,u){return this.property.possiblyEvaluate(this,r,s,u)}}class Ht{constructor(r){this.property=r,this.value=new Vt(r,void 0)}transitioned(r,s){return new Nt(this.property,this.value,s,Jn({},r.transition,this.transition),r.now)}untransitioned(){return new Nt(this.property,this.value,null,{},0)}}class ke{constructor(r){this._properties=r,this._values=Object.create(r.defaultTransitionablePropertyValues)}getValue(r){return Bn(this._values[r].value.value)}setValue(r,s){this._values.hasOwnProperty(r)||(this._values[r]=new Ht(this._values[r].property)),this._values[r].value=new Vt(this._values[r].property,s===null?void 0:Bn(s))}getTransition(r){return Bn(this._values[r].transition)}setTransition(r,s){this._values.hasOwnProperty(r)||(this._values[r]=new Ht(this._values[r].property)),this._values[r].transition=Bn(s)||void 0}serialize(){const r={};for(const s of Object.keys(this._values)){const u=this.getValue(s);u!==void 0&&(r[s]=u);const p=this.getTransition(s);p!==void 0&&(r[`${s}-transition`]=p)}return r}transitioned(r,s){const u=new ne(this._properties);for(const p of Object.keys(this._values))u._values[p]=this._values[p].transitioned(r,s._values[p]);return u}untransitioned(){const r=new ne(this._properties);for(const s of Object.keys(this._values))r._values[s]=this._values[s].untransitioned();return r}}class Nt{constructor(r,s,u,p,g){const b=p.delay||0,x=p.duration||0;g=g||0,this.property=r,this.value=s,this.begin=g+b,this.end=this.begin+x,r.specification.transition&&(p.delay||p.duration)&&(this.prior=u)}possiblyEvaluate(r,s,u){const p=r.now||0,g=this.value.possiblyEvaluate(r,s,u),b=this.prior;if(b){if(p>this.end)return this.prior=null,g;if(this.value.isDataDriven())return this.prior=null,g;if(p<this.begin)return b.possiblyEvaluate(r,s,u);{const x=(p-this.begin)/(this.end-this.begin);return this.property.interpolate(b.possiblyEvaluate(r,s,u),g,ce(x))}}return g}}class ne{constructor(r){this._properties=r,this._values=Object.create(r.defaultTransitioningPropertyValues)}possiblyEvaluate(r,s,u){const p=new Gt(this._properties);for(const g of Object.keys(this._values))p._values[g]=this._values[g].possiblyEvaluate(r,s,u);return p}hasTransition(){for(const r of Object.keys(this._values))if(this._values[r].prior)return!0;return!1}}class Xt{constructor(r){this._properties=r,this._values=Object.create(r.defaultPropertyValues)}getValue(r){return Bn(this._values[r].value)}setValue(r,s){this._values[r]=new Vt(this._values[r].property,s===null?void 0:Bn(s))}serialize(){const r={};for(const s of Object.keys(this._values)){const u=this.getValue(s);u!==void 0&&(r[s]=u)}return r}possiblyEvaluate(r,s,u){const p=new Gt(this._properties);for(const g of Object.keys(this._values))p._values[g]=this._values[g].possiblyEvaluate(r,s,u);return p}}class ue{constructor(r,s,u){this.property=r,this.value=s,this.parameters=u}isConstant(){return this.value.kind==="constant"}constantOr(r){return this.value.kind==="constant"?this.value.value:r}evaluate(r,s,u,p){return this.property.evaluate(this.value,this.parameters,r,s,u,p)}}class Gt{constructor(r){this._properties=r,this._values=Object.create(r.defaultPossiblyEvaluatedValues)}get(r){return this._values[r]}}class Ot{constructor(r){this.specification=r}possiblyEvaluate(r,s){return r.expression.evaluate(s)}interpolate(r,s,u){const p=$a[this.specification.type];return p?p(r,s,u):r}}class Wt{constructor(r,s){this.specification=r,this.overrides=s}possiblyEvaluate(r,s,u,p){return new ue(this,r.expression.kind==="constant"||r.expression.kind==="camera"?{kind:"constant",value:r.expression.evaluate(s,null,{},u,p)}:r.expression,s)}interpolate(r,s,u){if(r.value.kind!=="constant"||s.value.kind!=="constant")return r;if(r.value.value===void 0||s.value.value===void 0)return new ue(this,{kind:"constant",value:void 0},r.parameters);const p=$a[this.specification.type];return p?new ue(this,{kind:"constant",value:p(r.value.value,s.value.value,u)},r.parameters):r}evaluate(r,s,u,p,g,b){return r.kind==="constant"?r.value:r.evaluate(s,u,p,g,b)}}class ie{constructor(r){this.specification=r}possiblyEvaluate(r,s,u,p){return!!r.expression.evaluate(s,null,{},u,p)}interpolate(){return!1}}class pe{constructor(r){this.properties=r,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const s=new Ft(0,{});for(const u in r){const p=r[u];p.specification.overridable&&this.overridableProperties.push(u);const g=this.defaultPropertyValues[u]=new Vt(p,void 0),b=this.defaultTransitionablePropertyValues[u]=new Ht(p);this.defaultTransitioningPropertyValues[u]=b.untransitioned(),this.defaultPossiblyEvaluatedValues[u]=g.possiblyEvaluate(s)}}}function Je(a,r){return 256*(a=se(Math.floor(a),0,255))+se(Math.floor(r),0,255)}qe(Wt,"DataDrivenProperty"),qe(Ot,"DataConstantProperty"),qe(ie,"ColorRampProperty");const Pn={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class We{constructor(r,s){this._structArray=r,this._pos1=s*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class je{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(r,s){return r._trim(),s&&(r.isTransferred=!0,s.push(r.arrayBuffer)),{length:r.length,arrayBuffer:r.arrayBuffer}}static deserialize(r){const s=Object.create(this.prototype);return s.arrayBuffer=r.arrayBuffer,s.length=r.length,s.capacity=r.arrayBuffer.byteLength/s.bytesPerElement,s._refreshViews(),s}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(r){this.reserve(r),this.length=r}reserve(r){if(r>this.capacity){this.capacity=Math.max(r,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const s=this.uint8;this._refreshViews(),s&&this.uint8.set(s)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function nn(a,r=1){let s=0,u=0;return{members:a.map(p=>{const g=Pn[p.type].BYTES_PER_ELEMENT,b=s=Nn(s,Math.max(r,g)),x=p.components||1;return u=Math.max(u,g),s+=g*x,{name:p.name,type:p.type,components:x,offset:b}}),size:Nn(s,Math.max(u,r)),alignment:r}}function Nn(a,r){return Math.ceil(a/r)*r}class sn extends je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s){const u=this.length;return this.resize(u+1),this.emplace(u,r,s)}emplace(r,s,u){const p=2*r;return this.int16[p+0]=s,this.int16[p+1]=u,r}}sn.prototype.bytesPerElement=4,qe(sn,"StructArrayLayout2i4");class ar extends je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,u){const p=this.length;return this.resize(p+1),this.emplace(p,r,s,u)}emplace(r,s,u,p){const g=3*r;return this.int16[g+0]=s,this.int16[g+1]=u,this.int16[g+2]=p,r}}ar.prototype.bytesPerElement=6,qe(ar,"StructArrayLayout3i6");class yr extends je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,u,p){const g=this.length;return this.resize(g+1),this.emplace(g,r,s,u,p)}emplace(r,s,u,p,g){const b=4*r;return this.int16[b+0]=s,this.int16[b+1]=u,this.int16[b+2]=p,this.int16[b+3]=g,r}}yr.prototype.bytesPerElement=8,qe(yr,"StructArrayLayout4i8");class Mr extends je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,u,p,g,b,x){const T=this.length;return this.resize(T+1),this.emplace(T,r,s,u,p,g,b,x)}emplace(r,s,u,p,g,b,x,T){const k=6*r,L=12*r,O=3*r;return this.int16[k+0]=s,this.int16[k+1]=u,this.uint8[L+4]=p,this.uint8[L+5]=g,this.uint8[L+6]=b,this.uint8[L+7]=x,this.float32[O+2]=T,r}}Mr.prototype.bytesPerElement=12,qe(Mr,"StructArrayLayout2i4ub1f12");class wr extends je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,u,p){const g=this.length;return this.resize(g+1),this.emplace(g,r,s,u,p)}emplace(r,s,u,p,g){const b=4*r;return this.float32[b+0]=s,this.float32[b+1]=u,this.float32[b+2]=p,this.float32[b+3]=g,r}}wr.prototype.bytesPerElement=16,qe(wr,"StructArrayLayout4f16");class vi extends je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,u,p,g){const b=this.length;return this.resize(b+1),this.emplace(b,r,s,u,p,g)}emplace(r,s,u,p,g,b){const x=6*r,T=3*r;return this.uint16[x+0]=s,this.uint16[x+1]=u,this.uint16[x+2]=p,this.uint16[x+3]=g,this.float32[T+2]=b,r}}vi.prototype.bytesPerElement=12,qe(vi,"StructArrayLayout4ui1f12");class zo extends je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,s,u,p){const g=this.length;return this.resize(g+1),this.emplace(g,r,s,u,p)}emplace(r,s,u,p,g){const b=4*r;return this.uint16[b+0]=s,this.uint16[b+1]=u,this.uint16[b+2]=p,this.uint16[b+3]=g,r}}zo.prototype.bytesPerElement=8,qe(zo,"StructArrayLayout4ui8");class Ia extends je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,u,p,g,b){const x=this.length;return this.resize(x+1),this.emplace(x,r,s,u,p,g,b)}emplace(r,s,u,p,g,b,x){const T=6*r;return this.int16[T+0]=s,this.int16[T+1]=u,this.int16[T+2]=p,this.int16[T+3]=g,this.int16[T+4]=b,this.int16[T+5]=x,r}}Ia.prototype.bytesPerElement=12,qe(Ia,"StructArrayLayout6i12");class Ss extends je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,s,u,p,g,b,x,T,k,L,O,R){const U=this.length;return this.resize(U+1),this.emplace(U,r,s,u,p,g,b,x,T,k,L,O,R)}emplace(r,s,u,p,g,b,x,T,k,L,O,R,U){const $=12*r;return this.int16[$+0]=s,this.int16[$+1]=u,this.int16[$+2]=p,this.int16[$+3]=g,this.uint16[$+4]=b,this.uint16[$+5]=x,this.uint16[$+6]=T,this.uint16[$+7]=k,this.int16[$+8]=L,this.int16[$+9]=O,this.int16[$+10]=R,this.int16[$+11]=U,r}}Ss.prototype.bytesPerElement=24,qe(Ss,"StructArrayLayout4i4ui4i24");class Fr extends je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,u,p,g,b){const x=this.length;return this.resize(x+1),this.emplace(x,r,s,u,p,g,b)}emplace(r,s,u,p,g,b,x){const T=10*r,k=5*r;return this.int16[T+0]=s,this.int16[T+1]=u,this.int16[T+2]=p,this.float32[k+2]=g,this.float32[k+3]=b,this.float32[k+4]=x,r}}Fr.prototype.bytesPerElement=20,qe(Fr,"StructArrayLayout3i3f20");class Er extends je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(r){const s=this.length;return this.resize(s+1),this.emplace(s,r)}emplace(r,s){return this.uint32[1*r+0]=s,r}}Er.prototype.bytesPerElement=4,qe(Er,"StructArrayLayout1ul4");class ir extends je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,s,u,p,g,b,x,T,k,L,O,R,U){const $=this.length;return this.resize($+1),this.emplace($,r,s,u,p,g,b,x,T,k,L,O,R,U)}emplace(r,s,u,p,g,b,x,T,k,L,O,R,U,$){const X=20*r,nt=10*r;return this.int16[X+0]=s,this.int16[X+1]=u,this.int16[X+2]=p,this.int16[X+3]=g,this.int16[X+4]=b,this.float32[nt+3]=x,this.float32[nt+4]=T,this.float32[nt+5]=k,this.float32[nt+6]=L,this.int16[X+14]=O,this.uint32[nt+8]=R,this.uint16[X+18]=U,this.uint16[X+19]=$,r}}ir.prototype.bytesPerElement=40,qe(ir,"StructArrayLayout5i4f1i1ul2ui40");class si extends je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,u,p,g,b,x){const T=this.length;return this.resize(T+1),this.emplace(T,r,s,u,p,g,b,x)}emplace(r,s,u,p,g,b,x,T){const k=8*r;return this.int16[k+0]=s,this.int16[k+1]=u,this.int16[k+2]=p,this.int16[k+4]=g,this.int16[k+5]=b,this.int16[k+6]=x,this.int16[k+7]=T,r}}si.prototype.bytesPerElement=16,qe(si,"StructArrayLayout3i2i2i16");class ho extends je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,s,u,p,g){const b=this.length;return this.resize(b+1),this.emplace(b,r,s,u,p,g)}emplace(r,s,u,p,g,b){const x=4*r,T=8*r;return this.float32[x+0]=s,this.float32[x+1]=u,this.float32[x+2]=p,this.int16[T+6]=g,this.int16[T+7]=b,r}}ho.prototype.bytesPerElement=16,qe(ho,"StructArrayLayout2f1f2i16");class zr extends je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,u,p){const g=this.length;return this.resize(g+1),this.emplace(g,r,s,u,p)}emplace(r,s,u,p,g){const b=12*r,x=3*r;return this.uint8[b+0]=s,this.uint8[b+1]=u,this.float32[x+1]=p,this.float32[x+2]=g,r}}zr.prototype.bytesPerElement=12,qe(zr,"StructArrayLayout2ub2f12");class fo extends je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,u){const p=this.length;return this.resize(p+1),this.emplace(p,r,s,u)}emplace(r,s,u,p){const g=3*r;return this.float32[g+0]=s,this.float32[g+1]=u,this.float32[g+2]=p,r}}fo.prototype.bytesPerElement=12,qe(fo,"StructArrayLayout3f12");class po extends je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,s,u){const p=this.length;return this.resize(p+1),this.emplace(p,r,s,u)}emplace(r,s,u,p){const g=3*r;return this.uint16[g+0]=s,this.uint16[g+1]=u,this.uint16[g+2]=p,r}}po.prototype.bytesPerElement=6,qe(po,"StructArrayLayout3ui6");class Js extends je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(r,s,u,p,g,b,x,T,k,L,O,R,U,$,X,nt,dt,yt,lt,_t,Et){const xt=this.length;return this.resize(xt+1),this.emplace(xt,r,s,u,p,g,b,x,T,k,L,O,R,U,$,X,nt,dt,yt,lt,_t,Et)}emplace(r,s,u,p,g,b,x,T,k,L,O,R,U,$,X,nt,dt,yt,lt,_t,Et,xt){const qt=30*r,$t=15*r,Qt=60*r;return this.int16[qt+0]=s,this.int16[qt+1]=u,this.int16[qt+2]=p,this.float32[$t+2]=g,this.float32[$t+3]=b,this.uint16[qt+8]=x,this.uint16[qt+9]=T,this.uint32[$t+5]=k,this.uint32[$t+6]=L,this.uint32[$t+7]=O,this.uint16[qt+16]=R,this.uint16[qt+17]=U,this.uint16[qt+18]=$,this.float32[$t+10]=X,this.float32[$t+11]=nt,this.uint8[Qt+48]=dt,this.uint8[Qt+49]=yt,this.uint8[Qt+50]=lt,this.uint32[$t+13]=_t,this.int16[qt+28]=Et,this.uint8[Qt+58]=xt,r}}Js.prototype.bytesPerElement=60,qe(Js,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Fc extends je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(r,s,u,p,g,b,x,T,k,L,O,R,U,$,X,nt,dt,yt,lt,_t,Et,xt,qt,$t,Qt,_e,Zt,ee,re,de){const ye=this.length;return this.resize(ye+1),this.emplace(ye,r,s,u,p,g,b,x,T,k,L,O,R,U,$,X,nt,dt,yt,lt,_t,Et,xt,qt,$t,Qt,_e,Zt,ee,re,de)}emplace(r,s,u,p,g,b,x,T,k,L,O,R,U,$,X,nt,dt,yt,lt,_t,Et,xt,qt,$t,Qt,_e,Zt,ee,re,de,ye){const Yt=38*r,Pe=19*r;return this.int16[Yt+0]=s,this.int16[Yt+1]=u,this.int16[Yt+2]=p,this.float32[Pe+2]=g,this.float32[Pe+3]=b,this.int16[Yt+8]=x,this.int16[Yt+9]=T,this.int16[Yt+10]=k,this.int16[Yt+11]=L,this.int16[Yt+12]=O,this.int16[Yt+13]=R,this.uint16[Yt+14]=U,this.uint16[Yt+15]=$,this.uint16[Yt+16]=X,this.uint16[Yt+17]=nt,this.uint16[Yt+18]=dt,this.uint16[Yt+19]=yt,this.uint16[Yt+20]=lt,this.uint16[Yt+21]=_t,this.uint16[Yt+22]=Et,this.uint16[Yt+23]=xt,this.uint16[Yt+24]=qt,this.uint16[Yt+25]=$t,this.uint16[Yt+26]=Qt,this.uint16[Yt+27]=_e,this.uint16[Yt+28]=Zt,this.uint32[Pe+15]=ee,this.float32[Pe+16]=re,this.float32[Pe+17]=de,this.float32[Pe+18]=ye,r}}Fc.prototype.bytesPerElement=76,qe(Fc,"StructArrayLayout3i2f6i15ui1ul3f76");class Qo extends je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r){const s=this.length;return this.resize(s+1),this.emplace(s,r)}emplace(r,s){return this.float32[1*r+0]=s,r}}Qo.prototype.bytesPerElement=4,qe(Qo,"StructArrayLayout1f4");class ua extends je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s,u,p,g){const b=this.length;return this.resize(b+1),this.emplace(b,r,s,u,p,g)}emplace(r,s,u,p,g,b){const x=5*r;return this.float32[x+0]=s,this.float32[x+1]=u,this.float32[x+2]=p,this.float32[x+3]=g,this.float32[x+4]=b,r}}ua.prototype.bytesPerElement=20,qe(ua,"StructArrayLayout5f20");class Ms extends je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,s,u,p){const g=this.length;return this.resize(g+1),this.emplace(g,r,s,u,p)}emplace(r,s,u,p,g){const b=6*r;return this.uint32[3*r+0]=s,this.uint16[b+2]=u,this.uint16[b+3]=p,this.uint16[b+4]=g,r}}Ms.prototype.bytesPerElement=12,qe(Ms,"StructArrayLayout1ul3ui12");class Qs extends je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,s){const u=this.length;return this.resize(u+1),this.emplace(u,r,s)}emplace(r,s,u){const p=2*r;return this.uint16[p+0]=s,this.uint16[p+1]=u,r}}Qs.prototype.bytesPerElement=4,qe(Qs,"StructArrayLayout2ui4");class tl extends je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r){const s=this.length;return this.resize(s+1),this.emplace(s,r)}emplace(r,s){return this.uint16[1*r+0]=s,r}}tl.prototype.bytesPerElement=2,qe(tl,"StructArrayLayout1ui2");class Nc extends je{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,s){const u=this.length;return this.resize(u+1),this.emplace(u,r,s)}emplace(r,s,u){const p=2*r;return this.float32[p+0]=s,this.float32[p+1]=u,r}}Nc.prototype.bytesPerElement=8,qe(Nc,"StructArrayLayout2f8");class Jx extends We{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Jx.prototype.size=40;class Cy extends ir{get(r){return new Jx(this,r)}}qe(Cy,"CollisionBoxArray");class Qx extends We{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(r){this._structArray.uint8[this._pos1+49]=r}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(r){this._structArray.uint8[this._pos1+50]=r}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(r){this._structArray.uint32[this._pos4+13]=r}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(r){this._structArray.uint8[this._pos1+58]=r}}Qx.prototype.size=60;class tw extends Js{get(r){return new Qx(this,r)}}qe(tw,"PlacedSymbolArray");class ew extends We{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(r){this._structArray.uint32[this._pos4+15]=r}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}ew.prototype.size=76;class nw extends Fc{get(r){return new ew(this,r)}}qe(nw,"SymbolInstanceArray");class rw extends Qo{getoffsetX(r){return this.float32[1*r+0]}}qe(rw,"GlyphOffsetArray");class iw extends sn{getx(r){return this.int16[2*r+0]}gety(r){return this.int16[2*r+1]}}qe(iw,"SymbolLineVertexArray");class ow extends We{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}ow.prototype.size=12;class aw extends Ms{get(r){return new ow(this,r)}}qe(aw,"FeatureIndexArray");class sw extends Qs{geta_centroid_pos0(r){return this.uint16[2*r+0]}geta_centroid_pos1(r){return this.uint16[2*r+1]}}qe(sw,"FillExtrusionCentroidArray");const zA=nn([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),OA=nn([{name:"a_dash",components:4,type:"Uint16"}]);var Qu={},DA={get exports(){return Qu},set exports(a){Qu=a}},Sy={};({get exports(){return Sy},set exports(a){Sy=a}}).exports=function(a,r){var s,u,p,g,b,x,T,k;for(u=a.length-(s=3&a.length),p=r,b=3432918353,x=461845907,k=0;k<u;)T=255&a.charCodeAt(k)|(255&a.charCodeAt(++k))<<8|(255&a.charCodeAt(++k))<<16|(255&a.charCodeAt(++k))<<24,++k,p=27492+(65535&(g=5*(65535&(p=(p^=T=(65535&(T=(T=(65535&T)*b+(((T>>>16)*b&65535)<<16)&4294967295)<<15|T>>>17))*x+(((T>>>16)*x&65535)<<16)&4294967295)<<13|p>>>19))+((5*(p>>>16)&65535)<<16)&4294967295))+((58964+(g>>>16)&65535)<<16);switch(T=0,s){case 3:T^=(255&a.charCodeAt(k+2))<<16;case 2:T^=(255&a.charCodeAt(k+1))<<8;case 1:p^=T=(65535&(T=(T=(65535&(T^=255&a.charCodeAt(k)))*b+(((T>>>16)*b&65535)<<16)&4294967295)<<15|T>>>17))*x+(((T>>>16)*x&65535)<<16)&4294967295}return p^=a.length,p=2246822507*(65535&(p^=p>>>16))+((2246822507*(p>>>16)&65535)<<16)&4294967295,p=3266489909*(65535&(p^=p>>>13))+((3266489909*(p>>>16)&65535)<<16)&4294967295,(p^=p>>>16)>>>0};var My={};({get exports(){return My},set exports(a){My=a}}).exports=function(a,r){for(var s,u=a.length,p=r^u,g=0;u>=4;)s=1540483477*(65535&(s=255&a.charCodeAt(g)|(255&a.charCodeAt(++g))<<8|(255&a.charCodeAt(++g))<<16|(255&a.charCodeAt(++g))<<24))+((1540483477*(s>>>16)&65535)<<16),p=1540483477*(65535&p)+((1540483477*(p>>>16)&65535)<<16)^(s=1540483477*(65535&(s^=s>>>24))+((1540483477*(s>>>16)&65535)<<16)),u-=4,++g;switch(u){case 3:p^=(255&a.charCodeAt(g+2))<<16;case 2:p^=(255&a.charCodeAt(g+1))<<8;case 1:p=1540483477*(65535&(p^=255&a.charCodeAt(g)))+((1540483477*(p>>>16)&65535)<<16)}return p=1540483477*(65535&(p^=p>>>13))+((1540483477*(p>>>16)&65535)<<16),(p^=p>>>15)>>>0};var lw=Sy,RA=My;DA.exports=lw,Qu.murmur3=lw,Qu.murmur2=RA;class _g{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(r,s,u,p){this.ids.push(cw(r)),this.positions.push(s,u,p)}getPositions(r){const s=cw(r);let u=0,p=this.ids.length-1;for(;u<p;){const b=u+p>>1;this.ids[b]>=s?p=b:u=b+1}const g=[];for(;this.ids[u]===s;)g.push({index:this.positions[3*u],start:this.positions[3*u+1],end:this.positions[3*u+2]}),u++;return g}static serialize(r,s){const u=new Float64Array(r.ids),p=new Uint32Array(r.positions);return Ay(u,p,0,u.length-1),s&&s.push(u.buffer,p.buffer),{ids:u,positions:p}}static deserialize(r){const s=new _g;return s.ids=r.ids,s.positions=r.positions,s.indexed=!0,s}}function cw(a){const r=+a;return!isNaN(r)&&Number.MIN_SAFE_INTEGER<=r&&r<=Number.MAX_SAFE_INTEGER?r:Qu(String(a))}function Ay(a,r,s,u){for(;s<u;){const p=a[s+u>>1];let g=s-1,b=u+1;for(;;){do g++;while(a[g]<p);do b--;while(a[b]>p);if(g>=b)break;yg(a,g,b),yg(r,3*g,3*b),yg(r,3*g+1,3*b+1),yg(r,3*g+2,3*b+2)}b-s<u-b?(Ay(a,r,s,b),s=b+1):(Ay(a,r,b+1,u),u=b)}}function yg(a,r,s){const u=a[r];a[r]=a[s],a[s]=u}qe(_g,"FeaturePositionMap");class Vl{constructor(r){this.gl=r.gl,this.initialized=!1}fetchUniformLocation(r,s){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(r,s),this.initialized=!0),!!this.location}}class bg extends Vl{constructor(r){super(r),this.current=0}set(r,s,u){this.fetchUniformLocation(r,s)&&this.current!==u&&(this.current=u,this.gl.uniform1f(this.location,u))}}class uw extends Vl{constructor(r){super(r),this.current=[0,0,0,0]}set(r,s,u){this.fetchUniformLocation(r,s)&&(u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]&&u[3]===this.current[3]||(this.current=u,this.gl.uniform4f(this.location,u[0],u[1],u[2],u[3])))}}class dw extends Vl{constructor(r){super(r),this.current=kn.transparent}set(r,s,u){this.fetchUniformLocation(r,s)&&(u.r===this.current.r&&u.g===this.current.g&&u.b===this.current.b&&u.a===this.current.a||(this.current=u,this.gl.uniform4f(this.location,u.r,u.g,u.b,u.a)))}}const BA=new Float32Array(16),FA=new Float32Array(9),NA=new Float32Array(4);function Iy(a){return[Je(255*a.r,255*a.g),Je(255*a.b,255*a.a)]}class Nf{constructor(r,s,u){this.value=r,this.uniformNames=s.map(p=>`u_${p}`),this.type=u}setUniform(r,s,u,p,g){s.set(r,g,p.constantOr(this.value))}getBinding(r,s){return this.type==="color"?new dw(r):new bg(r)}}class mh{constructor(r,s){this.uniformNames=s.map(u=>`u_${u}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(r){this.pixelRatio=r.pixelRatio||1,this.pattern=r.tl.concat(r.br)}setUniform(r,s,u,p,g){const b=g==="u_pattern"||g==="u_dash"?this.pattern:g==="u_pixel_ratio"?this.pixelRatio:null;b&&s.set(r,g,b)}getBinding(r,s){return s==="u_pattern"||s==="u_dash"?new uw(r):new bg(r)}}class Gl{constructor(r,s,u,p){this.expression=r,this.type=u,this.maxValue=0,this.paintVertexAttributes=s.map(g=>({name:`a_${g}`,type:"Float32",components:u==="color"?2:1,offset:0})),this.paintVertexArray=new p}populatePaintArray(r,s,u,p,g,b){const x=this.paintVertexArray.length,T=this.expression.evaluate(new Ft(0),s,{},g,p,b);this.paintVertexArray.resize(r),this._setPaintValue(x,r,T)}updatePaintArray(r,s,u,p,g){const b=this.expression.evaluate({zoom:0},u,p,void 0,g);this._setPaintValue(r,s,b)}_setPaintValue(r,s,u){if(this.type==="color"){const p=Iy(u);for(let g=r;g<s;g++)this.paintVertexArray.emplace(g,p[0],p[1])}else{for(let p=r;p<s;p++)this.paintVertexArray.emplace(p,u);this.maxValue=Math.max(this.maxValue,Math.abs(u))}}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class As{constructor(r,s,u,p,g,b){this.expression=r,this.uniformNames=s.map(x=>`u_${x}_t`),this.type=u,this.useIntegerZoom=p,this.zoom=g,this.maxValue=0,this.paintVertexAttributes=s.map(x=>({name:`a_${x}`,type:"Float32",components:u==="color"?4:2,offset:0})),this.paintVertexArray=new b}populatePaintArray(r,s,u,p,g,b){const x=this.expression.evaluate(new Ft(this.zoom),s,{},g,p,b),T=this.expression.evaluate(new Ft(this.zoom+1),s,{},g,p,b),k=this.paintVertexArray.length;this.paintVertexArray.resize(r),this._setPaintValue(k,r,x,T)}updatePaintArray(r,s,u,p,g){const b=this.expression.evaluate({zoom:this.zoom},u,p,void 0,g),x=this.expression.evaluate({zoom:this.zoom+1},u,p,void 0,g);this._setPaintValue(r,s,b,x)}_setPaintValue(r,s,u,p){if(this.type==="color"){const g=Iy(u),b=Iy(p);for(let x=r;x<s;x++)this.paintVertexArray.emplace(x,g[0],g[1],b[0],b[1])}else{for(let g=r;g<s;g++)this.paintVertexArray.emplace(g,u,p);this.maxValue=Math.max(this.maxValue,Math.abs(u),Math.abs(p))}}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(r,s,u,p,g){const b=this.useIntegerZoom?Math.floor(u.zoom):u.zoom,x=se(this.expression.interpolationFactor(b,this.zoom,this.zoom+1),0,1);s.set(r,g,x)}getBinding(r,s){return new bg(r)}}class jc{constructor(r,s,u,p,g){this.expression=r,this.layerId=g,this.paintVertexAttributes=(u==="array"?OA:zA).members;for(let b=0;b<s.length;++b);this.paintVertexArray=new p}populatePaintArray(r,s,u){const p=this.paintVertexArray.length;this.paintVertexArray.resize(r),this._setPaintValues(p,r,s.patterns&&s.patterns[this.layerId],u)}updatePaintArray(r,s,u,p,g,b){this._setPaintValues(r,s,u.patterns&&u.patterns[this.layerId],b)}_setPaintValues(r,s,u,p){if(!p||!u)return;const g=p[u];if(!g)return;const{tl:b,br:x,pixelRatio:T}=g;for(let k=r;k<s;k++)this.paintVertexArray.emplace(k,b[0],b[1],x[0],x[1],T)}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Uc{constructor(r,s,u=()=>!0){this.binders={},this._buffers=[];const p=[];for(const g in r.paint._values){if(!u(g))continue;const b=r.paint.get(g);if(!(b instanceof ue&&To(b.property.specification)))continue;const x=UA(g,r.type),T=b.value,k=b.property.specification.type,L=b.property.useIntegerZoom,O=g==="line-dasharray"||g.endsWith("pattern"),R=g==="line-dasharray"&&r.layout.get("line-cap").value.kind!=="constant";if(T.kind!=="constant"||R)if(T.kind==="source"||R||O){const U=hw(g,k,"source");this.binders[g]=O?new jc(T,x,k,U,r.id):new Gl(T,x,k,U),p.push(`/a_${g}`)}else{const U=hw(g,k,"composite");this.binders[g]=new As(T,x,k,L,s,U),p.push(`/z_${g}`)}else this.binders[g]=O?new mh(T.value,x):new Nf(T.value,x,k),p.push(`/u_${g}`)}this.cacheKey=p.sort().join("")}getMaxValue(r){const s=this.binders[r];return s instanceof Gl||s instanceof As?s.maxValue:0}populatePaintArrays(r,s,u,p,g,b){for(const x in this.binders){const T=this.binders[x];(T instanceof Gl||T instanceof As||T instanceof jc)&&T.populatePaintArray(r,s,u,p,g,b)}}setConstantPatternPositions(r){for(const s in this.binders){const u=this.binders[s];u instanceof mh&&u.setConstantPatternPositions(r)}}updatePaintArrays(r,s,u,p,g,b){let x=!1;for(const T in r){const k=s.getPositions(T);for(const L of k){const O=u.feature(L.index);for(const R in this.binders){const U=this.binders[R];if((U instanceof Gl||U instanceof As||U instanceof jc)&&U.expression.isStateDependent===!0){const $=p.paint.get(R);U.expression=$.value,U.updatePaintArray(L.start,L.end,O,r[T],g,b),x=!0}}}}return x}defines(){const r=[];for(const s in this.binders){const u=this.binders[s];(u instanceof Nf||u instanceof mh)&&r.push(...u.uniformNames.map(p=>`#define HAS_UNIFORM_${p}`))}return r}getBinderAttributes(){const r=[];for(const s in this.binders){const u=this.binders[s];if(u instanceof Gl||u instanceof As||u instanceof jc)for(let p=0;p<u.paintVertexAttributes.length;p++)r.push(u.paintVertexAttributes[p].name)}return r}getBinderUniforms(){const r=[];for(const s in this.binders){const u=this.binders[s];if(u instanceof Nf||u instanceof mh||u instanceof As)for(const p of u.uniformNames)r.push(p)}return r}getPaintVertexBuffers(){return this._buffers}getUniforms(r){const s=[];for(const u in this.binders){const p=this.binders[u];if(p instanceof Nf||p instanceof mh||p instanceof As)for(const g of p.uniformNames)s.push({name:g,property:u,binding:p.getBinding(r,g)})}return s}setUniforms(r,s,u,p,g){for(const{name:b,property:x,binding:T}of u)this.binders[x].setUniform(r,T,g,p.get(x),b)}updatePaintBuffers(){this._buffers=[];for(const r in this.binders){const s=this.binders[r];(s instanceof Gl||s instanceof As||s instanceof jc)&&s.paintVertexBuffer&&this._buffers.push(s.paintVertexBuffer)}}upload(r){for(const s in this.binders){const u=this.binders[s];(u instanceof Gl||u instanceof As||u instanceof jc)&&u.upload(r)}this.updatePaintBuffers()}destroy(){for(const r in this.binders){const s=this.binders[r];(s instanceof Gl||s instanceof As||s instanceof jc)&&s.destroy()}}}class td{constructor(r,s,u=()=>!0){this.programConfigurations={};for(const p of r)this.programConfigurations[p.id]=new Uc(p,s,u);this.needsUpload=!1,this._featureMap=new _g,this._bufferOffset=0}populatePaintArrays(r,s,u,p,g,b,x){for(const T in this.programConfigurations)this.programConfigurations[T].populatePaintArrays(r,s,p,g,b,x);s.id!==void 0&&this._featureMap.add(s.id,u,this._bufferOffset,r),this._bufferOffset=r,this.needsUpload=!0}updatePaintArrays(r,s,u,p,g){for(const b of u)this.needsUpload=this.programConfigurations[b.id].updatePaintArrays(r,this._featureMap,s,b,p,g)||this.needsUpload}get(r){return this.programConfigurations[r]}upload(r){if(this.needsUpload){for(const s in this.programConfigurations)this.programConfigurations[s].upload(r);this.needsUpload=!1}}destroy(){for(const r in this.programConfigurations)this.programConfigurations[r].destroy()}}const jA={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function UA(a,r){return jA[a]||[a.replace(`${r}-`,"").replace(/-/g,"_")]}const $A={"line-pattern":{source:vi,composite:vi},"fill-pattern":{source:vi,composite:vi},"fill-extrusion-pattern":{source:vi,composite:vi},"line-dasharray":{source:zo,composite:zo}},VA={color:{source:Nc,composite:wr},number:{source:Qo,composite:Nc}};function hw(a,r,s){const u=$A[a];return u&&u[s]||VA[r][s]}qe(Nf,"ConstantBinder"),qe(mh,"PatternConstantBinder"),qe(Gl,"SourceExpressionBinder"),qe(jc,"PatternCompositeBinder"),qe(As,"CompositeExpressionBinder"),qe(Uc,"ProgramConfiguration",{omit:["_buffers"]}),qe(td,"ProgramConfigurationSet");const vg="-transition";class Is extends Ki{constructor(r,s){if(super(),this.id=r.id,this.type=r.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,r.type!=="custom"&&(this.metadata=r.metadata,this.minzoom=r.minzoom,this.maxzoom=r.maxzoom,r.type!=="background"&&r.type!=="sky"&&(this.source=r.source,this.sourceLayer=r["source-layer"],this.filter=r.filter),s.layout&&(this._unevaluatedLayout=new Xt(s.layout)),s.paint)){this._transitionablePaint=new ke(s.paint);for(const u in r.paint)this.setPaintProperty(u,r.paint[u],{validate:!1});for(const u in r.layout)this.setLayoutProperty(u,r.layout[u],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Gt(s.paint)}}getLayoutProperty(r){return r==="visibility"?this.visibility:this._unevaluatedLayout.getValue(r)}setLayoutProperty(r,s,u={}){s!=null&&this._validate(rg,`layers.${this.id}.layout.${r}`,r,s,u)||(r!=="visibility"?this._unevaluatedLayout.setValue(r,s):this.visibility=s)}getPaintProperty(r){return Ce(r,vg)?this._transitionablePaint.getTransition(r.slice(0,-vg.length)):this._transitionablePaint.getValue(r)}setPaintProperty(r,s,u={}){if(s!=null&&this._validate(ky,`layers.${this.id}.paint.${r}`,r,s,u))return!1;if(Ce(r,vg))return this._transitionablePaint.setTransition(r.slice(0,-vg.length),s||void 0),!1;{const p=this._transitionablePaint._values[r],g=p.value.isDataDriven(),b=p.value;this._transitionablePaint.setValue(r,s),this._handleSpecialPaintPropertyUpdate(r);const x=this._transitionablePaint._values[r].value,T=x.isDataDriven(),k=Ce(r,"pattern")||r==="line-dasharray";return T||g||k||this._handleOverridablePaintPropertyUpdate(r,b,x)}}_handleSpecialPaintPropertyUpdate(r){}getProgramIds(){return null}getProgramConfiguration(r){return null}_handleOverridablePaintPropertyUpdate(r,s,u){return!1}isHidden(r){return!!(this.minzoom&&r<this.minzoom)||!!(this.maxzoom&&r>=this.maxzoom)||this.visibility==="none"}updateTransitions(r){this._transitioningPaint=this._transitionablePaint.transitioned(r,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(r,s){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(r,void 0,s)),this.paint=this._transitioningPaint.possiblyEvaluate(r,void 0,s)}serialize(){const r={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(r.layout=r.layout||{},r.layout.visibility=this.visibility),Qn(r,(s,u)=>!(s===void 0||u==="layout"&&!Object.keys(s).length||u==="paint"&&!Object.keys(s).length))}_validate(r,s,u,p,g={}){return(!g||g.validate!==!1)&&ig(this,r.call(ng,{key:s,layerType:this.type,objectKey:u,value:p,styleSpec:Kt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const r in this.paint._values){const s=this.paint.get(r);if(s instanceof ue&&To(s.property.specification)&&(s.value.kind==="source"||s.value.kind==="composite")&&s.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=ih(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const GA=nn([{name:"a_pos",components:2,type:"Int16"}],4),qA=nn([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class xi{constructor(r=[]){this.segments=r}prepareSegment(r,s,u,p){let g=this.segments[this.segments.length-1];return r>xi.MAX_VERTEX_ARRAY_LENGTH&&Qe(`Max vertices per segment is ${xi.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${r}`),(!g||g.vertexLength+r>xi.MAX_VERTEX_ARRAY_LENGTH||g.sortKey!==p)&&(g={vertexOffset:s.length,primitiveOffset:u.length,vertexLength:0,primitiveLength:0},p!==void 0&&(g.sortKey=p),this.segments.push(g)),g}get(){return this.segments}destroy(){for(const r of this.segments)for(const s in r.vaos)r.vaos[s].destroy()}static simpleSegment(r,s,u,p){return new xi([{vertexOffset:r,primitiveOffset:s,vertexLength:u,primitiveLength:p,vaos:{},sortKey:0}])}}xi.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,qe(xi,"SegmentVector");var bn=8192;class $c{constructor(r,s){r&&(s?this.setSouthWest(r).setNorthEast(s):r.length===4?this.setSouthWest([r[0],r[1]]).setNorthEast([r[2],r[3]]):this.setSouthWest(r[0]).setNorthEast(r[1]))}setNorthEast(r){return this._ne=r instanceof rr?new rr(r.lng,r.lat):rr.convert(r),this}setSouthWest(r){return this._sw=r instanceof rr?new rr(r.lng,r.lat):rr.convert(r),this}extend(r){const s=this._sw,u=this._ne;let p,g;if(r instanceof rr)p=r,g=r;else{if(!(r instanceof $c))return Array.isArray(r)?r.length===4||r.every(Array.isArray)?this.extend($c.convert(r)):this.extend(rr.convert(r)):typeof r=="object"&&r!==null&&r.hasOwnProperty("lat")&&r.hasOwnProperty("lon")?this.extend(rr.convert(r)):this;if(p=r._sw,g=r._ne,!p||!g)return this}return s||u?(s.lng=Math.min(p.lng,s.lng),s.lat=Math.min(p.lat,s.lat),u.lng=Math.max(g.lng,u.lng),u.lat=Math.max(g.lat,u.lat)):(this._sw=new rr(p.lng,p.lat),this._ne=new rr(g.lng,g.lat)),this}getCenter(){return new rr((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new rr(this.getWest(),this.getNorth())}getSouthEast(){return new rr(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(r){const{lng:s,lat:u}=rr.convert(r);let p=this._sw.lng<=s&&s<=this._ne.lng;return this._sw.lng>this._ne.lng&&(p=this._sw.lng>=s&&s>=this._ne.lng),this._sw.lat<=u&&u<=this._ne.lat&&p}static convert(r){return!r||r instanceof $c?r:new $c(r)}}var xg=1e-6,da=typeof Float32Array!="undefined"?Float32Array:Array;function fw(){var a=new da(9);return da!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[5]=0,a[6]=0,a[7]=0),a[0]=1,a[4]=1,a[8]=1,a}function pw(a,r,s){var u=r[0],p=r[1],g=r[2],b=r[3],x=r[4],T=r[5],k=r[6],L=r[7],O=r[8],R=s[0],U=s[1],$=s[2],X=s[3],nt=s[4],dt=s[5],yt=s[6],lt=s[7],_t=s[8];return a[0]=R*u+U*b+$*k,a[1]=R*p+U*x+$*L,a[2]=R*g+U*T+$*O,a[3]=X*u+nt*b+dt*k,a[4]=X*p+nt*x+dt*L,a[5]=X*g+nt*T+dt*O,a[6]=yt*u+lt*b+_t*k,a[7]=yt*p+lt*x+_t*L,a[8]=yt*g+lt*T+_t*O,a}function Ps(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function Py(a,r){var s=r[0],u=r[1],p=r[2],g=r[3],b=r[4],x=r[5],T=r[6],k=r[7],L=r[8],O=r[9],R=r[10],U=r[11],$=r[12],X=r[13],nt=r[14],dt=r[15],yt=s*x-u*b,lt=s*T-p*b,_t=s*k-g*b,Et=u*T-p*x,xt=u*k-g*x,qt=p*k-g*T,$t=L*X-O*$,Qt=L*nt-R*$,_e=L*dt-U*$,Zt=O*nt-R*X,ee=O*dt-U*X,re=R*dt-U*nt,de=yt*re-lt*ee+_t*Zt+Et*_e-xt*Qt+qt*$t;return de?(a[0]=(x*re-T*ee+k*Zt)*(de=1/de),a[1]=(p*ee-u*re-g*Zt)*de,a[2]=(X*qt-nt*xt+dt*Et)*de,a[3]=(R*xt-O*qt-U*Et)*de,a[4]=(T*_e-b*re-k*Qt)*de,a[5]=(s*re-p*_e+g*Qt)*de,a[6]=(nt*_t-$*qt-dt*lt)*de,a[7]=(L*qt-R*_t+U*lt)*de,a[8]=(b*ee-x*_e+k*$t)*de,a[9]=(u*_e-s*ee-g*$t)*de,a[10]=($*xt-X*_t+dt*yt)*de,a[11]=(O*_t-L*xt-U*yt)*de,a[12]=(x*Qt-b*Zt-T*$t)*de,a[13]=(s*Zt-u*Qt+p*$t)*de,a[14]=(X*lt-$*Et-nt*yt)*de,a[15]=(L*Et-O*lt+R*yt)*de,a):null}function ed(a,r,s){var u=r[0],p=r[1],g=r[2],b=r[3],x=r[4],T=r[5],k=r[6],L=r[7],O=r[8],R=r[9],U=r[10],$=r[11],X=r[12],nt=r[13],dt=r[14],yt=r[15],lt=s[0],_t=s[1],Et=s[2],xt=s[3];return a[0]=lt*u+_t*x+Et*O+xt*X,a[1]=lt*p+_t*T+Et*R+xt*nt,a[2]=lt*g+_t*k+Et*U+xt*dt,a[3]=lt*b+_t*L+Et*$+xt*yt,a[4]=(lt=s[4])*u+(_t=s[5])*x+(Et=s[6])*O+(xt=s[7])*X,a[5]=lt*p+_t*T+Et*R+xt*nt,a[6]=lt*g+_t*k+Et*U+xt*dt,a[7]=lt*b+_t*L+Et*$+xt*yt,a[8]=(lt=s[8])*u+(_t=s[9])*x+(Et=s[10])*O+(xt=s[11])*X,a[9]=lt*p+_t*T+Et*R+xt*nt,a[10]=lt*g+_t*k+Et*U+xt*dt,a[11]=lt*b+_t*L+Et*$+xt*yt,a[12]=(lt=s[12])*u+(_t=s[13])*x+(Et=s[14])*O+(xt=s[15])*X,a[13]=lt*p+_t*T+Et*R+xt*nt,a[14]=lt*g+_t*k+Et*U+xt*dt,a[15]=lt*b+_t*L+Et*$+xt*yt,a}function jf(a,r,s){var u,p,g,b,x,T,k,L,O,R,U,$,X=s[0],nt=s[1],dt=s[2];return r===a?(a[12]=r[0]*X+r[4]*nt+r[8]*dt+r[12],a[13]=r[1]*X+r[5]*nt+r[9]*dt+r[13],a[14]=r[2]*X+r[6]*nt+r[10]*dt+r[14],a[15]=r[3]*X+r[7]*nt+r[11]*dt+r[15]):(p=r[1],g=r[2],b=r[3],x=r[4],T=r[5],k=r[6],L=r[7],O=r[8],R=r[9],U=r[10],$=r[11],a[0]=u=r[0],a[1]=p,a[2]=g,a[3]=b,a[4]=x,a[5]=T,a[6]=k,a[7]=L,a[8]=O,a[9]=R,a[10]=U,a[11]=$,a[12]=u*X+x*nt+O*dt+r[12],a[13]=p*X+T*nt+R*dt+r[13],a[14]=g*X+k*nt+U*dt+r[14],a[15]=b*X+L*nt+$*dt+r[15]),a}function nd(a,r,s){var u=s[0],p=s[1],g=s[2];return a[0]=r[0]*u,a[1]=r[1]*u,a[2]=r[2]*u,a[3]=r[3]*u,a[4]=r[4]*p,a[5]=r[5]*p,a[6]=r[6]*p,a[7]=r[7]*p,a[8]=r[8]*g,a[9]=r[9]*g,a[10]=r[10]*g,a[11]=r[11]*g,a[12]=r[12],a[13]=r[13],a[14]=r[14],a[15]=r[15],a}function Ly(a,r,s){var u=Math.sin(s),p=Math.cos(s),g=r[4],b=r[5],x=r[6],T=r[7],k=r[8],L=r[9],O=r[10],R=r[11];return r!==a&&(a[0]=r[0],a[1]=r[1],a[2]=r[2],a[3]=r[3],a[12]=r[12],a[13]=r[13],a[14]=r[14],a[15]=r[15]),a[4]=g*p+k*u,a[5]=b*p+L*u,a[6]=x*p+O*u,a[7]=T*p+R*u,a[8]=k*p-g*u,a[9]=L*p-b*u,a[10]=O*p-x*u,a[11]=R*p-T*u,a}function wg(a,r,s){var u=Math.sin(s),p=Math.cos(s),g=r[0],b=r[1],x=r[2],T=r[3],k=r[8],L=r[9],O=r[10],R=r[11];return r!==a&&(a[4]=r[4],a[5]=r[5],a[6]=r[6],a[7]=r[7],a[12]=r[12],a[13]=r[13],a[14]=r[14],a[15]=r[15]),a[0]=g*p-k*u,a[1]=b*p-L*u,a[2]=x*p-O*u,a[3]=T*p-R*u,a[8]=g*u+k*p,a[9]=b*u+L*p,a[10]=x*u+O*p,a[11]=T*u+R*p,a}function mw(a,r){return a[0]=r[0],a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=r[1],a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=r[2],a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function gw(a,r,s){var u,p,g,b=s[0],x=s[1],T=s[2],k=Math.hypot(b,x,T);return k<xg?null:(b*=k=1/k,x*=k,T*=k,u=Math.sin(r),p=Math.cos(r),a[0]=b*b*(g=1-p)+p,a[1]=x*b*g+T*u,a[2]=T*b*g-x*u,a[3]=0,a[4]=b*x*g-T*u,a[5]=x*x*g+p,a[6]=T*x*g+b*u,a[7]=0,a[8]=b*T*g+x*u,a[9]=x*T*g-b*u,a[10]=T*T*g+p,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a)}Math.hypot||(Math.hypot=function(){for(var a=0,r=arguments.length;r--;)a+=arguments[r]*arguments[r];return Math.sqrt(a)});var HA=ed;function zy(){var a=new da(3);return da!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a}function _w(a){var r=new da(3);return r[0]=a[0],r[1]=a[1],r[2]=a[2],r}function Uf(a){return Math.hypot(a[0],a[1],a[2])}function gh(a,r,s){var u=new da(3);return u[0]=a,u[1]=r,u[2]=s,u}function ql(a,r,s){return a[0]=r[0]+s[0],a[1]=r[1]+s[1],a[2]=r[2]+s[2],a}function Oy(a,r,s){return a[0]=r[0]-s[0],a[1]=r[1]-s[1],a[2]=r[2]-s[2],a}function yw(a,r,s){return a[0]=r[0]*s[0],a[1]=r[1]*s[1],a[2]=r[2]*s[2],a}function $f(a,r,s){return a[0]=Math.min(r[0],s[0]),a[1]=Math.min(r[1],s[1]),a[2]=Math.min(r[2],s[2]),a}function Vf(a,r,s){return a[0]=Math.max(r[0],s[0]),a[1]=Math.max(r[1],s[1]),a[2]=Math.max(r[2],s[2]),a}function Pa(a,r,s){return a[0]=r[0]*s,a[1]=r[1]*s,a[2]=r[2]*s,a}function Gf(a,r,s,u){return a[0]=r[0]+s[0]*u,a[1]=r[1]+s[1]*u,a[2]=r[2]+s[2]*u,a}function Oo(a,r){var s=r[0],u=r[1],p=r[2],g=s*s+u*u+p*p;return g>0&&(g=1/Math.sqrt(g)),a[0]=r[0]*g,a[1]=r[1]*g,a[2]=r[2]*g,a}function Wa(a,r){return a[0]*r[0]+a[1]*r[1]+a[2]*r[2]}function Dy(a,r,s){var u=r[0],p=r[1],g=r[2],b=s[0],x=s[1],T=s[2];return a[0]=p*T-g*x,a[1]=g*b-u*T,a[2]=u*x-p*b,a}function gi(a,r,s){var u=r[0],p=r[1],g=r[2],b=s[3]*u+s[7]*p+s[11]*g+s[15];return a[0]=(s[0]*u+s[4]*p+s[8]*g+s[12])/(b=b||1),a[1]=(s[1]*u+s[5]*p+s[9]*g+s[13])/b,a[2]=(s[2]*u+s[6]*p+s[10]*g+s[14])/b,a}function bw(a,r,s){var u=s[0],p=s[1],g=s[2],b=r[0],x=r[1],T=r[2],k=p*T-g*x,L=g*b-u*T,O=u*x-p*b,R=p*O-g*L,U=g*k-u*O,$=u*L-p*k,X=2*s[3];return L*=X,O*=X,U*=2,$*=2,a[0]=b+(k*=X)+(R*=2),a[1]=x+L+U,a[2]=T+O+$,a}var qf,Ls=Oy,WA=yw,ZA=Uf;function vw(a,r,s){return a[0]=r[0]*s,a[1]=r[1]*s,a[2]=r[2]*s,a[3]=r[3]*s,a}function xw(a,r){var s=r[0],u=r[1],p=r[2],g=r[3],b=s*s+u*u+p*p+g*g;return b>0&&(b=1/Math.sqrt(b)),a[0]=s*b,a[1]=u*b,a[2]=p*b,a[3]=g*b,a}function rd(a,r,s){var u=r[0],p=r[1],g=r[2],b=r[3];return a[0]=s[0]*u+s[4]*p+s[8]*g+s[12]*b,a[1]=s[1]*u+s[5]*p+s[9]*g+s[13]*b,a[2]=s[2]*u+s[6]*p+s[10]*g+s[14]*b,a[3]=s[3]*u+s[7]*p+s[11]*g+s[15]*b,a}function ww(){var a=new da(4);return da!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a[3]=1,a}function Ew(a){return a[0]=0,a[1]=0,a[2]=0,a[3]=1,a}function Tw(a,r,s){s*=.5;var u=r[0],p=r[1],g=r[2],b=r[3],x=Math.sin(s),T=Math.cos(s);return a[0]=u*T+b*x,a[1]=p*T+g*x,a[2]=g*T-p*x,a[3]=b*T-u*x,a}function kw(a,r,s){s*=.5;var u=r[0],p=r[1],g=r[2],b=r[3],x=Math.sin(s),T=Math.cos(s);return a[0]=u*T-g*x,a[1]=p*T+b*x,a[2]=g*T+u*x,a[3]=b*T-p*x,a}zy(),qf=new da(4),da!=Float32Array&&(qf[0]=0,qf[1]=0,qf[2]=0,qf[3]=0);var XA=xw;zy(),gh(1,0,0),gh(0,1,0),ww(),ww(),fw();const YA=nn([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:Cw}=YA,Sw=nn([{name:"a_pos_3",components:3,type:"Int16"}]);var Hf=nn([{name:"a_pos",type:"Int16",components:2}]);class Ry{constructor(r,s){this.pos=r,this.dir=s}intersectsPlane(r,s,u){const p=Wa(s,this.dir);if(Math.abs(p)<1e-6)return!1;const g=((r[0]-this.pos[0])*s[0]+(r[1]-this.pos[1])*s[1]+(r[2]-this.pos[2])*s[2])/p;return u[0]=this.pos[0]+this.dir[0]*g,u[1]=this.pos[1]+this.dir[1]*g,u[2]=this.pos[2]+this.dir[2]*g,!0}closestPointOnSphere(r,s,u){if(function(U,$){var X=U[0],nt=U[1],dt=U[2],yt=$[0],lt=$[1],_t=$[2];return Math.abs(X-yt)<=xg*Math.max(1,Math.abs(X),Math.abs(yt))&&Math.abs(nt-lt)<=xg*Math.max(1,Math.abs(nt),Math.abs(lt))&&Math.abs(dt-_t)<=xg*Math.max(1,Math.abs(dt),Math.abs(_t))}(this.pos,r)||s===0)return u[0]=u[1]=u[2]=0,!1;const[p,g,b]=this.dir,x=this.pos[0]-r[0],T=this.pos[1]-r[1],k=this.pos[2]-r[2],L=p*p+g*g+b*b,O=2*(x*p+T*g+k*b),R=O*O-4*L*(x*x+T*T+k*k-s*s);if(R<0){const U=Math.max(-O/2,0),$=x+p*U,X=T+g*U,nt=k+b*U,dt=Math.hypot($,X,nt);return u[0]=$*s/dt,u[1]=X*s/dt,u[2]=nt*s/dt,!1}{const U=(-O-Math.sqrt(R))/(2*L);if(U<0){const $=Math.hypot(x,T,k);return u[0]=x*s/$,u[1]=T*s/$,u[2]=k*s/$,!1}return u[0]=x+p*U,u[1]=T+g*U,u[2]=k+b*U,!0}}}class By{constructor(r,s,u,p,g){this.TL=r,this.TR=s,this.BR=u,this.BL=p,this.horizon=g}static fromInvProjectionMatrix(r,s,u){const p=[-1,1,1],g=[1,1,1],b=[1,-1,1],x=[-1,-1,1],T=gi(p,p,r),k=gi(g,g,r),L=gi(b,b,r),O=gi(x,x,r);return new By(T,k,L,O,s/u)}}class Fy{constructor(r,s){this.points=r,this.planes=s}static fromInvProjectionMatrix(r,s,u,p){const g=Math.pow(2,u),b=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(T=>{const k=rd([],T,r),L=1/k[3]/s*g;return function(O,R,U){return O[0]=R[0]*U[0],O[1]=R[1]*U[1],O[2]=R[2]*U[2],O[3]=R[3]*U[3],O}(k,k,[L,L,p?1/k[3]:L,L])}),x=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(T=>{const k=Oo([],Dy([],Ls([],b[T[0]],b[T[1]]),Ls([],b[T[2]],b[T[1]]))),L=-Wa(k,b[T[1]]);return k.concat(L)});return new Fy(b,x)}}class Do{static fromPoints(r){const s=[1/0,1/0,1/0],u=[-1/0,-1/0,-1/0];for(const p of r)$f(s,s,p),Vf(u,u,p);return new Do(s,u)}static applyTransform(r,s){const u=r.getCorners();for(let p=0;p<u.length;++p)gi(u[p],u[p],s);return Do.fromPoints(u)}constructor(r,s){this.min=r,this.max=s,this.center=Pa([],ql([],this.min,this.max),.5)}quadrant(r){const s=[r%2==0,r<2],u=_w(this.min),p=_w(this.max);for(let g=0;g<s.length;g++)u[g]=s[g]?this.min[g]:this.center[g],p[g]=s[g]?this.center[g]:this.max[g];return p[2]=this.max[2],new Do(u,p)}distanceX(r){return Math.max(Math.min(this.max[0],r[0]),this.min[0])-r[0]}distanceY(r){return Math.max(Math.min(this.max[1],r[1]),this.min[1])-r[1]}distanceZ(r){return Math.max(Math.min(this.max[2],r[2]),this.min[2])-r[2]}getCorners(){const r=this.min,s=this.max;return[[r[0],r[1],r[2]],[s[0],r[1],r[2]],[s[0],s[1],r[2]],[r[0],s[1],r[2]],[r[0],r[1],s[2]],[s[0],r[1],s[2]],[s[0],s[1],s[2]],[r[0],s[1],s[2]]]}intersects(r){const s=this.getCorners();let u=!0;for(let p=0;p<r.planes.length;p++){const g=r.planes[p];let b=0;for(let x=0;x<s.length;x++)b+=Wa(g,s[x])+g[3]>=0;if(b===0)return 0;b!==s.length&&(u=!1)}if(u)return 2;for(let p=0;p<3;p++){let g=Number.MAX_VALUE,b=-Number.MAX_VALUE;for(let x=0;x<r.points.length;x++){const T=r.points[x][p]-this.min[p];g=Math.min(g,T),b=Math.max(b,T)}if(b<0||g>this.max[p]-this.min[p])return 0}return 1}}const el=bn/Math.PI/2,id=64,Wf=[id,32,16],Za=-el,Xa=el,KA=[new Do([Za,Za,Za],[Xa,Xa,Xa]),new Do([Za,Za,Za],[0,0,Xa]),new Do([0,Za,Za],[Xa,0,Xa]),new Do([Za,0,Za],[0,Xa,Xa]),new Do([0,0,Za],[Xa,Xa,Xa])];function Eg(a){return a*el/Yf}function Mw(a,r,s,u=!0){const p=Pa([],a._camera.position,a.worldSize),g=[r,s,1,1];rd(g,g,a.pixelMatrixInverse),vw(g,g,1/g[3]);const b=Oo([],Ls([],g,p)),x=a.globeMatrix,T=[x[12],x[13],x[14]],k=Ls([],T,p),L=Uf(k),O=Oo([],k),R=a.worldSize/(2*Math.PI),U=Wa(O,b),$=Math.asin(R/L);if($<Math.acos(U)){if(!u)return null;const _e=[],Zt=[];Pa(_e,b,L/U),Oo(Zt,Ls(Zt,_e,k)),Oo(b,ql(b,k,Pa(b,Zt,Math.tan($)*L)))}const X=[];new Ry(p,b).closestPointOnSphere(T,R,X);const nt=Oo([],Me(x,0)),dt=Oo([],Me(x,1)),yt=Oo([],Me(x,2)),lt=Wa(nt,X),_t=Wa(dt,X),Et=Wa(yt,X),xt=oe(Math.asin(-_t/R));let qt=oe(Math.atan2(lt,Et));qt=a.center.lng+function(_e,Zt){const ee=(Zt-_e+180)%360-180;return ee<-180?ee+360:ee}(a.center.lng,qt);const $t=rl(qt),Qt=se(il(xt),0,1);return new vh($t,Qt)}class JA{constructor(r,s,u){this.a=Ls([],r,u),this.b=Ls([],s,u),this.center=u;const p=Oo([],this.a),g=Oo([],this.b);this.angle=Math.acos(Wa(p,g))}}function Ny(a,r){if(a.angle===0)return null;let s;return s=a.a[r]===0?1/a.angle*.5*Math.PI:1/a.angle*Math.atan(a.b[r]/a.a[r]/Math.sin(a.angle)-1/Math.tan(a.angle)),s<0||s>1?null:function(u,p,g,b){const x=Math.sin(g);return u*(Math.sin((1-b)*g)/x)+p*(Math.sin(b*g)/x)}(a.a[r],a.b[r],a.angle,se(s,0,1))+a.center[r]}function nl(a){if(a.z<=1)return KA[a.z+2*a.y+a.x];const r=jy(Tg(a));return Do.fromPoints(r)}function od(a,r,s){return Pa(a,a,1-s),Gf(a,a,r,s)}function Aw(a,r){const s=bh(r.zoom);if(s===0)return nl(a);const u=Tg(a),p=jy(u),g=rl(u.getWest())*r.worldSize,b=rl(u.getEast())*r.worldSize,x=il(u.getNorth())*r.worldSize,T=il(u.getSouth())*r.worldSize,k=[g,x,0],L=[b,x,0],O=[g,T,0],R=[b,T,0],U=Py([],r.globeMatrix);return gi(k,k,U),gi(L,L,U),gi(O,O,U),gi(R,R,U),p[0]=od(p[0],O,s),p[1]=od(p[1],R,s),p[2]=od(p[2],L,s),p[3]=od(p[3],k,s),Do.fromPoints(p)}function Iw(a,r,s){for(const u of a)gi(u,u,r),Pa(u,u,s)}function QA(a,r,s){const u=r/a.worldSize,p=a.globeMatrix;if(s.z<=1){const $t=nl(s).getCorners();return Iw($t,p,u),Do.fromPoints($t)}const g=Tg(s),b=jy(g);Iw(b,p,u);const x=Number.MAX_VALUE,T=[-x,-x,-x],k=[x,x,x];if(g.contains(a.center)){for(const _e of b)$f(k,k,_e),Vf(T,T,_e);T[2]=0;const $t=a.point,Qt=[$t.x*u,$t.y*u,0];return $f(k,k,Qt),Vf(T,T,Qt),new Do(k,T)}const L=[p[12]*u,p[13]*u,p[14]*u],O=g.getCenter(),R=se(a.center.lat,-go,go),U=se(O.lat,-go,go),$=rl(a.center.lng),X=il(R);let nt=$-rl(O.lng);const dt=X-il(U);nt>.5?nt-=1:nt<-.5&&(nt+=1);let yt=0;Math.abs(nt)>Math.abs(dt)?yt=nt>=0?1:3:(yt=dt>=0?0:2,Gf(L,L,[p[4]*u,p[5]*u,p[6]*u],-Math.sin(jt(dt>=0?g.getSouth():g.getNorth()))*el));const lt=b[yt],_t=b[(yt+1)%4],Et=new JA(lt,_t,L),xt=[Ny(Et,0)||lt[0],Ny(Et,1)||lt[1],Ny(Et,2)||lt[2]],qt=bh(a.zoom);if(qt>0){const $t=function({x:_e,y:Zt,z:ee},re,de,ye,Yt){const Pe=1/(1<<ee);let fn=_e*Pe,Fe=fn+Pe,Xe=Zt*Pe,Le=Xe+Pe,mn=0;const jn=(fn+Fe)/2-ye;return jn>.5?mn=-1:jn<-.5&&(mn=1),fn=((fn+mn)*re-(ye*=re))*de+ye,Fe=((Fe+mn)*re-ye)*de+ye,Xe=(Xe*re-(Yt*=re))*de+Yt,Le=(Le*re-Yt)*de+Yt,[[fn,Le,0],[Fe,Le,0],[Fe,Xe,0],[fn,Xe,0]]}(s,r,a._pixelsPerMercatorPixel,$,X);for(let _e=0;_e<b.length;_e++)od(b[_e],$t[_e],qt);const Qt=ql([],$t[yt],$t[(yt+1)%4]);Pa(Qt,Qt,.5),od(xt,Qt,qt)}for(const $t of b)$f(k,k,$t),Vf(T,T,$t);return k[2]=Math.min(lt[2],_t[2]),$f(k,k,xt),Vf(T,T,xt),new Do(k,T)}function Tg({x:a,y:r,z:s}){const u=1/(1<<s),p=new rr(La(a*u),mo((r+1)*u)),g=new rr(La((a+1)*u),mo(r*u));return new $c(p,g)}function jy(a){const r=jt(a.getNorth()),s=jt(a.getSouth()),u=Math.cos(r),p=Math.cos(s),g=Math.sin(r),b=Math.sin(s),x=a.getWest(),T=a.getEast();return[_h(p,b,x),_h(p,b,T),_h(u,g,T),_h(u,g,x)]}function _h(a,r,s,u=el){return s=jt(s),[a*Math.sin(s)*u,-r*u,a*Math.cos(s)*u]}function yh(a,r,s){return _h(Math.cos(jt(a)),Math.sin(jt(a)),r,s)}function Zf(a,r,s,u){const p=1<<s.z,g=(a/bn+s.x)/p;return yh(mo((r/bn+s.y)/p),La(g),u)}function kg({min:a,max:r}){return 16383/Math.max(r[0]-a[0],r[1]-a[1],r[2]-a[2])}const Pw=new Float64Array(16);function Xf(a){const r=kg(a),s=mw(Pw,[r,r,r]);return jf(s,s,((u=[])[0]=-(p=a.min)[0],u[1]=-p[1],u[2]=-p[2],u));var u,p}function Uy(a){const r=(u=a.min,(s=Pw)[0]=1,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=1,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=1,s[11]=0,s[12]=u[0],s[13]=u[1],s[14]=u[2],s[15]=1,s);var s,u;const p=1/kg(a);return nd(r,r,[p,p,p])}function Lw(a,r,s,u,p){const g=function(T){const k=bn/(2*Math.PI);return T/(2*Math.PI)/k}(s),b=[a,r,-s/(2*Math.PI)],x=Ps(new Float64Array(16));return jf(x,x,b),nd(x,x,[g,g,g]),Ly(x,x,jt(-p)),wg(x,x,jt(-u)),x}function bh(a){return Ze(5,6,a)}function zw(a,r){const s=yh(r.lat,r.lng),u=function($){const X=yh($._center.lat,$._center.lng);let nt=Dy([],gh(0,1,0),X);const dt=gw([],-$.angle,X);nt=gi(nt,nt,dt),gw(dt,-$._pitch,nt);const yt=Oo([],X);return Pa(yt,yt,Eg($.cameraToCenterDistance/$.pixelsPerMeter)),gi(yt,yt,dt),ql([],X,yt)}(a);return b=(p=Oy([],u,s))[0],x=p[1],T=p[2],k=(g=s)[0],L=g[1],O=g[2],U=(R=Math.sqrt(b*b+x*x+T*T)*Math.sqrt(k*k+L*L+O*O))&&Wa(p,g)/R,Math.acos(Math.min(Math.max(U,-1),1));var p,g,b,x,T,k,L,O,R,U}function $y(a,r){return zw(a,r)>Math.PI/2*1.01}const Ow=jt(85),t6=Math.cos(Ow),e6=Math.sin(Ow),Yf=63710088e-1,Dw=2*Math.PI*Yf;class rr{constructor(r,s){if(isNaN(r)||isNaN(s))throw new Error(`Invalid LngLat object: (${r}, ${s})`);if(this.lng=+r,this.lat=+s,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new rr(gn(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(r){const s=Math.PI/180,u=this.lat*s,p=r.lat*s,g=Math.sin(u)*Math.sin(p)+Math.cos(u)*Math.cos(p)*Math.cos((r.lng-this.lng)*s);return Yf*Math.acos(Math.min(g,1))}toBounds(r=0){const s=360*r/40075017,u=s/Math.cos(Math.PI/180*this.lat);return new $c(new rr(this.lng-u,this.lat-s),new rr(this.lng+u,this.lat+s))}toEcef(r){const s=Eg(r);return yh(this.lat,this.lng,el+s)}static convert(r){if(r instanceof rr)return r;if(Array.isArray(r)&&(r.length===2||r.length===3))return new rr(Number(r[0]),Number(r[1]));if(!Array.isArray(r)&&typeof r=="object"&&r!==null)return new rr(Number("lng"in r?r.lng:r.lon),Number(r.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}function Vy(a){return Dw*Math.cos(a*Math.PI/180)}function rl(a){return(180+a)/360}function il(a){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a*Math.PI/360)))/360}function zs(a,r){return a/Vy(r)}function La(a){return 360*a-180}function mo(a){return 360/Math.PI*Math.atan(Math.exp((180-360*a)*Math.PI/180))-90}function Rw(a,r){return a*Vy(mo(r))}const go=85.051129;function Bw(a){return 1/Math.cos(a*Math.PI/180)}class vh{constructor(r,s,u=0){this.x=+r,this.y=+s,this.z=+u}static fromLngLat(r,s=0){const u=rr.convert(r);return new vh(rl(u.lng),il(u.lat),zs(s,u.lat))}toLngLat(){return new rr(La(this.x),mo(this.y))}toAltitude(){return Rw(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Dw*Bw(mo(this.y))}}function Gy(a,r,s,u,p,g,b,x,T){const k=(r+u)/2,L=(s+p)/2,O=new et(k,L);x(O),function(R,U,$,X,nt,dt){const yt=$-nt,lt=X-dt;return Math.abs((X-U)*yt-($-R)*lt)/Math.hypot(yt,lt)}(O.x,O.y,g.x,g.y,b.x,b.y)>=T?(Gy(a,r,s,k,L,g,O,x,T),Gy(a,k,L,u,p,O,b,x,T)):a.push(b)}function Fw(a,r,s){let u=a[0],p=u.x,g=u.y;r(u);const b=[u];for(let x=1;x<a.length;x++){const T=a[x],{x:k,y:L}=T;r(T),Gy(b,p,g,k,L,u,T,r,s),p=k,g=L,u=T}return b}function qy(a,r,s,u){if(u(r,s)){const p=r.add(s)._mult(.5);qy(a,r,p,u),qy(a,p,s,u)}else a.push(s)}function n6(a,r){let s=a[0];const u=[s];for(let p=1;p<a.length;p++){const g=a[p];qy(u,s,g,r),s=g}return u}const Hy=Math.pow(2,14)-1,Nw=-Hy-1;function r6(a,r){const s=Math.round(a.x*r),u=Math.round(a.y*r);return a.x=se(s,Nw,Hy),a.y=se(u,Nw,Hy),(s<a.x||s>a.x+1||u<a.y||u>a.y+1)&&Qe("Geometry exceeds allowed extent, reduce your vector tile buffer size"),a}function Hl(a,r,s){const u=a.loadGeometry(),p=a.extent,g=bn/p;if(r&&s&&s.projection.isReprojectedInTileSpace){const b=1<<r.z,{scale:x,x:T,y:k,projection:L}=s,O=R=>{const U=La((r.x+R.x/p)/b),$=mo((r.y+R.y/p)/b),X=L.project(U,$);R.x=(X.x*x-T)*p,R.y=(X.y*x-k)*p};for(let R=0;R<u.length;R++)if(a.type!==1)u[R]=Fw(u[R],O,1);else{const U=[];for(const $ of u[R])$.x<0||$.x>=p||$.y<0||$.y>=p||(O($),U.push($));u[R]=U}}for(const b of u)for(const x of b)r6(x,g);return u}function ad(a,r){return{type:a.type,id:a.id,properties:a.properties,geometry:r?Hl(a):[]}}function Cg(a,r,s,u,p){a.emplaceBack(2*r+(u+1)/2,2*s+(p+1)/2)}function Sg(a,r,s){a.emplaceBack(r.x,r.y,r.z,s[0]*16384,s[1]*16384,s[2]*16384)}class Wy{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(s=>s.id),this.index=r.index,this.hasPattern=!1,this.projection=r.projection,this.layoutVertexArray=new sn,this.indexArray=new po,this.segments=new xi,this.programConfigurations=new td(r.layers,r.zoom),this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(r,s,u,p){const g=this.layers[0],b=[];let x=null;g.type==="circle"&&(x=g.layout.get("circle-sort-key"));for(const{feature:k,id:L,index:O,sourceLayerIndex:R}of r){const U=this.layers[0]._featureFilter.needGeometry,$=ad(k,U);if(!this.layers[0]._featureFilter.filter(new Ft(this.zoom),$,u))continue;const X=x?x.evaluate($,{},u):void 0,nt={id:L,properties:k.properties,type:k.type,sourceLayerIndex:R,index:O,geometry:U?$.geometry:Hl(k,u,p),patterns:{},sortKey:X};b.push(nt)}x&&b.sort((k,L)=>k.sortKey-L.sortKey);let T=null;p.projection.name==="globe"&&(this.globeExtVertexArray=new Ia,T=p.projection);for(const k of b){const{geometry:L,index:O,sourceLayerIndex:R}=k,U=r[O].feature;this.addFeature(k,L,O,s.availableImages,u,T),s.featureIndex.insert(U,L,O,R,this.index)}}update(r,s,u,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,s,this.stateDependentLayers,u,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,GA.members),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=r.createVertexBuffer(this.globeExtVertexArray,qA.members))),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(r,s,u,p,g,b){for(const x of s)for(const T of x){const k=T.x,L=T.y;if(k<0||k>=bn||L<0||L>=bn)continue;if(b){const U=b.projectTilePoint(k,L,g),$=b.upVector(g,k,L),X=this.globeExtVertexArray;Sg(X,U,$),Sg(X,U,$),Sg(X,U,$),Sg(X,U,$)}const O=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,r.sortKey),R=O.vertexLength;Cg(this.layoutVertexArray,k,L,-1,-1),Cg(this.layoutVertexArray,k,L,1,-1),Cg(this.layoutVertexArray,k,L,1,1),Cg(this.layoutVertexArray,k,L,-1,1),this.indexArray.emplaceBack(R,R+1,R+2),this.indexArray.emplaceBack(R,R+2,R+3),O.vertexLength+=4,O.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,u,{},p,g)}}function jw(a,r){for(let s=0;s<a.length;s++)if(sd(r,a[s]))return!0;for(let s=0;s<r.length;s++)if(sd(a,r[s]))return!0;return!!Zy(a,r)}function i6(a,r,s){return!!sd(a,r)||!!Xy(r,a,s)}function Uw(a,r){if(a.length===1)return Vw(r,a[0]);for(let s=0;s<r.length;s++){const u=r[s];for(let p=0;p<u.length;p++)if(sd(a,u[p]))return!0}for(let s=0;s<a.length;s++)if(Vw(r,a[s]))return!0;for(let s=0;s<r.length;s++)if(Zy(a,r[s]))return!0;return!1}function o6(a,r,s){if(a.length>1){if(Zy(a,r))return!0;for(let u=0;u<r.length;u++)if(Xy(r[u],a,s))return!0}for(let u=0;u<a.length;u++)if(Xy(a[u],r,s))return!0;return!1}function Zy(a,r){if(a.length===0||r.length===0)return!1;for(let s=0;s<a.length-1;s++){const u=a[s],p=a[s+1];for(let g=0;g<r.length-1;g++)if(a6(u,p,r[g],r[g+1]))return!0}return!1}function a6(a,r,s,u){return bt(a,s,u)!==bt(r,s,u)&&bt(a,r,s)!==bt(a,r,u)}function Xy(a,r,s){const u=s*s;if(r.length===1)return a.distSqr(r[0])<u;for(let p=1;p<r.length;p++)if($w(a,r[p-1],r[p])<u)return!0;return!1}function $w(a,r,s){const u=r.distSqr(s);if(u===0)return a.distSqr(r);const p=((a.x-r.x)*(s.x-r.x)+(a.y-r.y)*(s.y-r.y))/u;return a.distSqr(p<0?r:p>1?s:s.sub(r)._mult(p)._add(r))}function Vw(a,r){let s,u,p,g=!1;for(let b=0;b<a.length;b++){s=a[b];for(let x=0,T=s.length-1;x<s.length;T=x++)u=s[x],p=s[T],u.y>r.y!=p.y>r.y&&r.x<(p.x-u.x)*(r.y-u.y)/(p.y-u.y)+u.x&&(g=!g)}return g}function sd(a,r){let s=!1;for(let u=0,p=a.length-1;u<a.length;p=u++){const g=a[u],b=a[p];g.y>r.y!=b.y>r.y&&r.x<(b.x-g.x)*(r.y-g.y)/(b.y-g.y)+g.x&&(s=!s)}return s}function Gw(a,r,s,u,p){for(const b of a)if(r<=b.x&&s<=b.y&&u>=b.x&&p>=b.y)return!0;const g=[new et(r,s),new et(r,p),new et(u,p),new et(u,s)];if(a.length>2){for(const b of g)if(sd(a,b))return!0}for(let b=0;b<a.length-1;b++)if(s6(a[b],a[b+1],g))return!0;return!1}function s6(a,r,s){const u=s[0],p=s[2];if(a.x<u.x&&r.x<u.x||a.x>p.x&&r.x>p.x||a.y<u.y&&r.y<u.y||a.y>p.y&&r.y>p.y)return!1;const g=bt(a,r,s[0]);return g!==bt(a,r,s[1])||g!==bt(a,r,s[2])||g!==bt(a,r,s[3])}function xh(a,r,s){const u=r.paint.get(a).value;return u.kind==="constant"?u.value:s.programConfigurations.get(r.id).getMaxValue(a)}function Mg(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function qw(a,r,s,u,p){if(!r[0]&&!r[1])return a;const g=et.convert(r)._mult(p);s==="viewport"&&g._rotate(-u);const b=[];for(let x=0;x<a.length;x++)b.push(a[x].sub(g));return b}function Hw(a,r,s,u){const p=et.convert(a)._mult(u);return r==="viewport"&&p._rotate(-s),p}qe(Wy,"CircleBucket",{omit:["layers"]});const l6=new pe({"circle-sort-key":new Wt(Kt.layout_circle["circle-sort-key"])});var c6={paint:new pe({"circle-radius":new Wt(Kt.paint_circle["circle-radius"]),"circle-color":new Wt(Kt.paint_circle["circle-color"]),"circle-blur":new Wt(Kt.paint_circle["circle-blur"]),"circle-opacity":new Wt(Kt.paint_circle["circle-opacity"]),"circle-translate":new Ot(Kt.paint_circle["circle-translate"]),"circle-translate-anchor":new Ot(Kt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ot(Kt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ot(Kt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Wt(Kt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Wt(Kt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Wt(Kt.paint_circle["circle-stroke-opacity"])}),layout:l6};function Ww(a,r,s,u,p,g,b,x,T){if(g&&a.queryGeometry.isAboveHorizon)return!1;g&&(T*=a.pixelToTileUnitsFactor);const k=a.tileID.canonical,L=s.projection.upVectorScale(k,s.center.lat,s.worldSize).metersToTile;for(const O of r)for(const R of O){const U=R.add(x),$=p&&s.elevation?s.elevation.exaggeration()*p.getElevationAt(U.x,U.y,!0):0,X=s.projection.projectTilePoint(U.x,U.y,k);if($>0){const lt=s.projection.upVector(k,U.x,U.y);X.x+=lt[0]*L*$,X.y+=lt[1]*L*$,X.z+=lt[2]*L*$}const nt=g?U:u6(X.x,X.y,X.z,u),dt=g?a.tilespaceRays.map(lt=>h6(lt,$)):a.queryGeometry.screenGeometry,yt=rd([],[X.x,X.y,X.z,1],u);if(!b&&g?T*=yt[3]/s.cameraToCenterDistance:b&&!g&&(T*=s.cameraToCenterDistance/yt[3]),g){const lt=mo((R.y/bn+k.y)/(1<<k.z));T/=s.projection.pixelsPerMeter(lt,1)/zs(1,lt)}if(i6(dt,nt,T))return!0}return!1}function u6(a,r,s,u){const p=rd([],[a,r,s,1],u);return new et(p[0]/p[3],p[1]/p[3])}const Zw=gh(0,0,0),d6=gh(0,0,1);function h6(a,r){const s=zy();return Zw[2]=r,a.intersectsPlane(Zw,d6,s),new et(s[0],s[1])}class Xw extends Wy{}function Yw(a,{width:r,height:s},u,p){if(p){if(p instanceof Uint8ClampedArray)p=new Uint8Array(p.buffer);else if(p.length!==r*s*u)throw new RangeError("mismatched image size")}else p=new Uint8Array(r*s*u);return a.width=r,a.height=s,a.data=p,a}function Kw(a,r,s){const{width:u,height:p}=r;u===a.width&&p===a.height||(Yy(a,r,{x:0,y:0},{x:0,y:0},{width:Math.min(a.width,u),height:Math.min(a.height,p)},s),a.width=u,a.height=p,a.data=r.data)}function Yy(a,r,s,u,p,g){if(p.width===0||p.height===0)return r;if(p.width>a.width||p.height>a.height||s.x>a.width-p.width||s.y>a.height-p.height)throw new RangeError("out of range source coordinates for image copy");if(p.width>r.width||p.height>r.height||u.x>r.width-p.width||u.y>r.height-p.height)throw new RangeError("out of range destination coordinates for image copy");const b=a.data,x=r.data;for(let T=0;T<p.height;T++){const k=((s.y+T)*a.width+s.x)*g,L=((u.y+T)*r.width+u.x)*g;for(let O=0;O<p.width*g;O++)x[L+O]=b[k+O]}return r}qe(Xw,"HeatmapBucket",{omit:["layers"]});class Wl{constructor(r,s){Yw(this,r,1,s)}resize(r){Kw(this,new Wl(r),1)}clone(){return new Wl({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(r,s,u,p,g){Yy(r,s,u,p,g,1)}}class ha{constructor(r,s){Yw(this,r,4,s)}resize(r){Kw(this,new ha(r),4)}replace(r,s){s?this.data.set(r):this.data=r instanceof Uint8ClampedArray?new Uint8Array(r.buffer):r}clone(){return new ha({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(r,s,u,p,g){Yy(r,s,u,p,g,4)}}qe(Wl,"AlphaImage"),qe(ha,"RGBAImage");var f6={paint:new pe({"heatmap-radius":new Wt(Kt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Wt(Kt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ot(Kt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ie(Kt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ot(Kt.paint_heatmap["heatmap-opacity"])})};function Ky(a){const r={},s=a.resolution||256,u=a.clips?a.clips.length:1,p=a.image||new ha({width:s,height:u}),g=(b,x,T)=>{r[a.evaluationKey]=T;const k=a.expression.evaluate(r);p.data[b+x+0]=Math.floor(255*k.r/k.a),p.data[b+x+1]=Math.floor(255*k.g/k.a),p.data[b+x+2]=Math.floor(255*k.b/k.a),p.data[b+x+3]=Math.floor(255*k.a)};if(a.clips)for(let b=0,x=0;b<u;++b,x+=4*s)for(let T=0,k=0;T<s;T++,k+=4){const L=T/(s-1),{start:O,end:R}=a.clips[b];g(x,k,O*(1-L)+R*L)}else for(let b=0,x=0;b<s;b++,x+=4)g(0,x,b/(s-1));return p}var p6={paint:new pe({"hillshade-illumination-direction":new Ot(Kt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Ot(Kt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ot(Kt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ot(Kt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ot(Kt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ot(Kt.paint_hillshade["hillshade-accent-color"])})};const m6=nn([{name:"a_pos",components:2,type:"Int16"}],4),{members:g6}=m6;var wh={};function Ag(a,r,s){s=s||2;var u,p,g,b,x,T,k,L=r&&r.length,O=L?r[0]*s:a.length,R=Jw(a,0,O,s,!0),U=[];if(!R||R.next===R.prev)return U;if(L&&(R=function(X,nt,dt,yt){var lt,_t,Et,xt=[];for(lt=0,_t=nt.length;lt<_t;lt++)(Et=Jw(X,nt[lt]*yt,lt<_t-1?nt[lt+1]*yt:X.length,yt,!1))===Et.next&&(Et.steiner=!0),xt.push(T6(Et));for(xt.sort(x6),lt=0;lt<xt.length;lt++)dt=w6(xt[lt],dt);return dt}(a,r,R,s)),a.length>80*s){u=g=a[0],p=b=a[1];for(var $=s;$<O;$+=s)(x=a[$])<u&&(u=x),(T=a[$+1])<p&&(p=T),x>g&&(g=x),T>b&&(b=T);k=(k=Math.max(g-u,b-p))!==0?32767/k:0}return Kf(R,U,s,u,p,k,0),U}function Jw(a,r,s,u,p){var g,b;if(p===t1(a,r,s,u)>0)for(g=r;g<s;g+=u)b=e2(g,a[g],a[g+1],b);else for(g=s-u;g>=r;g-=u)b=e2(g,a[g],a[g+1],b);return b&&Ig(b,b.next)&&(Qf(b),b=b.next),b}function ld(a,r){if(!a)return a;r||(r=a);var s,u=a;do if(s=!1,u.steiner||!Ig(u,u.next)&&wi(u.prev,u,u.next)!==0)u=u.next;else{if(Qf(u),(u=r=u.prev)===u.next)break;s=!0}while(s||u!==r);return r}function Kf(a,r,s,u,p,g,b){if(a){!b&&g&&function(L,O,R,U){var $=L;do $.z===0&&($.z=Jy($.x,$.y,O,R,U)),$.prevZ=$.prev,$.nextZ=$.next,$=$.next;while($!==L);$.prevZ.nextZ=null,$.prevZ=null,function(X){var nt,dt,yt,lt,_t,Et,xt,qt,$t=1;do{for(dt=X,X=null,_t=null,Et=0;dt;){for(Et++,yt=dt,xt=0,nt=0;nt<$t&&(xt++,yt=yt.nextZ);nt++);for(qt=$t;xt>0||qt>0&&yt;)xt!==0&&(qt===0||!yt||dt.z<=yt.z)?(lt=dt,dt=dt.nextZ,xt--):(lt=yt,yt=yt.nextZ,qt--),_t?_t.nextZ=lt:X=lt,lt.prevZ=_t,_t=lt;dt=yt}_t.nextZ=null,$t*=2}while(Et>1)}($)}(a,u,p,g);for(var x,T,k=a;a.prev!==a.next;)if(x=a.prev,T=a.next,g?y6(a,u,p,g):_6(a))r.push(x.i/s|0),r.push(a.i/s|0),r.push(T.i/s|0),Qf(a),a=T.next,k=T.next;else if((a=T)===k){b?b===1?Kf(a=b6(ld(a),r,s),r,s,u,p,g,2):b===2&&v6(a,r,s,u,p,g):Kf(ld(a),r,s,u,p,g,1);break}}}function _6(a){var r=a.prev,s=a,u=a.next;if(wi(r,s,u)>=0)return!1;for(var p=r.x,g=s.x,b=u.x,x=r.y,T=s.y,k=u.y,L=p<g?p<b?p:b:g<b?g:b,O=x<T?x<k?x:k:T<k?T:k,R=p>g?p>b?p:b:g>b?g:b,U=x>T?x>k?x:k:T>k?T:k,$=u.next;$!==r;){if($.x>=L&&$.x<=R&&$.y>=O&&$.y<=U&&Eh(p,x,g,T,b,k,$.x,$.y)&&wi($.prev,$,$.next)>=0)return!1;$=$.next}return!0}function y6(a,r,s,u){var p=a.prev,g=a,b=a.next;if(wi(p,g,b)>=0)return!1;for(var x=p.x,T=g.x,k=b.x,L=p.y,O=g.y,R=b.y,U=x<T?x<k?x:k:T<k?T:k,$=L<O?L<R?L:R:O<R?O:R,X=x>T?x>k?x:k:T>k?T:k,nt=L>O?L>R?L:R:O>R?O:R,dt=Jy(U,$,r,s,u),yt=Jy(X,nt,r,s,u),lt=a.prevZ,_t=a.nextZ;lt&&lt.z>=dt&&_t&&_t.z<=yt;){if(lt.x>=U&&lt.x<=X&&lt.y>=$&&lt.y<=nt&&lt!==p&&lt!==b&&Eh(x,L,T,O,k,R,lt.x,lt.y)&&wi(lt.prev,lt,lt.next)>=0||(lt=lt.prevZ,_t.x>=U&&_t.x<=X&&_t.y>=$&&_t.y<=nt&&_t!==p&&_t!==b&&Eh(x,L,T,O,k,R,_t.x,_t.y)&&wi(_t.prev,_t,_t.next)>=0))return!1;_t=_t.nextZ}for(;lt&&lt.z>=dt;){if(lt.x>=U&&lt.x<=X&&lt.y>=$&&lt.y<=nt&&lt!==p&&lt!==b&&Eh(x,L,T,O,k,R,lt.x,lt.y)&&wi(lt.prev,lt,lt.next)>=0)return!1;lt=lt.prevZ}for(;_t&&_t.z<=yt;){if(_t.x>=U&&_t.x<=X&&_t.y>=$&&_t.y<=nt&&_t!==p&&_t!==b&&Eh(x,L,T,O,k,R,_t.x,_t.y)&&wi(_t.prev,_t,_t.next)>=0)return!1;_t=_t.nextZ}return!0}function b6(a,r,s){var u=a;do{var p=u.prev,g=u.next.next;!Ig(p,g)&&Qw(p,u,u.next,g)&&Jf(p,g)&&Jf(g,p)&&(r.push(p.i/s|0),r.push(u.i/s|0),r.push(g.i/s|0),Qf(u),Qf(u.next),u=a=g),u=u.next}while(u!==a);return ld(u)}function v6(a,r,s,u,p,g){var b=a;do{for(var x=b.next.next;x!==b.prev;){if(b.i!==x.i&&k6(b,x)){var T=t2(b,x);return b=ld(b,b.next),T=ld(T,T.next),Kf(b,r,s,u,p,g,0),void Kf(T,r,s,u,p,g,0)}x=x.next}b=b.next}while(b!==a)}function x6(a,r){return a.x-r.x}function w6(a,r){var s=function(p,g){var b,x=g,T=p.x,k=p.y,L=-1/0;do{if(k<=x.y&&k>=x.next.y&&x.next.y!==x.y){var O=x.x+(k-x.y)*(x.next.x-x.x)/(x.next.y-x.y);if(O<=T&&O>L&&(L=O,b=x.x<x.next.x?x:x.next,O===T))return b}x=x.next}while(x!==g);if(!b)return null;var R,U=b,$=b.x,X=b.y,nt=1/0;x=b;do T>=x.x&&x.x>=$&&T!==x.x&&Eh(k<X?T:L,k,$,X,k<X?L:T,k,x.x,x.y)&&(R=Math.abs(k-x.y)/(T-x.x),Jf(x,p)&&(R<nt||R===nt&&(x.x>b.x||x.x===b.x&&E6(b,x)))&&(b=x,nt=R)),x=x.next;while(x!==U);return b}(a,r);if(!s)return r;var u=t2(s,a);return ld(u,u.next),ld(s,s.next)}function E6(a,r){return wi(a.prev,a,r.prev)<0&&wi(r.next,a,a.next)<0}function Jy(a,r,s,u,p){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-s)*p|0)|a<<8))|a<<4))|a<<2))|a<<1))|(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-u)*p|0)|r<<8))|r<<4))|r<<2))|r<<1))<<1}function T6(a){var r=a,s=a;do(r.x<s.x||r.x===s.x&&r.y<s.y)&&(s=r),r=r.next;while(r!==a);return s}function Eh(a,r,s,u,p,g,b,x){return(p-b)*(r-x)>=(a-b)*(g-x)&&(a-b)*(u-x)>=(s-b)*(r-x)&&(s-b)*(g-x)>=(p-b)*(u-x)}function k6(a,r){return a.next.i!==r.i&&a.prev.i!==r.i&&!function(s,u){var p=s;do{if(p.i!==s.i&&p.next.i!==s.i&&p.i!==u.i&&p.next.i!==u.i&&Qw(p,p.next,s,u))return!0;p=p.next}while(p!==s);return!1}(a,r)&&(Jf(a,r)&&Jf(r,a)&&function(s,u){var p=s,g=!1,b=(s.x+u.x)/2,x=(s.y+u.y)/2;do p.y>x!=p.next.y>x&&p.next.y!==p.y&&b<(p.next.x-p.x)*(x-p.y)/(p.next.y-p.y)+p.x&&(g=!g),p=p.next;while(p!==s);return g}(a,r)&&(wi(a.prev,a,r.prev)||wi(a,r.prev,r))||Ig(a,r)&&wi(a.prev,a,a.next)>0&&wi(r.prev,r,r.next)>0)}function wi(a,r,s){return(r.y-a.y)*(s.x-r.x)-(r.x-a.x)*(s.y-r.y)}function Ig(a,r){return a.x===r.x&&a.y===r.y}function Qw(a,r,s,u){var p=Lg(wi(a,r,s)),g=Lg(wi(a,r,u)),b=Lg(wi(s,u,a)),x=Lg(wi(s,u,r));return p!==g&&b!==x||!(p!==0||!Pg(a,s,r))||!(g!==0||!Pg(a,u,r))||!(b!==0||!Pg(s,a,u))||!(x!==0||!Pg(s,r,u))}function Pg(a,r,s){return r.x<=Math.max(a.x,s.x)&&r.x>=Math.min(a.x,s.x)&&r.y<=Math.max(a.y,s.y)&&r.y>=Math.min(a.y,s.y)}function Lg(a){return a>0?1:a<0?-1:0}function Jf(a,r){return wi(a.prev,a,a.next)<0?wi(a,r,a.next)>=0&&wi(a,a.prev,r)>=0:wi(a,r,a.prev)<0||wi(a,a.next,r)<0}function t2(a,r){var s=new Qy(a.i,a.x,a.y),u=new Qy(r.i,r.x,r.y),p=a.next,g=r.prev;return a.next=r,r.prev=a,s.next=p,p.prev=s,u.next=s,s.prev=u,g.next=u,u.prev=g,u}function e2(a,r,s,u){var p=new Qy(a,r,s);return u?(p.next=u.next,p.prev=u,u.next.prev=p,u.next=p):(p.prev=p,p.next=p),p}function Qf(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function Qy(a,r,s){this.i=a,this.x=r,this.y=s,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function t1(a,r,s,u){for(var p=0,g=r,b=s-u;g<s;g+=u)p+=(a[b]-a[g])*(a[g+1]+a[b+1]),b=g;return p}function C6(a,r,s,u,p){n2(a,r,s||0,u||a.length-1,p||S6)}function n2(a,r,s,u,p){for(;u>s;){if(u-s>600){var g=u-s+1,b=r-s+1,x=Math.log(g),T=.5*Math.exp(2*x/3),k=.5*Math.sqrt(x*T*(g-T)/g)*(b-g/2<0?-1:1);n2(a,r,Math.max(s,Math.floor(r-b*T/g+k)),Math.min(u,Math.floor(r+(g-b)*T/g+k)),p)}var L=a[r],O=s,R=u;for(tp(a,s,r),p(a[u],L)>0&&tp(a,s,u);O<R;){for(tp(a,O,R),O++,R--;p(a[O],L)<0;)O++;for(;p(a[R],L)>0;)R--}p(a[s],L)===0?tp(a,s,R):tp(a,++R,u),R<=r&&(s=R+1),r<=R&&(u=R-1)}}function tp(a,r,s){var u=a[r];a[r]=a[s],a[s]=u}function S6(a,r){return a<r?-1:a>r?1:0}function e1(a,r){const s=a.length;if(s<=1)return[a];const u=[];let p,g;for(let b=0;b<s;b++){const x=vt(a[b]);x!==0&&(a[b].area=Math.abs(x),g===void 0&&(g=x<0),g===x<0?(p&&u.push(p),p=[a[b]]):p.push(a[b]))}if(p&&u.push(p),r>1)for(let b=0;b<u.length;b++)u[b].length<=r||(C6(u[b],r,1,u[b].length-1,M6),u[b]=u[b].slice(0,r));return u}function M6(a,r){return r.area-a.area}function n1(a,r,s){const u=s.patternDependencies;let p=!1;for(const g of r){const b=g.paint.get(`${a}-pattern`);b.isConstant()||(p=!0);const x=b.constantOr(null);x&&(p=!0,u[x]=!0)}return p}function r1(a,r,s,u,p){const g=p.patternDependencies;for(const b of r){const x=b.paint.get(`${a}-pattern`).value;if(x.kind!=="constant"){let T=x.evaluate({zoom:u},s,{},p.availableImages);T=T&&T.name?T.name:T,g[T]=!0,s.patterns[b.id]=T}}return s}({get exports(){return wh},set exports(a){wh=a}}).exports=Ag,wh.default=Ag,Ag.deviation=function(a,r,s,u){var p=r&&r.length,g=Math.abs(t1(a,0,p?r[0]*s:a.length,s));if(p)for(var b=0,x=r.length;b<x;b++)g-=Math.abs(t1(a,r[b]*s,b<x-1?r[b+1]*s:a.length,s));var T=0;for(b=0;b<u.length;b+=3){var k=u[b]*s,L=u[b+1]*s,O=u[b+2]*s;T+=Math.abs((a[k]-a[O])*(a[L+1]-a[k+1])-(a[k]-a[L])*(a[O+1]-a[k+1]))}return g===0&&T===0?0:Math.abs((T-g)/g)},Ag.flatten=function(a){for(var r=a[0][0].length,s={vertices:[],holes:[],dimensions:r},u=0,p=0;p<a.length;p++){for(var g=0;g<a[p].length;g++)for(var b=0;b<r;b++)s.vertices.push(a[p][g][b]);p>0&&s.holes.push(u+=a[p-1].length)}return s};class zg{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(s=>s.id),this.index=r.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new sn,this.indexArray=new po,this.indexArray2=new Qs,this.programConfigurations=new td(r.layers,r.zoom),this.segments=new xi,this.segments2=new xi,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.projection=r.projection}populate(r,s,u,p){this.hasPattern=n1("fill",this.layers,s);const g=this.layers[0].layout.get("fill-sort-key"),b=[];for(const{feature:x,id:T,index:k,sourceLayerIndex:L}of r){const O=this.layers[0]._featureFilter.needGeometry,R=ad(x,O);if(!this.layers[0]._featureFilter.filter(new Ft(this.zoom),R,u))continue;const U=g?g.evaluate(R,{},u,s.availableImages):void 0,$={id:T,properties:x.properties,type:x.type,sourceLayerIndex:L,index:k,geometry:O?R.geometry:Hl(x,u,p),patterns:{},sortKey:U};b.push($)}g&&b.sort((x,T)=>x.sortKey-T.sortKey);for(const x of b){const{geometry:T,index:k,sourceLayerIndex:L}=x;if(this.hasPattern){const O=r1("fill",this.layers,x,this.zoom,s);this.patternFeatures.push(O)}else this.addFeature(x,T,k,u,{},s.availableImages);s.featureIndex.insert(r[k].feature,T,k,L,this.index)}}update(r,s,u,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,s,this.stateDependentLayers,u,p)}addFeatures(r,s,u,p,g){for(const b of this.patternFeatures)this.addFeature(b,b.geometry,b.index,s,u,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,g6),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.indexBuffer2=r.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(r,s,u,p,g,b=[]){for(const x of e1(s,500)){let T=0;for(const $ of x)T+=$.length;const k=this.segments.prepareSegment(T,this.layoutVertexArray,this.indexArray),L=k.vertexLength,O=[],R=[];for(const $ of x){if($.length===0)continue;$!==x[0]&&R.push(O.length/2);const X=this.segments2.prepareSegment($.length,this.layoutVertexArray,this.indexArray2),nt=X.vertexLength;this.layoutVertexArray.emplaceBack($[0].x,$[0].y),this.indexArray2.emplaceBack(nt+$.length-1,nt),O.push($[0].x),O.push($[0].y);for(let dt=1;dt<$.length;dt++)this.layoutVertexArray.emplaceBack($[dt].x,$[dt].y),this.indexArray2.emplaceBack(nt+dt-1,nt+dt),O.push($[dt].x),O.push($[dt].y);X.vertexLength+=$.length,X.primitiveLength+=$.length}const U=wh(O,R);for(let $=0;$<U.length;$+=3)this.indexArray.emplaceBack(L+U[$],L+U[$+1],L+U[$+2]);k.vertexLength+=T,k.primitiveLength+=U.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,u,g,b,p)}}qe(zg,"FillBucket",{omit:["layers","patternFeatures"]});const A6=new pe({"fill-sort-key":new Wt(Kt.layout_fill["fill-sort-key"])});var I6={paint:new pe({"fill-antialias":new Ot(Kt.paint_fill["fill-antialias"]),"fill-opacity":new Wt(Kt.paint_fill["fill-opacity"]),"fill-color":new Wt(Kt.paint_fill["fill-color"]),"fill-outline-color":new Wt(Kt.paint_fill["fill-outline-color"]),"fill-translate":new Ot(Kt.paint_fill["fill-translate"]),"fill-translate-anchor":new Ot(Kt.paint_fill["fill-translate-anchor"]),"fill-pattern":new Wt(Kt.paint_fill["fill-pattern"])}),layout:A6};const P6=nn([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),L6=nn([{name:"a_centroid_pos",components:2,type:"Uint16"}]),z6=nn([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:O6}=P6;var Og={},D6=et,r2=Th;function Th(a,r,s,u,p){this.properties={},this.extent=s,this.type=0,this._pbf=a,this._geometry=-1,this._keys=u,this._values=p,a.readFields(R6,this,r)}function R6(a,r,s){a==1?r.id=s.readVarint():a==2?function(u,p){for(var g=u.readVarint()+u.pos;u.pos<g;){var b=p._keys[u.readVarint()],x=p._values[u.readVarint()];p.properties[b]=x}}(s,r):a==3?r.type=s.readVarint():a==4&&(r._geometry=s.pos)}function B6(a){for(var r,s,u=0,p=0,g=a.length,b=g-1;p<g;b=p++)u+=((s=a[b]).x-(r=a[p]).x)*(r.y+s.y);return u}Th.types=["Unknown","Point","LineString","Polygon"],Th.prototype.loadGeometry=function(){var a=this._pbf;a.pos=this._geometry;for(var r,s=a.readVarint()+a.pos,u=1,p=0,g=0,b=0,x=[];a.pos<s;){if(p<=0){var T=a.readVarint();u=7&T,p=T>>3}if(p--,u===1||u===2)g+=a.readSVarint(),b+=a.readSVarint(),u===1&&(r&&x.push(r),r=[]),r.push(new D6(g,b));else{if(u!==7)throw new Error("unknown command "+u);r&&r.push(r[0].clone())}}return r&&x.push(r),x},Th.prototype.bbox=function(){var a=this._pbf;a.pos=this._geometry;for(var r=a.readVarint()+a.pos,s=1,u=0,p=0,g=0,b=1/0,x=-1/0,T=1/0,k=-1/0;a.pos<r;){if(u<=0){var L=a.readVarint();s=7&L,u=L>>3}if(u--,s===1||s===2)(p+=a.readSVarint())<b&&(b=p),p>x&&(x=p),(g+=a.readSVarint())<T&&(T=g),g>k&&(k=g);else if(s!==7)throw new Error("unknown command "+s)}return[b,T,x,k]},Th.prototype.toGeoJSON=function(a,r,s){var u,p,g=this.extent*Math.pow(2,s),b=this.extent*a,x=this.extent*r,T=this.loadGeometry(),k=Th.types[this.type];function L(U){for(var $=0;$<U.length;$++){var X=U[$];U[$]=[360*(X.x+b)/g-180,360/Math.PI*Math.atan(Math.exp((180-360*(X.y+x)/g)*Math.PI/180))-90]}}switch(this.type){case 1:var O=[];for(u=0;u<T.length;u++)O[u]=T[u][0];L(T=O);break;case 2:for(u=0;u<T.length;u++)L(T[u]);break;case 3:for(T=function(U){var $=U.length;if($<=1)return[U];for(var X,nt,dt=[],yt=0;yt<$;yt++){var lt=B6(U[yt]);lt!==0&&(nt===void 0&&(nt=lt<0),nt===lt<0?(X&&dt.push(X),X=[U[yt]]):X.push(U[yt]))}return X&&dt.push(X),dt}(T),u=0;u<T.length;u++)for(p=0;p<T[u].length;p++)L(T[u][p])}T.length===1?T=T[0]:k="Multi"+k;var R={type:"Feature",geometry:{type:k,coordinates:T},properties:this.properties};return"id"in this&&(R.id=this.id),R};var F6=r2,i2=o2;function o2(a,r){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=a,this._keys=[],this._values=[],this._features=[],a.readFields(N6,this,r),this.length=this._features.length}function N6(a,r,s){a===15?r.version=s.readVarint():a===1?r.name=s.readString():a===5?r.extent=s.readVarint():a===2?r._features.push(s.pos):a===3?r._keys.push(s.readString()):a===4&&r._values.push(function(u){for(var p=null,g=u.readVarint()+u.pos;u.pos<g;){var b=u.readVarint()>>3;p=b===1?u.readString():b===2?u.readFloat():b===3?u.readDouble():b===4?u.readVarint64():b===5?u.readVarint():b===6?u.readSVarint():b===7?u.readBoolean():null}return p}(s))}o2.prototype.feature=function(a){if(a<0||a>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[a];var r=this._pbf.readVarint()+this._pbf.pos;return new F6(this._pbf,r,this.extent,this._keys,this._values)};var j6=i2;function U6(a,r,s){if(a===3){var u=new j6(s,s.readVarint()+s.pos);u.length&&(r[u.name]=u)}}var i1=Og.VectorTile=function(a,r){this.layers=a.readFields(U6,{},r)},Dg=Og.VectorTileFeature=r2;function Rg(a,r,s,u){const p=[],g=u===0?(b,x,T,k,L,O)=>{b.push(new et(O,T+(O-x)/(k-x)*(L-T)))}:(b,x,T,k,L,O)=>{b.push(new et(x+(O-T)/(L-T)*(k-x),O))};for(const b of a){const x=[];for(const T of b){if(T.length<=2)continue;const k=[];for(let R=0;R<T.length-1;R++){const U=T[R].x,$=T[R].y,X=T[R+1].x,nt=T[R+1].y,dt=u===0?U:$,yt=u===0?X:nt;dt<r?yt>r&&g(k,U,$,X,nt,r):dt>s?yt<s&&g(k,U,$,X,nt,s):k.push(T[R]),yt<r&&dt>=r&&g(k,U,$,X,nt,r),yt>s&&dt<=s&&g(k,U,$,X,nt,s)}let L=T[T.length-1];const O=u===0?L.x:L.y;O>=r&&O<=s&&k.push(L),k.length&&(L=k[k.length-1],k[0].x===L.x&&k[0].y===L.y||k.push(k[0]),x.push(k))}x.length&&p.push(x)}return p}Og.VectorTileLayer=i2;const $6=Dg.types,V6=Math.pow(2,13);function ep(a,r,s,u,p,g,b,x){a.emplaceBack((r<<1)+b,(s<<1)+g,(Math.floor(u*V6)<<1)+p,Math.round(x))}function np(a,r,s){a.emplaceBack(r.x,r.y,r.z,s[0]*16384,s[1]*16384,s[2]*16384)}class a2{constructor(){this.acc=new et(0,0),this.polyCount=[]}startRing(r){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new et(r.x,r.y),this.max=new et(r.x,r.y))}append(r,s){this.currentPolyCount.edges++,this.acc._add(r);const u=this.min,p=this.max;r.x<u.x?u.x=r.x:r.x>p.x&&(p.x=r.x),r.y<u.y?u.y=r.y:r.y>p.y&&(p.y=r.y),((r.x===0||r.x===bn)&&r.x===s.x)!=((r.y===0||r.y===bn)&&r.y===s.y)&&this.processBorderOverlap(r,s),s.x<0!=r.x<0&&this.addBorderIntersection(0,An(s.y,r.y,(0-s.x)/(r.x-s.x))),s.x>bn!=r.x>bn&&this.addBorderIntersection(1,An(s.y,r.y,(bn-s.x)/(r.x-s.x))),s.y<0!=r.y<0&&this.addBorderIntersection(2,An(s.x,r.x,(0-s.y)/(r.y-s.y))),s.y>bn!=r.y>bn&&this.addBorderIntersection(3,An(s.x,r.x,(bn-s.y)/(r.y-s.y)))}addBorderIntersection(r,s){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const u=this.borders[r];s<u[0]&&(u[0]=s),s>u[1]&&(u[1]=s)}processBorderOverlap(r,s){if(r.x===s.x){if(r.y===s.y)return;const u=r.x===0?0:1;this.addBorderIntersection(u,s.y),this.addBorderIntersection(u,r.y)}else{const u=r.y===0?2:3;this.addBorderIntersection(u,s.x),this.addBorderIntersection(u,r.x)}}centroid(){const r=this.polyCount.reduce((s,u)=>s+u.edges,0);return r!==0?this.acc.div(r)._round():new et(0,0)}span(){return new et(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((r,s)=>r+ +(s[0]!==Number.MAX_VALUE),0)}}class rp{constructor(r){this.zoom=r.zoom,this.canonical=r.canonical,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(s=>s.id),this.index=r.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=r.projection,this.layoutVertexArray=new yr,this.centroidVertexArray=new sw,this.indexArray=new po,this.programConfigurations=new td(r.layers,r.zoom),this.segments=new xi,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.enableTerrain=r.enableTerrain}populate(r,s,u,p){this.features=[],this.hasPattern=n1("fill-extrusion",this.layers,s),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(g){const b=Math.exp(Math.PI*(1-g.y/(1<<g.z)*2));return 80150034*b/(b*b+1)/bn/(1<<g.z)}(u),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:g,id:b,index:x,sourceLayerIndex:T}of r){const k=this.layers[0]._featureFilter.needGeometry,L=ad(g,k);if(!this.layers[0]._featureFilter.filter(new Ft(this.zoom),L,u))continue;const O={id:b,sourceLayerIndex:T,index:x,geometry:k?L.geometry:Hl(g,u,p),properties:g.properties,type:g.type,patterns:{}},R=this.layoutVertexArray.length;this.hasPattern?this.features.push(r1("fill-extrusion",this.layers,O,this.zoom,s)):this.addFeature(O,O.geometry,x,u,{},s.availableImages,p),s.featureIndex.insert(g,O.geometry,x,T,this.index,R)}this.sortBorders()}addFeatures(r,s,u,p,g){for(const b of this.features){const{geometry:x}=b;this.addFeature(b,x,b.index,s,u,p,g)}this.sortBorders()}update(r,s,u,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,s,this.stateDependentLayers,u,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,O6),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=r.createVertexBuffer(this.layoutVertexExtArray,z6.members,!0))),this.programConfigurations.upload(r),this.uploaded=!0}uploadCentroid(r){this.centroidVertexArray.length!==0&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=r.createVertexBuffer(this.centroidVertexArray,L6.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(r,s,u,p,g,b,x){const T=[new et(0,0),new et(bn,bn)],k=x.projection,L=k.name==="globe",O=this.enableTerrain&&!L?new a2:null,R=$6[r.type]==="Polygon";L&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Ia);const U=e1(s,500);for(let dt=U.length-1;dt>=0;dt--){const yt=U[dt];(yt.length===0||($=yt[0]).every(lt=>lt.x<=0)||$.every(lt=>lt.x>=bn)||$.every(lt=>lt.y<=0)||$.every(lt=>lt.y>=bn))&&U.splice(dt,1)}var $;let X;if(L)X=f2(U,T,p);else{X=[];for(const dt of U)X.push({polygon:dt,bounds:T})}const nt=R?this.edgeRadius:0;for(const{polygon:dt,bounds:yt}of X){let lt=0,_t=0;for(const xt of dt)R&&!xt[0].equals(xt[xt.length-1])&&xt.push(xt[0]),_t+=R?xt.length-1:xt.length;const Et=this.segments.prepareSegment((R?5:4)*_t,this.layoutVertexArray,this.indexArray);if(R){const xt=[],qt=[];lt=Et.vertexLength;for(const Qt of dt){let _e,Zt;Qt.length&&Qt!==dt[0]&&qt.push(xt.length/2),_e=Qt[1].sub(Qt[0])._perp()._unit();for(let ee=1;ee<Qt.length;ee++){const re=Qt[ee],de=Qt[ee===Qt.length-1?1:ee+1];let{x:ye,y:Yt}=re;if(nt){Zt=de.sub(re)._perp()._unit();const Pe=_e.add(Zt)._unit(),fn=nt*Math.min(4,1/(_e.x*Pe.x+_e.y*Pe.y));ye+=fn*Pe.x,Yt+=fn*Pe.y,_e=Zt}ep(this.layoutVertexArray,ye,Yt,0,0,1,1,0),Et.vertexLength++,xt.push(re.x,re.y),L&&np(this.layoutVertexExtArray,k.projectTilePoint(ye,Yt,p),k.upVector(p,ye,Yt))}}const $t=wh(xt,qt);for(let Qt=0;Qt<$t.length;Qt+=3)this.indexArray.emplaceBack(lt+$t[Qt],lt+$t[Qt+2],lt+$t[Qt+1]),Et.primitiveLength++}for(const xt of dt){O&&xt.length&&O.startRing(xt[0]);let qt,$t,Qt,_e=xt.length>4&&u2(xt[xt.length-2],xt[0],xt[1]),Zt=nt?G6(xt[xt.length-2],xt[0],xt[1],nt):0;$t=xt[1].sub(xt[0])._perp()._unit();let ee=!0;for(let re=1,de=0;re<xt.length;re++){let ye=xt[re-1],Yt=xt[re];const Pe=xt[re===xt.length-1?1:re+1];if(O&&R&&O.currentPolyCount.top++,c2(Yt,ye,yt)){nt&&($t=Pe.sub(Yt)._perp()._unit(),ee=!ee);continue}O&&O.append(Yt,ye);const fn=Yt.sub(ye)._perp(),Fe=fn.x/(Math.abs(fn.x)+Math.abs(fn.y)),Xe=fn.y>0?1:0,Le=ye.dist(Yt);if(de+Le>32768&&(de=0),nt){Qt=Pe.sub(Yt)._perp()._unit();let On=l2(ye,Yt,Pe,s2($t,Qt),nt);isNaN(On)&&(On=0);const yn=Yt.sub(ye)._unit();ye=ye.add(yn.mult(Zt))._round(),Yt=Yt.add(yn.mult(-On))._round(),Zt=On,$t=Qt}const mn=Et.vertexLength,jn=xt.length>4&&u2(ye,Yt,Pe);let Rn=d2(de,_e,ee);if(ep(this.layoutVertexArray,ye.x,ye.y,Fe,Xe,0,0,Rn),ep(this.layoutVertexArray,ye.x,ye.y,Fe,Xe,0,1,Rn),de+=Le,Rn=d2(de,jn,!ee),_e=jn,ep(this.layoutVertexArray,Yt.x,Yt.y,Fe,Xe,0,0,Rn),ep(this.layoutVertexArray,Yt.x,Yt.y,Fe,Xe,0,1,Rn),Et.vertexLength+=4,this.indexArray.emplaceBack(mn+0,mn+1,mn+2),this.indexArray.emplaceBack(mn+1,mn+3,mn+2),Et.primitiveLength+=2,nt){const On=lt+(re===1?xt.length-2:re-2),yn=re===1?lt:On+1;if(this.indexArray.emplaceBack(mn+1,On,mn+3),this.indexArray.emplaceBack(On,yn,mn+3),Et.primitiveLength+=2,qt===void 0&&(qt=mn),!c2(Pe,xt[re],yt)){const hr=re===xt.length-1?qt:Et.vertexLength;this.indexArray.emplaceBack(mn+2,mn+3,hr),this.indexArray.emplaceBack(mn+3,hr+1,hr),this.indexArray.emplaceBack(mn+3,yn,hr+1),Et.primitiveLength+=3}ee=!ee}if(L){const On=this.layoutVertexExtArray,yn=k.projectTilePoint(ye.x,ye.y,p),hr=k.projectTilePoint(Yt.x,Yt.y,p),Cn=k.upVector(p,ye.x,ye.y),Un=k.upVector(p,Yt.x,Yt.y);np(On,yn,Cn),np(On,yn,Cn),np(On,hr,Un),np(On,hr,Un)}}R&&(lt+=xt.length-1)}}if(O&&O.polyCount.length>0){if(O.borders){O.vertexArrayOffset=this.centroidVertexArray.length;const dt=O.borders,yt=this.featuresOnBorder.push(O)-1;for(let lt=0;lt<4;lt++)dt[lt][0]!==Number.MAX_VALUE&&this.borders[lt].push(yt)}this.encodeCentroid(O.borders?void 0:O.centroid(),O)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,u,g,b,p)}sortBorders(){for(let r=0;r<4;r++)this.borders[r].sort((s,u)=>this.featuresOnBorder[s].borders[r][0]-this.featuresOnBorder[u].borders[r][0])}encodeCentroid(r,s,u=!0){let p,g;if(r)if(r.y!==0){const x=s.span()._mult(this.tileToMeter);p=(Math.max(r.x,1)<<3)+Math.min(7,Math.round(x.x/10)),g=(Math.max(r.y,1)<<3)+Math.min(7,Math.round(x.y/10))}else p=Math.ceil(7*(r.x+450)),g=0;else p=0,g=+u;let b=u?this.centroidVertexArray.length:s.vertexArrayOffset;for(const x of s.polyCount){u&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*x.edges+x.top);for(let T=0;T<x.top;T++)this.centroidVertexArray.emplace(b++,p,g);for(let T=0;T<2*x.edges;T++)this.centroidVertexArray.emplace(b++,0,g),this.centroidVertexArray.emplace(b++,p,g)}}}function s2(a,r){const s=a.add(r)._unit();return a.x*s.x+a.y*s.y}function G6(a,r,s,u){const p=r.sub(a)._perp()._unit(),g=s.sub(r)._perp()._unit();return l2(a,r,s,s2(p,g),u)}function l2(a,r,s,u,p){const g=Math.sqrt(1-u*u);return Math.min(a.dist(r)/3,r.dist(s)/3,p*g/u)}function c2(a,r,s){return a.x<s[0].x&&r.x<s[0].x||a.x>s[1].x&&r.x>s[1].x||a.y<s[0].y&&r.y<s[0].y||a.y>s[1].y&&r.y>s[1].y}function u2(a,r,s){if(a.x<0||a.x>=bn||r.x<0||r.x>=bn||s.x<0||s.x>=bn)return!1;const u=s.sub(r),p=u.perp(),g=a.sub(r);return(u.x*g.x+u.y*g.y)/Math.sqrt((u.x*u.x+u.y*u.y)*(g.x*g.x+g.y*g.y))>-.866&&p.x*g.x+p.y*g.y<0}function d2(a,r,s){const u=r?2|a:-3&a;return s?1|u:-2&u}function h2(){const a=Math.PI/32,r=Math.tan(a),s=Yf;return s*Math.sqrt(1+2*r*r)-s}function f2(a,r,s){const u=1<<s.z,p=La(s.x/u),g=La((s.x+1)/u),b=mo(s.y/u),x=mo((s.y+1)/u);return function(T,k,L,O,R=0,U){const $=[];if(!T.length||!L||!O)return $;const X=(xt,qt)=>{for(const $t of xt)$.push({polygon:$t,bounds:qt})},nt=Math.ceil(Math.log2(L)),dt=Math.ceil(Math.log2(O)),yt=nt-dt,lt=[];for(let xt=0;xt<Math.abs(yt);xt++)lt.push(yt>0?0:1);for(let xt=0;xt<Math.min(nt,dt);xt++)lt.push(0),lt.push(1);let _t=T;if(_t=Rg(_t,k[0].y-R,k[1].y+R,1),_t=Rg(_t,k[0].x-R,k[1].x+R,0),!_t.length)return $;const Et=[];for(lt.length?Et.push({polygons:_t,bounds:k,depth:0}):X(_t,k);Et.length;){const xt=Et.pop(),qt=xt.depth,$t=lt[qt],Qt=xt.bounds[0],_e=xt.bounds[1],Zt=$t===0?Qt.x:Qt.y,ee=$t===0?_e.x:_e.y,re=U?U($t,Zt,ee):.5*(Zt+ee),de=Rg(xt.polygons,Zt-R,re+R,$t),ye=Rg(xt.polygons,re-R,ee+R,$t);if(de.length){const Yt=[Qt,new et($t===0?re:_e.x,$t===1?re:_e.y)];lt.length>qt+1?Et.push({polygons:de,bounds:Yt,depth:qt+1}):X(de,Yt)}if(ye.length){const Yt=[new et($t===0?re:Qt.x,$t===1?re:Qt.y),_e];lt.length>qt+1?Et.push({polygons:ye,bounds:Yt,depth:qt+1}):X(ye,Yt)}}return $}(a,r,Math.ceil((g-p)/11.25),Math.ceil((b-x)/11.25),1,(T,k,L)=>{if(T===0)return .5*(k+L);{const O=mo((s.y+k/bn)/u);return(il(.5*(mo((s.y+L/bn)/u)+O))*u-s.y)*bn}})}qe(rp,"FillExtrusionBucket",{omit:["layers","features"]}),qe(a2,"PartMetadata");const q6=new pe({"fill-extrusion-edge-radius":new Ot(Kt["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var H6={paint:new pe({"fill-extrusion-opacity":new Ot(Kt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Wt(Kt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ot(Kt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ot(Kt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Wt(Kt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Wt(Kt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Wt(Kt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Ot(Kt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Ot(Kt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Ot(Kt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"])}),layout:q6};function p2(a,r,s){var u=2*Math.PI*6378137/256/Math.pow(2,s);return[a*u-2*Math.PI*6378137/2,r*u-2*Math.PI*6378137/2]}class Bg{constructor(r,s,u){this.z=r,this.x=s,this.y=u,this.key=ip(0,r,r,s,u)}equals(r){return this.z===r.z&&this.x===r.x&&this.y===r.y}url(r,s){const u=function(g,b,x){var T=p2(256*g,256*(b=Math.pow(2,x)-b-1),x),k=p2(256*(g+1),256*(b+1),x);return T[0]+","+T[1]+","+k[0]+","+k[1]}(this.x,this.y,this.z),p=function(g,b,x){let T,k="";for(let L=g;L>0;L--)T=1<<L-1,k+=(b&T?1:0)+(x&T?2:0);return k}(this.z,this.x,this.y);return r[(this.x+this.y)%r.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(s==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",p).replace("{bbox-epsg-3857}",u)}toString(){return`${this.z}/${this.x}/${this.y}`}}class m2{constructor(r,s){this.wrap=r,this.canonical=s,this.key=ip(r,s.z,s.z,s.x,s.y)}}class Ro{constructor(r,s,u,p,g){this.overscaledZ=r,this.wrap=s,this.canonical=new Bg(u,+p,+g),this.key=s===0&&r===u?this.canonical.key:ip(s,r,u,p,g)}equals(r){return this.overscaledZ===r.overscaledZ&&this.wrap===r.wrap&&this.canonical.equals(r.canonical)}scaledTo(r){const s=this.canonical.z-r;return r>this.canonical.z?new Ro(r,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ro(r,this.wrap,r,this.canonical.x>>s,this.canonical.y>>s)}calculateScaledKey(r,s=!0){if(this.overscaledZ===r&&s)return this.key;if(r>this.canonical.z)return ip(this.wrap*+s,r,this.canonical.z,this.canonical.x,this.canonical.y);{const u=this.canonical.z-r;return ip(this.wrap*+s,r,r,this.canonical.x>>u,this.canonical.y>>u)}}isChildOf(r){if(r.wrap!==this.wrap)return!1;const s=this.canonical.z-r.canonical.z;return r.overscaledZ===0||r.overscaledZ<this.overscaledZ&&r.canonical.x===this.canonical.x>>s&&r.canonical.y===this.canonical.y>>s}children(r){if(this.overscaledZ>=r)return[new Ro(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const s=this.canonical.z+1,u=2*this.canonical.x,p=2*this.canonical.y;return[new Ro(s,this.wrap,s,u,p),new Ro(s,this.wrap,s,u+1,p),new Ro(s,this.wrap,s,u,p+1),new Ro(s,this.wrap,s,u+1,p+1)]}isLessThan(r){return this.wrap<r.wrap||!(this.wrap>r.wrap)&&(this.overscaledZ<r.overscaledZ||!(this.overscaledZ>r.overscaledZ)&&(this.canonical.x<r.canonical.x||!(this.canonical.x>r.canonical.x)&&this.canonical.y<r.canonical.y))}wrapped(){return new Ro(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(r){return new Ro(this.overscaledZ,r,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new m2(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function ip(a,r,s,u,p){const g=1<<Math.min(s,22);let b=g*(p%g)+u%g;return a&&s<22&&(b+=g*g*((a<0?-2*a-1:2*a)%(1<<2*(22-s)))),16*(32*b+s)+(r-s)}qe(Bg,"CanonicalTileID"),qe(Ro,"OverscaledTileID",{omit:["projMatrix"]});class kh extends et{constructor(r,s,u){super(r,s),this.z=u}}function op(a,r){return a.x*r.x+a.y*r.y}function g2(a,r){if(a.length===1){let s=0;const u=r[s++];let p;for(;!p||u.equals(p);)if(p=r[s++],!p)return 1/0;for(;s<r.length;s++){const g=r[s],b=a[0],x=p.sub(u),T=g.sub(u),k=b.sub(u),L=op(x,x),O=op(x,T),R=op(T,T),U=op(k,x),$=op(k,T),X=L*R-O*O,nt=(R*U-O*$)/X,dt=(L*$-O*U)/X,yt=u.z*(1-nt-dt)+p.z*nt+g.z*dt;if(isFinite(yt))return yt}return 1/0}{let s=1/0;for(const u of r)s=Math.min(s,u.z);return s}}function _2(a,r,s,u,p,g,b,x){const T=b*p.getElevationAt(a,r,!0,!0),k=g[0]!==0,L=k?g[1]===0?b*(g[0]/7-450):b*function(O,R,U){const $=Math.floor(R[0]/8),X=Math.floor(R[1]/8),nt=10*(R[0]-8*$),dt=10*(R[1]-8*X),yt=O.getElevationAt($,X,!0,!0),lt=O.getMeterToDEM(U),_t=Math.floor(.5*(nt*lt-1)),Et=Math.floor(.5*(dt*lt-1)),xt=O.tileCoordToPixel($,X),qt=2*_t+1,$t=2*Et+1,Qt=function(ye,Yt,Pe,fn,Fe){return[ye.getElevationAtPixel(Yt,Pe,!0),ye.getElevationAtPixel(Yt+Fe,Pe,!0),ye.getElevationAtPixel(Yt,Pe+Fe,!0),ye.getElevationAtPixel(Yt+fn,Pe+Fe,!0)]}(O,xt.x-_t,xt.y-Et,qt,$t),_e=Math.abs(Qt[0]-Qt[1]),Zt=Math.abs(Qt[2]-Qt[3]),ee=Math.abs(Qt[0]-Qt[2])+Math.abs(Qt[1]-Qt[3]),re=Math.min(.25,.5*lt*(_e+Zt)/qt),de=Math.min(.25,.5*lt*ee/$t);return yt+Math.max(re*nt,de*dt)}(p,g,x):T;return{base:T+(s===0)?-1:s,top:k?Math.max(L+u,T+s+2):T+u}}const W6=nn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:Z6}=W6,X6=nn([{name:"a_packed",components:4,type:"Float32"}]),{members:Y6}=X6,K6=Dg.types,J6=Math.cos(Math.PI/180*37.5);class Fg{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(s=>s.id),this.index=r.index,this.projection=r.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(s=>{this.gradients[s.id]={}}),this.layoutVertexArray=new Mr,this.layoutVertexArray2=new wr,this.indexArray=new po,this.programConfigurations=new td(r.layers,r.zoom),this.segments=new xi,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(r,s,u,p){this.hasPattern=n1("line",this.layers,s);const g=this.layers[0].layout.get("line-sort-key"),b=[];for(const{feature:L,id:O,index:R,sourceLayerIndex:U}of r){const $=this.layers[0]._featureFilter.needGeometry,X=ad(L,$);if(!this.layers[0]._featureFilter.filter(new Ft(this.zoom),X,u))continue;const nt=g?g.evaluate(X,{},u):void 0,dt={id:O,properties:L.properties,type:L.type,sourceLayerIndex:U,index:R,geometry:$?X.geometry:Hl(L,u,p),patterns:{},sortKey:nt};b.push(dt)}g&&b.sort((L,O)=>L.sortKey-O.sortKey);const{lineAtlas:x,featureIndex:T}=s,k=this.addConstantDashes(x);for(const L of b){const{geometry:O,index:R,sourceLayerIndex:U}=L;if(k&&this.addFeatureDashes(L,x),this.hasPattern){const $=r1("line",this.layers,L,this.zoom,s);this.patternFeatures.push($)}else this.addFeature(L,O,R,u,x.positions,s.availableImages);T.insert(r[R].feature,O,R,U,this.index)}}addConstantDashes(r){let s=!1;for(const u of this.layers){const p=u.paint.get("line-dasharray").value,g=u.layout.get("line-cap").value;if(p.kind!=="constant"||g.kind!=="constant")s=!0;else{const b=g.value,x=p.value;if(!x)continue;r.addDash(x,b)}}return s}addFeatureDashes(r,s){const u=this.zoom;for(const p of this.layers){const g=p.paint.get("line-dasharray").value,b=p.layout.get("line-cap").value;if(g.kind==="constant"&&b.kind==="constant")continue;let x,T;if(g.kind==="constant"){if(x=g.value,!x)continue}else x=g.evaluate({zoom:u},r);T=b.kind==="constant"?b.value:b.evaluate({zoom:u},r),s.addDash(x,T),r.patterns[p.id]=s.getKey(x,T)}}update(r,s,u,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,s,this.stateDependentLayers,u,p)}addFeatures(r,s,u,p,g){for(const b of this.patternFeatures)this.addFeature(b,b.geometry,b.index,s,u,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=r.createVertexBuffer(this.layoutVertexArray2,Y6)),this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,Z6),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(r){if(r.properties&&r.properties.hasOwnProperty("mapbox_clip_start")&&r.properties.hasOwnProperty("mapbox_clip_end"))return{start:+r.properties.mapbox_clip_start,end:+r.properties.mapbox_clip_end}}addFeature(r,s,u,p,g,b){const x=this.layers[0].layout,T=x.get("line-join").evaluate(r,{}),k=x.get("line-cap").evaluate(r,{}),L=x.get("line-miter-limit"),O=x.get("line-round-limit");this.lineClips=this.lineFeatureClips(r);for(const R of s)this.addLine(R,r,T,k,L,O);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,u,g,b,p)}addLine(r,s,u,p,g,b){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let dt=0;dt<r.length-1;dt++)this.totalDistance+=r[dt].dist(r[dt+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const x=K6[s.type]==="Polygon";let T=r.length;for(;T>=2&&r[T-1].equals(r[T-2]);)T--;let k=0;for(;k<T-1&&r[k].equals(r[k+1]);)k++;if(T<(x?3:2))return;u==="bevel"&&(g=1.05);const L=this.overscaling<=16?122880/(512*this.overscaling):0,O=this.segments.prepareSegment(10*T,this.layoutVertexArray,this.indexArray);let R,U,$,X,nt;this.e1=this.e2=-1,x&&(R=r[T-2],nt=r[k].sub(R)._unit()._perp());for(let dt=k;dt<T;dt++){if($=dt===T-1?x?r[k+1]:void 0:r[dt+1],$&&r[dt].equals($))continue;nt&&(X=nt),R&&(U=R),R=r[dt],nt=$?$.sub(R)._unit()._perp():X,X=X||nt;let yt=X.add(nt);yt.x===0&&yt.y===0||yt._unit();const lt=X.x*nt.x+X.y*nt.y,_t=yt.x*nt.x+yt.y*nt.y,Et=_t!==0?1/_t:1/0,xt=2*Math.sqrt(2-2*_t),qt=_t<J6&&U&&$,$t=X.x*nt.y-X.y*nt.x>0;if(qt&&dt>k){const Zt=R.dist(U);if(Zt>2*L){const ee=R.sub(R.sub(U)._mult(L/Zt)._round());this.updateDistance(U,ee),this.addCurrentVertex(ee,X,0,0,O),U=ee}}const Qt=U&&$;let _e=Qt?u:x?"butt":p;if(Qt&&_e==="round"&&(Et<b?_e="miter":Et<=2&&(_e="fakeround")),_e==="miter"&&Et>g&&(_e="bevel"),_e==="bevel"&&(Et>2&&(_e="flipbevel"),Et<g&&(_e="miter")),U&&this.updateDistance(U,R),_e==="miter")yt._mult(Et),this.addCurrentVertex(R,yt,0,0,O);else if(_e==="flipbevel"){if(Et>100)yt=nt.mult(-1);else{const Zt=Et*X.add(nt).mag()/X.sub(nt).mag();yt._perp()._mult(Zt*($t?-1:1))}this.addCurrentVertex(R,yt,0,0,O),this.addCurrentVertex(R,yt.mult(-1),0,0,O)}else if(_e==="bevel"||_e==="fakeround"){const Zt=-Math.sqrt(Et*Et-1),ee=$t?Zt:0,re=$t?0:Zt;if(U&&this.addCurrentVertex(R,X,ee,re,O),_e==="fakeround"){const de=Math.round(180*xt/Math.PI/20);for(let ye=1;ye<de;ye++){let Yt=ye/de;if(Yt!==.5){const fn=Yt-.5;Yt+=Yt*fn*(Yt-1)*((1.0904+lt*(lt*(3.55645-1.43519*lt)-3.2452))*fn*fn+(.848013+lt*(.215638*lt-1.06021)))}const Pe=nt.sub(X)._mult(Yt)._add(X)._unit()._mult($t?-1:1);this.addHalfVertex(R,Pe.x,Pe.y,!1,$t,0,O)}}$&&this.addCurrentVertex(R,nt,-ee,-re,O)}else if(_e==="butt")this.addCurrentVertex(R,yt,0,0,O);else if(_e==="square"){const Zt=U?1:-1;U||this.addCurrentVertex(R,yt,Zt,Zt,O),this.addCurrentVertex(R,yt,0,0,O),U&&this.addCurrentVertex(R,yt,Zt,Zt,O)}else _e==="round"&&(U&&(this.addCurrentVertex(R,X,0,0,O),this.addCurrentVertex(R,X,1,1,O,!0)),$&&(this.addCurrentVertex(R,nt,-1,-1,O,!0),this.addCurrentVertex(R,nt,0,0,O)));if(qt&&dt<T-1){const Zt=R.dist($);if(Zt>2*L){const ee=R.add($.sub(R)._mult(L/Zt)._round());this.updateDistance(R,ee),this.addCurrentVertex(ee,nt,0,0,O),R=ee}}}}addCurrentVertex(r,s,u,p,g,b=!1){const x=s.y*p-s.x,T=-s.y-s.x*p;this.addHalfVertex(r,s.x+s.y*u,s.y-s.x*u,b,!1,u,g),this.addHalfVertex(r,x,T,b,!0,-p,g)}addHalfVertex({x:r,y:s},u,p,g,b,x,T){this.layoutVertexArray.emplaceBack((r<<1)+(g?1:0),(s<<1)+(b?1:0),Math.round(63*u)+128,Math.round(63*p)+128,1+(x===0?0:x<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const k=T.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,k),T.primitiveLength++),b?this.e2=k:this.e1=k}updateScaledDistance(){if(this.lineClips){const r=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=r*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(r,s){this.distance+=r.dist(s),this.updateScaledDistance()}}qe(Fg,"LineBucket",{omit:["layers","patternFeatures"]});const Q6=new pe({"line-cap":new Wt(Kt.layout_line["line-cap"]),"line-join":new Wt(Kt.layout_line["line-join"]),"line-miter-limit":new Ot(Kt.layout_line["line-miter-limit"]),"line-round-limit":new Ot(Kt.layout_line["line-round-limit"]),"line-sort-key":new Wt(Kt.layout_line["line-sort-key"])});var y2={paint:new pe({"line-opacity":new Wt(Kt.paint_line["line-opacity"]),"line-color":new Wt(Kt.paint_line["line-color"]),"line-translate":new Ot(Kt.paint_line["line-translate"]),"line-translate-anchor":new Ot(Kt.paint_line["line-translate-anchor"]),"line-width":new Wt(Kt.paint_line["line-width"]),"line-gap-width":new Wt(Kt.paint_line["line-gap-width"]),"line-offset":new Wt(Kt.paint_line["line-offset"]),"line-blur":new Wt(Kt.paint_line["line-blur"]),"line-dasharray":new Wt(Kt.paint_line["line-dasharray"]),"line-pattern":new Wt(Kt.paint_line["line-pattern"]),"line-gradient":new ie(Kt.paint_line["line-gradient"]),"line-trim-offset":new Ot(Kt.paint_line["line-trim-offset"])}),layout:Q6};const b2=new class extends Wt{possiblyEvaluate(a,r){return r=new Ft(Math.floor(r.zoom),{now:r.now,fadeDuration:r.fadeDuration,transition:r.transition}),super.possiblyEvaluate(a,r)}evaluate(a,r,s,u){return r=Jn({},r,{zoom:Math.floor(r.zoom)}),super.evaluate(a,r,s,u)}}(y2.paint.properties["line-width"].specification);function v2(a,r){return r>0?r+2*a:a}b2.useIntegerZoom=!0;const tI=nn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),eI=nn([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),nI=nn([{name:"a_projected_pos",components:4,type:"Float32"}],4);nn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const rI=nn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),iI=nn([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);nn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const x2=nn([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),oI=nn([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);nn([{name:"triangle",components:3,type:"Uint16"}]),nn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),nn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),nn([{type:"Float32",name:"offsetX"}]),nn([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var _o=24;const ol=128;function o1(a,r){const{expression:s}=r;if(s.kind==="constant")return{kind:"constant",layoutSize:s.evaluate(new Ft(a+1))};if(s.kind==="source")return{kind:"source"};{const{zoomStops:u,interpolationType:p}=s;let g=0;for(;g<u.length&&u[g]<=a;)g++;g=Math.max(0,g-1);let b=g;for(;b<u.length&&u[b]<a+1;)b++;b=Math.min(u.length-1,b);const x=u[g],T=u[b];return s.kind==="composite"?{kind:"composite",minZoom:x,maxZoom:T,interpolationType:p}:{kind:"camera",minZoom:x,maxZoom:T,minSize:s.evaluate(new Ft(x)),maxSize:s.evaluate(new Ft(T)),interpolationType:p}}}function Ng(a,{uSize:r,uSizeT:s},{lowerSize:u,upperSize:p}){return a.kind==="source"?u/ol:a.kind==="composite"?An(u/ol,p/ol,s):r}function Ch(a,r){let s=0,u=0;if(a.kind==="constant")u=a.layoutSize;else if(a.kind!=="source"){const{interpolationType:p,minZoom:g,maxZoom:b}=a,x=p?se(Lo.interpolationFactor(p,r,g,b),0,1):0;a.kind==="camera"?u=An(a.minSize,a.maxSize,x):s=x}return{uSizeT:s,uSize:u}}var aI=Object.freeze({__proto__:null,getSizeData:o1,evaluateSizeForFeature:Ng,evaluateSizeForZoom:Ch,SIZE_PACK_FACTOR:ol});function sI(a,r,s){return a.sections.forEach(u=>{u.text=function(p,g,b){const x=g.layout.get("text-transform").evaluate(b,{});return x==="uppercase"?p=p.toLocaleUpperCase():x==="lowercase"&&(p=p.toLocaleLowerCase()),Mt.applyArabicShaping&&(p=Mt.applyArabicShaping(p)),p}(u.text,r,s)}),a}const ap={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"};function lI(a){return a==="\uFE36"||a==="\uFE48"||a==="\uFE38"||a==="\uFE44"||a==="\uFE42"||a==="\uFE3E"||a==="\uFE3C"||a==="\uFE3A"||a==="\uFE18"||a==="\uFE40"||a==="\uFE10"||a==="\uFE13"||a==="\uFE14"||a==="\uFF40"||a==="\uFFE3"||a==="\uFE11"||a==="\uFE12"}function cI(a){return a==="\uFE35"||a==="\uFE47"||a==="\uFE37"||a==="\uFE43"||a==="\uFE41"||a==="\uFE3D"||a==="\uFE3B"||a==="\uFE39"||a==="\uFE17"||a==="\uFE3F"}var sp=Ar,w2=function(a,r,s,u,p){var g,b,x=8*p-u-1,T=(1<<x)-1,k=T>>1,L=-7,O=s?p-1:0,R=s?-1:1,U=a[r+O];for(O+=R,g=U&(1<<-L)-1,U>>=-L,L+=x;L>0;g=256*g+a[r+O],O+=R,L-=8);for(b=g&(1<<-L)-1,g>>=-L,L+=u;L>0;b=256*b+a[r+O],O+=R,L-=8);if(g===0)g=1-k;else{if(g===T)return b?NaN:1/0*(U?-1:1);b+=Math.pow(2,u),g-=k}return(U?-1:1)*b*Math.pow(2,g-u)},E2=function(a,r,s,u,p,g){var b,x,T,k=8*g-p-1,L=(1<<k)-1,O=L>>1,R=p===23?Math.pow(2,-24)-Math.pow(2,-77):0,U=u?0:g-1,$=u?1:-1,X=r<0||r===0&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(x=isNaN(r)?1:0,b=L):(b=Math.floor(Math.log(r)/Math.LN2),r*(T=Math.pow(2,-b))<1&&(b--,T*=2),(r+=b+O>=1?R/T:R*Math.pow(2,1-O))*T>=2&&(b++,T/=2),b+O>=L?(x=0,b=L):b+O>=1?(x=(r*T-1)*Math.pow(2,p),b+=O):(x=r*Math.pow(2,O-1)*Math.pow(2,p),b=0));p>=8;a[s+U]=255&x,U+=$,x/=256,p-=8);for(b=b<<p|x,k+=p;k>0;a[s+U]=255&b,U+=$,b/=256,k-=8);a[s+U-$]|=128*X};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function Ar(a){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(a)?a:new Uint8Array(a||0),this.pos=0,this.type=0,this.length=this.buf.length}Ar.Varint=0,Ar.Fixed64=1,Ar.Bytes=2,Ar.Fixed32=5;var a1=4294967296,T2=1/a1,k2=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");function Zl(a){return a.type===Ar.Bytes?a.readVarint()+a.pos:a.pos+1}function Sh(a,r,s){return s?4294967296*r+(a>>>0):4294967296*(r>>>0)+(a>>>0)}function C2(a,r,s){var u=r<=16383?1:r<=2097151?2:r<=268435455?3:Math.floor(Math.log(r)/(7*Math.LN2));s.realloc(u);for(var p=s.pos-1;p>=a;p--)s.buf[p+u]=s.buf[p]}function uI(a,r){for(var s=0;s<a.length;s++)r.writeVarint(a[s])}function dI(a,r){for(var s=0;s<a.length;s++)r.writeSVarint(a[s])}function hI(a,r){for(var s=0;s<a.length;s++)r.writeFloat(a[s])}function fI(a,r){for(var s=0;s<a.length;s++)r.writeDouble(a[s])}function pI(a,r){for(var s=0;s<a.length;s++)r.writeBoolean(a[s])}function mI(a,r){for(var s=0;s<a.length;s++)r.writeFixed32(a[s])}function gI(a,r){for(var s=0;s<a.length;s++)r.writeSFixed32(a[s])}function _I(a,r){for(var s=0;s<a.length;s++)r.writeFixed64(a[s])}function yI(a,r){for(var s=0;s<a.length;s++)r.writeSFixed64(a[s])}function jg(a,r){return(a[r]|a[r+1]<<8|a[r+2]<<16)+16777216*a[r+3]}function Mh(a,r,s){a[s]=r,a[s+1]=r>>>8,a[s+2]=r>>>16,a[s+3]=r>>>24}function S2(a,r){return(a[r]|a[r+1]<<8|a[r+2]<<16)+(a[r+3]<<24)}function bI(a,r,s){r.glyphs=[],a===1&&s.readMessage(vI,r)}function vI(a,r,s){if(a===3){const{id:u,bitmap:p,width:g,height:b,left:x,top:T,advance:k}=s.readMessage(xI,{});r.glyphs.push({id:u,bitmap:new Wl({width:g+6,height:b+6},p),metrics:{width:g,height:b,left:x,top:T,advance:k}})}else a===4?r.ascender=s.readSVarint():a===5&&(r.descender=s.readSVarint())}function xI(a,r,s){a===1?r.id=s.readVarint():a===2?r.bitmap=s.readBytes():a===3?r.width=s.readVarint():a===4?r.height=s.readVarint():a===5?r.left=s.readSVarint():a===6?r.top=s.readSVarint():a===7&&(r.advance=s.readVarint())}function s1(a){let r=0,s=0;for(const b of a)r+=b.w*b.h,s=Math.max(s,b.w);a.sort((b,x)=>x.h-b.h);const u=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(r/.95)),s),h:1/0}];let p=0,g=0;for(const b of a)for(let x=u.length-1;x>=0;x--){const T=u[x];if(!(b.w>T.w||b.h>T.h)){if(b.x=T.x,b.y=T.y,g=Math.max(g,b.y+b.h),p=Math.max(p,b.x+b.w),b.w===T.w&&b.h===T.h){const k=u.pop();x<u.length&&(u[x]=k)}else b.h===T.h?(T.x+=b.w,T.w-=b.w):b.w===T.w?(T.y+=b.h,T.h-=b.h):(u.push({x:T.x+b.w,y:T.y,w:T.w-b.w,h:b.h}),T.y+=b.h,T.h-=b.h);break}}return{w:p,h:g,fill:r/(p*g)||0}}Ar.prototype={destroy:function(){this.buf=null},readFields:function(a,r,s){for(s=s||this.length;this.pos<s;){var u=this.readVarint(),p=u>>3,g=this.pos;this.type=7&u,a(p,r,this),this.pos===g&&this.skip(u)}return r},readMessage:function(a,r){return this.readFields(a,r,this.readVarint()+this.pos)},readFixed32:function(){var a=jg(this.buf,this.pos);return this.pos+=4,a},readSFixed32:function(){var a=S2(this.buf,this.pos);return this.pos+=4,a},readFixed64:function(){var a=jg(this.buf,this.pos)+jg(this.buf,this.pos+4)*a1;return this.pos+=8,a},readSFixed64:function(){var a=jg(this.buf,this.pos)+S2(this.buf,this.pos+4)*a1;return this.pos+=8,a},readFloat:function(){var a=w2(this.buf,this.pos,!0,23,4);return this.pos+=4,a},readDouble:function(){var a=w2(this.buf,this.pos,!0,52,8);return this.pos+=8,a},readVarint:function(a){var r,s,u=this.buf;return r=127&(s=u[this.pos++]),s<128?r:(r|=(127&(s=u[this.pos++]))<<7,s<128?r:(r|=(127&(s=u[this.pos++]))<<14,s<128?r:(r|=(127&(s=u[this.pos++]))<<21,s<128?r:function(p,g,b){var x,T,k=b.buf;if(x=(112&(T=k[b.pos++]))>>4,T<128||(x|=(127&(T=k[b.pos++]))<<3,T<128)||(x|=(127&(T=k[b.pos++]))<<10,T<128)||(x|=(127&(T=k[b.pos++]))<<17,T<128)||(x|=(127&(T=k[b.pos++]))<<24,T<128)||(x|=(1&(T=k[b.pos++]))<<31,T<128))return Sh(p,x,g);throw new Error("Expected varint not more than 10 bytes")}(r|=(15&(s=u[this.pos]))<<28,a,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var a=this.readVarint();return a%2==1?(a+1)/-2:a/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var a=this.readVarint()+this.pos,r=this.pos;return this.pos=a,a-r>=12&&k2?function(s,u,p){return k2.decode(s.subarray(u,p))}(this.buf,r,a):function(s,u,p){for(var g="",b=u;b<p;){var x,T,k,L=s[b],O=null,R=L>239?4:L>223?3:L>191?2:1;if(b+R>p)break;R===1?L<128&&(O=L):R===2?(192&(x=s[b+1]))==128&&(O=(31&L)<<6|63&x)<=127&&(O=null):R===3?(T=s[b+2],(192&(x=s[b+1]))==128&&(192&T)==128&&((O=(15&L)<<12|(63&x)<<6|63&T)<=2047||O>=55296&&O<=57343)&&(O=null)):R===4&&(T=s[b+2],k=s[b+3],(192&(x=s[b+1]))==128&&(192&T)==128&&(192&k)==128&&((O=(15&L)<<18|(63&x)<<12|(63&T)<<6|63&k)<=65535||O>=1114112)&&(O=null)),O===null?(O=65533,R=1):O>65535&&(O-=65536,g+=String.fromCharCode(O>>>10&1023|55296),O=56320|1023&O),g+=String.fromCharCode(O),b+=R}return g}(this.buf,r,a)},readBytes:function(){var a=this.readVarint()+this.pos,r=this.buf.subarray(this.pos,a);return this.pos=a,r},readPackedVarint:function(a,r){if(this.type!==Ar.Bytes)return a.push(this.readVarint(r));var s=Zl(this);for(a=a||[];this.pos<s;)a.push(this.readVarint(r));return a},readPackedSVarint:function(a){if(this.type!==Ar.Bytes)return a.push(this.readSVarint());var r=Zl(this);for(a=a||[];this.pos<r;)a.push(this.readSVarint());return a},readPackedBoolean:function(a){if(this.type!==Ar.Bytes)return a.push(this.readBoolean());var r=Zl(this);for(a=a||[];this.pos<r;)a.push(this.readBoolean());return a},readPackedFloat:function(a){if(this.type!==Ar.Bytes)return a.push(this.readFloat());var r=Zl(this);for(a=a||[];this.pos<r;)a.push(this.readFloat());return a},readPackedDouble:function(a){if(this.type!==Ar.Bytes)return a.push(this.readDouble());var r=Zl(this);for(a=a||[];this.pos<r;)a.push(this.readDouble());return a},readPackedFixed32:function(a){if(this.type!==Ar.Bytes)return a.push(this.readFixed32());var r=Zl(this);for(a=a||[];this.pos<r;)a.push(this.readFixed32());return a},readPackedSFixed32:function(a){if(this.type!==Ar.Bytes)return a.push(this.readSFixed32());var r=Zl(this);for(a=a||[];this.pos<r;)a.push(this.readSFixed32());return a},readPackedFixed64:function(a){if(this.type!==Ar.Bytes)return a.push(this.readFixed64());var r=Zl(this);for(a=a||[];this.pos<r;)a.push(this.readFixed64());return a},readPackedSFixed64:function(a){if(this.type!==Ar.Bytes)return a.push(this.readSFixed64());var r=Zl(this);for(a=a||[];this.pos<r;)a.push(this.readSFixed64());return a},skip:function(a){var r=7&a;if(r===Ar.Varint)for(;this.buf[this.pos++]>127;);else if(r===Ar.Bytes)this.pos=this.readVarint()+this.pos;else if(r===Ar.Fixed32)this.pos+=4;else{if(r!==Ar.Fixed64)throw new Error("Unimplemented type: "+r);this.pos+=8}},writeTag:function(a,r){this.writeVarint(a<<3|r)},realloc:function(a){for(var r=this.length||16;r<this.pos+a;)r*=2;if(r!==this.length){var s=new Uint8Array(r);s.set(this.buf),this.buf=s,this.length=r}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(a){this.realloc(4),Mh(this.buf,a,this.pos),this.pos+=4},writeSFixed32:function(a){this.realloc(4),Mh(this.buf,a,this.pos),this.pos+=4},writeFixed64:function(a){this.realloc(8),Mh(this.buf,-1&a,this.pos),Mh(this.buf,Math.floor(a*T2),this.pos+4),this.pos+=8},writeSFixed64:function(a){this.realloc(8),Mh(this.buf,-1&a,this.pos),Mh(this.buf,Math.floor(a*T2),this.pos+4),this.pos+=8},writeVarint:function(a){(a=+a||0)>268435455||a<0?function(r,s){var u,p;if(r>=0?(u=r%4294967296|0,p=r/4294967296|0):(p=~(-r/4294967296),4294967295^(u=~(-r%4294967296))?u=u+1|0:(u=0,p=p+1|0)),r>=0xffffffffffffffff||r<-0xffffffffffffffff)throw new Error("Given varint doesn't fit into 10 bytes");s.realloc(10),function(g,b,x){x.buf[x.pos++]=127&g|128,g>>>=7,x.buf[x.pos++]=127&g|128,g>>>=7,x.buf[x.pos++]=127&g|128,g>>>=7,x.buf[x.pos++]=127&g|128,x.buf[x.pos]=127&(g>>>=7)}(u,0,s),function(g,b){var x=(7&g)<<4;b.buf[b.pos++]|=x|((g>>>=3)?128:0),g&&(b.buf[b.pos++]=127&g|((g>>>=7)?128:0),g&&(b.buf[b.pos++]=127&g|((g>>>=7)?128:0),g&&(b.buf[b.pos++]=127&g|((g>>>=7)?128:0),g&&(b.buf[b.pos++]=127&g|((g>>>=7)?128:0),g&&(b.buf[b.pos++]=127&g)))))}(p,s)}(a,this):(this.realloc(4),this.buf[this.pos++]=127&a|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=a>>>7&127))))},writeSVarint:function(a){this.writeVarint(a<0?2*-a-1:2*a)},writeBoolean:function(a){this.writeVarint(Boolean(a))},writeString:function(a){a=String(a),this.realloc(4*a.length),this.pos++;var r=this.pos;this.pos=function(u,p,g){for(var b,x,T=0;T<p.length;T++){if((b=p.charCodeAt(T))>55295&&b<57344){if(!x){b>56319||T+1===p.length?(u[g++]=239,u[g++]=191,u[g++]=189):x=b;continue}if(b<56320){u[g++]=239,u[g++]=191,u[g++]=189,x=b;continue}b=x-55296<<10|b-56320|65536,x=null}else x&&(u[g++]=239,u[g++]=191,u[g++]=189,x=null);b<128?u[g++]=b:(b<2048?u[g++]=b>>6|192:(b<65536?u[g++]=b>>12|224:(u[g++]=b>>18|240,u[g++]=b>>12&63|128),u[g++]=b>>6&63|128),u[g++]=63&b|128)}return g}(this.buf,a,this.pos);var s=this.pos-r;s>=128&&C2(r,s,this),this.pos=r-1,this.writeVarint(s),this.pos+=s},writeFloat:function(a){this.realloc(4),E2(this.buf,a,this.pos,!0,23,4),this.pos+=4},writeDouble:function(a){this.realloc(8),E2(this.buf,a,this.pos,!0,52,8),this.pos+=8},writeBytes:function(a){var r=a.length;this.writeVarint(r),this.realloc(r);for(var s=0;s<r;s++)this.buf[this.pos++]=a[s]},writeRawMessage:function(a,r){this.pos++;var s=this.pos;a(r,this);var u=this.pos-s;u>=128&&C2(s,u,this),this.pos=s-1,this.writeVarint(u),this.pos+=u},writeMessage:function(a,r,s){this.writeTag(a,Ar.Bytes),this.writeRawMessage(r,s)},writePackedVarint:function(a,r){r.length&&this.writeMessage(a,uI,r)},writePackedSVarint:function(a,r){r.length&&this.writeMessage(a,dI,r)},writePackedBoolean:function(a,r){r.length&&this.writeMessage(a,pI,r)},writePackedFloat:function(a,r){r.length&&this.writeMessage(a,hI,r)},writePackedDouble:function(a,r){r.length&&this.writeMessage(a,fI,r)},writePackedFixed32:function(a,r){r.length&&this.writeMessage(a,mI,r)},writePackedSFixed32:function(a,r){r.length&&this.writeMessage(a,gI,r)},writePackedFixed64:function(a,r){r.length&&this.writeMessage(a,_I,r)},writePackedSFixed64:function(a,r){r.length&&this.writeMessage(a,yI,r)},writeBytesField:function(a,r){this.writeTag(a,Ar.Bytes),this.writeBytes(r)},writeFixed32Field:function(a,r){this.writeTag(a,Ar.Fixed32),this.writeFixed32(r)},writeSFixed32Field:function(a,r){this.writeTag(a,Ar.Fixed32),this.writeSFixed32(r)},writeFixed64Field:function(a,r){this.writeTag(a,Ar.Fixed64),this.writeFixed64(r)},writeSFixed64Field:function(a,r){this.writeTag(a,Ar.Fixed64),this.writeSFixed64(r)},writeVarintField:function(a,r){this.writeTag(a,Ar.Varint),this.writeVarint(r)},writeSVarintField:function(a,r){this.writeTag(a,Ar.Varint),this.writeSVarint(r)},writeStringField:function(a,r){this.writeTag(a,Ar.Bytes),this.writeString(r)},writeFloatField:function(a,r){this.writeTag(a,Ar.Fixed32),this.writeFloat(r)},writeDoubleField:function(a,r){this.writeTag(a,Ar.Fixed64),this.writeDouble(r)},writeBooleanField:function(a,r){this.writeVarintField(a,Boolean(r))}};class l1{constructor(r,{pixelRatio:s,version:u,stretchX:p,stretchY:g,content:b}){this.paddedRect=r,this.pixelRatio=s,this.stretchX=p,this.stretchY=g,this.content=b,this.version=u}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class M2{constructor(r,s){const u={},p={};this.haveRenderCallbacks=[];const g=[];this.addImages(r,u,g),this.addImages(s,p,g);const{w:b,h:x}=s1(g),T=new ha({width:b||1,height:x||1});for(const k in r){const L=r[k],O=u[k].paddedRect;ha.copy(L.data,T,{x:0,y:0},{x:O.x+1,y:O.y+1},L.data)}for(const k in s){const L=s[k],O=p[k].paddedRect,R=O.x+1,U=O.y+1,$=L.data.width,X=L.data.height;ha.copy(L.data,T,{x:0,y:0},{x:R,y:U},L.data),ha.copy(L.data,T,{x:0,y:X-1},{x:R,y:U-1},{width:$,height:1}),ha.copy(L.data,T,{x:0,y:0},{x:R,y:U+X},{width:$,height:1}),ha.copy(L.data,T,{x:$-1,y:0},{x:R-1,y:U},{width:1,height:X}),ha.copy(L.data,T,{x:0,y:0},{x:R+$,y:U},{width:1,height:X})}this.image=T,this.iconPositions=u,this.patternPositions=p}addImages(r,s,u){for(const p in r){const g=r[p],b={x:0,y:0,w:g.data.width+2,h:g.data.height+2};u.push(b),s[p]=new l1(b,g),g.hasRenderCallback&&this.haveRenderCallbacks.push(p)}}patchUpdatedImages(r,s){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(u=>r.hasImage(u)),r.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const u in r.updatedImages)this.patchUpdatedImage(this.iconPositions[u],r.getImage(u),s),this.patchUpdatedImage(this.patternPositions[u],r.getImage(u),s)}patchUpdatedImage(r,s,u){if(!r||!s||r.version===s.version)return;r.version=s.version;const[p,g]=r.tl;u.update(s.data,void 0,{x:p,y:g})}}qe(l1,"ImagePosition"),qe(M2,"ImageAtlas");const za={horizontal:1,vertical:2,horizontalOnly:3};class lp{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(r,s){const u=new lp;return u.scale=r||1,u.fontStack=s,u}static forImage(r){const s=new lp;return s.imageName=r,s}}class Ah{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(r,s){const u=new Ah;for(let p=0;p<r.sections.length;p++){const g=r.sections[p];g.image?u.addImageSection(g):u.addTextSection(g,s)}return u}length(){return this.text.length}getSection(r){return this.sections[this.sectionIndex[r]]}getSections(){return this.sections}getSectionIndex(r){return this.sectionIndex[r]}getCharCode(r){return this.text.charCodeAt(r)}verticalizePunctuation(r){this.text=function(s,u){let p="";for(let g=0;g<s.length;g++){const b=s.charCodeAt(g+1)||null,x=s.charCodeAt(g-1)||null;p+=!u&&(b&&z(b)&&!ap[s[g+1]]||x&&z(x)&&!ap[s[g-1]])||!ap[s[g]]?s[g]:ap[s[g]]}return p}(this.text,r)}trim(){let r=0;for(let u=0;u<this.text.length&&Ug[this.text.charCodeAt(u)];u++)r++;let s=this.text.length;for(let u=this.text.length-1;u>=0&&u>=r&&Ug[this.text.charCodeAt(u)];u--)s--;this.text=this.text.substring(r,s),this.sectionIndex=this.sectionIndex.slice(r,s)}substring(r,s){const u=new Ah;return u.text=this.text.substring(r,s),u.sectionIndex=this.sectionIndex.slice(r,s),u.sections=this.sections,u}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((r,s)=>Math.max(r,this.sections[s].scale),0)}addTextSection(r,s){this.text+=r.text,this.sections.push(lp.forText(r.scale,r.fontStack||s));const u=this.sections.length-1;for(let p=0;p<r.text.length;++p)this.sectionIndex.push(u)}addImageSection(r){const s=r.image?r.image.name:"";if(s.length===0)return void Qe("Can't add FormattedSection with an empty image.");const u=this.getNextImageSectionCharCode();u?(this.text+=String.fromCharCode(u),this.sections.push(lp.forImage(s)),this.sectionIndex.push(this.sections.length-1)):Qe("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function c1(a,r,s,u,p,g,b,x,T,k,L,O,R,U,$){const X=Ah.fromFeature(a,p);O===za.vertical&&X.verticalizePunctuation(R);let nt=[];const dt=function(xt,qt,$t,Qt,_e,Zt){if(!xt)return[];const ee=[],re=function(Pe,fn,Fe,Xe,Le,mn){let jn=0;for(let Rn=0;Rn<Pe.length();Rn++){const On=Pe.getSection(Rn);jn+=A2(Pe.getCharCode(Rn),On,Xe,Le,fn,mn)}return jn/Math.max(1,Math.ceil(jn/Fe))}(xt,qt,$t,Qt,_e,Zt),de=xt.text.indexOf("\u200B")>=0;let ye=0;for(let Pe=0;Pe<xt.length();Pe++){const fn=xt.getSection(Pe),Fe=xt.getCharCode(Pe);if(Ug[Fe]||(ye+=A2(Fe,fn,Qt,_e,qt,Zt)),Pe<xt.length()-1){const Xe=!((Yt=Fe)<11904||!(lg(Yt)||fh(Yt)||m(Yt)||gg(Yt)||dg(Yt)||sg(Yt)||cg(Yt)||Ku(Yt)||hg(Yt)||Ff(Yt)||ug(Yt)||_(Yt)||hh(Yt)||Rf(Yt)||Df(Yt)||Bf(Yt)||Bc(Yt)||Ju(Yt)||pg(Yt)||fg(Yt)));(wI[Fe]||Xe||fn.imageName)&&ee.push(P2(Pe+1,ye,re,ee,EI(Fe,xt.getCharCode(Pe+1),Xe&&de),!1))}}var Yt;return L2(P2(xt.length(),ye,re,ee,0,!0))}(X,k,g,r,u,U),{processBidirectionalText:yt,processStyledBidirectionalText:lt}=Mt;if(yt&&X.sections.length===1){const xt=yt(X.toString(),dt);for(const qt of xt){const $t=new Ah;$t.text=qt,$t.sections=X.sections;for(let Qt=0;Qt<qt.length;Qt++)$t.sectionIndex.push(0);nt.push($t)}}else if(lt){const xt=lt(X.text,X.sectionIndex,dt);for(const qt of xt){const $t=new Ah;$t.text=qt[0],$t.sectionIndex=qt[1],$t.sections=X.sections,nt.push($t)}}else nt=function(xt,qt){const $t=[],Qt=xt.text;let _e=0;for(const Zt of qt)$t.push(xt.substring(_e,Zt)),_e=Zt;return _e<Qt.length&&$t.push(xt.substring(_e,Qt.length)),$t}(X,dt);const _t=[],Et={positionedLines:_t,text:X.toString(),top:L[1],bottom:L[1],left:L[0],right:L[0],writingMode:O,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(xt,qt,$t,Qt,_e,Zt,ee,re,de,ye,Yt,Pe){let fn=0,Fe=0,Xe=0;const Le=re==="right"?1:re==="left"?0:.5;let mn=!1;for(const Cn of _e){const Un=Cn.getSections();for(const br of Un){if(br.imageName)continue;const Or=qt[br.fontStack];if(Or&&(mn=Or.ascender!==void 0&&Or.descender!==void 0,!mn))break}if(!mn)break}let jn=0;for(const Cn of _e){Cn.trim();const Un=Cn.getMaxScale(),br=(Un-1)*_o,Or={positionedGlyphs:[],lineOffset:0};xt.positionedLines[jn]=Or;const Ir=Or.positionedGlyphs;let Dr=0;if(!Cn.length()){Fe+=Zt,++jn;continue}let Nr=0,li=0;for(let fr=0;fr<Cn.length();fr++){const Ci=Cn.getSection(fr),Ei=Cn.getSectionIndex(fr),or=Cn.getCharCode(fr);let Hr=Ci.scale,zi=null,vr=null,_i=null,Co=_o,no=0;const ro=!(de===za.horizontal||!Yt&&!I(or)||Yt&&(Ug[or]||(Rn=or,Yu(Rn)||ag(Rn)||Of(Rn)||ph(Rn)||h(Rn))));if(Ci.imageName){const Bo=Qt[Ci.imageName];if(!Bo)continue;_i=Ci.imageName,xt.iconsInText=xt.iconsInText||!0,vr=Bo.paddedRect;const io=Bo.displaySize;Hr=Hr*_o/Pe,zi={width:io[0],height:io[1],left:1,top:-3,advance:ro?io[1]:io[0],localGlyph:!1},no=mn?-zi.height*Hr:Un*_o-17-io[1]*Hr,Co=zi.advance;const Yl=(ro?io[0]:io[1])*Hr-_o*Un;Yl>0&&Yl>Dr&&(Dr=Yl)}else{const Bo=$t[Ci.fontStack];if(!Bo)continue;Bo[or]&&(vr=Bo[or]);const io=qt[Ci.fontStack];if(!io)continue;const Yl=io.glyphs[or];if(!Yl)continue;if(zi=Yl.metrics,Co=or!==8203?_o:0,mn){const Oh=io.ascender!==void 0?Math.abs(io.ascender):0,gp=io.descender!==void 0?Math.abs(io.descender):0,_p=(Oh+gp)*Hr;Nr<_p&&(Nr=_p,li=(Oh-gp)/2*Hr),no=-Oh*Hr}else no=(Un-Hr)*_o-17}ro?(xt.verticalizable=!0,Ir.push({glyph:or,imageName:_i,x:fn,y:Fe+no,vertical:ro,scale:Hr,localGlyph:zi.localGlyph,fontStack:Ci.fontStack,sectionIndex:Ei,metrics:zi,rect:vr}),fn+=Co*Hr+ye):(Ir.push({glyph:or,imageName:_i,x:fn,y:Fe+no,vertical:ro,scale:Hr,localGlyph:zi.localGlyph,fontStack:Ci.fontStack,sectionIndex:Ei,metrics:zi,rect:vr}),fn+=zi.advance*Hr+ye)}Ir.length!==0&&(Xe=Math.max(fn-ye,Xe),mn?z2(Ir,Le,Dr,li,Zt*Un/2):z2(Ir,Le,Dr,0,Zt/2)),fn=0;const eo=Zt*Un+Dr;Or.lineOffset=Math.max(Dr,br),Fe+=eo,++jn}var Rn;const On=Fe,{horizontalAlign:yn,verticalAlign:hr}=u1(ee);(function(Cn,Un,br,Or,Ir,Dr){const Nr=(Un-br)*Ir,li=-Dr*Or;for(const eo of Cn)for(const fr of eo.positionedGlyphs)fr.x+=Nr,fr.y+=li})(xt.positionedLines,Le,yn,hr,Xe,On),xt.top+=-hr*On,xt.bottom=xt.top+On,xt.left+=-yn*Xe,xt.right=xt.left+Xe,xt.hasBaseline=mn}(Et,r,s,u,nt,b,x,T,O,k,R,$),!function(xt){for(const qt of xt)if(qt.positionedGlyphs.length!==0)return!1;return!0}(_t)&&Et}const Ug={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},wI={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function A2(a,r,s,u,p,g){if(r.imageName){const b=u[r.imageName];return b?b.displaySize[0]*r.scale*_o/g+p:0}{const b=s[r.fontStack],x=b&&b.glyphs[a];return x?x.metrics.advance*r.scale+p:0}}function I2(a,r,s,u){const p=Math.pow(a-r,2);return u?a<r?p/2:2*p:p+Math.abs(s)*s}function EI(a,r,s){let u=0;return a===10&&(u-=1e4),s&&(u+=150),a!==40&&a!==65288||(u+=50),r!==41&&r!==65289||(u+=50),u}function P2(a,r,s,u,p,g){let b=null,x=I2(r,s,p,g);for(const T of u){const k=I2(r-T.x,s,p,g)+T.badness;k<=x&&(b=T,x=k)}return{index:a,x:r,priorBreak:b,badness:x}}function L2(a){return a?L2(a.priorBreak).concat(a.index):[]}function u1(a){let r=.5,s=.5;switch(a){case"right":case"top-right":case"bottom-right":r=1;break;case"left":case"top-left":case"bottom-left":r=0}switch(a){case"bottom":case"bottom-right":case"bottom-left":s=1;break;case"top":case"top-right":case"top-left":s=0}return{horizontalAlign:r,verticalAlign:s}}function z2(a,r,s,u,p){if(!(r||s||u||p))return;const g=a.length-1,b=a[g],x=(b.x+b.metrics.advance*b.scale)*r;for(let T=0;T<=g;T++)a[T].x-=x,a[T].y+=s+u+p}function TI(a,r,s){const{horizontalAlign:u,verticalAlign:p}=u1(s),g=r[0]-a.displaySize[0]*u,b=r[1]-a.displaySize[1]*p;return{image:a,top:b,bottom:b+a.displaySize[1],left:g,right:g+a.displaySize[0]}}function O2(a,r,s,u,p,g){const b=a.image;let x;if(b.content){const nt=b.content,dt=b.pixelRatio||1;x=[nt[0]/dt,nt[1]/dt,b.displaySize[0]-nt[2]/dt,b.displaySize[1]-nt[3]/dt]}const T=r.left*g,k=r.right*g;let L,O,R,U;s==="width"||s==="both"?(U=p[0]+T-u[3],O=p[0]+k+u[1]):(U=p[0]+(T+k-b.displaySize[0])/2,O=U+b.displaySize[0]);const $=r.top*g,X=r.bottom*g;return s==="height"||s==="both"?(L=p[1]+$-u[0],R=p[1]+X+u[2]):(L=p[1]+($+X-b.displaySize[1])/2,R=L+b.displaySize[1]),{image:b,top:L,right:O,bottom:R,left:U,collisionPadding:x}}class Xl extends et{constructor(r,s,u,p,g){super(r,s),this.angle=p,this.z=u,g!==void 0&&(this.segment=g)}clone(){return new Xl(this.x,this.y,this.z,this.angle,this.segment)}}function D2(a,r,s,u,p){if(r.segment===void 0)return!0;let g=r,b=r.segment+1,x=0;for(;x>-s/2;){if(b--,b<0)return!1;x-=a[b].dist(g),g=a[b]}x+=a[b].dist(a[b+1]),b++;const T=[];let k=0;for(;x<s/2;){const L=a[b],O=a[b+1];if(!O)return!1;let R=a[b-1].angleTo(L)-L.angleTo(O);for(R=Math.abs((R+3*Math.PI)%(2*Math.PI)-Math.PI),T.push({distance:x,angleDelta:R}),k+=R;x-T[0].distance>u;)k-=T.shift().angleDelta;if(k>p)return!1;b++,x+=L.dist(O)}return!0}function R2(a){let r=0;for(let s=0;s<a.length-1;s++)r+=a[s].dist(a[s+1]);return r}function B2(a,r,s){return a?.6*r*s:0}function F2(a,r){return Math.max(a?a.right-a.left:0,r?r.right-r.left:0)}function kI(a,r,s,u,p,g){const b=B2(s,p,g),x=F2(s,u)*g;let T=0;const k=R2(a)/2;for(let L=0;L<a.length-1;L++){const O=a[L],R=a[L+1],U=O.dist(R);if(T+U>k){const $=(k-T)/U,X=An(O.x,R.x,$),nt=An(O.y,R.y,$),dt=new Xl(X,nt,0,R.angleTo(O),L);return!b||D2(a,dt,x,b,r)?dt:void 0}T+=U}}function CI(a,r,s,u,p,g,b,x,T){const k=B2(u,g,b),L=F2(u,p),O=L*b,R=a[0].x===0||a[0].x===T||a[0].y===0||a[0].y===T;return r-O<r/4&&(r=O+r/4),N2(a,R?r/2*x%r:(L/2+2*g)*b*x%r,r,k,s,O,R,!1,T)}function N2(a,r,s,u,p,g,b,x,T){const k=g/2,L=R2(a);let O=0,R=r-s,U=[];for(let $=0;$<a.length-1;$++){const X=a[$],nt=a[$+1],dt=X.dist(nt),yt=nt.angleTo(X);for(;R+s<O+dt;){R+=s;const lt=(R-O)/dt,_t=An(X.x,nt.x,lt),Et=An(X.y,nt.y,lt);if(_t>=0&&_t<T&&Et>=0&&Et<T&&R-k>=0&&R+k<=L){const xt=new Xl(_t,Et,0,yt,$);xt._round(),u&&!D2(a,xt,g,u,p)||U.push(xt)}}O+=dt}return x||U.length||b||(U=N2(a,O/2,s,u,p,g,b,!0,T)),U}function j2(a,r,s,u,p){const g=[];for(let b=0;b<a.length;b++){const x=a[b];let T;for(let k=0;k<x.length-1;k++){let L=x[k],O=x[k+1];L.x<r&&O.x<r||(L.x<r?L=new et(r,L.y+(r-L.x)/(O.x-L.x)*(O.y-L.y))._round():O.x<r&&(O=new et(r,L.y+(r-L.x)/(O.x-L.x)*(O.y-L.y))._round()),L.y<s&&O.y<s||(L.y<s?L=new et(L.x+(s-L.y)/(O.y-L.y)*(O.x-L.x),s)._round():O.y<s&&(O=new et(L.x+(s-L.y)/(O.y-L.y)*(O.x-L.x),s)._round()),L.x>=u&&O.x>=u||(L.x>=u?L=new et(u,L.y+(u-L.x)/(O.x-L.x)*(O.y-L.y))._round():O.x>=u&&(O=new et(u,L.y+(u-L.x)/(O.x-L.x)*(O.y-L.y))._round()),L.y>=p&&O.y>=p||(L.y>=p?L=new et(L.x+(p-L.y)/(O.y-L.y)*(O.x-L.x),p)._round():O.y>=p&&(O=new et(L.x+(p-L.y)/(O.y-L.y)*(O.x-L.x),p)._round()),T&&L.equals(T[T.length-1])||(T=[L],g.push(T)),T.push(O)))))}}return g}qe(Xl,"Anchor");const cp=1e20;function U2(a,r,s,u,p,g,b,x,T){for(let k=r;k<r+u;k++)$2(a,s*g+k,g,p,b,x,T);for(let k=s;k<s+p;k++)$2(a,k*g+r,1,u,b,x,T)}function $2(a,r,s,u,p,g,b){g[0]=0,b[0]=-cp,b[1]=cp,p[0]=a[r];for(let x=1,T=0,k=0;x<u;x++){p[x]=a[r+x*s];const L=x*x;do{const O=g[T];k=(p[x]-p[O]+L-O*O)/(x-O)/2}while(k<=b[T]&&--T>-1);T++,g[T]=x,b[T]=k,b[T+1]=cp}for(let x=0,T=0;x<u;x++){for(;b[T+1]<x;)T++;const k=g[T],L=x-k;a[r+x*s]=p[k]+L*L}}const d1={none:0,ideographs:1,all:2};class Ih{constructor(r,s,u){this.requestManager=r,this.localGlyphMode=s,this.localFontFamily=u,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(r){this.url=r}getGlyphs(r,s){const u=[];for(const p in r)for(const g of r[p])u.push({stack:p,id:g});_n(u,({stack:p,id:g},b)=>{let x=this.entries[p];x||(x=this.entries[p]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let T=x.glyphs[g];if(T!==void 0)return void b(null,{stack:p,id:g,glyph:T});if(T=this._tinySDF(x,p,g),T)return x.glyphs[g]=T,void b(null,{stack:p,id:g,glyph:T});const k=Math.floor(g/256);if(256*k>65535)return void b(new Error("glyphs > 65535 not supported"));if(x.ranges[k])return void b(null,{stack:p,id:g,glyph:T});let L=x.requests[k];L||(L=x.requests[k]=[],Ih.loadGlyphRange(p,k,this.url,this.requestManager,(O,R)=>{if(R){x.ascender=R.ascender,x.descender=R.descender;for(const U in R.glyphs)this._doesCharSupportLocalGlyph(+U)||(x.glyphs[+U]=R.glyphs[+U]);x.ranges[k]=!0}for(const U of L)U(O,R);delete x.requests[k]})),L.push((O,R)=>{O?b(O):R&&b(null,{stack:p,id:g,glyph:R.glyphs[g]||null})})},(p,g)=>{if(p)s(p);else if(g){const b={};for(const{stack:x,id:T,glyph:k}of g)b[x]===void 0&&(b[x]={}),b[x].glyphs===void 0&&(b[x].glyphs={}),b[x].glyphs[T]=k&&{id:k.id,bitmap:k.bitmap.clone(),metrics:k.metrics},b[x].ascender=this.entries[x].ascender,b[x].descender=this.entries[x].descender;s(null,b)}})}_doesCharSupportLocalGlyph(r){return this.localGlyphMode!==d1.none&&(this.localGlyphMode===d1.all?!!this.localFontFamily:!!this.localFontFamily&&(Ff(r)||mg(r)||hh(r)||Bc(r)||Ku(r)))}_tinySDF(r,s,u){const p=this.localFontFamily;if(!p||!this._doesCharSupportLocalGlyph(u))return;let g=r.tinySDF;if(!g){let X="400";/bold/i.test(s)?X="900":/medium/i.test(s)?X="500":/light/i.test(s)&&(X="200"),g=r.tinySDF=new Ih.TinySDF({fontFamily:p,fontWeight:X,fontSize:48,buffer:6,radius:16}),g.fontWeight=X}if(this.localGlyphs[g.fontWeight][u])return this.localGlyphs[g.fontWeight][u];const b=String.fromCharCode(u),{data:x,width:T,height:k,glyphWidth:L,glyphHeight:O,glyphLeft:R,glyphTop:U,glyphAdvance:$}=g.draw(b);return this.localGlyphs[g.fontWeight][u]={id:u,bitmap:new Wl({width:T,height:k},x),metrics:{width:L/2,height:O/2,left:R/2,top:U/2-27,advance:$/2,localGlyph:!0}}}}function V2(a,r,s,u){const p=[],g=a.image,b=g.pixelRatio,x=g.paddedRect.w-2,T=g.paddedRect.h-2,k=a.right-a.left,L=a.bottom-a.top,O=g.stretchX||[[0,x]],R=g.stretchY||[[0,T]],U=(Zt,ee)=>Zt+ee[1]-ee[0],$=O.reduce(U,0),X=R.reduce(U,0),nt=x-$,dt=T-X;let yt=0,lt=$,_t=0,Et=X,xt=0,qt=nt,$t=0,Qt=dt;if(g.content&&u){const Zt=g.content;yt=$g(O,0,Zt[0]),_t=$g(R,0,Zt[1]),lt=$g(O,Zt[0],Zt[2]),Et=$g(R,Zt[1],Zt[3]),xt=Zt[0]-yt,$t=Zt[1]-_t,qt=Zt[2]-Zt[0]-lt,Qt=Zt[3]-Zt[1]-Et}const _e=(Zt,ee,re,de)=>{const ye=Vg(Zt.stretch-yt,lt,k,a.left),Yt=Gg(Zt.fixed-xt,qt,Zt.stretch,$),Pe=Vg(ee.stretch-_t,Et,L,a.top),fn=Gg(ee.fixed-$t,Qt,ee.stretch,X),Fe=Vg(re.stretch-yt,lt,k,a.left),Xe=Gg(re.fixed-xt,qt,re.stretch,$),Le=Vg(de.stretch-_t,Et,L,a.top),mn=Gg(de.fixed-$t,Qt,de.stretch,X),jn=new et(ye,Pe),Rn=new et(Fe,Pe),On=new et(Fe,Le),yn=new et(ye,Le),hr=new et(Yt/b,fn/b),Cn=new et(Xe/b,mn/b),Un=r*Math.PI/180;if(Un){const Ir=Math.sin(Un),Dr=Math.cos(Un),Nr=[Dr,-Ir,Ir,Dr];jn._matMult(Nr),Rn._matMult(Nr),yn._matMult(Nr),On._matMult(Nr)}const br=Zt.stretch+Zt.fixed,Or=ee.stretch+ee.fixed;return{tl:jn,tr:Rn,bl:yn,br:On,tex:{x:g.paddedRect.x+1+br,y:g.paddedRect.y+1+Or,w:re.stretch+re.fixed-br,h:de.stretch+de.fixed-Or},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:hr,pixelOffsetBR:Cn,minFontScaleX:qt/b/k,minFontScaleY:Qt/b/L,isSDF:s}};if(u&&(g.stretchX||g.stretchY)){const Zt=G2(O,nt,$),ee=G2(R,dt,X);for(let re=0;re<Zt.length-1;re++){const de=Zt[re],ye=Zt[re+1];for(let Yt=0;Yt<ee.length-1;Yt++)p.push(_e(de,ee[Yt],ye,ee[Yt+1]))}}else p.push(_e({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:x+1},{fixed:0,stretch:T+1}));return p}function $g(a,r,s){let u=0;for(const p of a)u+=Math.max(r,Math.min(s,p[1]))-Math.max(r,Math.min(s,p[0]));return u}function G2(a,r,s){const u=[{fixed:-1,stretch:0}];for(const[p,g]of a){const b=u[u.length-1];u.push({fixed:p-b.stretch,stretch:b.stretch}),u.push({fixed:p-b.stretch,stretch:b.stretch+(g-p)})}return u.push({fixed:r+1,stretch:s}),u}function Vg(a,r,s,u){return a/r*s+u}function Gg(a,r,s,u){return a-r*s/u}function SI(a,r,s,u){const p=r+a.positionedLines[u].lineOffset;return u===0?s+p/2:s+(p+(r+a.positionedLines[u-1].lineOffset))/2}Ih.loadGlyphRange=function(a,r,s,u,p){const g=256*r,b=g+255,x=u.transformRequest(u.normalizeGlyphsURL(s).replace("{fontstack}",a).replace("{range}",`${g}-${b}`),nr.Glyphs);Zi(x,(T,k)=>{if(T)p(T);else if(k){const L={},O=function(R){return new sp(R).readFields(bI,{})}(k);for(const R of O.glyphs)L[R.id]=R;p(null,{glyphs:L,ascender:O.ascender,descender:O.descender})}})},Ih.TinySDF=class{constructor({fontSize:a=24,buffer:r=3,radius:s=8,cutoff:u=.25,fontFamily:p="sans-serif",fontWeight:g="normal",fontStyle:b="normal"}={}){this.buffer=r,this.cutoff=u,this.radius=s;const x=this.size=a+4*r,T=this._createCanvas(x),k=this.ctx=T.getContext("2d",{willReadFrequently:!0});k.font=`${b} ${g} ${a}px ${p}`,k.textBaseline="alphabetic",k.textAlign="left",k.fillStyle="black",this.gridOuter=new Float64Array(x*x),this.gridInner=new Float64Array(x*x),this.f=new Float64Array(x),this.z=new Float64Array(x+1),this.v=new Uint16Array(x)}_createCanvas(a){const r=document.createElement("canvas");return r.width=r.height=a,r}draw(a){const{width:r,actualBoundingBoxAscent:s,actualBoundingBoxDescent:u,actualBoundingBoxLeft:p,actualBoundingBoxRight:g}=this.ctx.measureText(a),b=Math.ceil(s),x=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(g-p))),T=Math.min(this.size-this.buffer,b+Math.ceil(u)),k=x+2*this.buffer,L=T+2*this.buffer,O=Math.max(k*L,0),R=new Uint8ClampedArray(O),U={data:R,width:k,height:L,glyphWidth:x,glyphHeight:T,glyphTop:b,glyphLeft:0,glyphAdvance:r};if(x===0||T===0)return U;const{ctx:$,buffer:X,gridInner:nt,gridOuter:dt}=this;$.clearRect(X,X,x,T),$.fillText(a,X,X+b);const yt=$.getImageData(X,X,x,T);dt.fill(cp,0,O),nt.fill(0,0,O);for(let lt=0;lt<T;lt++)for(let _t=0;_t<x;_t++){const Et=yt.data[4*(lt*x+_t)+3]/255;if(Et===0)continue;const xt=(lt+X)*k+_t+X;if(Et===1)dt[xt]=0,nt[xt]=cp;else{const qt=.5-Et;dt[xt]=qt>0?qt*qt:0,nt[xt]=qt<0?qt*qt:0}}U2(dt,0,0,k,L,k,this.f,this.v,this.z),U2(nt,X,X,x,T,k,this.f,this.v,this.z);for(let lt=0;lt<O;lt++){const _t=Math.sqrt(dt[lt])-Math.sqrt(nt[lt]);R[lt]=Math.round(255-255*(_t/this.radius+this.cutoff))}return U}};class MI{constructor(r=[],s=AI){if(this.data=r,this.length=this.data.length,this.compare=s,this.length>0)for(let u=(this.length>>1)-1;u>=0;u--)this._down(u)}push(r){this.data.push(r),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const r=this.data[0],s=this.data.pop();return this.length--,this.length>0&&(this.data[0]=s,this._down(0)),r}peek(){return this.data[0]}_up(r){const{data:s,compare:u}=this,p=s[r];for(;r>0;){const g=r-1>>1,b=s[g];if(u(p,b)>=0)break;s[r]=b,r=g}s[r]=p}_down(r){const{data:s,compare:u}=this,p=this.length>>1,g=s[r];for(;r<p;){let b=1+(r<<1),x=s[b];const T=b+1;if(T<this.length&&u(s[T],x)<0&&(b=T,x=s[T]),u(x,g)>=0)break;s[r]=x,r=b}s[r]=g}}function AI(a,r){return a<r?-1:a>r?1:0}function II(a,r=1,s=!1){let u=1/0,p=1/0,g=-1/0,b=-1/0;const x=a[0];for(let U=0;U<x.length;U++){const $=x[U];(!U||$.x<u)&&(u=$.x),(!U||$.y<p)&&(p=$.y),(!U||$.x>g)&&(g=$.x),(!U||$.y>b)&&(b=$.y)}const T=Math.min(g-u,b-p);let k=T/2;const L=new MI([],PI);if(T===0)return new et(u,p);for(let U=u;U<g;U+=T)for(let $=p;$<b;$+=T)L.push(new Ph(U+k,$+k,k,a));let O=function(U){let $=0,X=0,nt=0;const dt=U[0];for(let yt=0,lt=dt.length,_t=lt-1;yt<lt;_t=yt++){const Et=dt[yt],xt=dt[_t],qt=Et.x*xt.y-xt.x*Et.y;X+=(Et.x+xt.x)*qt,nt+=(Et.y+xt.y)*qt,$+=3*qt}return new Ph(X/$,nt/$,0,U)}(a),R=L.length;for(;L.length;){const U=L.pop();(U.d>O.d||!O.d)&&(O=U,s&&console.log("found best %d after %d probes",Math.round(1e4*U.d)/1e4,R)),U.max-O.d<=r||(k=U.h/2,L.push(new Ph(U.p.x-k,U.p.y-k,k,a)),L.push(new Ph(U.p.x+k,U.p.y-k,k,a)),L.push(new Ph(U.p.x-k,U.p.y+k,k,a)),L.push(new Ph(U.p.x+k,U.p.y+k,k,a)),R+=4)}return s&&(console.log(`num probes: ${R}`),console.log(`best distance: ${O.d}`)),O.p}function PI(a,r){return r.max-a.max}function Ph(a,r,s,u){this.p=new et(a,r),this.h=s,this.d=function(p,g){let b=!1,x=1/0;for(let T=0;T<g.length;T++){const k=g[T];for(let L=0,O=k.length,R=O-1;L<O;R=L++){const U=k[L],$=k[R];U.y>p.y!=$.y>p.y&&p.x<($.x-U.x)*(p.y-U.y)/($.y-U.y)+U.x&&(b=!b),x=Math.min(x,$w(p,U,$))}}return(b?1:-1)*Math.sqrt(x)}(this.p,u),this.max=this.d+this.h*Math.SQRT2}const h1=Number.POSITIVE_INFINITY,LI=Math.sqrt(2);function q2(a,[r,s]){let u=0,p=0;if(s===h1){r<0&&(r=0);const g=r/LI;switch(a){case"top-right":case"top-left":p=g-7;break;case"bottom-right":case"bottom-left":p=7-g;break;case"bottom":p=7-r;break;case"top":p=r-7}switch(a){case"top-right":case"bottom-right":u=-g;break;case"top-left":case"bottom-left":u=g;break;case"left":u=r;break;case"right":u=-r}}else{switch(r=Math.abs(r),s=Math.abs(s),a){case"top-right":case"top-left":case"top":p=s-7;break;case"bottom-right":case"bottom-left":case"bottom":p=7-s}switch(a){case"top-right":case"bottom-right":case"right":u=-r;break;case"top-left":case"bottom-left":case"left":u=r}}return[u,p]}function zI(a,r,s,u,p,g,b,x,T,k){a.createArrays(),a.tilePixelRatio=bn/(512*a.overscaling),a.compareText={},a.iconsNeedLinear=!1;const L=a.layers[0].layout,O=a.layers[0]._unevaluatedLayout._values,R={};if(a.textSizeData.kind==="composite"){const{minZoom:X,maxZoom:nt}=a.textSizeData;R.compositeTextSizes=[O["text-size"].possiblyEvaluate(new Ft(X),x),O["text-size"].possiblyEvaluate(new Ft(nt),x)]}if(a.iconSizeData.kind==="composite"){const{minZoom:X,maxZoom:nt}=a.iconSizeData;R.compositeIconSizes=[O["icon-size"].possiblyEvaluate(new Ft(X),x),O["icon-size"].possiblyEvaluate(new Ft(nt),x)]}R.layoutTextSize=O["text-size"].possiblyEvaluate(new Ft(T+1),x),R.layoutIconSize=O["icon-size"].possiblyEvaluate(new Ft(T+1),x),R.textMaxSize=O["text-size"].possiblyEvaluate(new Ft(18),x);const U=L.get("text-rotation-alignment")==="map"&&L.get("symbol-placement")!=="point",$=L.get("text-size");for(const X of a.features){const nt=L.get("text-font").evaluate(X,{},x).join(","),dt=$.evaluate(X,{},x),yt=R.layoutTextSize.evaluate(X,{},x),lt=(R.layoutIconSize.evaluate(X,{},x),{horizontal:{},vertical:void 0}),_t=X.text;let Et,xt=[0,0];if(_t){const Qt=_t.toString(),_e=L.get("text-letter-spacing").evaluate(X,{},x)*_o,Zt=L.get("text-line-height").evaluate(X,{},x)*_o,ee=w(Qt)?_e:0,re=L.get("text-anchor").evaluate(X,{},x),de=L.get("text-variable-anchor");if(!de){const Fe=L.get("text-radial-offset").evaluate(X,{},x);xt=Fe?q2(re,[Fe*_o,h1]):L.get("text-offset").evaluate(X,{},x).map(Xe=>Xe*_o)}let ye=U?"center":L.get("text-justify").evaluate(X,{},x);const Yt=L.get("symbol-placement")==="point",Pe=Yt?L.get("text-max-width").evaluate(X,{},x)*_o:1/0,fn=Fe=>{a.allowVerticalPlacement&&v(Qt)&&(lt.vertical=c1(_t,r,s,p,nt,Pe,Zt,re,Fe,ee,xt,za.vertical,!0,yt,dt))};if(!U&&de){const Fe=ye==="auto"?de.map(Le=>f1(Le)):[ye];let Xe=!1;for(let Le=0;Le<Fe.length;Le++){const mn=Fe[Le];if(!lt.horizontal[mn])if(Xe)lt.horizontal[mn]=lt.horizontal[0];else{const jn=c1(_t,r,s,p,nt,Pe,Zt,"center",mn,ee,xt,za.horizontal,!1,yt,dt);jn&&(lt.horizontal[mn]=jn,Xe=jn.positionedLines.length===1)}}fn("left")}else{if(ye==="auto"&&(ye=f1(re)),Yt||L.get("text-writing-mode").indexOf("horizontal")>=0||!v(Qt)){const Fe=c1(_t,r,s,p,nt,Pe,Zt,re,ye,ee,xt,za.horizontal,!1,yt,dt);Fe&&(lt.horizontal[ye]=Fe)}fn(Yt?"left":ye)}}let qt=!1;if(X.icon&&X.icon.name){const Qt=u[X.icon.name];Qt&&(Et=TI(p[X.icon.name],L.get("icon-offset").evaluate(X,{},x),L.get("icon-anchor").evaluate(X,{},x)),qt=Qt.sdf,a.sdfIcons===void 0?a.sdfIcons=Qt.sdf:a.sdfIcons!==Qt.sdf&&Qe("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Qt.pixelRatio!==a.pixelRatio||L.get("icon-rotate").constantOr(1)!==0)&&(a.iconsNeedLinear=!0))}const $t=W2(lt.horizontal)||lt.vertical;a.iconsInText||(a.iconsInText=!!$t&&$t.iconsInText),($t||Et)&&OI(a,X,lt,Et,u,R,yt,0,xt,qt,b,x,k)}g&&a.generateCollisionDebugBuffers(T,a.collisionBoxArray)}function f1(a){switch(a){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function OI(a,r,s,u,p,g,b,x,T,k,L,O,R){let U=g.textMaxSize.evaluate(r,{},O);U===void 0&&(U=b);const $=a.layers[0].layout,X=$.get("icon-offset").evaluate(r,{},O),nt=W2(s.horizontal)||s.vertical,dt=R.name==="globe",yt=b/24,lt=a.tilePixelRatio*U/24,_t=(ee=a.overscaling,a.zoom>18&&ee>2&&(ee>>=1),Math.max(bn/(512*ee),1)*$.get("symbol-spacing")),Et=$.get("text-padding")*a.tilePixelRatio,xt=$.get("icon-padding")*a.tilePixelRatio,qt=jt($.get("text-max-angle")),$t=$.get("text-rotation-alignment")==="map"&&$.get("symbol-placement")!=="point",Qt=$.get("icon-rotation-alignment")==="map"&&$.get("symbol-placement")!=="point",_e=$.get("symbol-placement"),Zt=_t/2;var ee;const re=$.get("icon-text-fit");let de;u&&re!=="none"&&(a.allowVerticalPlacement&&s.vertical&&(de=O2(u,s.vertical,re,$.get("icon-text-fit-padding"),X,yt)),nt&&(u=O2(u,nt,re,$.get("icon-text-fit-padding"),X,yt)));const ye=(Yt,Pe,fn)=>{if(Pe.x<0||Pe.x>=bn||Pe.y<0||Pe.y>=bn)return;let Fe=null;if(dt){const{x:Xe,y:Le,z:mn}=R.projectTilePoint(Pe.x,Pe.y,fn);Fe={anchor:new Xl(Xe,Le,mn,0,void 0),up:R.upVector(fn,Pe.x,Pe.y)}}(function(Xe,Le,mn,jn,Rn,On,yn,hr,Cn,Un,br,Or,Ir,Dr,Nr,li,eo,fr,Ci,Ei,or,Hr,zi,vr,_i){const Co=Xe.addToLineVertexArray(Le,jn);let no,ro,Bo,io,Yl,Oh,gp,_p=0,w3=0,E3=0,T3=0,k1=-1,C1=-1;const cl={};let k3=Qu("");const dd=mn?mn.anchor:Le;let S1=0,M1=0;if(Cn._unevaluatedLayout.getValue("text-radial-offset")===void 0?[S1,M1]=Cn.layout.get("text-offset").evaluate(or,{},_i).map(fa=>fa*_o):(S1=Cn.layout.get("text-radial-offset").evaluate(or,{},_i)*_o,M1=h1),Xe.allowVerticalPlacement&&Rn.vertical){const fa=Rn.vertical;if(Nr)Oh=p1(fa),hr&&(gp=p1(hr));else{const pa=Cn.layout.get("text-rotate").evaluate(or,{},_i)+90;Bo=qg(Un,dd,Le,br,Or,Ir,fa,Dr,pa,li),hr&&(io=qg(Un,dd,Le,br,Or,Ir,hr,fr,pa))}}if(On){const fa=Cn.layout.get("icon-rotate").evaluate(or,{},_i),pa=Cn.layout.get("icon-text-fit")!=="none",yp=V2(On,fa,zi,pa),I1=hr?V2(hr,fa,zi,pa):void 0;ro=qg(Un,dd,Le,br,Or,Ir,On,fr,fa),_p=4*yp.length;const C3=Xe.iconSizeData;let hd=null;C3.kind==="source"?(hd=[ol*Cn.layout.get("icon-size").evaluate(or,{},_i)],hd[0]>Vc&&Qe(`${Xe.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):C3.kind==="composite"&&(hd=[ol*Hr.compositeIconSizes[0].evaluate(or,{},_i),ol*Hr.compositeIconSizes[1].evaluate(or,{},_i)],(hd[0]>Vc||hd[1]>Vc)&&Qe(`${Xe.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Xe.addSymbols(Xe.icon,yp,hd,Ei,Ci,or,!1,mn,Le,Co.lineStartIndex,Co.lineLength,-1,vr,_i),k1=Xe.icon.placedSymbolArray.length-1,I1&&(w3=4*I1.length,Xe.addSymbols(Xe.icon,I1,hd,Ei,Ci,or,za.vertical,mn,Le,Co.lineStartIndex,Co.lineLength,-1,vr,_i),C1=Xe.icon.placedSymbolArray.length-1)}for(const fa in Rn.horizontal){const pa=Rn.horizontal[fa];no||(k3=Qu(pa.text),Nr?Yl=p1(pa):no=qg(Un,dd,Le,br,Or,Ir,pa,Dr,Cn.layout.get("text-rotate").evaluate(or,{},_i),li));const yp=pa.positionedLines.length===1;if(E3+=H2(Xe,mn,Le,pa,yn,Cn,Nr,or,li,Co,Rn.vertical?za.horizontal:za.horizontalOnly,yp?Object.keys(Rn.horizontal):[fa],cl,k1,Hr,vr,_i),yp)break}Rn.vertical&&(T3+=H2(Xe,mn,Le,Rn.vertical,yn,Cn,Nr,or,li,Co,za.vertical,["vertical"],cl,C1,Hr,vr,_i));let Xc=-1;const A1=(fa,pa)=>fa?Math.max(fa,pa):pa;Xc=A1(Yl,Xc),Xc=A1(Oh,Xc),Xc=A1(gp,Xc);const aP=Xc>-1?1:0;Xe.glyphOffsetArray.length>=qc.MAX_GLYPHS&&Qe("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),or.sortKey!==void 0&&Xe.addToSortKeyRanges(Xe.symbolInstances.length,or.sortKey),Xe.symbolInstances.emplaceBack(dd.x,dd.y,dd.z,Le.x,Le.y,cl.right>=0?cl.right:-1,cl.center>=0?cl.center:-1,cl.left>=0?cl.left:-1,cl.vertical>=0?cl.vertical:-1,k1,C1,k3,no!==void 0?no:Xe.collisionBoxArray.length,no!==void 0?no+1:Xe.collisionBoxArray.length,Bo!==void 0?Bo:Xe.collisionBoxArray.length,Bo!==void 0?Bo+1:Xe.collisionBoxArray.length,ro!==void 0?ro:Xe.collisionBoxArray.length,ro!==void 0?ro+1:Xe.collisionBoxArray.length,io||Xe.collisionBoxArray.length,io?io+1:Xe.collisionBoxArray.length,br,E3,T3,_p,w3,aP,0,S1,M1,Xc)})(a,Pe,Fe,Yt,s,u,p,de,a.layers[0],a.collisionBoxArray,r.index,r.sourceLayerIndex,a.index,Et,$t,T,0,xt,Qt,X,r,g,k,L,O)};if(_e==="line")for(const Yt of j2(r.geometry,0,0,bn,bn)){const Pe=CI(Yt,_t,qt,s.vertical||nt,u,24,lt,a.overscaling,bn);for(const fn of Pe){const Fe=nt;Fe&&DI(a,Fe.text,Zt,fn)||ye(Yt,fn,O)}}else if(_e==="line-center"){for(const Yt of r.geometry)if(Yt.length>1){const Pe=kI(Yt,qt,s.vertical||nt,u,24,lt);Pe&&ye(Yt,Pe,O)}}else if(r.type==="Polygon")for(const Yt of e1(r.geometry,0)){const Pe=II(Yt,16);ye(Yt[0],new Xl(Pe.x,Pe.y,0,0,void 0),O)}else if(r.type==="LineString")for(const Yt of r.geometry)ye(Yt,new Xl(Yt[0].x,Yt[0].y,0,0,void 0),O);else if(r.type==="Point")for(const Yt of r.geometry)for(const Pe of Yt)ye([Pe],new Xl(Pe.x,Pe.y,0,0,void 0),O)}const Vc=32640;function H2(a,r,s,u,p,g,b,x,T,k,L,O,R,U,$,X,nt){const dt=function(_t,Et,xt,qt,$t,Qt,_e,Zt){const ee=[];if(Et.positionedLines.length===0)return ee;const re=qt.layout.get("text-rotate").evaluate(Qt,{})*Math.PI/180,de=function(Fe){const Xe=Fe[0],Le=Fe[1],mn=Xe*Le;return mn>0?[Xe,-Le]:mn<0?[-Xe,Le]:Xe===0?[Le,Xe]:[Le,-Xe]}(xt);let ye=Math.abs(Et.top-Et.bottom);for(const Fe of Et.positionedLines)ye-=Fe.lineOffset;const Yt=Et.positionedLines.length,Pe=ye/Yt;let fn=Et.top-xt[1];for(let Fe=0;Fe<Yt;++Fe){const Xe=Et.positionedLines[Fe];fn=SI(Et,Pe,fn,Fe);for(const Le of Xe.positionedGlyphs){if(!Le.rect)continue;const mn=Le.rect||{};let jn=4,Rn=!0,On=1,yn=0;if(Le.imageName){const vr=_e[Le.imageName];if(!vr)continue;if(vr.sdf){Qe("SDF images are not supported in formatted text and will be ignored.");continue}Rn=!1,On=vr.pixelRatio,jn=1/On}const hr=($t||Zt)&&Le.vertical,Cn=Le.metrics.advance*Le.scale/2,Un=Le.metrics,br=Le.rect;if(br===null)continue;Zt&&Et.verticalizable&&(yn=Le.imageName?Cn-Le.metrics.width*Le.scale/2:0);const Or=$t?[Le.x+Cn,Le.y]:[0,0];let Ir=[0,0],Dr=[0,0],Nr=!1;$t||(hr?(Dr=[Le.x+Cn+de[0],Le.y+de[1]-yn],Nr=!0):Ir=[Le.x+Cn+xt[0],Le.y+xt[1]-yn]);const li=br.w*Le.scale/(On*(Le.localGlyph?2:1)),eo=br.h*Le.scale/(On*(Le.localGlyph?2:1));let fr,Ci,Ei,or;if(hr){const vr=Le.y-fn,_i=new et(-Cn,Cn-vr),Co=-Math.PI/2,no=new et(...Dr);fr=new et(-Cn+Ir[0],Ir[1]),fr._rotateAround(Co,_i)._add(no),fr.x+=-vr+Cn,fr.y-=(Un.left-jn)*Le.scale;const ro=Le.imageName?Un.advance*Le.scale:_o*Le.scale,Bo=String.fromCharCode(Le.glyph);lI(Bo)?fr.x+=(1-jn)*Le.scale:cI(Bo)?fr.x+=ro-Un.height*Le.scale+(-jn-1)*Le.scale:fr.x+=Le.imageName||Un.width+2*jn===br.w&&Un.height+2*jn===br.h?(ro-eo)/2:(ro-(Un.height+2*jn)*Le.scale)/2,Ci=new et(fr.x,fr.y-li),Ei=new et(fr.x+eo,fr.y),or=new et(fr.x+eo,fr.y-li)}else{const vr=(Un.left-jn)*Le.scale-Cn+Ir[0],_i=(-Un.top-jn)*Le.scale+Ir[1],Co=vr+li,no=_i+eo;fr=new et(vr,_i),Ci=new et(Co,_i),Ei=new et(vr,no),or=new et(Co,no)}if(re){let vr;vr=$t?new et(0,0):Nr?new et(de[0],de[1]):new et(xt[0],xt[1]),fr._rotateAround(re,vr),Ci._rotateAround(re,vr),Ei._rotateAround(re,vr),or._rotateAround(re,vr)}const Hr=new et(0,0),zi=new et(0,0);ee.push({tl:fr,tr:Ci,bl:Ei,br:or,tex:mn,writingMode:Et.writingMode,glyphOffset:Or,sectionIndex:Le.sectionIndex,isSDF:Rn,pixelOffsetTL:Hr,pixelOffsetBR:zi,minFontScaleX:0,minFontScaleY:0})}}return ee}(0,u,T,g,b,x,p,a.allowVerticalPlacement),yt=a.textSizeData;let lt=null;yt.kind==="source"?(lt=[ol*g.layout.get("text-size").evaluate(x,{},nt)],lt[0]>Vc&&Qe(`${a.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):yt.kind==="composite"&&(lt=[ol*$.compositeTextSizes[0].evaluate(x,{},nt),ol*$.compositeTextSizes[1].evaluate(x,{},nt)],(lt[0]>Vc||lt[1]>Vc)&&Qe(`${a.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),a.addSymbols(a.text,dt,lt,T,b,x,L,r,s,k.lineStartIndex,k.lineLength,U,X,nt);for(const _t of O)R[_t]=a.text.placedSymbolArray.length-1;return 4*dt.length}function W2(a){for(const r in a)return a[r];return null}function qg(a,r,s,u,p,g,b,x,T,k){let L=b.top,O=b.bottom,R=b.left,U=b.right;const $=b.collisionPadding;if($&&(R-=$[0],L-=$[1],U+=$[2],O+=$[3]),T){const X=new et(R,L),nt=new et(U,L),dt=new et(R,O),yt=new et(U,O),lt=jt(T);let _t=new et(0,0);k&&(_t=new et(k[0],k[1])),X._rotateAround(lt,_t),nt._rotateAround(lt,_t),dt._rotateAround(lt,_t),yt._rotateAround(lt,_t),R=Math.min(X.x,nt.x,dt.x,yt.x),U=Math.max(X.x,nt.x,dt.x,yt.x),L=Math.min(X.y,nt.y,dt.y,yt.y),O=Math.max(X.y,nt.y,dt.y,yt.y)}return a.emplaceBack(r.x,r.y,r.z,s.x,s.y,R,L,U,O,x,u,p,g),a.length-1}function p1(a){a.collisionPadding&&(a.top-=a.collisionPadding[1],a.bottom+=a.collisionPadding[3]);const r=a.bottom-a.top;return r>0?Math.max(10,r):null}function DI(a,r,s,u){const p=a.compareText;if(r in p){const g=p[r];for(let b=g.length-1;b>=0;b--)if(u.dist(g[b])<s)return!0}else p[r]=[];return p[r].push(u),!1}function Z2(a,r){const s=a.fovAboveCenter,u=a.elevation?a.elevation.getMinElevationBelowMSL()*r:0,p=(a._camera.position[2]*a.worldSize-u)/Math.cos(a._pitch),g=Math.sin(s)*p/Math.sin(Math.max(Math.PI/2-a._pitch-s,.01)),b=Math.sin(a._pitch)*g+p;return Math.min(1.01*b,p*(1/a._horizonShift))}function cd(a,r){if(!r.isReprojectedInTileSpace)return{scale:1<<a.z,x:a.x,y:a.y,x2:a.x+1,y2:a.y+1,projection:r};const s=Math.pow(2,-a.z),u=a.x*s,p=(a.x+1)*s,g=a.y*s,b=(a.y+1)*s,x=La(u),T=La(p),k=mo(g),L=mo(b),O=r.project(x,k),R=r.project(T,k),U=r.project(T,L),$=r.project(x,L);let X=Math.min(O.x,R.x,U.x,$.x),nt=Math.min(O.y,R.y,U.y,$.y),dt=Math.max(O.x,R.x,U.x,$.x),yt=Math.max(O.y,R.y,U.y,$.y);const lt=s/16;function _t(xt,qt,$t,Qt,_e,Zt){const ee=($t+_e)/2,re=(Qt+Zt)/2,de=r.project(La(ee),mo(re)),ye=Math.max(0,X-de.x,nt-de.y,de.x-dt,de.y-yt);X=Math.min(X,de.x),dt=Math.max(dt,de.x),nt=Math.min(nt,de.y),yt=Math.max(yt,de.y),ye>lt&&(_t(xt,de,$t,Qt,ee,re),_t(de,qt,ee,re,_e,Zt))}_t(O,R,u,g,p,g),_t(R,U,p,g,p,b),_t(U,$,p,b,u,b),_t($,O,u,b,u,g),X-=lt,nt-=lt,dt+=lt,yt+=lt;const Et=1/Math.max(dt-X,yt-nt);return{scale:Et,x:X*Et,y:nt*Et,x2:dt*Et,y2:yt*Et,projection:r}}const RI=Ps(new Float32Array(16));class Gc{constructor(r){this.spec=r,this.name=r.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(r,s){return{x:0,y:0,z:0}}unproject(r,s){return new rr(0,0)}projectTilePoint(r,s,u){return{x:r,y:s,z:0}}locationPoint(r,s,u=!0){return r._coordinatePoint(r.locationCoordinate(s),u)}pixelsPerMeter(r,s){return zs(1,r)*s}pixelSpaceConversion(r,s,u){return 1}farthestPixelDistance(r){return Z2(r,r.pixelsPerMeter)}pointCoordinate(r,s,u,p){const g=r.horizonLineFromTop(!1),b=new et(s,Math.max(g,u));return r.rayIntersectionCoordinate(r.pointRayIntersection(b,p))}pointCoordinate3D(r,s,u){const p=new et(s,u);if(r.elevation)return r.elevation.pointCoordinate(p);{const g=this.pointCoordinate(r,p.x,p.y,0);return[g.x,g.y,g.z]}}isPointAboveHorizon(r,s){if(r.elevation)return!this.pointCoordinate3D(r,s.x,s.y);const u=r.horizonLineFromTop();return s.y<u}createInversionMatrix(r,s){return RI}createTileMatrix(r,s,u){let p,g,b;const x=u.canonical,T=Ps(new Float64Array(16));if(this.isReprojectedInTileSpace){const k=cd(x,this);p=1,g=k.x+u.wrap*k.scale,b=k.y,nd(T,T,[p/k.scale,p/k.scale,r.pixelsPerMeter/s])}else p=s/r.zoomScale(x.z),g=(x.x+Math.pow(2,x.z)*u.wrap)*p,b=x.y*p;return jf(T,T,[g,b,0]),nd(T,T,[p/bn,p/bn,1]),T}upVector(r,s,u){return[0,0,1]}upVectorScale(r,s,u){return{metersToTile:1}}}class BI extends Gc{constructor(r){super(r),this.range=[4,7],this.center=r.center||[-96,37.5];const[s,u]=this.parallels=r.parallels||[29.5,45.5],p=Math.sin(jt(s));this.n=(p+Math.sin(jt(u)))/2,this.c=1+p*(2*this.n-p),this.r0=Math.sqrt(this.c)/this.n}project(r,s){const{n:u,c:p,r0:g}=this,b=jt(r-this.center[0]),x=jt(s),T=Math.sqrt(p-2*u*Math.sin(x))/u;return{x:T*Math.sin(b*u),y:T*Math.cos(b*u)-g,z:0}}unproject(r,s){const{n:u,c:p,r0:g}=this,b=g+s;let x=Math.atan2(r,Math.abs(b))*Math.sign(b);b*u<0&&(x-=Math.PI*Math.sign(r)*Math.sign(b));const T=jt(this.center[0])*u;x=gn(x,-Math.PI-T,Math.PI-T);const k=se(oe(x/u)+this.center[0],-180,180),L=Math.asin(se((p-(r*r+b*b)*u*u)/(2*u),-1,1)),O=se(oe(L),-go,go);return new rr(k,O)}}const up=1.340264,dp=-.081106,hp=893e-6,fp=.003796,Hg=Math.sqrt(3)/2;class FI extends Gc{project(r,s){s=s/180*Math.PI,r=r/180*Math.PI;const u=Math.asin(Hg*Math.sin(s)),p=u*u,g=p*p*p;return{x:.5*(r*Math.cos(u)/(Hg*(up+3*dp*p+g*(7*hp+9*fp*p)))/Math.PI+.5),y:1-.5*(u*(up+dp*p+g*(hp+fp*p))/Math.PI+1),z:0}}unproject(r,s){r=(2*r-.5)*Math.PI;let u=s=(2*(1-s)-1)*Math.PI,p=u*u,g=p*p*p;for(let L,O,R,U=0;U<12&&(O=u*(up+dp*p+g*(hp+fp*p))-s,R=up+3*dp*p+g*(7*hp+9*fp*p),L=O/R,u=se(u-L,-Math.PI/3,Math.PI/3),p=u*u,g=p*p*p,!(Math.abs(L)<1e-12));++U);const b=Hg*r*(up+3*dp*p+g*(7*hp+9*fp*p))/Math.cos(u),x=Math.asin(Math.sin(u)/Hg),T=se(180*b/Math.PI,-180,180),k=se(180*x/Math.PI,-go,go);return new rr(T,k)}}class NI extends Gc{constructor(r){super(r),this.wrap=!0,this.supportsWorldCopies=!0}project(r,s){return{x:.5+r/360,y:.5-s/360,z:0}}unproject(r,s){const u=360*(r-.5),p=se(360*(.5-s),-go,go);return new rr(u,p)}}const Lh=Math.PI/2;function Wg(a){return Math.tan((Lh+a)/2)}class jI extends Gc{constructor(r){super(r),this.center=r.center||[0,30];const[s,u]=this.parallels=r.parallels||[30,30];let p=jt(s),g=jt(u);this.southernCenter=p+g<0,this.southernCenter&&(p=-p,g=-g);const b=Math.cos(p),x=Wg(p);this.n=p===g?Math.sin(p):Math.log(b/Math.cos(g))/Math.log(Wg(g)/x),this.f=b*Math.pow(Wg(p),this.n)/this.n}project(r,s){s=jt(s),this.southernCenter&&(s=-s),r=jt(r-this.center[0]);const u=1e-6,{n:p,f:g}=this;g>0?s<-Lh+u&&(s=-Lh+u):s>Lh-u&&(s=Lh-u);const b=g/Math.pow(Wg(s),p);let x=b*Math.sin(p*r),T=g-b*Math.cos(p*r);return x=.5*(x/Math.PI+.5),T=.5*(T/Math.PI+.5),{x,y:this.southernCenter?T:1-T,z:0}}unproject(r,s){r=(2*r-.5)*Math.PI,this.southernCenter&&(s=1-s),s=(2*(1-s)-.5)*Math.PI;const{n:u,f:p}=this,g=p-s,b=Math.sign(g),x=Math.sign(u)*Math.sqrt(r*r+g*g);let T=Math.atan2(r,Math.abs(g))*b;g*u<0&&(T-=Math.PI*Math.sign(r)*b);const k=se(oe(T/u)+this.center[0],-180,180),L=se(oe(2*Math.atan(Math.pow(p/x,1/u))-Lh),-go,go);return new rr(k,this.southernCenter?-L:L)}}class X2 extends Gc{constructor(r){super(r),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(r,s){return{x:rl(r),y:il(s),z:0}}unproject(r,s){const u=La(r),p=mo(s);return new rr(u,p)}}const Y2=jt(go);class UI extends Gc{project(r,s){const u=(s=jt(s))*s,p=u*u;return{x:.5*((r=jt(r))*(.8707-.131979*u+p*(p*(.003971*u-.001529*p)-.013791))/Math.PI+.5),y:1-.5*(s*(1.007226+u*(.015085+p*(.028874*u-.044475-.005916*p)))/Math.PI+1),z:0}}unproject(r,s){r=(2*r-.5)*Math.PI;let u=s=(2*(1-s)-1)*Math.PI,p=25,g=0,b=u*u;do{b=u*u;const k=b*b;g=(u*(1.007226+b*(.015085+k*(.028874*b-.044475-.005916*k)))-s)/(1.007226+b*(.045255+k*(.259866*b-.311325-.005916*11*k))),u=se(u-g,-Y2,Y2)}while(Math.abs(g)>1e-6&&--p>0);b=u*u;const x=se(oe(r/(.8707+b*(b*(b*b*b*(.003971-.001529*b)-.013791)-.131979))),-180,180),T=oe(u);return new rr(x,T)}}const K2=jt(go);class $I extends Gc{project(r,s){s=jt(s),r=jt(r);const u=Math.cos(s),p=2/Math.PI,g=Math.acos(u*Math.cos(r/2)),b=Math.sin(g)/g,x=.5*(r*p+2*u*Math.sin(r/2)/b)||0,T=.5*(s+Math.sin(s)/b)||0;return{x:.5*(x/Math.PI+.5),y:1-.5*(T/Math.PI+1),z:0}}unproject(r,s){let u=r=(2*r-.5)*Math.PI,p=s=(2*(1-s)-1)*Math.PI,g=25;const b=1e-6;let x=0,T=0;do{const k=Math.cos(p),L=Math.sin(p),O=2*L*k,R=L*L,U=k*k,$=Math.cos(u/2),X=Math.sin(u/2),nt=2*$*X,dt=X*X,yt=1-U*$*$,lt=yt?1/yt:0,_t=yt?Math.acos(k*$)*Math.sqrt(1/yt):0,Et=.5*(2*_t*k*X+2*u/Math.PI)-r,xt=.5*(_t*L+p)-s,qt=.5*lt*(U*dt+_t*k*$*R)+1/Math.PI,$t=lt*(nt*O/4-_t*L*X),Qt=.125*lt*(O*X-_t*L*U*nt),_e=.5*lt*(R*$+_t*dt*k)+.5,Zt=$t*Qt-_e*qt;x=(xt*$t-Et*_e)/Zt,T=(Et*Qt-xt*qt)/Zt,u=se(u-x,-Math.PI,Math.PI),p=se(p-T,-K2,K2)}while((Math.abs(x)>b||Math.abs(T)>b)&&--g>0);return new rr(oe(u),oe(p))}}class J2 extends Gc{constructor(r){super(r),this.center=r.center||[0,0],this.parallels=r.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(jt(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(r,s){const{scale:u,cosPhi:p}=this;return{x:jt(r)*p*u+.5,y:-Math.sin(jt(s))/p*u+.5,z:0}}unproject(r,s){const{scale:u,cosPhi:p}=this,g=-(s-.5)/u,b=se(oe((r-.5)/u)/p,-180,180),x=Math.asin(se(g*p,-1,1)),T=se(oe(x),-go,go);return new rr(b,T)}}class VI extends X2{constructor(r){super(r),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(r,s,u){const p=Zf(r,s,u);return gi(p,p,Xf(nl(u))),{x:p[0],y:p[1],z:p[2]}}locationPoint(r,s){const u=yh(s.lat,s.lng),p=Oo([],u),g=r.elevation?r.elevation.getAtPointOrZero(r.locationCoordinate(s),r._centerAltitude):r._centerAltitude;Gf(u,u,p,zs(1,0)*bn*g);const b=Ps(new Float64Array(16));return ed(b,r.pixelMatrix,r.globeMatrix),gi(u,u,b),new et(u[0],u[1])}pixelsPerMeter(r,s){return zs(1,0)*s}pixelSpaceConversion(r,s,u){const p=zs(1,r)*s,g=An(zs(1,45)*s,p,u);return this.pixelsPerMeter(r,s)/g}createTileMatrix(r,s,u){const p=Uy(nl(u.canonical));return ed(new Float64Array(16),r.globeMatrix,p)}createInversionMatrix(r,s){const{center:u}=r,p=Xf(nl(s));return wg(p,p,jt(u.lng)),Ly(p,p,jt(u.lat)),nd(p,p,[r._pixelsPerMercatorPixel,r._pixelsPerMercatorPixel,1]),Float32Array.from(p)}pointCoordinate(r,s,u,p){return Mw(r,s,u,!0)||new vh(0,0)}pointCoordinate3D(r,s,u){const p=this.pointCoordinate(r,s,u,0);return[p.x,p.y,p.z]}isPointAboveHorizon(r,s){return!Mw(r,s.x,s.y,!1)}farthestPixelDistance(r){const s=function(p,g){const b=p.cameraToCenterDistance,x=p._centerAltitude*g,T=p._camera,k=p._camera.forward(),L=ql([],Pa([],k,-b),[0,0,x]),O=p.worldSize/(2*Math.PI),R=[0,0,-O],U=p.width/p.height,$=Math.tan(p.fovAboveCenter),X=Pa([],T.up(),$),nt=Pa([],T.right(),$*U),dt=Oo([],ql([],ql([],k,X),nt)),yt=[];let lt;if(new Ry(L,dt).closestPointOnSphere(R,O,yt)){const _t=ql([],yt,R),Et=Ls([],_t,L);lt=Math.cos(p.fovAboveCenter)*Uf(Et)}else{const _t=Ls([],L,R),Et=Ls([],R,L);Oo(Et,Et);const xt=Uf(_t)-O;lt=Math.sqrt(xt*(xt+2*O));const qt=Math.acos(lt/(O+xt))-Math.acos(Wa(k,Et));lt*=Math.cos(qt)}return 1.01*lt}(r,this.pixelsPerMeter(r.center.lat,r.worldSize)),u=bh(r.zoom);if(u>0){const p=Z2(r,zs(1,r.center.lat)*r.worldSize),g=r.worldSize/(2*Math.PI),b=Math.max(r.width,r.height)/r.worldSize*Math.PI;return An(s,p+g*(1-Math.cos(b)),Math.pow(u,10))}return s}upVector(r,s,u){return Zf(s,u,r,1)}upVectorScale(r){return{metersToTile:Eg(kg(nl(r)))}}}function Q2(a){const r=a.parallels,s=!!r&&Math.abs(r[0]+r[1])<.01;switch(a.name){case"mercator":return new X2(a);case"equirectangular":return new NI(a);case"naturalEarth":return new UI(a);case"equalEarth":return new FI(a);case"winkelTripel":return new $I(a);case"albers":return s?new J2(a):new BI(a);case"lambertConformalConic":return s?new J2(a):new jI(a);case"globe":return new VI(a)}throw new Error(`Invalid projection name: ${a.name}`)}const GI=Dg.types,qI=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Zg(a,r,s,u,p,g,b,x,T,k,L,O,R){const U=x?Math.min(Vc,Math.round(x[0])):0,$=x?Math.min(Vc,Math.round(x[1])):0;a.emplaceBack(r,s,Math.round(32*u),Math.round(32*p),g,b,(U<<1)+(T?1:0),$,16*k,16*L,256*O,256*R)}function Xg(a,r,s,u,p,g,b){a.emplaceBack(r,s,u,p,g,b)}function Yg(a,r,s,u,p){a.emplaceBack(r,s,u,p),a.emplaceBack(r,s,u,p),a.emplaceBack(r,s,u,p),a.emplaceBack(r,s,u,p)}function HI(a){for(const r of a.sections)if(q(r.text))return!0;return!1}class m1{constructor(r){this.layoutVertexArray=new Ss,this.indexArray=new po,this.programConfigurations=r,this.segments=new xi,this.dynamicLayoutVertexArray=new wr,this.opacityVertexArray=new Er,this.placedSymbolArray=new tw,this.globeExtVertexArray=new Fr}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(r,s,u,p){this.isEmpty()||(u&&(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,tI.members),this.indexBuffer=r.createIndexBuffer(this.indexArray,s),this.dynamicLayoutVertexBuffer=r.createVertexBuffer(this.dynamicLayoutVertexArray,nI.members,!0),this.opacityVertexBuffer=r.createVertexBuffer(this.opacityVertexArray,qI,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=r.createVertexBuffer(this.globeExtVertexArray,eI.members,!0)),this.opacityVertexBuffer.itemSize=1),(u||p)&&this.programConfigurations.upload(r))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}qe(m1,"SymbolBuffers");class g1{constructor(r,s,u){this.layoutVertexArray=new r,this.layoutAttributes=s,this.indexArray=new u,this.segments=new xi,this.collisionVertexArray=new zr,this.collisionVertexArrayExt=new fo}upload(r){this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=r.createVertexBuffer(this.collisionVertexArray,rI.members,!0),this.collisionVertexBufferExt=r.createVertexBuffer(this.collisionVertexArrayExt,iI.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}qe(g1,"CollisionBuffers");class qc{constructor(r){this.collisionBoxArray=r.collisionBoxArray,this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(b=>b.id),this.index=r.index,this.pixelRatio=r.pixelRatio,this.sourceLayerIndex=r.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Ps([]),this.placementViewportMatrix=Ps([]);const s=this.layers[0]._unevaluatedLayout._values;this.textSizeData=o1(this.zoom,s["text-size"]),this.iconSizeData=o1(this.zoom,s["icon-size"]);const u=this.layers[0].layout,p=u.get("symbol-sort-key"),g=u.get("symbol-z-order");this.canOverlap=u.get("text-allow-overlap")||u.get("icon-allow-overlap")||u.get("text-ignore-placement")||u.get("icon-ignore-placement"),this.sortFeaturesByKey=g!=="viewport-y"&&p.constantOr(1)!==void 0,this.sortFeaturesByY=(g==="viewport-y"||g==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=u.get("text-writing-mode").map(b=>za[b]),this.stateDependentLayerIds=this.layers.filter(b=>b.isStateDependent()).map(b=>b.id),this.sourceID=r.sourceID,this.projection=r.projection}createArrays(){this.text=new m1(new td(this.layers,this.zoom,r=>/^text/.test(r))),this.icon=new m1(new td(this.layers,this.zoom,r=>/^icon/.test(r))),this.glyphOffsetArray=new rw,this.lineVertexArray=new iw,this.symbolInstances=new nw}calculateGlyphDependencies(r,s,u,p,g){for(let b=0;b<r.length;b++)if(s[r.charCodeAt(b)]=!0,p&&g){const x=ap[r.charAt(b)];x&&(s[x.charCodeAt(0)]=!0)}}populate(r,s,u,p){const g=this.layers[0],b=g.layout,x=this.projection.name==="globe",T=b.get("text-font"),k=b.get("text-field"),L=b.get("icon-image"),O=(k.value.kind!=="constant"||k.value.value instanceof $i&&!k.value.value.isEmpty()||k.value.value.toString().length>0)&&(T.value.kind!=="constant"||T.value.value.length>0),R=L.value.kind!=="constant"||!!L.value.value||Object.keys(L.parameters).length>0,U=b.get("symbol-sort-key");if(this.features=[],!O&&!R)return;const $=s.iconDependencies,X=s.glyphDependencies,nt=s.availableImages,dt=new Ft(this.zoom);for(const{feature:yt,id:lt,index:_t,sourceLayerIndex:Et}of r){const xt=g._featureFilter.needGeometry,qt=ad(yt,xt);if(!g._featureFilter.filter(dt,qt,u))continue;if(xt||(qt.geometry=Hl(yt,u,p)),x&&yt.type!==1&&u.z<=5){const Zt=qt.geometry,ee=.98078528056,re=(de,ye)=>Wa(Zf(de.x,de.y,u,1),Zf(ye.x,ye.y,u,1))<ee;for(let de=0;de<Zt.length;de++)Zt[de]=n6(Zt[de],re)}let $t,Qt;if(O){const Zt=g.getValueAndResolveTokens("text-field",qt,u,nt),ee=$i.factory(Zt);HI(ee)&&(this.hasRTLText=!0),(!this.hasRTLText||Tt()==="unavailable"||this.hasRTLText&&Mt.isParsed())&&($t=sI(ee,g,qt))}if(R){const Zt=g.getValueAndResolveTokens("icon-image",qt,u,nt);Qt=Zt instanceof Ji?Zt:Ji.fromString(Zt)}if(!$t&&!Qt)continue;const _e=this.sortFeaturesByKey?U.evaluate(qt,{},u):void 0;if(this.features.push({id:lt,text:$t,icon:Qt,index:_t,sourceLayerIndex:Et,geometry:qt.geometry,properties:yt.properties,type:GI[yt.type],sortKey:_e}),Qt&&($[Qt.name]=!0),$t){const Zt=T.evaluate(qt,{},u).join(","),ee=b.get("text-rotation-alignment")==="map"&&b.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(za.vertical)>=0;for(const re of $t.sections)if(re.image)$[re.image.name]=!0;else{const de=v($t.toString()),ye=re.fontStack||Zt,Yt=X[ye]=X[ye]||{};this.calculateGlyphDependencies(re.text,Yt,ee,this.allowVerticalPlacement,de)}}}b.get("symbol-placement")==="line"&&(this.features=function(yt){const lt={},_t={},Et=[];let xt=0;function qt(Zt){Et.push(yt[Zt]),xt++}function $t(Zt,ee,re){const de=_t[Zt];return delete _t[Zt],_t[ee]=de,Et[de].geometry[0].pop(),Et[de].geometry[0]=Et[de].geometry[0].concat(re[0]),de}function Qt(Zt,ee,re){const de=lt[ee];return delete lt[ee],lt[Zt]=de,Et[de].geometry[0].shift(),Et[de].geometry[0]=re[0].concat(Et[de].geometry[0]),de}function _e(Zt,ee,re){const de=re?ee[0][ee[0].length-1]:ee[0][0];return`${Zt}:${de.x}:${de.y}`}for(let Zt=0;Zt<yt.length;Zt++){const ee=yt[Zt],re=ee.geometry,de=ee.text?ee.text.toString():null;if(!de){qt(Zt);continue}const ye=_e(de,re),Yt=_e(de,re,!0);if(ye in _t&&Yt in lt&&_t[ye]!==lt[Yt]){const Pe=Qt(ye,Yt,re),fn=$t(ye,Yt,Et[Pe].geometry);delete lt[ye],delete _t[Yt],_t[_e(de,Et[fn].geometry,!0)]=fn,Et[Pe].geometry=null}else ye in _t?$t(ye,Yt,re):Yt in lt?Qt(ye,Yt,re):(qt(Zt),lt[ye]=xt-1,_t[Yt]=xt-1)}return Et.filter(Zt=>Zt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((yt,lt)=>yt.sortKey-lt.sortKey)}update(r,s,u,p){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(r,s,this.layers,u,p),this.icon.programConfigurations.updatePaintArrays(r,s,this.layers,u,p))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(r){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(r),this.iconCollisionBox.upload(r)),this.text.upload(r,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(r,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=Q2(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(r,s){const u=this.lineVertexArray.length;if(r.segment!==void 0)for(const{x:p,y:g}of s)this.lineVertexArray.emplaceBack(p,g);return{lineStartIndex:u,lineLength:this.lineVertexArray.length-u}}addSymbols(r,s,u,p,g,b,x,T,k,L,O,R,U,$){const X=r.indexArray,nt=r.layoutVertexArray,dt=r.globeExtVertexArray,yt=r.segments.prepareSegment(4*s.length,nt,X,this.canOverlap?b.sortKey:void 0),lt=this.glyphOffsetArray.length,_t=yt.vertexLength,Et=this.allowVerticalPlacement&&x===za.vertical?Math.PI/2:0,xt=b.text&&b.text.sections;for(let $t=0;$t<s.length;$t++){const{tl:Qt,tr:_e,bl:Zt,br:ee,tex:re,pixelOffsetTL:de,pixelOffsetBR:ye,minFontScaleX:Yt,minFontScaleY:Pe,glyphOffset:fn,isSDF:Fe,sectionIndex:Xe}=s[$t],Le=yt.vertexLength,mn=fn[1];if(Zg(nt,k.x,k.y,Qt.x,mn+Qt.y,re.x,re.y,u,Fe,de.x,de.y,Yt,Pe),Zg(nt,k.x,k.y,_e.x,mn+_e.y,re.x+re.w,re.y,u,Fe,ye.x,de.y,Yt,Pe),Zg(nt,k.x,k.y,Zt.x,mn+Zt.y,re.x,re.y+re.h,u,Fe,de.x,ye.y,Yt,Pe),Zg(nt,k.x,k.y,ee.x,mn+ee.y,re.x+re.w,re.y+re.h,u,Fe,ye.x,ye.y,Yt,Pe),T){const{x:jn,y:Rn,z:On}=T.anchor,[yn,hr,Cn]=T.up;Xg(dt,jn,Rn,On,yn,hr,Cn),Xg(dt,jn,Rn,On,yn,hr,Cn),Xg(dt,jn,Rn,On,yn,hr,Cn),Xg(dt,jn,Rn,On,yn,hr,Cn),Yg(r.dynamicLayoutVertexArray,jn,Rn,On,Et)}else Yg(r.dynamicLayoutVertexArray,k.x,k.y,k.z,Et);X.emplaceBack(Le,Le+1,Le+2),X.emplaceBack(Le+1,Le+2,Le+3),yt.vertexLength+=4,yt.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(fn[0]),$t!==s.length-1&&Xe===s[$t+1].sectionIndex||r.programConfigurations.populatePaintArrays(nt.length,b,b.index,{},U,$,xt&&xt[Xe])}const qt=T?T.anchor:k;r.placedSymbolArray.emplaceBack(qt.x,qt.y,qt.z,k.x,k.y,lt,this.glyphOffsetArray.length-lt,_t,L,O,k.segment,u?u[0]:0,u?u[1]:0,p[0],p[1],x,0,!1,0,R,0)}_commitLayoutVertex(r,s,u,p,g,b,x){r.emplaceBack(s,u,p,g,b,Math.round(x.x),Math.round(x.y))}_addCollisionDebugVertices(r,s,u,p,g,b,x){const T=u.segments.prepareSegment(4,u.layoutVertexArray,u.indexArray),k=T.vertexLength,L=x.tileAnchorX,O=x.tileAnchorY;for(let U=0;U<4;U++)u.collisionVertexArray.emplaceBack(0,0,0,0);u.collisionVertexArrayExt.emplaceBack(s,-r.padding,-r.padding),u.collisionVertexArrayExt.emplaceBack(s,r.padding,-r.padding),u.collisionVertexArrayExt.emplaceBack(s,r.padding,r.padding),u.collisionVertexArrayExt.emplaceBack(s,-r.padding,r.padding),this._commitLayoutVertex(u.layoutVertexArray,p,g,b,L,O,new et(r.x1,r.y1)),this._commitLayoutVertex(u.layoutVertexArray,p,g,b,L,O,new et(r.x2,r.y1)),this._commitLayoutVertex(u.layoutVertexArray,p,g,b,L,O,new et(r.x2,r.y2)),this._commitLayoutVertex(u.layoutVertexArray,p,g,b,L,O,new et(r.x1,r.y2)),T.vertexLength+=4;const R=u.indexArray;R.emplaceBack(k,k+1),R.emplaceBack(k+1,k+2),R.emplaceBack(k+2,k+3),R.emplaceBack(k+3,k),T.primitiveLength+=4}_addTextDebugCollisionBoxes(r,s,u,p,g,b){for(let x=p;x<g;x++){const T=u.get(x),k=this.getSymbolInstanceTextSize(r,b,s,x);this._addCollisionDebugVertices(T,k,this.textCollisionBox,T.projectedAnchorX,T.projectedAnchorY,T.projectedAnchorZ,b)}}_addIconDebugCollisionBoxes(r,s,u,p,g,b){for(let x=p;x<g;x++){const T=u.get(x),k=this.getSymbolInstanceIconSize(r,s,b.placedIconSymbolIndex);this._addCollisionDebugVertices(T,k,this.iconCollisionBox,T.projectedAnchorX,T.projectedAnchorY,T.projectedAnchorZ,b)}}generateCollisionDebugBuffers(r,s){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new g1(si,x2.members,Qs),this.iconCollisionBox=new g1(si,x2.members,Qs);const u=Ch(this.iconSizeData,r),p=Ch(this.textSizeData,r);for(let g=0;g<this.symbolInstances.length;g++){const b=this.symbolInstances.get(g);this._addTextDebugCollisionBoxes(p,r,s,b.textBoxStartIndex,b.textBoxEndIndex,b),this._addTextDebugCollisionBoxes(p,r,s,b.verticalTextBoxStartIndex,b.verticalTextBoxEndIndex,b),this._addIconDebugCollisionBoxes(u,r,s,b.iconBoxStartIndex,b.iconBoxEndIndex,b),this._addIconDebugCollisionBoxes(u,r,s,b.verticalIconBoxStartIndex,b.verticalIconBoxEndIndex,b)}}getSymbolInstanceTextSize(r,s,u,p){const g=this.text.placedSymbolArray.get(s.rightJustifiedTextSymbolIndex>=0?s.rightJustifiedTextSymbolIndex:s.centerJustifiedTextSymbolIndex>=0?s.centerJustifiedTextSymbolIndex:s.leftJustifiedTextSymbolIndex>=0?s.leftJustifiedTextSymbolIndex:s.verticalPlacedTextSymbolIndex>=0?s.verticalPlacedTextSymbolIndex:p),b=Ng(this.textSizeData,r,g)/_o;return this.tilePixelRatio*b}getSymbolInstanceIconSize(r,s,u){const p=this.icon.placedSymbolArray.get(u),g=Ng(this.iconSizeData,r,p);return this.tilePixelRatio*g}_commitDebugCollisionVertexUpdate(r,s,u){r.emplaceBack(s,-u,-u),r.emplaceBack(s,u,-u),r.emplaceBack(s,u,u),r.emplaceBack(s,-u,u)}_updateTextDebugCollisionBoxes(r,s,u,p,g,b){for(let x=p;x<g;x++){const T=u.get(x),k=this.getSymbolInstanceTextSize(r,b,s,x);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,k,T.padding)}}_updateIconDebugCollisionBoxes(r,s,u,p,g,b){for(let x=p;x<g;x++){const T=u.get(x),k=this.getSymbolInstanceIconSize(r,s,b);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,k,T.padding)}}updateCollisionDebugBuffers(r,s){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const u=Ch(this.iconSizeData,r),p=Ch(this.textSizeData,r);for(let g=0;g<this.symbolInstances.length;g++){const b=this.symbolInstances.get(g);this._updateTextDebugCollisionBoxes(p,r,s,b.textBoxStartIndex,b.textBoxEndIndex,b),this._updateTextDebugCollisionBoxes(p,r,s,b.verticalTextBoxStartIndex,b.verticalTextBoxEndIndex,b),this._updateIconDebugCollisionBoxes(u,r,s,b.iconBoxStartIndex,b.iconBoxEndIndex,b.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(u,r,s,b.verticalIconBoxStartIndex,b.verticalIconBoxEndIndex,b.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(r,s,u,p,g,b,x,T,k){const L={};if(s<u){const{x1:O,y1:R,x2:U,y2:$,padding:X,projectedAnchorX:nt,projectedAnchorY:dt,projectedAnchorZ:yt,tileAnchorX:lt,tileAnchorY:_t,featureIndex:Et}=r.get(s);L.textBox={x1:O,y1:R,x2:U,y2:$,padding:X,projectedAnchorX:nt,projectedAnchorY:dt,projectedAnchorZ:yt,tileAnchorX:lt,tileAnchorY:_t},L.textFeatureIndex=Et}if(p<g){const{x1:O,y1:R,x2:U,y2:$,padding:X,projectedAnchorX:nt,projectedAnchorY:dt,projectedAnchorZ:yt,tileAnchorX:lt,tileAnchorY:_t,featureIndex:Et}=r.get(p);L.verticalTextBox={x1:O,y1:R,x2:U,y2:$,padding:X,projectedAnchorX:nt,projectedAnchorY:dt,projectedAnchorZ:yt,tileAnchorX:lt,tileAnchorY:_t},L.verticalTextFeatureIndex=Et}if(b<x){const{x1:O,y1:R,x2:U,y2:$,padding:X,projectedAnchorX:nt,projectedAnchorY:dt,projectedAnchorZ:yt,tileAnchorX:lt,tileAnchorY:_t,featureIndex:Et}=r.get(b);L.iconBox={x1:O,y1:R,x2:U,y2:$,padding:X,projectedAnchorX:nt,projectedAnchorY:dt,projectedAnchorZ:yt,tileAnchorX:lt,tileAnchorY:_t},L.iconFeatureIndex=Et}if(T<k){const{x1:O,y1:R,x2:U,y2:$,padding:X,projectedAnchorX:nt,projectedAnchorY:dt,projectedAnchorZ:yt,tileAnchorX:lt,tileAnchorY:_t,featureIndex:Et}=r.get(T);L.verticalIconBox={x1:O,y1:R,x2:U,y2:$,padding:X,projectedAnchorX:nt,projectedAnchorY:dt,projectedAnchorZ:yt,tileAnchorX:lt,tileAnchorY:_t},L.verticalIconFeatureIndex=Et}return L}deserializeCollisionBoxes(r){this.collisionArrays=[];for(let s=0;s<this.symbolInstances.length;s++){const u=this.symbolInstances.get(s);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(r,u.textBoxStartIndex,u.textBoxEndIndex,u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u.iconBoxStartIndex,u.iconBoxEndIndex,u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(r,s){const u=r.placedSymbolArray.get(s),p=u.vertexStartIndex+4*u.numGlyphs;for(let g=u.vertexStartIndex;g<p;g+=4)r.indexArray.emplaceBack(g,g+1,g+2),r.indexArray.emplaceBack(g+1,g+2,g+3)}getSortedSymbolIndexes(r){if(this.sortedAngle===r&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const s=Math.sin(r),u=Math.cos(r),p=[],g=[],b=[];for(let x=0;x<this.symbolInstances.length;++x){b.push(x);const T=this.symbolInstances.get(x);p.push(0|Math.round(s*T.tileAnchorX+u*T.tileAnchorY)),g.push(T.featureIndex)}return b.sort((x,T)=>p[x]-p[T]||g[T]-g[x]),b}addToSortKeyRanges(r,s){const u=this.sortKeyRanges[this.sortKeyRanges.length-1];u&&u.sortKey===s?u.symbolInstanceEnd=r+1:this.sortKeyRanges.push({sortKey:s,symbolInstanceStart:r,symbolInstanceEnd:r+1})}sortFeatures(r){if(this.sortFeaturesByY&&this.sortedAngle!==r&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(r),this.sortedAngle=r,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const s of this.symbolInstanceIndexes){const u=this.symbolInstances.get(s);this.featureSortOrder.push(u.featureIndex);const{rightJustifiedTextSymbolIndex:p,centerJustifiedTextSymbolIndex:g,leftJustifiedTextSymbolIndex:b,verticalPlacedTextSymbolIndex:x,placedIconSymbolIndex:T,verticalPlacedIconSymbolIndex:k}=u;p>=0&&this.addIndicesForPlacedSymbol(this.text,p),g>=0&&g!==p&&this.addIndicesForPlacedSymbol(this.text,g),b>=0&&b!==g&&b!==p&&this.addIndicesForPlacedSymbol(this.text,b),x>=0&&this.addIndicesForPlacedSymbol(this.text,x),T>=0&&this.addIndicesForPlacedSymbol(this.icon,T),k>=0&&this.addIndicesForPlacedSymbol(this.icon,k)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}qe(qc,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),qc.MAX_GLYPHS=65535,qc.addDynamicAttributes=Yg;const WI=new pe({"symbol-placement":new Ot(Kt.layout_symbol["symbol-placement"]),"symbol-spacing":new Ot(Kt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ot(Kt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Wt(Kt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ot(Kt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Ot(Kt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Ot(Kt.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ot(Kt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ot(Kt.layout_symbol["icon-rotation-alignment"]),"icon-size":new Wt(Kt.layout_symbol["icon-size"]),"icon-text-fit":new Ot(Kt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Ot(Kt.layout_symbol["icon-text-fit-padding"]),"icon-image":new Wt(Kt.layout_symbol["icon-image"]),"icon-rotate":new Wt(Kt.layout_symbol["icon-rotate"]),"icon-padding":new Ot(Kt.layout_symbol["icon-padding"]),"icon-keep-upright":new Ot(Kt.layout_symbol["icon-keep-upright"]),"icon-offset":new Wt(Kt.layout_symbol["icon-offset"]),"icon-anchor":new Wt(Kt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ot(Kt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ot(Kt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ot(Kt.layout_symbol["text-rotation-alignment"]),"text-field":new Wt(Kt.layout_symbol["text-field"]),"text-font":new Wt(Kt.layout_symbol["text-font"]),"text-size":new Wt(Kt.layout_symbol["text-size"]),"text-max-width":new Wt(Kt.layout_symbol["text-max-width"]),"text-line-height":new Wt(Kt.layout_symbol["text-line-height"]),"text-letter-spacing":new Wt(Kt.layout_symbol["text-letter-spacing"]),"text-justify":new Wt(Kt.layout_symbol["text-justify"]),"text-radial-offset":new Wt(Kt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ot(Kt.layout_symbol["text-variable-anchor"]),"text-anchor":new Wt(Kt.layout_symbol["text-anchor"]),"text-max-angle":new Ot(Kt.layout_symbol["text-max-angle"]),"text-writing-mode":new Ot(Kt.layout_symbol["text-writing-mode"]),"text-rotate":new Wt(Kt.layout_symbol["text-rotate"]),"text-padding":new Ot(Kt.layout_symbol["text-padding"]),"text-keep-upright":new Ot(Kt.layout_symbol["text-keep-upright"]),"text-transform":new Wt(Kt.layout_symbol["text-transform"]),"text-offset":new Wt(Kt.layout_symbol["text-offset"]),"text-allow-overlap":new Ot(Kt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Ot(Kt.layout_symbol["text-ignore-placement"]),"text-optional":new Ot(Kt.layout_symbol["text-optional"])});var _1={paint:new pe({"icon-opacity":new Wt(Kt.paint_symbol["icon-opacity"]),"icon-color":new Wt(Kt.paint_symbol["icon-color"]),"icon-halo-color":new Wt(Kt.paint_symbol["icon-halo-color"]),"icon-halo-width":new Wt(Kt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Wt(Kt.paint_symbol["icon-halo-blur"]),"icon-translate":new Ot(Kt.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ot(Kt.paint_symbol["icon-translate-anchor"]),"text-opacity":new Wt(Kt.paint_symbol["text-opacity"]),"text-color":new Wt(Kt.paint_symbol["text-color"],{runtimeType:wo,getOverride:a=>a.textColor,hasOverride:a=>!!a.textColor}),"text-halo-color":new Wt(Kt.paint_symbol["text-halo-color"]),"text-halo-width":new Wt(Kt.paint_symbol["text-halo-width"]),"text-halo-blur":new Wt(Kt.paint_symbol["text-halo-blur"]),"text-translate":new Ot(Kt.paint_symbol["text-translate"]),"text-translate-anchor":new Ot(Kt.paint_symbol["text-translate-anchor"])}),layout:WI};class t3{constructor(r){this.type=r.property.overrides?r.property.overrides.runtimeType:fs,this.defaultValue=r}evaluate(r){if(r.formattedSection){const s=this.defaultValue.property.overrides;if(s&&s.hasOverride(r.formattedSection))return s.getOverride(r.formattedSection)}return r.feature&&r.featureState?this.defaultValue.evaluate(r.feature,r.featureState):this.defaultValue.property.specification.default}eachChild(r){this.defaultValue.isConstant()||r(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}qe(t3,"FormatSectionOverride",{omit:["defaultValue"]});class Kg extends Is{constructor(r){super(r,_1)}recalculate(r,s){super.recalculate(r,s),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const u=this.layout.get("text-writing-mode");if(u){const p=[];for(const g of u)p.indexOf(g)<0&&p.push(g);this.layout._values["text-writing-mode"]=p}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(r,s,u,p){const g=this.layout.get(r).evaluate(s,{},u,p),b=this._unevaluatedLayout._values[r];return b.isDataDriven()||Pc(b.value)||!g?g:function(x,T){return T.replace(/{([^{}]+)}/g,(k,L)=>L in x?String(x[L]):"")}(s.properties,g)}createBucket(r){return new qc(r)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const r of _1.paint.overridableProperties){if(!Kg.hasPaintOverride(this.layout,r))continue;const s=this.paint.get(r),u=new t3(s),p=new ks(u,s.property.specification);let g=null;g=s.value.kind==="constant"||s.value.kind==="source"?new nh("source",p):new Ul("composite",p,s.value.zoomStops,s.value._interpolationType),this.paint._values[r]=new ue(s.property,g,s.parameters)}}_handleOverridablePaintPropertyUpdate(r,s,u){return!(!this.layout||s.isDataDriven()||u.isDataDriven())&&Kg.hasPaintOverride(this.layout,r)}static hasPaintOverride(r,s){const u=r.get("text-field"),p=_1.paint.properties[s];let g=!1;const b=x=>{for(const T of x)if(p.overrides&&p.overrides.hasOverride(T))return void(g=!0)};if(u.value.kind==="constant"&&u.value.value instanceof $i)b(u.value.value.sections);else if(u.value.kind==="source"){const x=k=>{g||(k instanceof Us&&fi(k.value)===gt?b(k.value.sections):k instanceof kl?b(k.sections):k.eachChild(x))},T=u.value;T._styleExpression&&x(T._styleExpression.expression)}return g}getProgramConfiguration(r){return new Uc(this,r)}}var ZI={paint:new pe({"background-color":new Ot(Kt.paint_background["background-color"]),"background-pattern":new Ot(Kt.paint_background["background-pattern"]),"background-opacity":new Ot(Kt.paint_background["background-opacity"])})},XI={paint:new pe({"raster-opacity":new Ot(Kt.paint_raster["raster-opacity"]),"raster-hue-rotate":new Ot(Kt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ot(Kt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ot(Kt.paint_raster["raster-brightness-max"]),"raster-saturation":new Ot(Kt.paint_raster["raster-saturation"]),"raster-contrast":new Ot(Kt.paint_raster["raster-contrast"]),"raster-resampling":new Ot(Kt.paint_raster["raster-resampling"]),"raster-fade-duration":new Ot(Kt.paint_raster["raster-fade-duration"])})};class YI extends Is{constructor(r){super(r,{}),this.implementation=r}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isLayerDraped(){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(r){this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)}onRemove(r){this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)}}var KI={paint:new pe({"sky-type":new Ot(Kt.paint_sky["sky-type"]),"sky-atmosphere-sun":new Ot(Kt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Ot(Kt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Ot(Kt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Ot(Kt.paint_sky["sky-gradient-radius"]),"sky-gradient":new ie(Kt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Ot(Kt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Ot(Kt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Ot(Kt.paint_sky["sky-opacity"])})};function y1(a,r,s){const u=[0,0,1],p=Ew([]);return kw(p,p,s?-jt(a)+Math.PI:jt(a)),Tw(p,p,-jt(r)),bw(u,u,p),Oo(u,u)}const JI={circle:class extends Is{constructor(a){super(a,c6)}createBucket(a){return new Wy(a)}queryRadius(a){const r=a;return xh("circle-radius",this,r)+xh("circle-stroke-width",this,r)+Mg(this.paint.get("circle-translate"))}queryIntersectsFeature(a,r,s,u,p,g,b,x){const T=Hw(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),g.angle,a.pixelToTileUnitsFactor),k=this.paint.get("circle-radius").evaluate(r,s)+this.paint.get("circle-stroke-width").evaluate(r,s);return Ww(a,u,g,b,x,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",T,k)}getProgramIds(){return["circle"]}getProgramConfiguration(a){return new Uc(this,a)}},heatmap:class extends Is{createBucket(a){return new Xw(a)}constructor(a){super(a,f6),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(a){a==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Ky({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(a){return xh("heatmap-radius",this,a)}queryIntersectsFeature(a,r,s,u,p,g,b,x){const T=this.paint.get("heatmap-radius").evaluate(r,s);return Ww(a,u,g,b,x,!0,!0,new et(0,0),T)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(a){return new Uc(this,a)}},hillshade:class extends Is{constructor(a){super(a,p6)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends Is{constructor(a){super(a,I6)}getProgramIds(){const a=this.paint.get("fill-pattern"),r=a&&a.constantOr(1),s=[r?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&s.push(r&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),s}getProgramConfiguration(a){return new Uc(this,a)}recalculate(a,r){super.recalculate(a,r);const s=this.paint._values["fill-outline-color"];s.value.kind==="constant"&&s.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(a){return new zg(a)}queryRadius(){return Mg(this.paint.get("fill-translate"))}queryIntersectsFeature(a,r,s,u,p,g){return!a.queryGeometry.isAboveHorizon&&Uw(qw(a.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),g.angle,a.pixelToTileUnitsFactor),u)}isTileClipped(){return!0}},"fill-extrusion":class extends Is{constructor(a){super(a,H6)}createBucket(a){return new rp(a)}queryRadius(){return Mg(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(a){return new Uc(this,a)}queryIntersectsFeature(a,r,s,u,p,g,b,x,T){const k=Hw(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),g.angle,a.pixelToTileUnitsFactor),L=this.paint.get("fill-extrusion-height").evaluate(r,s),O=this.paint.get("fill-extrusion-base").evaluate(r,s),R=[0,0],U=x&&g.elevation,$=g.elevation?g.elevation.exaggeration():1,X=a.tile.getBucket(this);if(U&&X instanceof rp){const _t=X.centroidVertexArray,Et=T+1;Et<_t.length&&(R[0]=_t.geta_centroid_pos0(Et),R[1]=_t.geta_centroid_pos1(Et))}if(R[0]===0&&R[1]===1)return!1;g.projection.name==="globe"&&(u=f2([u],[new et(0,0),new et(bn,bn)],a.tileID.canonical).map(_t=>_t.polygon).flat());const nt=U?x:null,[dt,yt]=function(_t,Et,xt,qt,$t,Qt,_e,Zt,ee,re,de){return _t.projection.name==="globe"?function(ye,Yt,Pe,fn,Fe,Xe,Le,mn,jn,Rn,On){const yn=[],hr=[],Cn=ye.projection.upVectorScale(On,ye.center.lat,ye.worldSize).metersToTile,Un=[0,0,0,1],br=[0,0,0,1],Or=(Dr,Nr,li,eo)=>{Dr[0]=Nr,Dr[1]=li,Dr[2]=eo,Dr[3]=1},Ir=h2();Pe>0&&(Pe+=Ir),fn+=Ir;for(const Dr of Yt){const Nr=[],li=[];for(const eo of Dr){const fr=eo.x+Fe.x,Ci=eo.y+Fe.y,Ei=ye.projection.projectTilePoint(fr,Ci,On),or=ye.projection.upVector(On,eo.x,eo.y);let Hr=Pe,zi=fn;if(Le){const vr=_2(fr,Ci,Pe,fn,Le,mn,jn,Rn);Hr+=vr.base,zi+=vr.top}Pe!==0?Or(Un,Ei.x+or[0]*Cn*Hr,Ei.y+or[1]*Cn*Hr,Ei.z+or[2]*Cn*Hr):Or(Un,Ei.x,Ei.y,Ei.z),Or(br,Ei.x+or[0]*Cn*zi,Ei.y+or[1]*Cn*zi,Ei.z+or[2]*Cn*zi),gi(Un,Un,Xe),gi(br,br,Xe),Nr.push(new kh(Un[0],Un[1],Un[2])),li.push(new kh(br[0],br[1],br[2]))}yn.push(Nr),hr.push(li)}return[yn,hr]}(_t,Et,xt,qt,$t,Qt,_e,Zt,ee,re,de):_e?function(ye,Yt,Pe,fn,Fe,Xe,Le,mn,jn){const Rn=[],On=[],yn=[0,0,0,1];for(const hr of ye){const Cn=[],Un=[];for(const br of hr){const Or=br.x+fn.x,Ir=br.y+fn.y,Dr=_2(Or,Ir,Yt,Pe,Xe,Le,mn,jn);yn[0]=Or,yn[1]=Ir,yn[2]=Dr.base,yn[3]=1,rd(yn,yn,Fe),yn[3]=Math.max(yn[3],1e-5);const Nr=new kh(yn[0]/yn[3],yn[1]/yn[3],yn[2]/yn[3]);yn[0]=Or,yn[1]=Ir,yn[2]=Dr.top,yn[3]=1,rd(yn,yn,Fe),yn[3]=Math.max(yn[3],1e-5);const li=new kh(yn[0]/yn[3],yn[1]/yn[3],yn[2]/yn[3]);Cn.push(Nr),Un.push(li)}Rn.push(Cn),On.push(Un)}return[Rn,On]}(Et,xt,qt,$t,Qt,_e,Zt,ee,re):function(ye,Yt,Pe,fn,Fe){const Xe=[],Le=[],mn=Fe[8]*Yt,jn=Fe[9]*Yt,Rn=Fe[10]*Yt,On=Fe[11]*Yt,yn=Fe[8]*Pe,hr=Fe[9]*Pe,Cn=Fe[10]*Pe,Un=Fe[11]*Pe;for(const br of ye){const Or=[],Ir=[];for(const Dr of br){const Nr=Dr.x+fn.x,li=Dr.y+fn.y,eo=Fe[0]*Nr+Fe[4]*li+Fe[12],fr=Fe[1]*Nr+Fe[5]*li+Fe[13],Ci=Fe[2]*Nr+Fe[6]*li+Fe[14],Ei=Fe[3]*Nr+Fe[7]*li+Fe[15],or=eo+mn,Hr=fr+jn,zi=Ci+Rn,vr=Math.max(Ei+On,1e-5),_i=eo+yn,Co=fr+hr,no=Ci+Cn,ro=Math.max(Ei+Un,1e-5);Or.push(new kh(or/vr,Hr/vr,zi/vr)),Ir.push(new kh(_i/ro,Co/ro,no/ro))}Xe.push(Or),Le.push(Ir)}return[Xe,Le]}(Et,xt,qt,$t,Qt)}(g,u,O,L,k,b,nt,R,$,g.center.lat,a.tileID.canonical),lt=a.queryGeometry;return function(_t,Et,xt){let qt=1/0;Uw(xt,Et)&&(qt=g2(xt,Et[0]));for(let $t=0;$t<Et.length;$t++){const Qt=Et[$t],_e=_t[$t];for(let Zt=0;Zt<Qt.length-1;Zt++){const ee=Qt[Zt],re=[ee,Qt[Zt+1],_e[Zt+1],_e[Zt],ee];jw(xt,re)&&(qt=Math.min(qt,g2(xt,re)))}}return qt!==1/0&&qt}(dt,yt,lt.isPointQuery()?lt.screenBounds:lt.screenGeometry)}},line:class extends Is{constructor(a){super(a,y2),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(a){if(a==="line-gradient"){const r=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=r._styleExpression&&r._styleExpression.expression instanceof Yo,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(a,r){super.recalculate(a,r),this.paint._values["line-floorwidth"]=b2.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,a)}createBucket(a){return new Fg(a)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(a){return new Uc(this,a)}queryRadius(a){const r=a,s=v2(xh("line-width",this,r),xh("line-gap-width",this,r)),u=xh("line-offset",this,r);return s/2+Math.abs(u)+Mg(this.paint.get("line-translate"))}queryIntersectsFeature(a,r,s,u,p,g){if(a.queryGeometry.isAboveHorizon)return!1;const b=qw(a.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),g.angle,a.pixelToTileUnitsFactor),x=a.pixelToTileUnitsFactor/2*v2(this.paint.get("line-width").evaluate(r,s),this.paint.get("line-gap-width").evaluate(r,s)),T=this.paint.get("line-offset").evaluate(r,s);return T&&(u=function(k,L){const O=[],R=new et(0,0);for(let U=0;U<k.length;U++){const $=k[U],X=[];for(let nt=0;nt<$.length;nt++){const dt=$[nt-1],yt=$[nt],lt=$[nt+1],_t=nt===0?R:yt.sub(dt)._unit()._perp(),Et=nt===$.length-1?R:lt.sub(yt)._unit()._perp(),xt=_t._add(Et)._unit();xt._mult(1/(xt.x*Et.x+xt.y*Et.y)),X.push(xt._mult(L)._add(yt))}O.push(X)}return O}(u,T*a.pixelToTileUnitsFactor)),function(k,L,O){for(let R=0;R<L.length;R++){const U=L[R];if(k.length>=3){for(let $=0;$<U.length;$++)if(sd(k,U[$]))return!0}if(o6(k,U,O))return!0}return!1}(b,u,x)}isTileClipped(){return!0}},symbol:Kg,background:class extends Is{constructor(a){super(a,ZI)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends Is{constructor(a){super(a,XI)}getProgramIds(){return["raster"]}},sky:class extends Is{constructor(a){super(a,KI),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(a){a==="sky-gradient"?this._updateColorRamp():a!=="sky-atmosphere-sun"&&a!=="sky-atmosphere-halo-color"&&a!=="sky-atmosphere-color"&&a!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Ky({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(a){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const r=a.style.light.properties.get("position");return this._lightPosition.azimuthal!==r.azimuthal||this._lightPosition.polar!==r.polar}return!1}getCenter(a,r){if(this.paint.get("sky-type")==="atmosphere"){const u=this.paint.get("sky-atmosphere-sun"),p=!u,g=a.style.light,b=g.properties.get("position");return p&&g.properties.get("anchor")==="viewport"&&Qe("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),p?y1(b.azimuthal,90-b.polar,r):y1(u[0],90-u[1],r)}const s=this.paint.get("sky-gradient-center");return y1(s[0],90-s[1],r)}is3D(){return!1}isSky(){return!0}markSkyboxValid(a){this._skyboxInvalidated=!1,this._lightPosition=a.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const a=this.paint.get("sky-type");return a==="atmosphere"?["skyboxCapture","skybox"]:a==="gradient"?["skyboxGradient"]:null}}};class pp{constructor(r,s,u,p){this.context=r,this.format=u,this.texture=r.gl.createTexture(),this.update(s,p)}update(r,s,u){const{width:p,height:g}=r,{context:b}=this,{gl:x}=b,{HTMLImageElement:T,HTMLCanvasElement:k,HTMLVideoElement:L,ImageData:O,ImageBitmap:R}=y;if(x.bindTexture(x.TEXTURE_2D,this.texture),b.pixelStoreUnpackFlipY.set(!1),b.pixelStoreUnpack.set(1),b.pixelStoreUnpackPremultiplyAlpha.set(this.format===x.RGBA&&(!s||s.premultiply!==!1)),u||this.size&&this.size[0]===p&&this.size[1]===g){const{x:U,y:$}=u||{x:0,y:0};r instanceof T||r instanceof k||r instanceof L||r instanceof O||R&&r instanceof R?x.texSubImage2D(x.TEXTURE_2D,0,U,$,x.RGBA,x.UNSIGNED_BYTE,r):x.texSubImage2D(x.TEXTURE_2D,0,U,$,p,g,x.RGBA,x.UNSIGNED_BYTE,r.data)}else this.size=[p,g],r instanceof T||r instanceof k||r instanceof L||r instanceof O||R&&r instanceof R?x.texImage2D(x.TEXTURE_2D,0,this.format,this.format,x.UNSIGNED_BYTE,r):x.texImage2D(x.TEXTURE_2D,0,this.format,p,g,0,this.format,x.UNSIGNED_BYTE,r.data);this.useMipmap=Boolean(s&&s.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&x.generateMipmap(x.TEXTURE_2D)}bind(r,s){const{context:u}=this,{gl:p}=u;p.bindTexture(p.TEXTURE_2D,this.texture),r!==this.filter&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,r),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,this.useMipmap?r===p.NEAREST?p.NEAREST_MIPMAP_NEAREST:p.LINEAR_MIPMAP_NEAREST:r),this.filter=r),s!==this.wrap&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,s),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,s),this.wrap=s)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:r}=this.context;r.deleteTexture(this.texture),this.texture=null}}class QI{constructor(r){this._callback=r,this._triggered=!1,typeof MessageChannel!="undefined"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class tP{constructor(){this.tasks={},this.taskQueue=[],He(["process"],this),this.invoker=new QI(this.process),this.nextId=0}add(r,s){const u=this.nextId++,p=function({type:g,isSymbolTile:b,zoom:x}){return x=x||0,g==="message"?0:g!=="maybePrepare"||b?g!=="parseTile"||b?g==="parseTile"&&b?300-x:g==="maybePrepare"&&b?400-x:500:200-x:100-x}(s);if(p===0){Jt();try{r()}finally{}return{cancel:()=>{}}}return this.tasks[u]={fn:r,metadata:s,priority:p,id:u},this.taskQueue.push(u),this.invoker.trigger(),{cancel:()=>{delete this.tasks[u]}}}process(){Jt();try{if(this.taskQueue=this.taskQueue.filter(u=>!!this.tasks[u]),!this.taskQueue.length)return;const r=this.pick();if(r===null)return;const s=this.tasks[r];if(delete this.tasks[r],this.taskQueue.length&&this.invoker.trigger(),!s)return;s.fn()}finally{}}pick(){let r=null,s=1/0;for(let p=0;p<this.taskQueue.length;p++){const g=this.tasks[this.taskQueue[p]];g.priority<s&&(s=g.priority,r=p)}if(r===null)return null;const u=this.taskQueue[r];return this.taskQueue.splice(r,1),u}remove(){this.invoker.remove()}}class e3{constructor(r){this._stringToNumber={},this._numberToString=[];for(let s=0;s<r.length;s++){const u=r[s];this._stringToNumber[u]=s,this._numberToString[s]=u}}encode(r){return this._stringToNumber[r]}decode(r){return this._numberToString[r]}}const eP=["tile","layer","source","sourceLayer","state"];class n3{constructor(r,s,u,p,g){this.type="Feature",this._vectorTileFeature=r,this._z=s,this._x=u,this._y=p,this.properties=r.properties,this.id=g}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(r){this._geometry=r}toJSON(){const r={type:"Feature",geometry:this.geometry,properties:this.properties};this.id!==void 0&&(r.id=this.id);for(const s of eP)this[s]!==void 0&&(r[s]=this[s]);return r}}const Ya=32,al=33,Hc=new Uint16Array(8184);for(let a=0;a<2046;a++){let r=a+2,s=0,u=0,p=0,g=0,b=0,x=0;for(1&r?p=g=b=Ya:s=u=x=Ya;(r>>=1)>1;){const k=s+p>>1,L=u+g>>1;1&r?(p=s,g=u,s=b,u=x):(s=p,u=g,p=b,g=x),b=k,x=L}const T=4*a;Hc[T+0]=s,Hc[T+1]=u,Hc[T+2]=p,Hc[T+3]=g}const sl=new Uint16Array(2178),Wc=new Uint8Array(1089),Jg=new Uint16Array(1089);function r3(a){return a===0?-.03125:a===32?.03125:0}var i3=nn([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const o3={type:2,extent:bn,loadGeometry:()=>[[new et(0,0),new et(8193,0),new et(8193,8193),new et(0,8193),new et(0,0)]]};class b1{constructor(r,s,u,p,g){this.tileID=r,this.uid=ur(),this.uses=0,this.tileSize=s,this.tileZoom=u,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=g,this.expiredRequestCount=0,this.state="loading",p&&p.transform&&(this.projection=p.transform.projection)}registerFadeDuration(r){const s=r+this.timeAdded;s<tr.now()||this.fadeEndTime&&s<this.fadeEndTime||(this.fadeEndTime=s)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=cd(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(r,s,u){if(this.unloadVectorData(),this.state="loaded",r){r.featureIndex&&(this.latestFeatureIndex=r.featureIndex,r.rawTileData?(this.latestRawTileData=r.rawTileData,this.latestFeatureIndex.rawTileData=r.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=r.collisionBoxArray,this.buckets=function(p,g){const b={};if(!g)return b;for(const x of p){const T=x.layerIds.map(k=>g.getLayer(k)).filter(Boolean);if(T.length!==0){x.layers=T,x.stateDependentLayerIds&&(x.stateDependentLayers=x.stateDependentLayerIds.map(k=>T.filter(L=>L.id===k)[0]));for(const k of T)b[k.id]=x}}return b}(r.buckets,s.style),this.hasSymbolBuckets=!1;for(const p in this.buckets){const g=this.buckets[p];if(g instanceof qc){if(this.hasSymbolBuckets=!0,!u)break;g.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const p in this.buckets){const g=this.buckets[p];if(g instanceof qc&&g.hasRTLText){this.hasRTLText=!0,Mt.isLoading()||Mt.isLoaded()||Tt()!=="deferred"||wt();break}}this.queryPadding=0;for(const p in this.buckets){const g=this.buckets[p];this.queryPadding=Math.max(this.queryPadding,s.style.getLayer(p).queryRadius(g))}r.imageAtlas&&(this.imageAtlas=r.imageAtlas),r.glyphAtlasImage&&(this.glyphAtlasImage=r.glyphAtlasImage),r.lineAtlas&&(this.lineAtlas=r.lineAtlas)}else this.collisionBoxArray=new Cy}unloadVectorData(){if(this.hasData()){for(const r in this.buckets)this.buckets[r].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(r){return this.buckets[r.id]}upload(r){for(const u in this.buckets){const p=this.buckets[u];p.uploadPending()&&p.upload(r)}const s=r.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new pp(r,this.imageAtlas.image,s.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new pp(r,this.glyphAtlasImage,s.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new pp(r,this.lineAtlas.image,s.ALPHA),this.lineAtlas.uploaded=!0)}prepare(r){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(r,this.imageAtlasTexture)}queryRenderedFeatures(r,s,u,p,g,b,x,T){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:p,pixelPosMatrix:x,transform:b,params:g,tileTransform:this.tileTransform},r,s,u):{}}querySourceFeatures(r,s){const u=this.latestFeatureIndex;if(!u||!u.rawTileData)return;const p=u.loadVTLayers(),g=s?s.sourceLayer:"",b=p._geojsonTileLayer||p[g];if(!b)return;const x=ih(s&&s.filter),{z:T,x:k,y:L}=this.tileID.canonical,O={z:T,x:k,y:L};for(let R=0;R<b.length;R++){const U=b.feature(R);if(x.needGeometry){const nt=ad(U,!0);if(!x.filter(new Ft(this.tileID.overscaledZ),nt,this.tileID.canonical))continue}else if(!x.filter(new Ft(this.tileID.overscaledZ),U))continue;const $=u.getId(U,g),X=new n3(U,T,k,L,$);X.tile=O,r.push(X)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(r){const s=this.expirationTime;if(r.cacheControl){const u=fe(r.cacheControl);u["max-age"]&&(this.expirationTime=Date.now()+1e3*u["max-age"])}else r.expires&&(this.expirationTime=new Date(r.expires).getTime());if(this.expirationTime){const u=Date.now();let p=!1;if(this.expirationTime>u)p=!1;else if(s)if(this.expirationTime<s)p=!0;else{const g=this.expirationTime-s;g?this.expirationTime=u+Math.max(g,3e4):p=!0}else p=!0;p?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(r,s){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(r).length===0||!s)return;const u=this.latestFeatureIndex.loadVTLayers(),p=s.style.listImages();for(const g in this.buckets){if(!s.style.hasLayer(g))continue;const b=this.buckets[g],x=b.layers[0].sourceLayer||"_geojsonTileLayer",T=u[x],k=r[x];if(!T||!k||Object.keys(k).length===0)continue;if(b.update(k,T,p,this.imageAtlas&&this.imageAtlas.patternPositions||{}),b instanceof Fg||b instanceof zg){const O=s.style._getSourceCache(b.layers[0].source);s._terrain&&s._terrain.enabled&&O&&b.programConfigurations.needsUpload&&s._terrain._clearRenderCacheForTile(O.id,this.tileID)}const L=s&&s.style&&s.style.getLayer(g);L&&(this.queryPadding=Math.max(this.queryPadding,L.queryRadius(b)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<tr.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(r){this.symbolFadeHoldUntil=tr.now()+r}setTexture(r,s){const u=s.context,p=u.gl;this.texture=this.texture||s.getTileTexture(r.width),this.texture?this.texture.update(r,{useMipmap:!0}):(this.texture=new pp(u,r,p.RGBA,{useMipmap:!0}),this.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE),u.extTextureFilterAnisotropic&&p.texParameterf(p.TEXTURE_2D,u.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,u.extTextureFilterAnisotropicMax))}setDependencies(r,s){const u={};for(const p of s)u[p]=!0;this.dependencies[r]=u}hasDependency(r,s){for(const u of r){const p=this.dependencies[u];if(p){for(const g of s)if(p[g])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(r,s){if(!s||s.name==="mercator"||this._tileDebugBuffer)return;const u=Hl(o3,this.tileID.canonical,this.tileTransform)[0],p=new sn,g=new tl;for(let b=0;b<u.length;b++){const{x,y:T}=u[b];p.emplaceBack(x,T),g.emplaceBack(b)}g.emplaceBack(0),this._tileDebugIndexBuffer=r.createIndexBuffer(g),this._tileDebugBuffer=r.createVertexBuffer(p,Hf.members),this._tileDebugSegments=xi.simpleSegment(0,0,p.length,g.length)}_makeTileBoundsBuffers(r,s){if(this._tileBoundsBuffer||!s||s.name==="mercator")return;const u=Hl(o3,this.tileID.canonical,this.tileTransform)[0];let p,g;if(this.isRaster){const b=function(x,T){const k=cd(x,T),L=Math.pow(2,x.z);for(let nt=0;nt<al;nt++)for(let dt=0;dt<al;dt++){const yt=La((x.x+(dt+r3(dt))/Ya)/L),lt=mo((x.y+(nt+r3(nt))/Ya)/L),_t=T.project(yt,lt),Et=nt*al+dt;sl[2*Et+0]=Math.round((_t.x*k.scale-k.x)*bn),sl[2*Et+1]=Math.round((_t.y*k.scale-k.y)*bn)}Wc.fill(0),Jg.fill(0);for(let nt=2045;nt>=0;nt--){const dt=4*nt,yt=Hc[dt+0],lt=Hc[dt+1],_t=Hc[dt+2],Et=Hc[dt+3],xt=yt+_t>>1,qt=lt+Et>>1,$t=xt+qt-lt,Qt=qt+yt-xt,_e=lt*al+yt,Zt=Et*al+_t,ee=qt*al+xt,re=Math.hypot((sl[2*_e+0]+sl[2*Zt+0])/2-sl[2*ee+0],(sl[2*_e+1]+sl[2*Zt+1])/2-sl[2*ee+1])>=16;if(Wc[ee]=Wc[ee]||(re?1:0),nt<1022){const de=(lt+Qt>>1)*al+(yt+$t>>1),ye=(Et+Qt>>1)*al+(_t+$t>>1);Wc[ee]=Wc[ee]||Wc[de]||Wc[ye]}}const O=new yr,R=new po;let U=0;function $(nt,dt){const yt=dt*al+nt;return Jg[yt]===0&&(O.emplaceBack(sl[2*yt+0],sl[2*yt+1],nt*bn/Ya,dt*bn/Ya),Jg[yt]=++U),Jg[yt]-1}function X(nt,dt,yt,lt,_t,Et){const xt=nt+yt>>1,qt=dt+lt>>1;if(Math.abs(nt-_t)+Math.abs(dt-Et)>1&&Wc[qt*al+xt])X(_t,Et,nt,dt,xt,qt),X(yt,lt,_t,Et,xt,qt);else{const $t=$(nt,dt),Qt=$(yt,lt),_e=$(_t,Et);R.emplaceBack($t,Qt,_e)}}return X(0,0,Ya,Ya,Ya,0),X(Ya,Ya,0,0,0,Ya),{vertices:O,indices:R}}(this.tileID.canonical,s);p=b.vertices,g=b.indices}else{p=new yr,g=new po;for(const{x,y:T}of u)p.emplaceBack(x,T,0,0);const b=wh(p.int16,void 0,4);for(let x=0;x<b.length;x+=3)g.emplaceBack(b[x],b[x+1],b[x+2])}this._tileBoundsBuffer=r.createVertexBuffer(p,i3.members),this._tileBoundsIndexBuffer=r.createIndexBuffer(g),this._tileBoundsSegments=xi.simpleSegment(0,0,p.length,g.length)}_makeGlobeTileDebugBuffers(r,s){const u=s.projection;if(!u||u.name!=="globe"||s.freezeTileCoverage)return;const p=this.tileID.canonical,g=Xf(Aw(p,s)),b=bh(s.zoom);let x;b>0&&(x=Py(new Float64Array(16),s.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(r,p,s,g,x,b),this._makeGlobeTileDebugTextBuffer(r,p,s,g,x,b)}_globePoint(r,s,u,p,g,b,x){let T=Zf(r,s,u);if(b){const k=1<<u.z,L=rl(p.center.lng),O=il(p.center.lat),R=(u.x+.5)/k-L;let U=0;R>.5?U=-1:R<-.5&&(U=1);let $=(r/bn+u.x)/k+U,X=(s/bn+u.y)/k;$=($-L)*p._pixelsPerMercatorPixel+L,X=(X-O)*p._pixelsPerMercatorPixel+O;const nt=[$*p.worldSize,X*p.worldSize,0];gi(nt,nt,b),T=od(T,nt,x)}return gi(T,T,g)}_makeGlobeTileDebugBorderBuffer(r,s,u,p,g,b){const x=new sn,T=new tl,k=new ar,L=(R,U,$,X,nt)=>{const dt=($-R)/(nt-1),yt=(X-U)/(nt-1),lt=x.length;for(let _t=0;_t<nt;_t++){const Et=R+_t*dt,xt=U+_t*yt;x.emplaceBack(Et,xt);const qt=this._globePoint(Et,xt,s,u,p,g,b);k.emplaceBack(qt[0],qt[1],qt[2]),T.emplaceBack(lt+_t)}},O=bn;L(0,0,O,0,16),L(O,0,O,O,16),L(O,O,0,O,16),L(0,O,0,0,16),this._tileDebugIndexBuffer=r.createIndexBuffer(T),this._tileDebugBuffer=r.createVertexBuffer(x,Hf.members),this._globeTileDebugBorderBuffer=r.createVertexBuffer(k,Sw.members),this._tileDebugSegments=xi.simpleSegment(0,0,x.length,T.length)}_makeGlobeTileDebugTextBuffer(r,s,u,p,g,b){const x=new sn,T=new po,k=new ar,L=25;T.reserve(32),x.reserve(L),k.reserve(L);const O=(R,U)=>L*R+U;for(let R=0;R<L;R++){const U=2048*R;for(let $=0;$<L;$++){const X=2048*$;x.emplaceBack(X,U);const nt=this._globePoint(X,U,s,u,p,g,b);k.emplaceBack(nt[0],nt[1],nt[2])}}for(let R=0;R<4;R++)for(let U=0;U<4;U++){const $=O(R,U),X=O(R,U+1),nt=O(R+1,U),dt=O(R+1,U+1);T.emplaceBack($,X,nt),T.emplaceBack(nt,X,dt)}this._tileDebugTextIndexBuffer=r.createIndexBuffer(T),this._tileDebugTextBuffer=r.createVertexBuffer(x,Hf.members),this._globeTileDebugTextBuffer=r.createVertexBuffer(k,Sw.members),this._tileDebugTextSegments=xi.simpleSegment(0,0,L,32)}}class nP{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(r,s,u){const p=String(s);if(this.stateChanges[r]=this.stateChanges[r]||{},this.stateChanges[r][p]=this.stateChanges[r][p]||{},Jn(this.stateChanges[r][p],u),this.deletedStates[r]===null){this.deletedStates[r]={};for(const g in this.state[r])g!==p&&(this.deletedStates[r][g]=null)}else if(this.deletedStates[r]&&this.deletedStates[r][p]===null){this.deletedStates[r][p]={};for(const g in this.state[r][p])u[g]||(this.deletedStates[r][p][g]=null)}else for(const g in u)this.deletedStates[r]&&this.deletedStates[r][p]&&this.deletedStates[r][p][g]===null&&delete this.deletedStates[r][p][g]}removeFeatureState(r,s,u){if(this.deletedStates[r]===null)return;const p=String(s);if(this.deletedStates[r]=this.deletedStates[r]||{},u&&s!==void 0)this.deletedStates[r][p]!==null&&(this.deletedStates[r][p]=this.deletedStates[r][p]||{},this.deletedStates[r][p][u]=null);else if(s!==void 0)if(this.stateChanges[r]&&this.stateChanges[r][p])for(u in this.deletedStates[r][p]={},this.stateChanges[r][p])this.deletedStates[r][p][u]=null;else this.deletedStates[r][p]=null;else this.deletedStates[r]=null}getState(r,s){const u=String(s),p=Jn({},(this.state[r]||{})[u],(this.stateChanges[r]||{})[u]);if(this.deletedStates[r]===null)return{};if(this.deletedStates[r]){const g=this.deletedStates[r][s];if(g===null)return{};for(const b in g)delete p[b]}return p}initializeTileState(r,s){r.setFeatureState(this.state,s)}coalesceChanges(r,s){const u={};for(const p in this.stateChanges){this.state[p]=this.state[p]||{};const g={};for(const b in this.stateChanges[p])this.state[p][b]||(this.state[p][b]={}),Jn(this.state[p][b],this.stateChanges[p][b]),g[b]=this.state[p][b];u[p]=g}for(const p in this.deletedStates){this.state[p]=this.state[p]||{};const g={};if(this.deletedStates[p]===null)for(const b in this.state[p])g[b]={},this.state[p][b]={};else for(const b in this.deletedStates[p]){if(this.deletedStates[p][b]===null)this.state[p][b]={};else if(this.state[p][b])for(const x of Object.keys(this.deletedStates[p][b]))delete this.state[p][b][x];g[b]=this.state[p][b]}u[p]=u[p]||{},Jn(u[p],g)}if(this.stateChanges={},this.deletedStates={},Object.keys(u).length!==0)for(const p in r)r[p].setFeatureState(u,s)}}class a3{constructor(r){this.size=r,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(r,s){const u=this.toIdx(r,s);return{min:this.minimums[u],max:this.maximums[u]}}isLeaf(r,s){return this.leaves[this.toIdx(r,s)]}toIdx(r,s){return s*this.size+r}}function s3(a,r,s,u){let p=0,g=Number.MAX_VALUE;for(let b=0;b<3;b++)if(Math.abs(u[b])<1e-15){if(s[b]<a[b]||s[b]>r[b])return null}else{const x=1/u[b];let T=(a[b]-s[b])*x,k=(r[b]-s[b])*x;if(T>k){const L=T;T=k,k=L}if(T>p&&(p=T),k<g&&(g=k),p>g)return null}return p}function l3(a,r,s,u,p,g,b,x,T,k,L){const O=u-a,R=p-r,U=g-s,$=b-a,X=x-r,nt=T-s,dt=L[1]*nt-L[2]*X,yt=L[2]*$-L[0]*nt,lt=L[0]*X-L[1]*$,_t=O*dt+R*yt+U*lt;if(Math.abs(_t)<1e-15)return null;const Et=1/_t,xt=k[0]-a,qt=k[1]-r,$t=k[2]-s,Qt=(xt*dt+qt*yt+$t*lt)*Et;if(Qt<0||Qt>1)return null;const _e=qt*U-$t*R,Zt=$t*O-xt*U,ee=xt*R-qt*O,re=(L[0]*_e+L[1]*Zt+L[2]*ee)*Et;return re<0||Qt+re>1?null:($*_e+X*Zt+nt*ee)*Et}function c3(a,r,s){return(a-r)/(s-r)}function u3(a,r,s,u,p,g,b,x,T){const k=1<<s,L=g-u,O=b-p,R=(a+1)/k*L+u,U=(r+0)/k*O+p,$=(r+1)/k*O+p;x[0]=(a+0)/k*L+u,x[1]=U,T[0]=R,T[1]=$}class d3{constructor(r){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=r,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const s=function(g){const b=Math.ceil(Math.log2(g.dim/8)),x=[];let T=Math.ceil(Math.pow(2,b));const k=1/T,L=(U,$,X,nt,dt)=>{const yt=nt?1:0,lt=(U+1)*X-yt,_t=$*X,Et=($+1)*X-yt;dt[0]=U*X,dt[1]=_t,dt[2]=lt,dt[3]=Et};let O=new a3(T);const R=[];for(let U=0;U<T*T;U++){L(U%T,Math.floor(U/T),k,!1,R);const $=Zc(R[0],R[1],g),X=Zc(R[2],R[1],g),nt=Zc(R[2],R[3],g),dt=Zc(R[0],R[3],g);O.minimums.push(Math.min($,X,nt,dt)),O.maximums.push(Math.max($,X,nt,dt)),O.leaves.push(1)}for(x.push(O),T/=2;T>=1;T/=2){const U=x[x.length-1];O=new a3(T);for(let $=0;$<T*T;$++){L($%T,Math.floor($/T),2,!0,R);const X=U.getElevation(R[0],R[1]),nt=U.getElevation(R[2],R[1]),dt=U.getElevation(R[2],R[3]),yt=U.getElevation(R[0],R[3]),lt=U.isLeaf(R[0],R[1]),_t=U.isLeaf(R[2],R[1]),Et=U.isLeaf(R[2],R[3]),xt=U.isLeaf(R[0],R[3]),qt=Math.min(X.min,nt.min,dt.min,yt.min),$t=Math.max(X.max,nt.max,dt.max,yt.max),Qt=lt&&_t&&Et&&xt;O.maximums.push($t),O.minimums.push(qt),O.leaves.push($t-qt<=5&&Qt?1:0)}x.push(O)}return x}(this.dem),u=s.length-1,p=s[u];this._addNode(p.minimums[0],p.maximums[0],p.leaves[0]),this._construct(s,0,0,u,0)}raycastRoot(r,s,u,p,g,b,x=1){return s3([r,s,-100],[u,p,this.maximums[0]*x],g,b)}raycast(r,s,u,p,g,b,x=1){if(!this.nodeCount)return null;const T=this.raycastRoot(r,s,u,p,g,b,x);if(T==null)return null;const k=[],L=[],O=[],R=[],U=[{idx:0,t:T,nodex:0,nodey:0,depth:0}];for(;U.length>0;){const{idx:$,t:X,nodex:nt,nodey:dt,depth:yt}=U.pop();if(this.leaves[$]){u3(nt,dt,yt,r,s,u,p,O,R);const _t=1<<yt,Et=(nt+0)/_t,xt=(nt+1)/_t,qt=(dt+0)/_t,$t=(dt+1)/_t,Qt=Zc(Et,qt,this.dem)*x,_e=Zc(xt,qt,this.dem)*x,Zt=Zc(xt,$t,this.dem)*x,ee=Zc(Et,$t,this.dem)*x,re=l3(O[0],O[1],Qt,R[0],O[1],_e,R[0],R[1],Zt,g,b),de=l3(R[0],R[1],Zt,O[0],R[1],ee,O[0],O[1],Qt,g,b),ye=Math.min(re!==null?re:Number.MAX_VALUE,de!==null?de:Number.MAX_VALUE);if(ye!==Number.MAX_VALUE)return ye;{const Yt=Gf([],g,b,X);if(h3(Qt,_e,ee,Zt,c3(Yt[0],O[0],R[0]),c3(Yt[1],O[1],R[1]))>=Yt[2])return X}continue}let lt=0;for(let _t=0;_t<this._siblingOffset.length;_t++){u3((nt<<1)+this._siblingOffset[_t][0],(dt<<1)+this._siblingOffset[_t][1],yt+1,r,s,u,p,O,R),O[2]=-100,R[2]=this.maximums[this.childOffsets[$]+_t]*x;const Et=s3(O,R,g,b);if(Et!=null){const xt=Et;k[_t]=xt;let qt=!1;for(let $t=0;$t<lt&&!qt;$t++)xt>=k[L[$t]]&&(L.splice($t,0,_t),qt=!0);qt||(L[lt]=_t),lt++}}for(let _t=0;_t<lt;_t++){const Et=L[_t];U.push({idx:this.childOffsets[$]+Et,t:k[Et],nodex:(nt<<1)+this._siblingOffset[Et][0],nodey:(dt<<1)+this._siblingOffset[Et][1],depth:yt+1})}}return null}_addNode(r,s,u){return this.minimums.push(r),this.maximums.push(s),this.leaves.push(u),this.childOffsets.push(0),this.nodeCount++}_construct(r,s,u,p,g){if(r[p].isLeaf(s,u)===1)return;this.childOffsets[g]||(this.childOffsets[g]=this.nodeCount);const b=p-1,x=r[b];let T=0,k=0;for(let L=0;L<this._siblingOffset.length;L++){const O=2*s+this._siblingOffset[L][0],R=2*u+this._siblingOffset[L][1],U=x.getElevation(O,R),$=x.isLeaf(O,R),X=this._addNode(U.min,U.max,$);$&&(T|=1<<L),k||(k=X)}for(let L=0;L<this._siblingOffset.length;L++)T&1<<L||this._construct(r,2*s+this._siblingOffset[L][0],2*u+this._siblingOffset[L][1],b,k+L)}}function h3(a,r,s,u,p,g){return An(An(a,s,g),An(r,u,g),p)}function Zc(a,r,s){const u=s.dim,p=se(a*u-.5,0,u-1),g=se(r*u-.5,0,u-1),b=Math.floor(p),x=Math.floor(g),T=Math.min(b+1,u-1),k=Math.min(x+1,u-1);return h3(s.get(b,x),s.get(T,x),s.get(b,k),s.get(T,k),p-b,g-x)}const f3={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};class Qg{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(r,s,u,p=!1,g=!1){if(this.uid=r,s.height!==s.width)throw new RangeError("DEM tiles must be square");if(u&&u!=="mapbox"&&u!=="terrarium")return Qe(`"${u}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=s.height;const b=this.dim=s.height-2,x=new Uint32Array(s.data.buffer);if(this.pixels=new Uint8Array(s.data.buffer),this.encoding=u||"mapbox",this.borderReady=p,!p){for(let T=0;T<b;T++)x[this._idx(-1,T)]=x[this._idx(0,T)],x[this._idx(b,T)]=x[this._idx(b-1,T)],x[this._idx(T,-1)]=x[this._idx(T,0)],x[this._idx(T,b)]=x[this._idx(T,b-1)];x[this._idx(-1,-1)]=x[this._idx(0,0)],x[this._idx(b,-1)]=x[this._idx(b-1,0)],x[this._idx(-1,b)]=x[this._idx(0,b-1)],x[this._idx(b,b)]=x[this._idx(b-1,b-1)],g&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new d3(this)}get(r,s,u=!1){u&&(r=se(r,-1,this.dim),s=se(s,-1,this.dim));const p=4*this._idx(r,s);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(this.pixels[p],this.pixels[p+1],this.pixels[p+2])}static getUnpackVector(r){return f3[r]}get unpackVector(){return f3[this.encoding]}_idx(r,s){if(r<-1||r>=this.dim+1||s<-1||s>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(s+1)*this.stride+(r+1)}_unpackMapbox(r,s,u){return(256*r*256+256*s+u)/10-1e4}_unpackTerrarium(r,s,u){return 256*r+s+u/256-32768}static pack(r,s){const u=[0,0,0,0],p=Qg.getUnpackVector(s);let g=Math.floor((r+p[3])/p[2]);return u[2]=g%256,g=Math.floor(g/256),u[1]=g%256,g=Math.floor(g/256),u[0]=g,u}getPixels(){return new ha({width:this.stride,height:this.stride},this.pixels)}backfillBorder(r,s,u){if(this.dim!==r.dim)throw new Error("dem dimension mismatch");let p=s*this.dim,g=s*this.dim+this.dim,b=u*this.dim,x=u*this.dim+this.dim;switch(s){case-1:p=g-1;break;case 1:g=p+1}switch(u){case-1:b=x-1;break;case 1:x=b+1}const T=-s*this.dim,k=-u*this.dim;for(let L=b;L<x;L++)for(let O=p;O<g;O++){const R=4*this._idx(O,L),U=4*this._idx(O+T,L+k);this.pixels[R+0]=r.pixels[U+0],this.pixels[R+1]=r.pixels[U+1],this.pixels[R+2]=r.pixels[U+2],this.pixels[R+3]=r.pixels[U+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}qe(Qg,"DEMData"),qe(d3,"DemMinMaxQuadTree",{omit:["dem"]});class rP{constructor(r,s){this.max=r,this.onRemove=s,this.reset()}reset(){for(const r in this.data)for(const s of this.data[r])s.timeout&&clearTimeout(s.timeout),this.onRemove(s.value);return this.data={},this.order=[],this}add(r,s,u){const p=r.wrapped().key;this.data[p]===void 0&&(this.data[p]=[]);const g={value:s,timeout:void 0};if(u!==void 0&&(g.timeout=setTimeout(()=>{this.remove(r,g)},u)),this.data[p].push(g),this.order.push(p),this.order.length>this.max){const b=this._getAndRemoveByKey(this.order[0]);b&&this.onRemove(b)}return this}has(r){return r.wrapped().key in this.data}getAndRemove(r){return this.has(r)?this._getAndRemoveByKey(r.wrapped().key):null}_getAndRemoveByKey(r){const s=this.data[r].shift();return s.timeout&&clearTimeout(s.timeout),this.data[r].length===0&&delete this.data[r],this.order.splice(this.order.indexOf(r),1),s.value}getByKey(r){const s=this.data[r];return s?s[0].value:null}get(r){return this.has(r)?this.data[r.wrapped().key][0].value:null}remove(r,s){if(!this.has(r))return this;const u=r.wrapped().key,p=s===void 0?0:this.data[u].indexOf(s),g=this.data[u][p];return this.data[u].splice(p,1),g.timeout&&clearTimeout(g.timeout),this.data[u].length===0&&delete this.data[u],this.onRemove(g.value),this.order.splice(this.order.indexOf(u),1),this}setMaxSize(r){for(this.max=r;this.order.length>this.max;){const s=this._getAndRemoveByKey(this.order[0]);s&&this.onRemove(s)}return this}filter(r){const s=[];for(const u in this.data)for(const p of this.data[u])r(p.value)||s.push(p);for(const u of s)this.remove(u.value.tileID,u)}}class zh{constructor(r,s,u){this.func=r,this.mask=s,this.range=u}}zh.ReadOnly=!1,zh.ReadWrite=!0,zh.disabled=new zh(519,zh.ReadOnly,[0,1]);const v1=7680;class x1{constructor(r,s,u,p,g,b){this.test=r,this.ref=s,this.mask=u,this.fail=p,this.depthFail=g,this.pass=b}}x1.disabled=new x1({func:519,mask:0},0,0,v1,v1,v1);class ll{constructor(r,s,u){this.blendFunction=r,this.blendColor=s,this.mask=u}}ll.Replace=[1,0],ll.disabled=new ll(ll.Replace,kn.transparent,[!1,!1,!1,!1]),ll.unblended=new ll(ll.Replace,kn.transparent,[!0,!0,!0,!0]),ll.alphaBlended=new ll([1,771],kn.transparent,[!0,!0,!0,!0]);const w1=1029,E1=2305;class Os{constructor(r,s,u){this.enable=r,this.mode=s,this.frontFace=u}}Os.disabled=new Os(!1,w1,E1),Os.backCCW=new Os(!0,w1,E1),Os.backCW=new Os(!0,w1,2304),Os.frontCW=new Os(!0,1028,2304),Os.frontCCW=new Os(!0,1028,E1);class ud extends Ki{constructor(r,s,u){super(),this.id=r,this._onlySymbols=u,s.on("data",p=>{p.dataType==="source"&&p.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&p.dataType==="source"&&p.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),s.on("error",()=>{this._sourceErrored=!0}),this._source=s,this._tiles={},this._cache=new rP(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=s.minTileCacheSize,this._maxTileCacheSize=s.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new nP,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(r){this.map=r,this._minTileCacheSize=this._minTileCacheSize===void 0&&r?r._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&r?r._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const r in this._tiles){const s=this._tiles[r];if(s.state!=="loaded"&&s.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const r=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,r&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(r,s){return r.isSymbolTile=this._onlySymbols,this._source.loadTile(r,s)}_unloadTile(r){if(this._source.unloadTile)return this._source.unloadTile(r,()=>{})}_abortTile(r){if(this._source.abortTile)return this._source.abortTile(r,()=>{})}serialize(){return this._source.serialize()}prepare(r){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const s in this._tiles){const u=this._tiles[s];u.upload(r),u.prepare(this.map.style.imageManager)}}getIds(){return Gn(this._tiles).map(r=>r.tileID).sort(p3).map(r=>r.key)}getRenderableIds(r){const s=[];for(const u in this._tiles)this._isIdRenderable(+u,r)&&s.push(this._tiles[u]);return r?s.sort((u,p)=>{const g=u.tileID,b=p.tileID,x=new et(g.canonical.x,g.canonical.y)._rotate(this.transform.angle),T=new et(b.canonical.x,b.canonical.y)._rotate(this.transform.angle);return g.overscaledZ-b.overscaledZ||T.y-x.y||T.x-x.x}).map(u=>u.tileID.key):s.map(u=>u.tileID).sort(p3).map(u=>u.key)}hasRenderableParent(r){const s=this.findLoadedParent(r,0);return!!s&&this._isIdRenderable(s.tileID.key)}_isIdRenderable(r,s){return this._tiles[r]&&this._tiles[r].hasData()&&!this._coveredTiles[r]&&(s||!this._tiles[r].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const r in this._tiles)this._tiles[r].state!=="errored"&&this._reloadTile(+r,"reloading")}}_reloadTile(r,s){const u=this._tiles[r];u&&(u.state!=="loading"&&(u.state=s),this._loadTile(u,this._tileLoaded.bind(this,u,r,s)))}_tileLoaded(r,s,u,p){if(p)if(r.state="errored",p.status!==404)this._source.fire(new Wo(p,{tile:r}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const g=this.map.painter.terrain;this.update(this.transform,g.getScaledDemTileSize(),!0),g.resetTileLookupCache(this.id)}else this.update(this.transform);else r.timeAdded=tr.now(),u==="expired"&&(r.refreshedUponExpiration=!0),this._setTileReloadTimer(s,r),this._source.type==="raster-dem"&&r.dem&&this._backfillDEM(r),this._state.initializeTileState(r,this.map?this.map.painter:null),this._source.fire(new Fn("data",{dataType:"source",tile:r,coord:r.tileID,sourceCacheId:this.id}))}_backfillDEM(r){const s=this.getRenderableIds();for(let p=0;p<s.length;p++){const g=s[p];if(r.neighboringTiles&&r.neighboringTiles[g]){const b=this.getTileByID(g);u(r,b),u(b,r)}}function u(p,g){if(!p.dem||p.dem.borderReady)return;p.needsHillshadePrepare=!0,p.needsDEMTextureUpload=!0;let b=g.tileID.canonical.x-p.tileID.canonical.x;const x=g.tileID.canonical.y-p.tileID.canonical.y,T=Math.pow(2,p.tileID.canonical.z),k=g.tileID.key;b===0&&x===0||Math.abs(x)>1||(Math.abs(b)>1&&(Math.abs(b+T)===1?b+=T:Math.abs(b-T)===1&&(b-=T)),g.dem&&p.dem&&(p.dem.backfillBorder(g.dem,b,x),p.neighboringTiles&&p.neighboringTiles[k]&&(p.neighboringTiles[k].backfilled=!0)))}}getTile(r){return this.getTileByID(r.key)}getTileByID(r){return this._tiles[r]}_retainLoadedChildren(r,s,u,p){for(const g in this._tiles){let b=this._tiles[g];if(p[g]||!b.hasData()||b.tileID.overscaledZ<=s||b.tileID.overscaledZ>u)continue;let x=b.tileID;for(;b&&b.tileID.overscaledZ>s+1;){const k=b.tileID.scaledTo(b.tileID.overscaledZ-1);b=this._tiles[k.key],b&&b.hasData()&&(x=k)}let T=x;for(;T.overscaledZ>s;)if(T=T.scaledTo(T.overscaledZ-1),r[T.key]){p[x.key]=x;break}}}findLoadedParent(r,s){if(r.key in this._loadedParentTiles){const u=this._loadedParentTiles[r.key];return u&&u.tileID.overscaledZ>=s?u:null}for(let u=r.overscaledZ-1;u>=s;u--){const p=r.scaledTo(u),g=this._getLoadedTile(p);if(g)return g}}_getLoadedTile(r){const s=this._tiles[r.key];return s&&s.hasData()?s:this._cache.getByKey(this._source.reparseOverscaled?r.wrapped().key:r.canonical.key)}updateCacheSize(r,s){s=s||this._source.tileSize;const u=Math.ceil(r.width/s)+1,p=Math.ceil(r.height/s)+1,g=Math.floor(u*p*5),b=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,g):g,x=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,b):b;this._cache.setMaxSize(x)}handleWrapJump(r){const s=Math.round((r-(this._prevLng===void 0?r:this._prevLng))/360);if(this._prevLng=r,s){const u={};for(const p in this._tiles){const g=this._tiles[p];g.tileID=g.tileID.unwrapTo(g.tileID.wrap+s),u[g.tileID.key]=g}this._tiles=u;for(const p in this._timers)clearTimeout(this._timers[p]),delete this._timers[p];for(const p in this._tiles)this._setTileReloadTimer(+p,this._tiles[p])}}update(r,s,u){if(this.transform=r,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!u)return;let p;this.updateCacheSize(r,s),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?p=r.getVisibleUnwrappedCoordinates(this._source.tileID).map(x=>new Ro(x.canonical.z,x.wrap,x.canonical.z,x.canonical.x,x.canonical.y)):(p=r.coveringTiles({tileSize:s||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!u,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(p=p.filter(x=>this._source.hasTile(x)))):p=[];const g=this._updateRetainedTiles(p);if(m3(this._source.type)&&p.length!==0){const x={},T={},k=Object.keys(g);for(const O of k){const R=g[O],U=this._tiles[O];if(!U||U.fadeEndTime&&U.fadeEndTime<=tr.now())continue;const $=this.findLoadedParent(R,Math.max(R.overscaledZ-ud.maxOverzooming,this._source.minzoom));$&&(this._addTile($.tileID),x[$.tileID.key]=$.tileID),T[O]=R}const L=p[p.length-1].overscaledZ;for(const O in this._tiles){const R=this._tiles[O];if(g[O]||!R.hasData())continue;let U=R.tileID;for(;U.overscaledZ>L;){U=U.scaledTo(U.overscaledZ-1);const $=this._tiles[U.key];if($&&$.hasData()&&T[U.key]){g[O]=R.tileID;break}}}for(const O in x)g[O]||(this._coveredTiles[O]=!0,g[O]=x[O])}for(const x in g)this._tiles[x].clearFadeHold();const b=function(x,T){const k=[];for(const L in x)L in T||k.push(L);return k}(this._tiles,g);for(const x of b){const T=this._tiles[x];T.hasSymbolBuckets&&!T.holdingForFade()?T.setHoldDuration(this.map._fadeDuration):T.hasSymbolBuckets&&!T.symbolFadeFinished()||this._removeTile(+x)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const r in this._tiles)this._tiles[r].holdingForFade()&&this._removeTile(+r)}_updateRetainedTiles(r){const s={};if(r.length===0)return s;const u={},p=r.reduce((k,L)=>Math.min(k,L.overscaledZ),1/0),g=r[0].overscaledZ,b=Math.max(g-ud.maxOverzooming,this._source.minzoom),x=Math.max(g+ud.maxUnderzooming,this._source.minzoom),T={};for(const k of r){const L=this._addTile(k);s[k.key]=k,L.hasData()||p<this._source.maxzoom&&(T[k.key]=k)}this._retainLoadedChildren(T,p,x,s);for(const k of r){let L=this._tiles[k.key];if(L.hasData())continue;if(k.canonical.z>=this._source.maxzoom){const R=k.children(this._source.maxzoom)[0],U=this.getTile(R);if(U&&U.hasData()){s[R.key]=R;continue}}else{const R=k.children(this._source.maxzoom);if(s[R[0].key]&&s[R[1].key]&&s[R[2].key]&&s[R[3].key])continue}let O=L.wasRequested();for(let R=k.overscaledZ-1;R>=b;--R){const U=k.scaledTo(R);if(u[U.key]||(u[U.key]=!0,L=this.getTile(U),!L&&O&&(L=this._addTile(U)),L&&(s[U.key]=U,O=L.wasRequested(),L.hasData())))break}}return s}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const r in this._tiles){const s=[];let u,p=this._tiles[r].tileID;for(;p.overscaledZ>0;){if(p.key in this._loadedParentTiles){u=this._loadedParentTiles[p.key];break}s.push(p.key);const g=p.scaledTo(p.overscaledZ-1);if(u=this._getLoadedTile(g),u)break;p=g}for(const g of s)this._loadedParentTiles[g]=u}}_addTile(r){let s=this._tiles[r.key];if(s)return s;s=this._cache.getAndRemove(r),s&&(this._setTileReloadTimer(r.key,s),s.tileID=r,this._state.initializeTileState(s,this.map?this.map.painter:null),this._cacheTimers[r.key]&&(clearTimeout(this._cacheTimers[r.key]),delete this._cacheTimers[r.key],this._setTileReloadTimer(r.key,s)));const u=Boolean(s);if(!u){const p=this.map?this.map.painter:null;s=new b1(r,this._source.tileSize*r.overscaleFactor(),this.transform.tileZoom,p,this._isRaster),this._loadTile(s,this._tileLoaded.bind(this,s,r.key,s.state))}return s?(s.uses++,this._tiles[r.key]=s,u||this._source.fire(new Fn("dataloading",{tile:s,coord:s.tileID,dataType:"source"})),s):null}_setTileReloadTimer(r,s){r in this._timers&&(clearTimeout(this._timers[r]),delete this._timers[r]);const u=s.getExpiryTimeout();u&&(this._timers[r]=setTimeout(()=>{this._reloadTile(r,"expired"),delete this._timers[r]},u))}_removeTile(r){const s=this._tiles[r];s&&(s.uses--,delete this._tiles[r],this._timers[r]&&(clearTimeout(this._timers[r]),delete this._timers[r]),s.uses>0||(s.hasData()&&s.state!=="reloading"?this._cache.add(s.tileID,s,s.getExpiryTimeout()):(s.aborted=!0,this._abortTile(s),this._unloadTile(s))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const r in this._tiles)this._removeTile(+r);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(r,s,u){const p=[],g=this.transform;if(!g)return p;const b=g.projection.name==="globe",x=rl(g.center.lng);for(const T in this._tiles){const k=this._tiles[T];if(u&&k.clearQueryDebugViz(),k.holdingForFade())continue;let L;if(b){const O=k.tileID.canonical;if(O.z===0){const R=[Math.abs(se(x,...mp(O,-1))-x),Math.abs(se(x,...mp(O,1))-x)];L=[0,2*R.indexOf(Math.min(...R))-1]}else{const R=[Math.abs(se(x,...mp(O,-1))-x),Math.abs(se(x,...mp(O,0))-x),Math.abs(se(x,...mp(O,1))-x)];L=[R.indexOf(Math.min(...R))-1]}}else L=[0];for(const O of L){const R=r.containsTile(k,g,s,O);R&&p.push(R)}}return p}getVisibleCoordinates(r){const s=this.getRenderableIds(r).map(u=>this._tiles[u].tileID);for(const u of s)u.projMatrix=this.transform.calculateProjMatrix(u.toUnwrapped());return s}hasTransition(){if(this._source.hasTransition())return!0;if(m3(this._source.type))for(const r in this._tiles){const s=this._tiles[r];if(s.fadeEndTime!==void 0&&s.fadeEndTime>=tr.now())return!0}return!1}setFeatureState(r,s,u){this._state.updateState(r=r||"_geojsonTileLayer",s,u)}removeFeatureState(r,s,u){this._state.removeFeatureState(r=r||"_geojsonTileLayer",s,u)}getFeatureState(r,s){return this._state.getState(r=r||"_geojsonTileLayer",s)}setDependencies(r,s,u){const p=this._tiles[r];p&&p.setDependencies(s,u)}reloadTilesForDependencies(r,s){for(const u in this._tiles)this._tiles[u].hasDependency(r,s)&&this._reloadTile(+u,"reloading");this._cache.filter(u=>!u.hasDependency(r,s))}_preloadTiles(r,s){const u=new Map,p=Array.isArray(r)?r:[r],g=this.map.painter.terrain,b=this.usedForTerrain&&g?g.getScaledDemTileSize():this._source.tileSize;for(const x of p){const T=x.coveringTiles({tileSize:b,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const k of T)u.set(k.key,k);this.usedForTerrain&&x.updateElevation(!1)}_n(Array.from(u.values()),(x,T)=>{const k=new b1(x,this._source.tileSize*x.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(k,L=>{this._source.type==="raster-dem"&&k.dem&&this._backfillDEM(k),T(L,k)})},s)}}function p3(a,r){const s=Math.abs(2*a.wrap)-+(a.wrap<0),u=Math.abs(2*r.wrap)-+(r.wrap<0);return a.overscaledZ-r.overscaledZ||u-s||r.canonical.y-a.canonical.y||r.canonical.x-a.canonical.x}function m3(a){return a==="raster"||a==="image"||a==="video"||a==="custom"}function mp(a,r){const s=1<<a.z;return[a.x/s+r,(a.x+1)/s+r]}ud.maxOverzooming=10,ud.maxUnderzooming=3;class t0{constructor(r,s,u){this._demTile=r,this._dem=this._demTile.dem,this._scale=s,this._offset=u}static create(r,s,u){const p=u||r.findDEMTileFor(s);if(!p||!p.dem)return;const g=p.dem,b=p.tileID,x=1<<s.canonical.z-b.canonical.z;return new t0(p,p.tileSize/bn/x,[(s.canonical.x/x-b.canonical.x)*g.dim,(s.canonical.y/x-b.canonical.y)*g.dim])}tileCoordToPixel(r,s){const u=s*this._scale+this._offset[1],p=Math.floor(r*this._scale+this._offset[0]),g=Math.floor(u);return new et(p,g)}getElevationAt(r,s,u,p){const g=r*this._scale+this._offset[0],b=s*this._scale+this._offset[1],x=Math.floor(g),T=Math.floor(b),k=this._dem;return p=!!p,u?An(An(k.get(x,T,p),k.get(x,T+1,p),b-T),An(k.get(x+1,T,p),k.get(x+1,T+1,p),b-T),g-x):k.get(x,T,p)}getElevationAtPixel(r,s,u){return this._dem.get(r,s,!!u)}getMeterToDEM(r){return(1<<this._demTile.tileID.canonical.z)*zs(1,r)*this._dem.stride}}class g3{constructor(r,s){this.tileID=r,this.x=r.canonical.x,this.y=r.canonical.y,this.z=r.canonical.z,this.grid=new Rc(bn,16,0),this.featureIndexArray=new aw,this.promoteId=s}insert(r,s,u,p,g,b=0){const x=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(u,p,g,b);const T=this.grid;for(let k=0;k<s.length;k++){const L=s[k],O=[1/0,1/0,-1/0,-1/0];for(let R=0;R<L.length;R++){const U=L[R];O[0]=Math.min(O[0],U.x),O[1]=Math.min(O[1],U.y),O[2]=Math.max(O[2],U.x),O[3]=Math.max(O[3],U.y)}O[0]<bn&&O[1]<bn&&O[2]>=0&&O[3]>=0&&T.insert(x,O[0],O[1],O[2],O[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new i1(new sp(this.rawTileData)).layers,this.sourceLayerCoder=new e3(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const r in this.vtLayers)this.vtFeatures[r]=[]}return this.vtLayers}query(r,s,u,p){this.loadVTLayers();const g=r.params||{},b=ih(g.filter),x=r.tileResult,T=r.transform,k=x.bufferedTilespaceBounds,L=this.grid.query(k.min.x,k.min.y,k.max.x,k.max.y,($,X,nt,dt)=>Gw(x.bufferedTilespaceGeometry,$,X,nt,dt));L.sort(iP);let O=null;T.elevation&&L.length>0&&(O=t0.create(T.elevation,this.tileID));const R={};let U;for(let $=0;$<L.length;$++){const X=L[$];if(X===U)continue;U=X;const nt=this.featureIndexArray.get(X);let dt=null;this.loadMatchingFeature(R,nt,b,g.layers,g.availableImages,s,u,p,(yt,lt,_t,Et=0)=>(dt||(dt=Hl(yt,this.tileID.canonical,r.tileTransform)),lt.queryIntersectsFeature(x,yt,_t,dt,this.z,r.transform,r.pixelPosMatrix,O,Et)))}return R}loadMatchingFeature(r,s,u,p,g,b,x,T,k){const{featureIndex:L,bucketIndex:O,sourceLayerIndex:R,layoutVertexArrayOffset:U}=s,$=this.bucketLayerIDs[O];if(p&&!function(yt,lt){for(let _t=0;_t<yt.length;_t++)if(lt.indexOf(yt[_t])>=0)return!0;return!1}(p,$))return;const X=this.sourceLayerCoder.decode(R),nt=this.vtLayers[X].feature(L);if(u.needGeometry){const yt=ad(nt,!0);if(!u.filter(new Ft(this.tileID.overscaledZ),yt,this.tileID.canonical))return}else if(!u.filter(new Ft(this.tileID.overscaledZ),nt))return;const dt=this.getId(nt,X);for(let yt=0;yt<$.length;yt++){const lt=$[yt];if(p&&p.indexOf(lt)<0)continue;const _t=b[lt];if(!_t)continue;let Et={};dt!==void 0&&T&&(Et=T.getState(_t.sourceLayer||"_geojsonTileLayer",dt));const xt=Jn({},x[lt]);xt.paint=_3(xt.paint,_t.paint,nt,Et,g),xt.layout=_3(xt.layout,_t.layout,nt,Et,g);const qt=!k||k(nt,_t,Et,U);if(!qt)continue;const $t=new n3(nt,this.z,this.x,this.y,dt);$t.layer=xt;let Qt=r[lt];Qt===void 0&&(Qt=r[lt]=[]),Qt.push({featureIndex:L,feature:$t,intersectionZ:qt})}}lookupSymbolFeatures(r,s,u,p,g,b,x,T){const k={};this.loadVTLayers();const L=ih(g);for(const O of r)this.loadMatchingFeature(k,{bucketIndex:u,sourceLayerIndex:p,featureIndex:O,layoutVertexArrayOffset:0},L,b,x,T,s);return k}loadFeature(r){const{featureIndex:s,sourceLayerIndex:u}=r;this.loadVTLayers();const p=this.sourceLayerCoder.decode(u),g=this.vtFeatures[p];if(g[s])return g[s];const b=this.vtLayers[p].feature(s);return g[s]=b,b}hasLayer(r){for(const s of this.bucketLayerIDs)for(const u of s)if(r===u)return!0;return!1}getId(r,s){let u=r.id;if(this.promoteId){const p=typeof this.promoteId=="string"?this.promoteId:this.promoteId[s];p!=null&&(u=r.properties[p]),typeof u=="boolean"&&(u=Number(u))}return u}}function _3(a,r,s,u,p){return Te(a,(g,b)=>{const x=r instanceof Gt?r.get(b):null;return x&&x.evaluate?x.evaluate(s,u,p):x})}function iP(a,r){return r-a}qe(g3,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class y3{constructor(r,s){this.width=r,this.height=s,this.nextRow=0,this.image=new Wl({width:r,height:s}),this.positions={},this.uploaded=!1}getDash(r,s){const u=this.getKey(r,s);return this.positions[u]}trim(){const r=this.width,s=this.height=_r(this.nextRow);this.image.resize({width:r,height:s})}getKey(r,s){return r.join(",")+s}getDashRanges(r,s,u){const p=[];let g=r.length%2==1?-r[r.length-1]*u:0,b=r[0]*u,x=!0;p.push({left:g,right:b,isDash:x,zeroLength:r[0]===0});let T=r[0];for(let k=1;k<r.length;k++){x=!x;const L=r[k];g=T*u,T+=L,b=T*u,p.push({left:g,right:b,isDash:x,zeroLength:L===0})}return p}addRoundDash(r,s,u){const p=s/2;for(let g=-u;g<=u;g++){const b=this.width*(this.nextRow+u+g);let x=0,T=r[x];for(let k=0;k<this.width;k++){k/T.right>1&&(T=r[++x]);const L=Math.abs(k-T.left),O=Math.abs(k-T.right),R=Math.min(L,O);let U;const $=g/u*(p+1);if(T.isDash){const X=p-Math.abs($);U=Math.sqrt(R*R+X*X)}else U=p-Math.sqrt(R*R+$*$);this.image.data[b+k]=Math.max(0,Math.min(255,U+128))}}}addRegularDash(r,s){for(let T=r.length-1;T>=0;--T){const k=r[T],L=r[T+1];k.zeroLength?r.splice(T,1):L&&L.isDash===k.isDash&&(L.left=k.left,r.splice(T,1))}const u=r[0],p=r[r.length-1];u.isDash===p.isDash&&(u.left=p.left-this.width,p.right=u.right+this.width);const g=this.width*this.nextRow;let b=0,x=r[b];for(let T=0;T<this.width;T++){T/x.right>1&&(x=r[++b]);const k=Math.abs(T-x.left),L=Math.abs(T-x.right),O=Math.min(k,L);this.image.data[g+T]=Math.max(0,Math.min(255,(x.isDash?O:-O)+s+128))}}addDash(r,s){const u=this.getKey(r,s);if(this.positions[u])return this.positions[u];const p=s==="round",g=p?7:0,b=2*g+1;if(this.nextRow+b>this.height)return Qe("LineAtlas out of space"),null;r.length===0&&r.push(1);let x=0;for(let L=0;L<r.length;L++)r[L]<0&&(Qe("Negative value is found in line dasharray, replacing values with 0"),r[L]=0),x+=r[L];if(x!==0){const L=this.width/x,O=this.getDashRanges(r,this.width,L);p?this.addRoundDash(O,L,g):this.addRegularDash(O,s==="square"?.5*L:0)}const T=this.nextRow+g;this.nextRow+=b;const k={tl:[T,g],br:[x,0]};return this.positions[u]=k,k}}qe(y3,"LineAtlas");class b3{constructor(r){const s={},u=[];for(const x in r){const T=r[x],k=s[x]={};for(const L in T.glyphs){const O=T.glyphs[+L];if(!O||O.bitmap.width===0||O.bitmap.height===0)continue;const R=O.metrics.localGlyph?2:1,U={x:0,y:0,w:O.bitmap.width+2*R,h:O.bitmap.height+2*R};u.push(U),k[L]=U}}const{w:p,h:g}=s1(u),b=new Wl({width:p||1,height:g||1});for(const x in r){const T=r[x];for(const k in T.glyphs){const L=T.glyphs[+k];if(!L||L.bitmap.width===0||L.bitmap.height===0)continue;const O=s[x][k],R=L.metrics.localGlyph?2:1;Wl.copy(L.bitmap,b,{x:0,y:0},{x:O.x+R,y:O.y+R},L.bitmap)}}this.image=b,this.positions=s}}qe(b3,"GlyphAtlas");class oP{constructor(r){this.tileID=new Ro(r.tileID.overscaledZ,r.tileID.wrap,r.tileID.canonical.z,r.tileID.canonical.x,r.tileID.canonical.y),this.tileZoom=r.tileZoom,this.uid=r.uid,this.zoom=r.zoom,this.canonical=r.tileID.canonical,this.pixelRatio=r.pixelRatio,this.tileSize=r.tileSize,this.source=r.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=r.showCollisionBoxes,this.collectResourceTiming=!!r.collectResourceTiming,this.returnDependencies=!!r.returnDependencies,this.promoteId=r.promoteId,this.enableTerrain=!!r.enableTerrain,this.isSymbolTile=r.isSymbolTile,this.tileTransform=cd(r.tileID.canonical,r.projection),this.projection=r.projection}parse(r,s,u,p,g){this.status="parsing",this.data=r,this.collisionBoxArray=new Cy;const b=new e3(Object.keys(r.layers).sort()),x=new g3(this.tileID,this.promoteId);x.bucketLayerIDs=[];const T={},k=new y3(256,256),L={featureIndex:x,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:k,availableImages:u},O=s.familiesBySource[this.source];for(const Et in O){const xt=r.layers[Et];if(!xt)continue;let qt=!1,$t=!1;for(const Zt of O[Et])Zt[0].type==="symbol"?qt=!0:$t=!0;if(this.isSymbolTile===!0&&!qt||this.isSymbolTile===!1&&!$t)continue;xt.version===1&&Qe(`Vector tile source "${this.source}" layer "${Et}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Qt=b.encode(Et),_e=[];for(let Zt=0;Zt<xt.length;Zt++){const ee=xt.feature(Zt),re=x.getId(ee,Et);_e.push({feature:ee,id:re,index:Zt,sourceLayerIndex:Qt})}for(const Zt of O[Et]){const ee=Zt[0];this.isSymbolTile!==void 0&&ee.type==="symbol"!==this.isSymbolTile||ee.minzoom&&this.zoom<Math.floor(ee.minzoom)||ee.maxzoom&&this.zoom>=ee.maxzoom||ee.visibility!=="none"&&(T1(Zt,this.zoom,u),(T[ee.id]=ee.createBucket({index:x.bucketLayerIDs.length,layers:Zt,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Qt,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:u})).populate(_e,L,this.tileID.canonical,this.tileTransform),x.bucketLayerIDs.push(Zt.map(re=>re.id)))}}let R,U,$,X;k.trim();const nt={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},dt=Te(L.glyphDependencies,Et=>Object.keys(Et).map(Number));Object.keys(dt).length?p.send("getGlyphs",{uid:this.uid,stacks:dt},(Et,xt)=>{R||(R=Et,U=xt,_t.call(this))},void 0,!1,nt):U={};const yt=Object.keys(L.iconDependencies);yt.length?p.send("getImages",{icons:yt,source:this.source,tileID:this.tileID,type:"icons"},(Et,xt)=>{R||(R=Et,$=xt,_t.call(this))},void 0,!1,nt):$={};const lt=Object.keys(L.patternDependencies);function _t(){if(R)return g(R);if(U&&$&&X){const Et=new b3(U),xt=new M2($,X);for(const qt in T){const $t=T[qt];$t instanceof qc?(T1($t.layers,this.zoom,u),zI($t,U,Et.positions,$,xt.iconPositions,this.showCollisionBoxes,u,this.tileID.canonical,this.tileZoom,this.projection)):$t.hasPattern&&($t instanceof Fg||$t instanceof zg||$t instanceof rp)&&(T1($t.layers,this.zoom,u),$t.addFeatures(L,this.tileID.canonical,xt.patternPositions,u,this.tileTransform))}this.status="done",g(null,{buckets:Gn(T).filter(qt=>!qt.isEmpty()),featureIndex:x,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Et.image,lineAtlas:k,imageAtlas:xt,glyphMap:this.returnDependencies?U:null,iconMap:this.returnDependencies?$:null,glyphPositions:this.returnDependencies?Et.positions:null})}}lt.length?p.send("getImages",{icons:lt,source:this.source,tileID:this.tileID,type:"patterns"},(Et,xt)=>{R||(R=Et,X=xt,_t.call(this))},void 0,!1,nt):X={},_t.call(this)}}function T1(a,r,s){const u=new Ft(r);for(const p of a)p.recalculate(u,s)}class v3{constructor(r){this.entries={},this.scheduler=r}request(r,s,u,p){const g=this.entries[r]=this.entries[r]||{callbacks:[]};if(g.result){const[b,x]=g.result;return this.scheduler?this.scheduler.add(()=>{p(b,x)},s):p(b,x),()=>{}}return g.callbacks.push(p),g.cancel||(g.cancel=u((b,x)=>{g.result=[b,x];for(const T of g.callbacks)this.scheduler?this.scheduler.add(()=>{T(b,x)},s):T(b,x);setTimeout(()=>delete this.entries[r],3e3)})),()=>{g.result||(g.callbacks=g.callbacks.filter(b=>b!==p),g.callbacks.length||(g.cancel(),delete this.entries[r]))}}}function x3(a,r,s){const u=JSON.stringify(a.request);return a.data&&(this.deduped.entries[u]={result:[null,a.data]}),this.deduped.request(u,{type:"parseTile",isSymbolTile:a.isSymbolTile,zoom:a.tileZoom},p=>{const g=Zi(a.request,(b,x,T,k)=>{b?p(b):x&&p(null,{vectorTile:s?void 0:new i1(new sp(x)),rawData:x,cacheControl:T,expires:k})});return()=>{g.cancel(),p()}},r)}o.ARRAY_TYPE=da,o.AUTH_ERR_MSG=us,o.Aabb=Do,o.Actor=class{constructor(a,r,s){this.target=a,this.parent=r,this.mapId=s,this.callbacks={},this.cancelCallbacks={},He(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=Jt()?a:y,this.scheduler=new tP}send(a,r,s,u,p=!1,g){const b=Math.round(1e18*Math.random()).toString(36).substring(0,10);s&&(s.metadata=g,this.callbacks[b]=s);const x=Ie(this.globalScope)?void 0:[];return this.target.postMessage({id:b,type:a,hasCallback:!!s,targetMapId:u,mustQueue:p,sourceMapId:this.mapId,data:Zu(r,x)},x),{cancel:()=>{s&&delete this.callbacks[b],this.target.postMessage({id:b,type:"<cancel>",targetMapId:u,sourceMapId:this.mapId})}}}receive(a){const r=a.data,s=r.id;if(s&&(!r.targetMapId||this.mapId===r.targetMapId))if(r.type==="<cancel>"){const u=this.cancelCallbacks[s];delete this.cancelCallbacks[s],u&&u.cancel()}else if(r.mustQueue||Jt()){const u=this.callbacks[s];this.cancelCallbacks[s]=this.scheduler.add(()=>this.processTask(s,r),u&&u.metadata||{type:"message"})}else this.processTask(s,r)}processTask(a,r){if(r.type==="<response>"){const s=this.callbacks[a];delete this.callbacks[a],s&&(r.error?s(Xu(r.error)):s(null,Xu(r.data)))}else{const s=Ie(this.globalScope)?void 0:[],u=r.hasCallback?(g,b)=>{delete this.cancelCallbacks[a],this.target.postMessage({id:a,type:"<response>",sourceMapId:this.mapId,error:g?Zu(g):null,data:Zu(b,s)},s)}:g=>{},p=Xu(r.data);if(this.parent[r.type])this.parent[r.type](r.sourceMapId,p,u);else if(this.parent.getWorkerSource){const g=r.type.split(".");this.parent.getWorkerSource(r.sourceMapId,g[0],p.source)[g[1]](p,u)}else u(new Error(`Could not find function ${r.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},o.CanonicalTileID=Bg,o.Color=kn,o.ColorMode=ll,o.CullFaceMode=Os,o.DEMData=Qg,o.DataConstantProperty=Ot,o.DedupedRequest=v3,o.DepthMode=zh,o.EXTENT=bn,o.Elevation=class{isDataAvailableAtPoint(a){const r=this._source();if(this.isUsingMockSource()||!r||a.y<0||a.y>1)return!1;const s=r.getSource().maxzoom,u=1<<s,p=Math.floor(a.x),g=Math.floor((a.x-p)*u),b=Math.floor(a.y*u),x=this.findDEMTileFor(new Ro(s,p,s,g,b));return!(!x||!x.dem)}getAtPointOrZero(a,r=0){return this.getAtPoint(a,r)||0}getAtPoint(a,r,s=!0){if(this.isUsingMockSource())return null;r==null&&(r=null);const u=this._source();if(!u||a.y<0||a.y>1)return r;const p=u.getSource().maxzoom,g=1<<p,b=Math.floor(a.x),x=a.x-b,T=new Ro(p,b,p,Math.floor(x*g),Math.floor(a.y*g)),k=this.findDEMTileFor(T);if(!k||!k.dem)return r;const L=k.dem,O=1<<k.tileID.canonical.z,R=(x*O-k.tileID.canonical.x)*L.dim,U=(a.y*O-k.tileID.canonical.y)*L.dim,$=Math.floor(R),X=Math.floor(U);return(s?this.exaggeration():1)*An(An(L.get($,X),L.get($,X+1),U-X),An(L.get($+1,X),L.get($+1,X+1),U-X),R-$)}getAtTileOffset(a,r,s){const u=1<<a.canonical.z;return this.getAtPointOrZero(new vh(a.wrap+(a.canonical.x+r/bn)/u,(a.canonical.y+s/bn)/u))}getAtTileOffsetFunc(a,r,s,u){return p=>{const g=this.getAtTileOffset(a,p.x,p.y),b=u.upVector(a.canonical,p.x,p.y);return Pa(b,b,g*u.upVectorScale(a.canonical,r,s).metersToTile),b}}getForTilePoints(a,r,s,u){if(this.isUsingMockSource())return!1;const p=t0.create(this,a,u);return!!p&&(r.forEach(g=>{g[2]=this.exaggeration()*p.getElevationAt(g[0],g[1],s)}),!0)}getMinMaxForTile(a){if(this.isUsingMockSource())return null;const r=this.findDEMTileFor(a);if(!r||!r.dem)return null;const s=r.dem.tree,u=r.tileID,p=1<<a.canonical.z-u.canonical.z;let g=a.canonical.x/p-u.canonical.x,b=a.canonical.y/p-u.canonical.y,x=0;for(let T=0;T<a.canonical.z-u.canonical.z&&!s.leaves[x];T++){g*=2,b*=2;const k=2*Math.floor(b)+Math.floor(g);x=s.childOffsets[x]+k,g%=1,b%=1}return{min:this.exaggeration()*s.minimums[x],max:this.exaggeration()*s.maximums[x]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(a,r,s){throw new Error("Pure virtual method called.")}pointCoordinate(a){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(a){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},o.ErrorEvent=Wo,o.EvaluationParameters=Ft,o.Event=Fn,o.Evented=Ki,o.FillExtrusionBucket=rp,o.Frustum=Fy,o.FrustumCorners=By,o.GLOBE_RADIUS=el,o.GLOBE_SCALE_MATCH_LATITUDE=45,o.GLOBE_ZOOM_THRESHOLD_MAX=6,o.GLOBE_ZOOM_THRESHOLD_MIN=5,o.GlobeSharedBuffers=class{constructor(a){this._createGrid(a),this._createPoles(a)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const a of this._poleSegments)a.destroy();for(const a of this._gridSegments)a.withSkirts.destroy(),a.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const a of this._wireframeSegments)a.destroy()}}_fillGridMeshWithLods(a,r){const s=new sn,u=new po,p=[],g=a+1+2,b=r[0]+1,x=r[0]+1+(1+r.length),T=(k,L,O)=>{let R=k===g-1?k-2:k===0?k:k-1;return R+=O?24575:0,[R,L]};for(let k=0;k<g;++k)s.emplaceBack(...T(k,0,!0));for(let k=0;k<b;++k)for(let L=0;L<g;++L)s.emplaceBack(...T(L,k,(L===0||L===g-1)&&!0));for(let k=0;k<r.length;++k){const L=r[k];for(let O=0;O<g;++O)s.emplaceBack(...T(O,L,!0))}for(let k=0;k<r.length;++k){const L=u.length,O=r[k]+1+2,R=new po;for(let X=0;X<O-1;X++){const nt=X===O-2,dt=nt?g*(x-r.length+k-X):g;for(let yt=0;yt<g-1;yt++){const lt=X*g+yt;X===0||nt||yt===0||yt===g-2?(R.emplaceBack(lt+1,lt,lt+dt),R.emplaceBack(lt+dt,lt+dt+1,lt+1)):(u.emplaceBack(lt+1,lt,lt+dt),u.emplaceBack(lt+dt,lt+dt+1,lt+1))}}const U=xi.simpleSegment(0,L,s.length,u.length-L);for(let X=0;X<R.uint16.length;X+=3)u.emplaceBack(R.uint16[X],R.uint16[X+1],R.uint16[X+2]);const $=xi.simpleSegment(0,L,s.length,u.length-L);p.push({withoutSkirts:U,withSkirts:$})}return{vertices:s,indices:u,segments:p}}_createGrid(a){const r=this._fillGridMeshWithLods(id,Wf);this._gridSegments=r.segments,this._gridBuffer=a.createVertexBuffer(r.vertices,Hf.members),this._gridIndexBuffer=a.createIndexBuffer(r.indices,!0)}_createPoles(a){const r=new po;for(let p=0;p<=id;p++)r.emplaceBack(0,p+1,p+2);this._poleIndexBuffer=a.createIndexBuffer(r,!0);const s=new ua,u=new ua;this._poleSegments=[];for(let p=0,g=0;p<5;p++){const b=360/(1<<p);s.emplaceBack(0,-el,0,.5,0),u.emplaceBack(0,-el,0,.5,1);for(let x=0;x<=id;x++){const T=x/id,k=An(0,b,T),[L,O,R]=_h(t6,e6,k,el);s.emplaceBack(L,O,R,T,0),u.emplaceBack(L,O,R,T,1)}this._poleSegments.push(xi.simpleSegment(g,0,66,64)),g+=66}this._poleNorthVertexBuffer=a.createVertexBuffer(s,Cw,!1),this._poleSouthVertexBuffer=a.createVertexBuffer(u,Cw,!1)}getGridBuffers(a,r){return[this._gridBuffer,this._gridIndexBuffer,r?this._gridSegments[a].withSkirts:this._gridSegments[a].withoutSkirts]}getPoleBuffers(a){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[a]]}getWirefameBuffers(a,r){if(!this._wireframeSegments){const s=new Qs,u=id,p=u+1+2,g=1;this._wireframeSegments=[];for(let b=0,x=0;b<Wf.length;b++){const T=Wf[b];for(let L=g;L<T+g;L++)for(let O=g;O<u+g;O++){const R=L*p+O;s.emplaceBack(R,R+1),s.emplaceBack(R,R+p),s.emplaceBack(R,R+p+1)}const k=T*u*3;this._wireframeSegments.push(xi.simpleSegment(0,x,(T+1)*p,k)),x+=k}this._wireframeIndexBuffer=a.createIndexBuffer(s)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[r]]}},o.GlyphManager=Ih,o.ImagePosition=l1,o.LivePerformanceUtils=ae,o.LngLat=rr,o.LngLatBounds=$c,o.LocalGlyphMode=d1,o.MAX_MERCATOR_LATITUDE=go,o.MercatorCoordinate=vh,o.ONE_EM=_o,o.OverscaledTileID=Ro,o.PerformanceMarkers=Ut,o.Properties=pe,o.RGBAImage=ha,o.Ray=Ry,o.RequestManager=class{constructor(a,r,s){this._transformRequestFn=a,this._customAccessToken=r,this._silenceAuthErrors=!!s,this._createSkuToken()}_createSkuToken(){const a=function(){let r="";for(let s=0;s<10;s++)r+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",V,r].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=a.token,this._skuTokenExpiresAt=a.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(a,r){return this._transformRequestFn&&this._transformRequestFn(a,r)||{url:a}}normalizeStyleURL(a,r){if(!Po(a))return a;const s=Xi(a);return s.path=`/styles/v1${s.path}`,this._makeAPIURL(s,this._customAccessToken||r)}normalizeGlyphsURL(a,r){if(!Po(a))return a;const s=Xi(a);return s.path=`/fonts/v1${s.path}`,this._makeAPIURL(s,this._customAccessToken||r)}normalizeSourceURL(a,r,s,u){if(!Po(a))return a;const p=Xi(a);return p.path=`/v4/${p.authority}.json`,p.params.push("secure"),s&&p.params.push(`language=${s}`),u&&p.params.push(`worldview=${u}`),this._makeAPIURL(p,this._customAccessToken||r)}normalizeSpriteURL(a,r,s,u){const p=Xi(a);return Po(a)?(p.path=`/styles/v1${p.path}/sprite${r}${s}`,this._makeAPIURL(p,this._customAccessToken||u)):(p.path+=`${r}${s}`,Fa(p))}normalizeTileURL(a,r,s){if(this._isSkuTokenExpired()&&this._createSkuToken(),a&&!Po(a))return a;const u=Xi(a);u.path=u.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${r||s&&u.authority!=="raster"&&s===512?"@2x":""}${P.supported?".webp":"$1"}`),u.authority==="raster"?u.path=`/${A.RASTER_URL_PREFIX}${u.path}`:(u.path=u.path.replace(/^.+\/v4\//,"/"),u.path=`/${A.TILE_URL_VERSION}${u.path}`);const p=this._customAccessToken||function(g){for(const b of g){const x=b.match(/^access_token=(.*)$/);if(x)return x[1]}return null}(u.params)||A.ACCESS_TOKEN;return A.REQUIRE_ACCESS_TOKEN&&p&&this._skuToken&&u.params.push(`sku=${this._skuToken}`),this._makeAPIURL(u,p)}canonicalizeTileURL(a,r){const s=Xi(a);if(!s.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!s.path.match(/\.[\w]+$/))return a;let u="mapbox://";s.path.match(/^\/raster\/v1\//)?u+=`raster/${s.path.replace(`/${A.RASTER_URL_PREFIX}/`,"")}`:u+=`tiles/${s.path.replace(`/${A.TILE_URL_VERSION}/`,"")}`;let p=s.params;return r&&(p=p.filter(g=>!g.match(/^access_token=/))),p.length&&(u+=`?${p.join("&")}`),u}canonicalizeTileset(a,r){const s=!!r&&Po(r),u=[];for(const p of a.tiles||[])ds(p)?u.push(this.canonicalizeTileURL(p,s)):u.push(p);return u}_makeAPIURL(a,r){const s="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",u=Xi(A.API_URL);if(a.protocol=u.protocol,a.authority=u.authority,a.protocol==="http"){const p=a.params.indexOf("secure");p>=0&&a.params.splice(p,1)}if(u.path!=="/"&&(a.path=`${u.path}${a.path}`),!A.REQUIRE_ACCESS_TOKEN)return Fa(a);if(r=r||A.ACCESS_TOKEN,!this._silenceAuthErrors){if(!r)throw new Error(`An API access token is required to use Mapbox GL. ${s}`);if(r[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${s}`)}return a.params=a.params.filter(p=>p.indexOf("access_token")===-1),a.params.push(`access_token=${r||""}`),Fa(a)}},o.ResourceType=nr,o.SegmentVector=xi,o.SourceCache=ud,o.StencilMode=x1,o.StructArrayLayout1ui2=tl,o.StructArrayLayout2f1f2i16=ho,o.StructArrayLayout2i4=sn,o.StructArrayLayout2ui4=Qs,o.StructArrayLayout3f12=fo,o.StructArrayLayout3ui6=po,o.StructArrayLayout4i8=yr,o.StructArrayLayout5f20=ua,o.Texture=pp,o.Tile=b1,o.Transitionable=ke,o.Uniform1f=bg,o.Uniform1i=class extends Vl{constructor(a){super(a),this.current=0}set(a,r,s){this.fetchUniformLocation(a,r)&&this.current!==s&&(this.current=s,this.gl.uniform1i(this.location,s))}},o.Uniform2f=class extends Vl{constructor(a){super(a),this.current=[0,0]}set(a,r,s){this.fetchUniformLocation(a,r)&&(s[0]===this.current[0]&&s[1]===this.current[1]||(this.current=s,this.gl.uniform2f(this.location,s[0],s[1])))}},o.Uniform3f=class extends Vl{constructor(a){super(a),this.current=[0,0,0]}set(a,r,s){this.fetchUniformLocation(a,r)&&(s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]||(this.current=s,this.gl.uniform3f(this.location,s[0],s[1],s[2])))}},o.Uniform4f=uw,o.UniformColor=dw,o.UniformMatrix2f=class extends Vl{constructor(a){super(a),this.current=NA}set(a,r,s){if(this.fetchUniformLocation(a,r)){for(let u=0;u<4;u++)if(s[u]!==this.current[u]){this.current=s,this.gl.uniformMatrix2fv(this.location,!1,s);break}}}},o.UniformMatrix3f=class extends Vl{constructor(a){super(a),this.current=FA}set(a,r,s){if(this.fetchUniformLocation(a,r)){for(let u=0;u<9;u++)if(s[u]!==this.current[u]){this.current=s,this.gl.uniformMatrix3fv(this.location,!1,s);break}}}},o.UniformMatrix4f=class extends Vl{constructor(a){super(a),this.current=BA}set(a,r,s){if(this.fetchUniformLocation(a,r)){if(s[12]!==this.current[12]||s[0]!==this.current[0])return this.current=s,void this.gl.uniformMatrix4fv(this.location,!1,s);for(let u=1;u<16;u++)if(s[u]!==this.current[u]){this.current=s,this.gl.uniformMatrix4fv(this.location,!1,s);break}}}},o.UnwrappedTileID=m2,o.ValidationError=Ne,o.VectorTileFeature=Dg,o.VectorTileWorkerSource=class extends Ki{constructor(a,r,s,u,p){super(),this.actor=a,this.layerIndex=r,this.availableImages=s,this.loadVectorData=p||x3,this.loading={},this.loaded={},this.deduped=new v3(a.scheduler),this.isSpriteLoaded=u,this.scheduler=a.scheduler}loadTile(a,r){const s=a.uid,u=a&&a.request,p=u&&u.collectResourceTiming,g=this.loading[s]=new oP(a);g.abort=this.loadVectorData(a,(b,x)=>{const T=!this.loading[s];if(delete this.loading[s],T||b||!x)return g.status="done",T||(this.loaded[s]=g),r(b);const k=x.rawData,L={};x.expires&&(L.expires=x.expires),x.cacheControl&&(L.cacheControl=x.cacheControl),g.vectorTile=x.vectorTile||new i1(new sp(k));const O=()=>{g.parse(g.vectorTile,this.layerIndex,this.availableImages,this.actor,(R,U)=>{if(R||!U)return r(R);const $={};if(p){const X=rn(u);X.length>0&&($.resourceTiming=JSON.parse(JSON.stringify(X)))}r(null,Jn({rawTileData:k.slice(0)},U,L,$))})};this.isSpriteLoaded?O():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(O,{type:"parseTile",isSymbolTile:a.isSymbolTile,zoom:a.tileZoom}):O()}),this.loaded=this.loaded||{},this.loaded[s]=g})}reloadTile(a,r){const s=this.loaded,u=a.uid,p=this;if(s&&s[u]){const g=s[u];g.showCollisionBoxes=a.showCollisionBoxes,g.enableTerrain=!!a.enableTerrain,g.projection=a.projection,g.tileTransform=cd(a.tileID.canonical,a.projection);const b=(x,T)=>{const k=g.reloadCallback;k&&(delete g.reloadCallback,g.parse(g.vectorTile,p.layerIndex,this.availableImages,p.actor,k)),r(x,T)};g.status==="parsing"?g.reloadCallback=b:g.status==="done"&&(g.vectorTile?g.parse(g.vectorTile,this.layerIndex,this.availableImages,this.actor,b):b())}}abortTile(a,r){const s=a.uid,u=this.loading[s];u&&(u.abort&&u.abort(),delete this.loading[s]),r()}removeTile(a,r){const s=this.loaded,u=a.uid;s&&s[u]&&delete s[u],r()}},o.WritingMode=za,o.ZoomDependentExpression=Ul,o.add=ql,o.addDynamicAttributes=Yg,o.adjoint=function(a,r){var s=r[0],u=r[1],p=r[2],g=r[3],b=r[4],x=r[5],T=r[6],k=r[7],L=r[8];return a[0]=b*L-x*k,a[1]=p*k-u*L,a[2]=u*x-p*b,a[3]=x*T-g*L,a[4]=s*L-p*T,a[5]=p*g-s*x,a[6]=g*k-b*T,a[7]=u*T-s*k,a[8]=s*b-u*g,a},o.asyncAll=_n,o.bezier=Ue,o.bindAll=He,o.boundsAttributes=i3,o.bufferConvexPolygon=function(a,r){const s=[];for(let u=0;u<a.length;u++){const p=gn(u-1,-1,a.length-1),g=gn(u+1,-1,a.length-1),b=a[u],x=a[g],T=a[p].sub(b).unit(),k=x.sub(b).unit(),L=k.angleWithSep(T.x,T.y),O=T.add(k).unit().mult(-1*r/Math.sin(L/2));s.push(b.add(O))}return s},o.cacheEntryPossiblyAdded=function(a){Yn++,Yn>on&&(a.getActor().send("enforceCacheSizeLimit",Ke),Yn=0)},o.calculateGlobeLabelMatrix=function(a,r){const{x:s,y:u}=a.point,p=Lw(s,u,a.worldSize/a._pixelsPerMercatorPixel,0,0);return ed(p,p,Uy(nl(r)))},o.calculateGlobeMatrix=function(a){const{x:r,y:s}=a.point,{lng:u,lat:p}=a._center;return Lw(r,s,a.worldSize,u,p)},o.calculateGlobeMercatorMatrix=function(a){const r=a.pixelsPerMeter,s=r/zs(1,a.center.lat),u=Ps(new Float64Array(16));return jf(u,u,[a.point.x,a.point.y,0]),nd(u,u,[s,s,r]),Float32Array.from(u)},o.circumferenceAtLatitude=Vy,o.clamp=se,o.clearTileCache=function(a){if(!vn())return;const r=y.caches.delete(ze);a&&r.catch(a).then(()=>a())},o.clipLine=j2,o.clone=function(a){var r=new da(16);return r[0]=a[0],r[1]=a[1],r[2]=a[2],r[3]=a[3],r[4]=a[4],r[5]=a[5],r[6]=a[6],r[7]=a[7],r[8]=a[8],r[9]=a[9],r[10]=a[10],r[11]=a[11],r[12]=a[12],r[13]=a[13],r[14]=a[14],r[15]=a[15],r},o.clone$1=Bn,o.collisionCircleLayout=oI,o.config=A,o.conjugate=function(a,r){return a[0]=-r[0],a[1]=-r[1],a[2]=-r[2],a[3]=r[3],a},o.create=function(){var a=new da(16);return da!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0),a[0]=1,a[5]=1,a[10]=1,a[15]=1,a},o.create$1=fw,o.createExpression=Lc,o.createLayout=nn,o.createStyleLayer=function(a){return a.type==="custom"?new YI(a):new JI[a.type](a)},o.cross=Dy,o.degToRad=jt,o.distance=function(a,r){return Math.hypot(r[0]-a[0],r[1]-a[1],r[2]-a[2])},o.div=function(a,r,s){return a[0]=r[0]/s[0],a[1]=r[1]/s[1],a[2]=r[2]/s[2],a},o.dot=Wa,o.earthRadius=Yf,o.ease=Ae,o.easeCubicInOut=ce,o.ecefToLatLng=function([a,r,s]){const u=Math.hypot(a,r,s),p=Math.atan2(a,s),g=.5*Math.PI-Math.acos(-r/u);return new rr(oe(p),oe(g))},o.emitValidationErrors=ig,o.endsWith=Ce,o.enforceCacheSizeLimit=function(a){Mn(),ve&&ve.then(r=>{r.keys().then(s=>{for(let u=0;u<s.length-a;u++)r.delete(s[u])})})},o.evaluateSizeForFeature=Ng,o.evaluateSizeForZoom=Ch,o.evaluateVariableOffset=q2,o.evented=mt,o.exactEquals=function(a,r){return a[0]===r[0]&&a[1]===r[1]&&a[2]===r[2]&&a[3]===r[3]},o.exactEquals$1=function(a,r){return a[0]===r[0]&&a[1]===r[1]&&a[2]===r[2]},o.exported=tr,o.exported$1=P,o.extend=Jn,o.extend$1=ia,o.fillExtrusionHeightLift=h2,o.filterObject=Qn,o.fromMat4=function(a,r){return a[0]=r[0],a[1]=r[1],a[2]=r[2],a[3]=r[4],a[4]=r[5],a[5]=r[6],a[6]=r[8],a[7]=r[9],a[8]=r[10],a},o.fromQuat=function(a,r){var s=r[0],u=r[1],p=r[2],g=r[3],b=s+s,x=u+u,T=p+p,k=s*b,L=u*b,O=u*x,R=p*b,U=p*x,$=p*T,X=g*b,nt=g*x,dt=g*T;return a[0]=1-O-$,a[1]=L+dt,a[2]=R-nt,a[3]=0,a[4]=L-dt,a[5]=1-k-$,a[6]=U+X,a[7]=0,a[8]=R+nt,a[9]=U-X,a[10]=1-k-O,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},o.fromRotation=function(a,r){var s=Math.sin(r),u=Math.cos(r);return a[0]=u,a[1]=s,a[2]=0,a[3]=-s,a[4]=u,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},o.fromScaling=mw,o.furthestTileCorner=function(a){const r=Math.round((a+45+360)%360/90)%4;return ge[r]},o.getAABBPointSquareDist=function(a,r,s){let u=0;for(let p=0;p<2;++p){const g=s?s[p]:0;a[p]>g&&(u+=(a[p]-g)*(a[p]-g)),r[p]<g&&(u+=(g-r[p])*(g-r[p]))}return u},o.getAnchorAlignment=u1,o.getAnchorJustification=f1,o.getBounds=function(a){let r=1/0,s=1/0,u=-1/0,p=-1/0;for(const g of a)r=Math.min(r,g.x),s=Math.min(s,g.y),u=Math.max(u,g.x),p=Math.max(p,g.y);return{min:new et(r,s),max:new et(u,p)}},o.getColumn=Me,o.getGridMatrix=function(a,r,s,u){const p=r.getNorth(),g=r.getSouth(),b=r.getWest(),x=r.getEast(),T=1<<a.z,k=x-b,L=p-g,O=k/id,R=-L/Wf[s],U=[0,O,0,R,0,0,p,b,0];if(a.z>0){const $=180/u;pw(U,U,[$/k+1,0,0,0,$/L+1,0,-.5*$/O,.5*$/R,1])}return U[2]=T,U[5]=a.x,U[8]=a.y,U},o.getImage=xa,o.getJSON=function(a,r){return Ui(Jn(a,{type:"json"}),r)},o.getLatitudinalLod=function(a){const r=go-5;a=se(a,-r,r)/r*90;const s=Math.pow(Math.abs(Math.sin(jt(a))),3);return Math.round(s*(Wf.length-1))},o.getMapSessionAPI=Lt,o.getPerformanceMeasurement=rn,o.getProjection=Q2,o.getRTLTextPluginStatus=Tt,o.getReferrer=Io,o.getTilePoint=function(a,{x:r,y:s},u=0){return new et(((r-u)*a.scale-a.x)*bn,(s*a.scale-a.y)*bn)},o.getTileVec3=function(a,r,s=0){return gh(((r.x-s)*a.scale-a.x)*bn,(r.y*a.scale-a.y)*bn,Rw(r.z,r.y))},o.getVideo=function(a,r){const s=y.document.createElement("video");s.muted=!0,s.onloadstart=function(){r(null,s)};for(let u=0;u<a.length;u++){const p=y.document.createElement("source");xo(a[u])||(s.crossOrigin="Anonymous"),p.src=a[u],s.appendChild(p)}return{cancel:()=>{}}},o.globeCenterToScreenPoint=function(a){const r=[0,0,0],s=Ps(new Float64Array(16));return ed(s,a.pixelMatrix,a.globeMatrix),gi(r,r,s),new et(r[0],r[1])},o.globeDenormalizeECEF=Uy,o.globeECEFOrigin=function(a,r){const s=[0,0,0];return gi(s,s,Xf(nl(r.canonical))),gi(s,s,a),s},o.globeMetersToEcef=Eg,o.globeNormalizeECEF=Xf,o.globePixelsToTileUnits=function(a,r){return bn/(512*Math.pow(2,a))*kg(nl(r))},o.globePoleMatrixForTile=function(a,r,s){const u=Ps(new Float64Array(16)),p=(r/(1<<a)-.5)*Math.PI*2;return wg(u,s.globeMatrix,p),Float32Array.from(u)},o.globeTileBounds=nl,o.globeTiltAtLngLat=zw,o.globeToMercatorTransition=bh,o.globeUseCustomAntiAliasing=function(a,r,s){const u=bh(s.zoom),p=a.style.map._antialias,g=!!r.extStandardDerivatives,b=r.extStandardDerivativesForceOff||a.terrain&&a.terrain.exaggeration()>0;return u===0&&!p&&!b&&g},o.identity=Ps,o.identity$1=Ew,o.invert=Py,o.isFullscreen=function(){return!!y.document.fullscreenElement||!!y.document.webkitFullscreenElement},o.isLngLatBehindGlobe=$y,o.isMapAuthenticated=function(a){return At.has(a)},o.isMapboxURL=Po,o.isSafariWithAntialiasingBug=function(a){const r=a.navigator?a.navigator.userAgent:null;return!!Ie(a)&&r&&(r.match("Version/15.4")||r.match("Version/15.5")||r.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},o.latFromMercatorY=mo,o.latLngToECEF=yh,o.len=ZA,o.length=Uf,o.length$1=function(a){return Math.hypot(a[0],a[1],a[2],a[3])},o.lngFromMercatorX=La,o.loadVectorTile=x3,o.makeRequest=Ui,o.mapValue=function(a,r,s,u,p){return se((a-r)/(s-r)*(p-u)+u,u,p)},o.mercatorScale=Bw,o.mercatorXfromLng=rl,o.mercatorYfromLat=il,o.mercatorZfromAltitude=zs,o.mul=HA,o.mul$1=WA,o.multiply=ed,o.multiply$1=pw,o.multiply$2=yw,o.nextPowerOfTwo=_r,o.normalize=Oo,o.normalize$1=XA,o.normalize$2=xw,o.number=An,o.ortho=function(a,r,s,u,p,g,b){var x=1/(r-s),T=1/(u-p),k=1/(g-b);return a[0]=-2*x,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*T,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*k,a[11]=0,a[12]=(r+s)*x,a[13]=(p+u)*T,a[14]=(b+g)*k,a[15]=1,a},o.pbf=sp,o.perspective=function(a,r,s,u,p){var g,b=1/Math.tan(r/2);return a[0]=b/s,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=b,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,p!=null&&p!==1/0?(a[10]=(p+u)*(g=1/(u-p)),a[14]=2*p*u*g):(a[10]=-1,a[14]=-2*u),a},o.pick=function(a,r){const s={};for(let u=0;u<r.length;u++){const p=r[u];p in a&&(s[p]=a[p])}return s},o.plugin=Mt,o.pointGeometry=et,o.polesInViewport=function(a){const r=Ps(new Float64Array(16));ed(r,a.pixelMatrix,a.globeMatrix);const s=[0,Za,0],u=[0,Xa,0];return gi(s,s,r),gi(u,u,r),[s[0]>0&&s[0]<=a.width&&s[1]>0&&s[1]<=a.height&&!$y(a,new rr(a.center.lat,90)),u[0]>0&&u[0]<=a.width&&u[1]>0&&u[1]<=a.height&&!$y(a,new rr(a.center.lat,-90))]},o.polygonContainsPoint=sd,o.polygonIntersectsBox=Gw,o.polygonIntersectsPolygon=jw,o.polygonizeBounds=function(a,r,s=0,u=!0){const p=new et(s,s),g=a.sub(p),b=r.add(p),x=[g,new et(b.x,g.y),b,new et(g.x,b.y)];return u&&x.push(g.clone()),x},o.posAttributes=Hf,o.postMapLoadEvent=st,o.postPerformanceEvent=kt,o.postTurnstileEvent=G,o.potpack=s1,o.prevPowerOfTwo=function(a){return a<=1?1:Math.pow(2,Math.floor(Math.log(a)/Math.LN2))},o.radToDeg=oe,o.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],o.registerForPluginStateChange=function(a){return a({pluginStatus:at,pluginURL:K}),mt.on("pluginStateChange",a),a},o.removeAuthState=function(a){At.delete(a)},o.renderColorRamp=Ky,o.resample=Fw,o.rotateX=Ly,o.rotateX$1=Tw,o.rotateY=wg,o.rotateY$1=kw,o.rotateZ=function(a,r,s){var u=Math.sin(s),p=Math.cos(s),g=r[0],b=r[1],x=r[2],T=r[3],k=r[4],L=r[5],O=r[6],R=r[7];return r!==a&&(a[8]=r[8],a[9]=r[9],a[10]=r[10],a[11]=r[11],a[12]=r[12],a[13]=r[13],a[14]=r[14],a[15]=r[15]),a[0]=g*p+k*u,a[1]=b*p+L*u,a[2]=x*p+O*u,a[3]=T*p+R*u,a[4]=k*p-g*u,a[5]=L*p-b*u,a[6]=O*p-x*u,a[7]=R*p-T*u,a},o.rotateZ$1=function(a,r,s){s*=.5;var u=r[0],p=r[1],g=r[2],b=r[3],x=Math.sin(s),T=Math.cos(s);return a[0]=u*T+p*x,a[1]=p*T-u*x,a[2]=g*T+b*x,a[3]=b*T-g*x,a},o.scale=nd,o.scale$1=vw,o.scale$2=Pa,o.scaleAndAdd=Gf,o.set=function(a,r,s,u){return a[0]=r,a[1]=s,a[2]=u,a},o.setCacheLimits=function(a,r){Ke=a,on=r},o.setColumn=function(a,r,s){a[4*r+0]=s[0],a[4*r+1]=s[1],a[4*r+2]=s[2],a[4*r+3]=s[3]},o.setRTLTextPlugin=function(a,r,s=!1){if(at===Q||at===it||at===rt)throw new Error("setRTLTextPlugin cannot be called multiple times.");K=tr.resolveURL(a),at=Q,ot=r,ut(),s||wt()},o.smoothstep=Ze,o.spec=Kt,o.squaredLength=function(a){var r=a[0],s=a[1],u=a[2];return r*r+s*s+u*u},o.storeAuthState=function(a,r){r?At.add(a):At.delete(a)},o.sub=Ls,o.subtract=Oy,o.symbolSize=aI,o.tileAABB=function(a,r,s,u,p,g,b,x,T){if(T.name==="globe")return QA(a,r,new Bg(s,u,p));const k=cd({z:s,x:u,y:p},T);return new Do([(g+k.x/k.scale)*r,r*(k.y/k.scale),b],[(g+k.x2/k.scale)*r,r*(k.y2/k.scale),x])},o.tileCornersToBounds=Tg,o.tileTransform=cd,o.transformMat3=function(a,r,s){var u=r[0],p=r[1],g=r[2];return a[0]=u*s[0]+p*s[3]+g*s[6],a[1]=u*s[1]+p*s[4]+g*s[7],a[2]=u*s[2]+p*s[5]+g*s[8],a},o.transformMat4=gi,o.transformMat4$1=rd,o.transformQuat=bw,o.transitionTileAABBinECEF=Aw,o.translate=jf,o.transpose=function(a,r){if(a===r){var s=r[1],u=r[2],p=r[5];a[1]=r[3],a[2]=r[6],a[3]=s,a[5]=r[7],a[6]=u,a[7]=p}else a[0]=r[0],a[1]=r[3],a[2]=r[6],a[3]=r[1],a[4]=r[4],a[5]=r[7],a[6]=r[2],a[7]=r[5],a[8]=r[8];return a},o.triggerPluginCompletionEvent=ht,o.uniqueId=ur,o.updateGlobeVertexNormal=function(a,r,s,u,p){const g=5*r+2;a.float32[g+0]=s,a.float32[g+1]=u,a.float32[g+2]=p},o.validateCustomStyleLayer=function(a){const r=[],s=a.id;return s===void 0&&r.push({message:`layers.${s}: missing required property "id"`}),a.render===void 0&&r.push({message:`layers.${s}: missing required method "render"`}),a.renderingMode&&a.renderingMode!=="2d"&&a.renderingMode!=="3d"&&r.push({message:`layers.${s}: property "renderingMode" must be either "2d" or "3d"`}),r},o.validateFilter=a=>Cs(If(a)),o.validateFog=a=>Cs(eg(a)),o.validateLayer=a=>Cs(Lf(a)),o.validateLight=a=>Cs(tg(a)),o.validateSource=a=>Cs(Hu(a)),o.validateStyle=ng,o.validateTerrain=a=>Cs(zf(a)),o.values=Gn,o.vectorTile=Og,o.version=E,o.warnOnce=Qe,o.window=y,o.wrap=gn}),d(["./shared"],function(o){function y(ct){if(typeof ct=="number"||typeof ct=="boolean"||typeof ct=="string"||ct==null)return JSON.stringify(ct);if(Array.isArray(ct)){let Y="[";for(const st of ct)Y+=`${y(st)},`;return`${Y}]`}let G="{";for(const Y of Object.keys(ct).sort())G+=`${Y}:${y(ct[Y])},`;return`${G}}`}function E(ct){let G="";for(const Y of o.refProperties)G+=`/${y(ct[Y])}`;return G}class C{constructor(G){this.keyCache={},G&&this.replace(G)}replace(G){this._layerConfigs={},this._layers={},this.update(G,[])}update(G,Y){for(const pt of G)this._layerConfigs[pt.id]=pt,(this._layers[pt.id]=o.createStyleLayer(pt)).compileFilter(),this.keyCache[pt.id]&&delete this.keyCache[pt.id];for(const pt of Y)delete this.keyCache[pt],delete this._layerConfigs[pt],delete this._layers[pt];this.familiesBySource={};const st=function(pt,kt){const Bt={};for(let At=0;At<pt.length;At++){const Ut=kt&&kt[pt[At].id]||E(pt[At]);kt&&(kt[pt[At].id]=Ut);let ae=Bt[Ut];ae||(ae=Bt[Ut]=[]),ae.push(pt[At])}const Lt=[];for(const At in Bt)Lt.push(Bt[At]);return Lt}(o.values(this._layerConfigs),this.keyCache);for(const pt of st){const kt=pt.map(Oe=>this._layers[Oe.id]),Bt=kt[0];if(Bt.visibility==="none")continue;const Lt=Bt.source||"";let At=this.familiesBySource[Lt];At||(At=this.familiesBySource[Lt]={});const Ut=Bt.sourceLayer||"_geojsonTileLayer";let ae=At[Ut];ae||(ae=At[Ut]=[]),ae.push(kt)}}}class A{loadTile(G,Y){const{uid:st,encoding:pt,rawImageData:kt,padding:Bt,buildQuadTree:Lt}=G,At=o.window.ImageBitmap&&kt instanceof o.window.ImageBitmap?this.getImageData(kt,Bt):kt;Y(null,new o.DEMData(st,At,pt,Bt<1,Lt))}getImageData(G,Y){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(G.width,G.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=G.width,this.offscreenCanvas.height=G.height,this.offscreenCanvasContext.drawImage(G,0,0,G.width,G.height);const st=this.offscreenCanvasContext.getImageData(-Y,-Y,G.width+2*Y,G.height+2*Y);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),st}}var P=function ct(G,Y){var st,pt=G&&G.type;if(pt==="FeatureCollection")for(st=0;st<G.features.length;st++)ct(G.features[st],Y);else if(pt==="GeometryCollection")for(st=0;st<G.geometries.length;st++)ct(G.geometries[st],Y);else if(pt==="Feature")ct(G.geometry,Y);else if(pt==="Polygon")B(G.coordinates,Y);else if(pt==="MultiPolygon")for(st=0;st<G.coordinates.length;st++)B(G.coordinates[st],Y);return G};function B(ct,G){if(ct.length!==0){j(ct[0],G);for(var Y=1;Y<ct.length;Y++)j(ct[Y],!G)}}function j(ct,G){for(var Y=0,st=0,pt=0,kt=ct.length,Bt=kt-1;pt<kt;Bt=pt++){var Lt=(ct[pt][0]-ct[Bt][0])*(ct[Bt][1]+ct[pt][1]),At=Y+Lt;st+=Math.abs(Y)>=Math.abs(Lt)?Y-At+Lt:Lt-At+Y,Y=At}Y+st>=0!=!!G&&ct.reverse()}const Z=o.VectorTileFeature.prototype.toGeoJSON;class W{constructor(G){this._feature=G,this.extent=o.EXTENT,this.type=G.type,this.properties=G.tags,"id"in G&&!isNaN(G.id)&&(this.id=parseInt(G.id,10))}loadGeometry(){if(this._feature.type===1){const G=[];for(const Y of this._feature.geometry)G.push([new o.pointGeometry(Y[0],Y[1])]);return G}{const G=[];for(const Y of this._feature.geometry){const st=[];for(const pt of Y)st.push(new o.pointGeometry(pt[0],pt[1]));G.push(st)}return G}}toGeoJSON(G,Y,st){return Z.call(this,G,Y,st)}}class H{constructor(G){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=o.EXTENT,this.length=G.length,this._features=G}feature(G){return new W(this._features[G])}}var V={},tt={get exports(){return V},set exports(ct){V=ct}},ft=o.pointGeometry,et=o.vectorTile.VectorTileFeature,Pt=Rt;function Rt(ct,G){this.options=G||{},this.features=ct,this.length=ct.length}function zt(ct,G){this.id=typeof ct.id=="number"?ct.id:void 0,this.type=ct.type,this.rawGeometry=ct.type===1?[ct.geometry]:ct.geometry,this.properties=ct.tags,this.extent=G||4096}Rt.prototype.feature=function(ct){return new zt(this.features[ct],this.options.extent)},zt.prototype.loadGeometry=function(){var ct=this.rawGeometry;this.geometry=[];for(var G=0;G<ct.length;G++){for(var Y=ct[G],st=[],pt=0;pt<Y.length;pt++)st.push(new ft(Y[pt][0],Y[pt][1]));this.geometry.push(st)}return this.geometry},zt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var ct=this.geometry,G=1/0,Y=-1/0,st=1/0,pt=-1/0,kt=0;kt<ct.length;kt++)for(var Bt=ct[kt],Lt=0;Lt<Bt.length;Lt++){var At=Bt[Lt];G=Math.min(G,At.x),Y=Math.max(Y,At.x),st=Math.min(st,At.y),pt=Math.max(pt,At.y)}return[G,st,Y,pt]},zt.prototype.toGeoJSON=et.prototype.toGeoJSON;var jt=o.pbf,oe=Pt;function ge(ct){var G=new jt;return function(Y,st){for(var pt in Y.layers)st.writeMessage(3,ce,Y.layers[pt])}(ct,G),G.finish()}function ce(ct,G){var Y;G.writeVarintField(15,ct.version||1),G.writeStringField(1,ct.name||""),G.writeVarintField(5,ct.extent||4096);var st={keys:[],values:[],keycache:{},valuecache:{}};for(Y=0;Y<ct.length;Y++)st.feature=ct.feature(Y),G.writeMessage(2,Ue,st);var pt=st.keys;for(Y=0;Y<pt.length;Y++)G.writeStringField(3,pt[Y]);var kt=st.values;for(Y=0;Y<kt.length;Y++)G.writeMessage(4,_n,kt[Y])}function Ue(ct,G){var Y=ct.feature;Y.id!==void 0&&G.writeVarintField(1,Y.id),G.writeMessage(2,Ae,ct),G.writeVarintField(3,Y.type),G.writeMessage(4,gn,Y)}function Ae(ct,G){var Y=ct.feature,st=ct.keys,pt=ct.values,kt=ct.keycache,Bt=ct.valuecache;for(var Lt in Y.properties){var At=Y.properties[Lt],Ut=kt[Lt];if(At!==null){Ut===void 0&&(st.push(Lt),kt[Lt]=Ut=st.length-1),G.writeVarint(Ut);var ae=typeof At;ae!=="string"&&ae!=="boolean"&&ae!=="number"&&(At=JSON.stringify(At));var Oe=ae+":"+At,me=Bt[Oe];me===void 0&&(pt.push(At),Bt[Oe]=me=pt.length-1),G.writeVarint(me)}}}function se(ct,G){return(G<<3)+(7&ct)}function Ze(ct){return ct<<1^ct>>31}function gn(ct,G){for(var Y=ct.loadGeometry(),st=ct.type,pt=0,kt=0,Bt=Y.length,Lt=0;Lt<Bt;Lt++){var At=Y[Lt],Ut=1;st===1&&(Ut=At.length),G.writeVarint(se(1,Ut));for(var ae=st===3?At.length-1:At.length,Oe=0;Oe<ae;Oe++){Oe===1&&st!==1&&G.writeVarint(se(2,ae-1));var me=At[Oe].x-pt,rn=At[Oe].y-kt;G.writeVarint(Ze(me)),G.writeVarint(Ze(rn)),pt+=me,kt+=rn}st===3&&G.writeVarint(se(7,1))}}function _n(ct,G){var Y=typeof ct;Y==="string"?G.writeStringField(1,ct):Y==="boolean"?G.writeBooleanField(7,ct):Y==="number"&&(ct%1!=0?G.writeDoubleField(3,ct):ct<0?G.writeSVarintField(6,ct):G.writeVarintField(5,ct))}function Gn(ct,G,Y,st,pt,kt){if(pt-st<=Y)return;const Bt=st+pt>>1;Jn(ct,G,Bt,st,pt,kt%2),Gn(ct,G,Y,st,Bt-1,kt+1),Gn(ct,G,Y,Bt+1,pt,kt+1)}function Jn(ct,G,Y,st,pt,kt){for(;pt>st;){if(pt-st>600){const Ut=pt-st+1,ae=Y-st+1,Oe=Math.log(Ut),me=.5*Math.exp(2*Oe/3),rn=.5*Math.sqrt(Oe*me*(Ut-me)/Ut)*(ae-Ut/2<0?-1:1);Jn(ct,G,Y,Math.max(st,Math.floor(Y-ae*me/Ut+rn)),Math.min(pt,Math.floor(Y+(Ut-ae)*me/Ut+rn)),kt)}const Bt=G[2*Y+kt];let Lt=st,At=pt;for(Wn(ct,G,st,Y),G[2*pt+kt]>Bt&&Wn(ct,G,st,pt);Lt<At;){for(Wn(ct,G,Lt,At),Lt++,At--;G[2*Lt+kt]<Bt;)Lt++;for(;G[2*At+kt]>Bt;)At--}G[2*st+kt]===Bt?Wn(ct,G,st,At):(At++,Wn(ct,G,At,pt)),At<=Y&&(st=At+1),Y<=At&&(pt=At-1)}}function Wn(ct,G,Y,st){ur(ct,Y,st),ur(G,2*Y,2*st),ur(G,2*Y+1,2*st+1)}function ur(ct,G,Y){const st=ct[G];ct[G]=ct[Y],ct[Y]=st}function Zn(ct,G,Y,st){const pt=ct-Y,kt=G-st;return pt*pt+kt*kt}tt.exports=ge,V.fromVectorTileJs=ge,V.fromGeojsonVt=function(ct,G){G=G||{};var Y={};for(var st in ct)Y[st]=new oe(ct[st].features,G),Y[st].name=st,Y[st].version=G.version,Y[st].extent=G.extent;return ge({layers:Y})},V.GeoJSONWrapper=oe;const _r=ct=>ct[0],he=ct=>ct[1];class He{constructor(G,Y=_r,st=he,pt=64,kt=Float64Array){this.nodeSize=pt,this.points=G;const Bt=G.length<65536?Uint16Array:Uint32Array,Lt=this.ids=new Bt(G.length),At=this.coords=new kt(2*G.length);for(let Ut=0;Ut<G.length;Ut++)Lt[Ut]=Ut,At[2*Ut]=Y(G[Ut]),At[2*Ut+1]=st(G[Ut]);Gn(Lt,At,pt,0,Lt.length-1,0)}range(G,Y,st,pt){return function(kt,Bt,Lt,At,Ut,ae,Oe){const me=[0,kt.length-1,0],rn=[];let tn,en;for(;me.length;){const dn=me.pop(),an=me.pop(),tr=me.pop();if(an-tr<=Oe){for(let Fn=tr;Fn<=an;Fn++)tn=Bt[2*Fn],en=Bt[2*Fn+1],tn>=Lt&&tn<=Ut&&en>=At&&en<=ae&&rn.push(kt[Fn]);continue}const hn=Math.floor((tr+an)/2);tn=Bt[2*hn],en=Bt[2*hn+1],tn>=Lt&&tn<=Ut&&en>=At&&en<=ae&&rn.push(kt[hn]);const qn=(dn+1)%2;(dn===0?Lt<=tn:At<=en)&&(me.push(tr),me.push(hn-1),me.push(qn)),(dn===0?Ut>=tn:ae>=en)&&(me.push(hn+1),me.push(an),me.push(qn))}return rn}(this.ids,this.coords,G,Y,st,pt,this.nodeSize)}within(G,Y,st){return function(pt,kt,Bt,Lt,At,Ut){const ae=[0,pt.length-1,0],Oe=[],me=At*At;for(;ae.length;){const rn=ae.pop(),tn=ae.pop(),en=ae.pop();if(tn-en<=Ut){for(let qn=en;qn<=tn;qn++)Zn(kt[2*qn],kt[2*qn+1],Bt,Lt)<=me&&Oe.push(pt[qn]);continue}const dn=Math.floor((en+tn)/2),an=kt[2*dn],tr=kt[2*dn+1];Zn(an,tr,Bt,Lt)<=me&&Oe.push(pt[dn]);const hn=(rn+1)%2;(rn===0?Bt-At<=an:Lt-At<=tr)&&(ae.push(en),ae.push(dn-1),ae.push(hn)),(rn===0?Bt+At>=an:Lt+At>=tr)&&(ae.push(dn+1),ae.push(tn),ae.push(hn))}return Oe}(this.ids,this.coords,G,Y,st,this.nodeSize)}}const Ce={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ct=>ct},Te=Math.fround||(Qn=new Float32Array(1),ct=>(Qn[0]=+ct,Qn[0]));var Qn;class Bn{constructor(G){this.options=Ie(Object.create(Ce),G),this.trees=new Array(this.options.maxZoom+1)}load(G){const{log:Y,minZoom:st,maxZoom:pt,nodeSize:kt}=this.options;Y&&console.time("total time");const Bt=`prepare ${G.length} points`;Y&&console.time(Bt),this.points=G;let Lt=[];for(let At=0;At<G.length;At++)G[At].geometry&&Lt.push(Qe(G[At],At));this.trees[pt+1]=new He(Lt,Ge,Me,kt,Float32Array),Y&&console.timeEnd(Bt);for(let At=pt;At>=st;At--){const Ut=+Date.now();Lt=this._cluster(Lt,At),this.trees[At]=new He(Lt,Ge,Me,kt,Float32Array),Y&&console.log("z%d: %d clusters in %dms",At,Lt.length,+Date.now()-Ut)}return Y&&console.timeEnd("total time"),this}getClusters(G,Y){let st=((G[0]+180)%360+360)%360-180;const pt=Math.max(-90,Math.min(90,G[1]));let kt=G[2]===180?180:((G[2]+180)%360+360)%360-180;const Bt=Math.max(-90,Math.min(90,G[3]));if(G[2]-G[0]>=360)st=-180,kt=180;else if(st>kt){const ae=this.getClusters([st,pt,180,Bt],Y),Oe=this.getClusters([-180,pt,kt,Bt],Y);return ae.concat(Oe)}const Lt=this.trees[this._limitZoom(Y)],At=Lt.range(Jt(st),fe(Bt),Jt(kt),fe(pt)),Ut=[];for(const ae of At){const Oe=Lt.points[ae];Ut.push(Oe.numPoints?bt(Oe):this.points[Oe.index])}return Ut}getChildren(G){const Y=this._getOriginId(G),st=this._getOriginZoom(G),pt="No cluster with the specified id.",kt=this.trees[st];if(!kt)throw new Error(pt);const Bt=kt.points[Y];if(!Bt)throw new Error(pt);const Lt=this.options.radius/(this.options.extent*Math.pow(2,st-1)),At=kt.within(Bt.x,Bt.y,Lt),Ut=[];for(const ae of At){const Oe=kt.points[ae];Oe.parentId===G&&Ut.push(Oe.numPoints?bt(Oe):this.points[Oe.index])}if(Ut.length===0)throw new Error(pt);return Ut}getLeaves(G,Y,st){const pt=[];return this._appendLeaves(pt,G,Y=Y||10,st=st||0,0),pt}getTile(G,Y,st){const pt=this.trees[this._limitZoom(G)],kt=Math.pow(2,G),{extent:Bt,radius:Lt}=this.options,At=Lt/Bt,Ut=(st-At)/kt,ae=(st+1+At)/kt,Oe={features:[]};return this._addTileFeatures(pt.range((Y-At)/kt,Ut,(Y+1+At)/kt,ae),pt.points,Y,st,kt,Oe),Y===0&&this._addTileFeatures(pt.range(1-At/kt,Ut,1,ae),pt.points,kt,st,kt,Oe),Y===kt-1&&this._addTileFeatures(pt.range(0,Ut,At/kt,ae),pt.points,-1,st,kt,Oe),Oe.features.length?Oe:null}getClusterExpansionZoom(G){let Y=this._getOriginZoom(G)-1;for(;Y<=this.options.maxZoom;){const st=this.getChildren(G);if(Y++,st.length!==1)break;G=st[0].properties.cluster_id}return Y}_appendLeaves(G,Y,st,pt,kt){const Bt=this.getChildren(Y);for(const Lt of Bt){const At=Lt.properties;if(At&&At.cluster?kt+At.point_count<=pt?kt+=At.point_count:kt=this._appendLeaves(G,At.cluster_id,st,pt,kt):kt<pt?kt++:G.push(Lt),G.length===st)break}return kt}_addTileFeatures(G,Y,st,pt,kt,Bt){for(const Lt of G){const At=Y[Lt],Ut=At.numPoints;let ae,Oe,me;if(Ut)ae=vt(At),Oe=At.x,me=At.y;else{const en=this.points[At.index];ae=en.properties,Oe=Jt(en.geometry.coordinates[0]),me=fe(en.geometry.coordinates[1])}const rn={type:1,geometry:[[Math.round(this.options.extent*(Oe*kt-st)),Math.round(this.options.extent*(me*kt-pt))]],tags:ae};let tn;Ut?tn=At.id:this.options.generateId?tn=At.index:this.points[At.index].id&&(tn=this.points[At.index].id),tn!==void 0&&(rn.id=tn),Bt.features.push(rn)}}_limitZoom(G){return Math.max(this.options.minZoom,Math.min(Math.floor(+G),this.options.maxZoom+1))}_cluster(G,Y){const st=[],{radius:pt,extent:kt,reduce:Bt,minPoints:Lt}=this.options,At=pt/(kt*Math.pow(2,Y));for(let Ut=0;Ut<G.length;Ut++){const ae=G[Ut];if(ae.zoom<=Y)continue;ae.zoom=Y;const Oe=this.trees[Y+1],me=Oe.within(ae.x,ae.y,At),rn=ae.numPoints||1;let tn=rn;for(const en of me){const dn=Oe.points[en];dn.zoom>Y&&(tn+=dn.numPoints||1)}if(tn>rn&&tn>=Lt){let en=ae.x*rn,dn=ae.y*rn,an=Bt&&rn>1?this._map(ae,!0):null;const tr=(Ut<<5)+(Y+1)+this.points.length;for(const hn of me){const qn=Oe.points[hn];if(qn.zoom<=Y)continue;qn.zoom=Y;const Fn=qn.numPoints||1;en+=qn.x*Fn,dn+=qn.y*Fn,qn.parentId=tr,Bt&&(an||(an=this._map(ae,!0)),Bt(an,this._map(qn)))}ae.parentId=tr,st.push(Ln(en/tn,dn/tn,tr,tn,an))}else if(st.push(ae),tn>1)for(const en of me){const dn=Oe.points[en];dn.zoom<=Y||(dn.zoom=Y,st.push(dn))}}return st}_getOriginId(G){return G-this.points.length>>5}_getOriginZoom(G){return(G-this.points.length)%32}_map(G,Y){if(G.numPoints)return Y?Ie({},G.properties):G.properties;const st=this.points[G.index].properties,pt=this.options.map(st);return Y&&pt===st?Ie({},pt):pt}}function Ln(ct,G,Y,st,pt){return{x:Te(ct),y:Te(G),zoom:1/0,id:Y,parentId:-1,numPoints:st,properties:pt}}function Qe(ct,G){const[Y,st]=ct.geometry.coordinates;return{x:Te(Jt(Y)),y:Te(fe(st)),zoom:1/0,index:G,parentId:-1}}function bt(ct){return{type:"Feature",id:ct.id,properties:vt(ct),geometry:{type:"Point",coordinates:[(G=ct.x,360*(G-.5)),be(ct.y)]}};var G}function vt(ct){const G=ct.numPoints,Y=G>=1e4?`${Math.round(G/1e3)}k`:G>=1e3?Math.round(G/100)/10+"k":G;return Ie(Ie({},ct.properties),{cluster:!0,cluster_id:ct.id,point_count:G,point_count_abbreviated:Y})}function Jt(ct){return ct/360+.5}function fe(ct){const G=Math.sin(ct*Math.PI/180),Y=.5-.25*Math.log((1+G)/(1-G))/Math.PI;return Y<0?0:Y>1?1:Y}function be(ct){const G=(180-360*ct)*Math.PI/180;return 360*Math.atan(Math.exp(G))/Math.PI-90}function Ie(ct,G){for(const Y in G)ct[Y]=G[Y];return ct}function Ge(ct){return ct.x}function Me(ct){return ct.y}function ze(ct,G,Y,st){for(var pt,kt=st,Bt=Y-G>>1,Lt=Y-G,At=ct[G],Ut=ct[G+1],ae=ct[Y],Oe=ct[Y+1],me=G+3;me<Y;me+=3){var rn=ve(ct[me],ct[me+1],At,Ut,ae,Oe);if(rn>kt)pt=me,kt=rn;else if(rn===kt){var tn=Math.abs(me-Bt);tn<Lt&&(pt=me,Lt=tn)}}kt>st&&(pt-G>3&&ze(ct,G,pt,st),ct[pt+2]=kt,Y-pt>3&&ze(ct,pt,Y,st))}function ve(ct,G,Y,st,pt,kt){var Bt=pt-Y,Lt=kt-st;if(Bt!==0||Lt!==0){var At=((ct-Y)*Bt+(G-st)*Lt)/(Bt*Bt+Lt*Lt);At>1?(Y=pt,st=kt):At>0&&(Y+=Bt*At,st+=Lt*At)}return(Bt=ct-Y)*Bt+(Lt=G-st)*Lt}function Ye(ct,G,Y,st){var pt={id:ct===void 0?null:ct,type:G,geometry:Y,tags:st,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(kt){var Bt=kt.geometry,Lt=kt.type;if(Lt==="Point"||Lt==="MultiPoint"||Lt==="LineString")Ke(kt,Bt);else if(Lt==="Polygon"||Lt==="MultiLineString")for(var At=0;At<Bt.length;At++)Ke(kt,Bt[At]);else if(Lt==="MultiPolygon")for(At=0;At<Bt.length;At++)for(var Ut=0;Ut<Bt[At].length;Ut++)Ke(kt,Bt[At][Ut])}(pt),pt}function Ke(ct,G){for(var Y=0;Y<G.length;Y+=3)ct.minX=Math.min(ct.minX,G[Y]),ct.minY=Math.min(ct.minY,G[Y+1]),ct.maxX=Math.max(ct.maxX,G[Y]),ct.maxY=Math.max(ct.maxY,G[Y+1])}function on(ct,G,Y,st){if(G.geometry){var pt=G.geometry.coordinates,kt=G.geometry.type,Bt=Math.pow(Y.tolerance/((1<<Y.maxZoom)*Y.extent),2),Lt=[],At=G.id;if(Y.promoteId?At=G.properties[Y.promoteId]:Y.generateId&&(At=st||0),kt==="Point")vn(pt,Lt);else if(kt==="MultiPoint")for(var Ut=0;Ut<pt.length;Ut++)vn(pt[Ut],Lt);else if(kt==="LineString")Mn(pt,Lt,Bt,!1);else if(kt==="MultiLineString"){if(Y.lineMetrics){for(Ut=0;Ut<pt.length;Ut++)Mn(pt[Ut],Lt=[],Bt,!1),ct.push(Ye(At,"LineString",Lt,G.properties));return}Xn(pt,Lt,Bt,!1)}else if(kt==="Polygon")Xn(pt,Lt,Bt,!0);else{if(kt!=="MultiPolygon"){if(kt==="GeometryCollection"){for(Ut=0;Ut<G.geometry.geometries.length;Ut++)on(ct,{id:At,geometry:G.geometry.geometries[Ut],properties:G.properties},Y,st);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Ut=0;Ut<pt.length;Ut++){var ae=[];Xn(pt[Ut],ae,Bt,!0),Lt.push(ae)}}ct.push(Ye(At,kt,Lt,G.properties))}}function vn(ct,G){G.push(Yn(ct[0])),G.push(nr(ct[1])),G.push(0)}function Mn(ct,G,Y,st){for(var pt,kt,Bt=0,Lt=0;Lt<ct.length;Lt++){var At=Yn(ct[Lt][0]),Ut=nr(ct[Lt][1]);G.push(At),G.push(Ut),G.push(0),Lt>0&&(Bt+=st?(pt*Ut-At*kt)/2:Math.sqrt(Math.pow(At-pt,2)+Math.pow(Ut-kt,2))),pt=At,kt=Ut}var ae=G.length-3;G[2]=1,ze(G,0,ae,Y),G[ae+2]=1,G.size=Math.abs(Bt),G.start=0,G.end=G.size}function Xn(ct,G,Y,st){for(var pt=0;pt<ct.length;pt++){var kt=[];Mn(ct[pt],kt,Y,st),G.push(kt)}}function Yn(ct){return ct/360+.5}function nr(ct){var G=Math.sin(ct*Math.PI/180),Y=.5-.25*Math.log((1+G)/(1-G))/Math.PI;return Y<0?0:Y>1?1:Y}function Rr(ct,G,Y,st,pt,kt,Bt,Lt){if(st/=G,kt>=(Y/=G)&&Bt<st)return ct;if(Bt<Y||kt>=st)return null;for(var At=[],Ut=0;Ut<ct.length;Ut++){var ae=ct[Ut],Oe=ae.geometry,me=ae.type,rn=pt===0?ae.minX:ae.minY,tn=pt===0?ae.maxX:ae.maxY;if(rn>=Y&&tn<st)At.push(ae);else if(!(tn<Y||rn>=st)){var en=[];if(me==="Point"||me==="MultiPoint")Io(Oe,en,Y,st,pt);else if(me==="LineString")Ui(Oe,en,Y,st,pt,!1,Lt.lineMetrics);else if(me==="MultiLineString")xo(Oe,en,Y,st,pt,!1);else if(me==="Polygon")xo(Oe,en,Y,st,pt,!0);else if(me==="MultiPolygon")for(var dn=0;dn<Oe.length;dn++){var an=[];xo(Oe[dn],an,Y,st,pt,!0),an.length&&en.push(an)}if(en.length){if(Lt.lineMetrics&&me==="LineString"){for(dn=0;dn<en.length;dn++)At.push(Ye(ae.id,me,en[dn],ae.tags));continue}me!=="LineString"&&me!=="MultiLineString"||(en.length===1?(me="LineString",en=en[0]):me="MultiLineString"),me!=="Point"&&me!=="MultiPoint"||(me=en.length===3?"Point":"MultiPoint"),At.push(Ye(ae.id,me,en,ae.tags))}}}return At.length?At:null}function Io(ct,G,Y,st,pt){for(var kt=0;kt<ct.length;kt+=3){var Bt=ct[kt+pt];Bt>=Y&&Bt<=st&&(G.push(ct[kt]),G.push(ct[kt+1]),G.push(ct[kt+2]))}}function Ui(ct,G,Y,st,pt,kt,Bt){for(var Lt,At,Ut=Zi(ct),ae=pt===0?di:hi,Oe=ct.start,me=0;me<ct.length-3;me+=3){var rn=ct[me],tn=ct[me+1],en=ct[me+2],dn=ct[me+3],an=ct[me+4],tr=pt===0?rn:tn,hn=pt===0?dn:an,qn=!1;Bt&&(Lt=Math.sqrt(Math.pow(rn-dn,2)+Math.pow(tn-an,2))),tr<Y?hn>Y&&(At=ae(Ut,rn,tn,dn,an,Y),Bt&&(Ut.start=Oe+Lt*At)):tr>st?hn<st&&(At=ae(Ut,rn,tn,dn,an,st),Bt&&(Ut.start=Oe+Lt*At)):ni(Ut,rn,tn,en),hn<Y&&tr>=Y&&(At=ae(Ut,rn,tn,dn,an,Y),qn=!0),hn>st&&tr<=st&&(At=ae(Ut,rn,tn,dn,an,st),qn=!0),!kt&&qn&&(Bt&&(Ut.end=Oe+Lt*At),G.push(Ut),Ut=Zi(ct)),Bt&&(Oe+=Lt)}var Fn=ct.length-3;rn=ct[Fn],tn=ct[Fn+1],en=ct[Fn+2],(tr=pt===0?rn:tn)>=Y&&tr<=st&&ni(Ut,rn,tn,en),Fn=Ut.length-3,kt&&Fn>=3&&(Ut[Fn]!==Ut[0]||Ut[Fn+1]!==Ut[1])&&ni(Ut,Ut[0],Ut[1],Ut[2]),Ut.length&&G.push(Ut)}function Zi(ct){var G=[];return G.size=ct.size,G.start=ct.start,G.end=ct.end,G}function xo(ct,G,Y,st,pt,kt){for(var Bt=0;Bt<ct.length;Bt++)Ui(ct[Bt],G,Y,st,pt,kt,!1)}function ni(ct,G,Y,st){ct.push(G),ct.push(Y),ct.push(st)}function di(ct,G,Y,st,pt,kt){var Bt=(kt-G)/(st-G);return ct.push(kt),ct.push(Y+(pt-Y)*Bt),ct.push(1),Bt}function hi(ct,G,Y,st,pt,kt){var Bt=(kt-Y)/(pt-Y);return ct.push(G+(st-G)*Bt),ct.push(kt),ct.push(1),Bt}function xa(ct,G){for(var Y=[],st=0;st<ct.length;st++){var pt,kt=ct[st],Bt=kt.type;if(Bt==="Point"||Bt==="MultiPoint"||Bt==="LineString")pt=us(kt.geometry,G);else if(Bt==="MultiLineString"||Bt==="Polygon"){pt=[];for(var Lt=0;Lt<kt.geometry.length;Lt++)pt.push(us(kt.geometry[Lt],G))}else if(Bt==="MultiPolygon")for(pt=[],Lt=0;Lt<kt.geometry.length;Lt++){for(var At=[],Ut=0;Ut<kt.geometry[Lt].length;Ut++)At.push(us(kt.geometry[Lt][Ut],G));pt.push(At)}Y.push(Ye(kt.id,Bt,pt,kt.tags))}return Y}function us(ct,G){var Y=[];Y.size=ct.size,ct.start!==void 0&&(Y.start=ct.start,Y.end=ct.end);for(var st=0;st<ct.length;st+=3)Y.push(ct[st]+G,ct[st+1],ct[st+2]);return Y}function Po(ct,G){if(ct.transformed)return ct;var Y,st,pt,kt=1<<ct.z,Bt=ct.x,Lt=ct.y;for(Y=0;Y<ct.features.length;Y++){var At=ct.features[Y],Ut=At.geometry,ae=At.type;if(At.geometry=[],ae===1)for(st=0;st<Ut.length;st+=2)At.geometry.push(ds(Ut[st],Ut[st+1],G,kt,Bt,Lt));else for(st=0;st<Ut.length;st++){var Oe=[];for(pt=0;pt<Ut[st].length;pt+=2)Oe.push(ds(Ut[st][pt],Ut[st][pt+1],G,kt,Bt,Lt));At.geometry.push(Oe)}}return ct.transformed=!0,ct}function ds(ct,G,Y,st,pt,kt){return[Math.round(Y*(ct*st-pt)),Math.round(Y*(G*st-kt))]}function mc(ct,G,Y,st,pt){for(var kt=G===pt.maxZoom?0:pt.tolerance/((1<<G)*pt.extent),Bt={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:Y,y:st,z:G,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Lt=0;Lt<ct.length;Lt++){Bt.numFeatures++,gc(Bt,ct[Lt],kt,pt);var At=ct[Lt].minX,Ut=ct[Lt].minY,ae=ct[Lt].maxX,Oe=ct[Lt].maxY;At<Bt.minX&&(Bt.minX=At),Ut<Bt.minY&&(Bt.minY=Ut),ae>Bt.maxX&&(Bt.maxX=ae),Oe>Bt.maxY&&(Bt.maxY=Oe)}return Bt}function gc(ct,G,Y,st){var pt=G.geometry,kt=G.type,Bt=[];if(kt==="Point"||kt==="MultiPoint")for(var Lt=0;Lt<pt.length;Lt+=3)Bt.push(pt[Lt]),Bt.push(pt[Lt+1]),ct.numPoints++,ct.numSimplified++;else if(kt==="LineString")wa(Bt,pt,ct,Y,!1,!1);else if(kt==="MultiLineString"||kt==="Polygon")for(Lt=0;Lt<pt.length;Lt++)wa(Bt,pt[Lt],ct,Y,kt==="Polygon",Lt===0);else if(kt==="MultiPolygon")for(var At=0;At<pt.length;At++){var Ut=pt[At];for(Lt=0;Lt<Ut.length;Lt++)wa(Bt,Ut[Lt],ct,Y,!0,Lt===0)}if(Bt.length){var ae=G.tags||null;if(kt==="LineString"&&st.lineMetrics){for(var Oe in ae={},G.tags)ae[Oe]=G.tags[Oe];ae.mapbox_clip_start=pt.start/pt.size,ae.mapbox_clip_end=pt.end/pt.size}var me={geometry:Bt,type:kt==="Polygon"||kt==="MultiPolygon"?3:kt==="LineString"||kt==="MultiLineString"?2:1,tags:ae};G.id!==null&&(me.id=G.id),ct.features.push(me)}}function wa(ct,G,Y,st,pt,kt){var Bt=st*st;if(st>0&&G.size<(pt?Bt:st))Y.numPoints+=G.length/3;else{for(var Lt=[],At=0;At<G.length;At+=3)(st===0||G[At+2]>Bt)&&(Y.numSimplified++,Lt.push(G[At]),Lt.push(G[At+1])),Y.numPoints++;pt&&function(Ut,ae){for(var Oe=0,me=0,rn=Ut.length,tn=rn-2;me<rn;tn=me,me+=2)Oe+=(Ut[me]-Ut[tn])*(Ut[me+1]+Ut[tn+1]);if(Oe>0===ae)for(me=0,rn=Ut.length;me<rn/2;me+=2){var en=Ut[me],dn=Ut[me+1];Ut[me]=Ut[rn-2-me],Ut[me+1]=Ut[rn-1-me],Ut[rn-2-me]=en,Ut[rn-1-me]=dn}}(Lt,kt),ct.push(Lt)}}function hs(ct,G){var Y=(G=this.options=function(pt,kt){for(var Bt in kt)pt[Bt]=kt[Bt];return pt}(Object.create(this.options),G)).debug;if(Y&&console.time("preprocess data"),G.maxZoom<0||G.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(G.promoteId&&G.generateId)throw new Error("promoteId and generateId cannot be used together.");var st=function(pt,kt){var Bt=[];if(pt.type==="FeatureCollection")for(var Lt=0;Lt<pt.features.length;Lt++)on(Bt,pt.features[Lt],kt,Lt);else on(Bt,pt.type==="Feature"?pt:{geometry:pt},kt);return Bt}(ct,G);this.tiles={},this.tileCoords=[],Y&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",G.indexMaxZoom,G.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),st=function(pt,kt){var Bt=kt.buffer/kt.extent,Lt=pt,At=Rr(pt,1,-1-Bt,Bt,0,-1,2,kt),Ut=Rr(pt,1,1-Bt,2+Bt,0,-1,2,kt);return(At||Ut)&&(Lt=Rr(pt,1,-Bt,1+Bt,0,-1,2,kt)||[],At&&(Lt=xa(At,1).concat(Lt)),Ut&&(Lt=Lt.concat(xa(Ut,-1)))),Lt}(st,G),st.length&&this.splitTile(st,0,0,0),Y&&(st.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Xi(ct,G,Y){return 32*((1<<ct)*Y+G)+ct}function Fa(ct,G){const Y=ct.tileID.canonical;if(!this._geoJSONIndex)return G(null,null);const st=this._geoJSONIndex.getTile(Y.z,Y.x,Y.y);if(!st)return G(null,null);const pt=new H(st.features);let kt=V(pt);kt.byteOffset===0&&kt.byteLength===kt.buffer.byteLength||(kt=new Uint8Array(kt)),G(null,{vectorTile:pt,rawData:kt.buffer})}hs.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},hs.prototype.splitTile=function(ct,G,Y,st,pt,kt,Bt){for(var Lt=[ct,G,Y,st],At=this.options,Ut=At.debug;Lt.length;){st=Lt.pop(),Y=Lt.pop(),G=Lt.pop(),ct=Lt.pop();var ae=1<<G,Oe=Xi(G,Y,st),me=this.tiles[Oe];if(!me&&(Ut>1&&console.time("creation"),me=this.tiles[Oe]=mc(ct,G,Y,st,At),this.tileCoords.push({z:G,x:Y,y:st}),Ut)){Ut>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",G,Y,st,me.numFeatures,me.numPoints,me.numSimplified),console.timeEnd("creation"));var rn="z"+G;this.stats[rn]=(this.stats[rn]||0)+1,this.total++}if(me.source=ct,pt){if(G===At.maxZoom||G===pt)continue;var tn=1<<pt-G;if(Y!==Math.floor(kt/tn)||st!==Math.floor(Bt/tn))continue}else if(G===At.indexMaxZoom||me.numPoints<=At.indexMaxPoints)continue;if(me.source=null,ct.length!==0){Ut>1&&console.time("clipping");var en,dn,an,tr,hn,qn,Fn=.5*At.buffer/At.extent,Wo=.5-Fn,Ki=.5+Fn,Kt=1+Fn;en=dn=an=tr=null,hn=Rr(ct,ae,Y-Fn,Y+Ki,0,me.minX,me.maxX,At),qn=Rr(ct,ae,Y+Wo,Y+Kt,0,me.minX,me.maxX,At),ct=null,hn&&(en=Rr(hn,ae,st-Fn,st+Ki,1,me.minY,me.maxY,At),dn=Rr(hn,ae,st+Wo,st+Kt,1,me.minY,me.maxY,At),hn=null),qn&&(an=Rr(qn,ae,st-Fn,st+Ki,1,me.minY,me.maxY,At),tr=Rr(qn,ae,st+Wo,st+Kt,1,me.minY,me.maxY,At),qn=null),Ut>1&&console.timeEnd("clipping"),Lt.push(en||[],G+1,2*Y,2*st),Lt.push(dn||[],G+1,2*Y,2*st+1),Lt.push(an||[],G+1,2*Y+1,2*st),Lt.push(tr||[],G+1,2*Y+1,2*st+1)}}},hs.prototype.getTile=function(ct,G,Y){var st=this.options,pt=st.extent,kt=st.debug;if(ct<0||ct>24)return null;var Bt=1<<ct,Lt=Xi(ct,G=(G%Bt+Bt)%Bt,Y);if(this.tiles[Lt])return Po(this.tiles[Lt],pt);kt>1&&console.log("drilling down to z%d-%d-%d",ct,G,Y);for(var At,Ut=ct,ae=G,Oe=Y;!At&&Ut>0;)Ut--,ae=Math.floor(ae/2),Oe=Math.floor(Oe/2),At=this.tiles[Xi(Ut,ae,Oe)];return At&&At.source?(kt>1&&console.log("found parent tile z%d-%d-%d",Ut,ae,Oe),kt>1&&console.time("drilling down"),this.splitTile(At.source,Ut,ae,Oe,ct,G,Y),kt>1&&console.timeEnd("drilling down"),this.tiles[Lt]?Po(this.tiles[Lt],pt):null):null};class Yi extends o.VectorTileWorkerSource{constructor(G,Y,st,pt,kt){super(G,Y,st,pt,Fa),kt&&(this.loadGeoJSON=kt)}loadData(G,Y){const st=G&&G.request,pt=st&&st.collectResourceTiming;this.loadGeoJSON(G,(kt,Bt)=>{if(kt||!Bt)return Y(kt);if(typeof Bt!="object")return Y(new Error(`Input data given to '${G.source}' is not a valid GeoJSON object.`));{P(Bt,!0);try{if(G.filter){const At=o.createExpression(G.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(At.result==="error")throw new Error(At.value.map(ae=>`${ae.key}: ${ae.message}`).join(", "));const Ut=Bt.features.filter(ae=>At.value.evaluate({zoom:0},ae));Bt={type:"FeatureCollection",features:Ut}}this._geoJSONIndex=G.cluster?new Bn(function({superclusterOptions:At,clusterProperties:Ut}){if(!Ut||!At)return At;const ae={},Oe={},me={accumulated:null,zoom:0},rn={properties:null},tn=Object.keys(Ut);for(const en of tn){const[dn,an]=Ut[en],tr=o.createExpression(an),hn=o.createExpression(typeof dn=="string"?[dn,["accumulated"],["get",en]]:dn);ae[en]=tr.value,Oe[en]=hn.value}return At.map=en=>{rn.properties=en;const dn={};for(const an of tn)dn[an]=ae[an].evaluate(me,rn);return dn},At.reduce=(en,dn)=>{rn.properties=dn;for(const an of tn)me.accumulated=en[an],en[an]=Oe[an].evaluate(me,rn)},At}(G)).load(Bt.features):function(At,Ut){return new hs(At,Ut)}(Bt,G.geojsonVtOptions)}catch(At){return Y(At)}this.loaded={};const Lt={};if(pt){const At=o.getPerformanceMeasurement(st);At&&(Lt.resourceTiming={},Lt.resourceTiming[G.source]=JSON.parse(JSON.stringify(At)))}Y(null,Lt)}})}reloadTile(G,Y){const st=this.loaded;return st&&st[G.uid]?super.reloadTile(G,Y):this.loadTile(G,Y)}loadGeoJSON(G,Y){if(G.request)o.getJSON(G.request,Y);else{if(typeof G.data!="string")return Y(new Error(`Input data given to '${G.source}' is not a valid GeoJSON object.`));try{return Y(null,JSON.parse(G.data))}catch{return Y(new Error(`Input data given to '${G.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(G,Y){try{Y(null,this._geoJSONIndex.getClusterExpansionZoom(G.clusterId))}catch(st){Y(st)}}getClusterChildren(G,Y){try{Y(null,this._geoJSONIndex.getChildren(G.clusterId))}catch(st){Y(st)}}getClusterLeaves(G,Y){try{Y(null,this._geoJSONIndex.getLeaves(G.clusterId,G.limit,G.offset))}catch(st){Y(st)}}}class Na{constructor(G){this.self=G,this.actor=new o.Actor(G,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=o.getProjection({name:"mercator"}),this.workerSourceTypes={vector:o.VectorTileWorkerSource,geojson:Yi},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(Y,st)=>{if(this.workerSourceTypes[Y])throw new Error(`Worker source with name "${Y}" already registered.`);this.workerSourceTypes[Y]=st},this.self.registerRTLTextPlugin=Y=>{if(o.plugin.isParsed())throw new Error("RTL text plugin already registered.");o.plugin.applyArabicShaping=Y.applyArabicShaping,o.plugin.processBidirectionalText=Y.processBidirectionalText,o.plugin.processStyledBidirectionalText=Y.processStyledBidirectionalText}}clearCaches(G,Y,st){delete this.layerIndexes[G],delete this.availableImages[G],delete this.workerSources[G],delete this.demWorkerSources[G],st()}checkIfReady(G,Y,st){st()}setReferrer(G,Y){this.referrer=Y}spriteLoaded(G,Y){this.isSpriteLoaded[G]=Y;for(const st in this.workerSources[G]){const pt=this.workerSources[G][st];for(const kt in pt)pt[kt]instanceof o.VectorTileWorkerSource&&(pt[kt].isSpriteLoaded=Y,pt[kt].fire(new o.Event("isSpriteLoaded")))}}setImages(G,Y,st){this.availableImages[G]=Y;for(const pt in this.workerSources[G]){const kt=this.workerSources[G][pt];for(const Bt in kt)kt[Bt].availableImages=Y}st()}enableTerrain(G,Y,st){this.terrain=Y,st()}setProjection(G,Y){this.projections[G]=o.getProjection(Y)}setLayers(G,Y,st){this.getLayerIndex(G).replace(Y),st()}updateLayers(G,Y,st){this.getLayerIndex(G).update(Y.layers,Y.removedIds),st()}loadTile(G,Y,st){const pt=this.enableTerrain?o.extend({enableTerrain:this.terrain},Y):Y;pt.projection=this.projections[G]||this.defaultProjection,this.getWorkerSource(G,Y.type,Y.source).loadTile(pt,st)}loadDEMTile(G,Y,st){const pt=this.enableTerrain?o.extend({buildQuadTree:this.terrain},Y):Y;this.getDEMWorkerSource(G,Y.source).loadTile(pt,st)}reloadTile(G,Y,st){const pt=this.enableTerrain?o.extend({enableTerrain:this.terrain},Y):Y;pt.projection=this.projections[G]||this.defaultProjection,this.getWorkerSource(G,Y.type,Y.source).reloadTile(pt,st)}abortTile(G,Y,st){this.getWorkerSource(G,Y.type,Y.source).abortTile(Y,st)}removeTile(G,Y,st){this.getWorkerSource(G,Y.type,Y.source).removeTile(Y,st)}removeSource(G,Y,st){if(!this.workerSources[G]||!this.workerSources[G][Y.type]||!this.workerSources[G][Y.type][Y.source])return;const pt=this.workerSources[G][Y.type][Y.source];delete this.workerSources[G][Y.type][Y.source],pt.removeSource!==void 0?pt.removeSource(Y,st):st()}loadWorkerSource(G,Y,st){try{this.self.importScripts(Y.url),st()}catch(pt){st(pt.toString())}}syncRTLPluginState(G,Y,st){try{o.plugin.setState(Y);const pt=o.plugin.getPluginURL();if(o.plugin.isLoaded()&&!o.plugin.isParsed()&&pt!=null){this.self.importScripts(pt);const kt=o.plugin.isParsed();st(kt?void 0:new Error(`RTL Text Plugin failed to import scripts from ${pt}`),kt)}}catch(pt){st(pt.toString())}}getAvailableImages(G){let Y=this.availableImages[G];return Y||(Y=[]),Y}getLayerIndex(G){let Y=this.layerIndexes[G];return Y||(Y=this.layerIndexes[G]=new C),Y}getWorkerSource(G,Y,st){if(this.workerSources[G]||(this.workerSources[G]={}),this.workerSources[G][Y]||(this.workerSources[G][Y]={}),!this.workerSources[G][Y][st]){const pt={send:(kt,Bt,Lt,At,Ut,ae)=>{this.actor.send(kt,Bt,Lt,G,Ut,ae)},scheduler:this.actor.scheduler};this.workerSources[G][Y][st]=new this.workerSourceTypes[Y](pt,this.getLayerIndex(G),this.getAvailableImages(G),this.isSpriteLoaded[G])}return this.workerSources[G][Y][st]}getDEMWorkerSource(G,Y){return this.demWorkerSources[G]||(this.demWorkerSources[G]={}),this.demWorkerSources[G][Y]||(this.demWorkerSources[G][Y]=new A),this.demWorkerSources[G][Y]}enforceCacheSizeLimit(G,Y){o.enforceCacheSizeLimit(Y)}getWorkerPerformanceMetrics(G,Y,st){st(void 0,void 0)}}return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope&&(self.worker=new Na(self)),Na}),d(["./shared"],function(o){function y(m,c){if(Array.isArray(m)){if(!Array.isArray(c)||m.length!==c.length)return!1;for(let h=0;h<m.length;h++)if(!y(m[h],c[h]))return!1;return!0}if(typeof m=="object"&&m!==null&&c!==null){if(typeof c!="object"||Object.keys(m).length!==Object.keys(c).length)return!1;for(const h in m)if(!y(m[h],c[h]))return!1;return!0}return m===c}var E=C;function C(m){return!function(c){return typeof window=="undefined"||typeof document=="undefined"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var _,v,w=new Blob([""],{type:"text/javascript"}),S=URL.createObjectURL(w);try{v=new Worker(S),_=!0}catch{_=!1}return v&&v.terminate(),URL.revokeObjectURL(S),_}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var _=document.createElement("canvas");_.width=_.height=1;var v=_.getContext("2d");if(!v)return!1;var w=v.getImageData(0,0,1,1);return w&&w.width===_.width}()?(A[h=c&&c.failIfMajorPerformanceCaveat]===void 0&&(A[h]=function(_){var v,w=function(S){var I=document.createElement("canvas"),z=Object.create(C.webGLContextAttributes);return z.failIfMajorPerformanceCaveat=S,I.getContext("webgl",z)||I.getContext("experimental-webgl",z)}(_);if(!w)return!1;try{v=w.createShader(w.VERTEX_SHADER)}catch{return!1}return!(!v||w.isContextLost())&&(w.shaderSource(v,"void main() {}"),w.compileShader(v),w.getShaderParameter(v,w.COMPILE_STATUS)===!0)}(h)),A[h]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var h}(m)}var A={};function P(m,c,h){const _=o.window.document.createElement(m);return c!==void 0&&(_.className=c),h&&h.appendChild(_),_}function B(m,c,h){const _=o.window.document.createElementNS("http://www.w3.org/2000/svg",m);for(const v of Object.keys(c))_.setAttributeNS(null,v,c[v]);return h&&h.appendChild(_),_}C.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const j=o.window.document&&o.window.document.documentElement.style,Z=j&&j.userSelect!==void 0?"userSelect":"WebkitUserSelect";let W;function H(){j&&Z&&(W=j[Z],j[Z]="none")}function V(){j&&Z&&(j[Z]=W)}function tt(m){m.preventDefault(),m.stopPropagation(),o.window.removeEventListener("click",tt,!0)}function ft(){o.window.addEventListener("click",tt,!0),o.window.setTimeout(()=>{o.window.removeEventListener("click",tt,!0)},0)}function et(m,c){const h=m.getBoundingClientRect();return zt(m,h,c)}function Pt(m,c){const h=m.getBoundingClientRect(),_=[];for(let v=0;v<c.length;v++)_.push(zt(m,h,c[v]));return _}function Rt(m){return o.window.InstallTrigger!==void 0&&m.button===2&&m.ctrlKey&&o.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:m.button}function zt(m,c,h){const _=m.offsetWidth===c.width?1:m.offsetWidth/c.width;return new o.pointGeometry((h.clientX-c.left)*_,(h.clientY-c.top)*_)}function jt(m,c){var h=c[0],_=c[1],v=c[2],w=c[3],S=h*w-v*_;return S?(m[0]=w*(S=1/S),m[1]=-_*S,m[2]=-v*S,m[3]=h*S,m):null}function oe(m){const{userImage:c}=m;return!!(c&&c.render&&c.render())&&(m.data.replace(new Uint8Array(c.data.buffer)),!0)}class ge extends o.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new o.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(c){if(this.loaded!==c&&(this.loaded=c,c)){for(const{ids:h,callback:_}of this.requestors)this._notify(h,_);this.requestors=[]}}hasImage(c){return!!this.getImage(c)}getImage(c){return this.images[c]}addImage(c,h){this._validate(c,h)&&(this.images[c]=h)}_validate(c,h){let _=!0;return this._validateStretch(h.stretchX,h.data&&h.data.width)||(this.fire(new o.ErrorEvent(new Error(`Image "${c}" has invalid "stretchX" value`))),_=!1),this._validateStretch(h.stretchY,h.data&&h.data.height)||(this.fire(new o.ErrorEvent(new Error(`Image "${c}" has invalid "stretchY" value`))),_=!1),this._validateContent(h.content,h)||(this.fire(new o.ErrorEvent(new Error(`Image "${c}" has invalid "content" value`))),_=!1),_}_validateStretch(c,h){if(!c)return!0;let _=0;for(const v of c){if(v[0]<_||v[1]<v[0]||h<v[1])return!1;_=v[1]}return!0}_validateContent(c,h){return!(c&&(c.length!==4||c[0]<0||h.data.width<c[0]||c[1]<0||h.data.height<c[1]||c[2]<0||h.data.width<c[2]||c[3]<0||h.data.height<c[3]||c[2]<c[0]||c[3]<c[1]))}updateImage(c,h){h.version=this.images[c].version+1,this.images[c]=h,this.updatedImages[c]=!0}removeImage(c){const h=this.images[c];delete this.images[c],delete this.patterns[c],h.userImage&&h.userImage.onRemove&&h.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(c,h){let _=!0;if(!this.isLoaded())for(const v of c)this.images[v]||(_=!1);this.isLoaded()||_?this._notify(c,h):this.requestors.push({ids:c,callback:h})}_notify(c,h){const _={};for(const v of c){this.images[v]||this.fire(new o.Event("styleimagemissing",{id:v}));const w=this.images[v];w?_[v]={data:w.data.clone(),pixelRatio:w.pixelRatio,sdf:w.sdf,version:w.version,stretchX:w.stretchX,stretchY:w.stretchY,content:w.content,hasRenderCallback:Boolean(w.userImage&&w.userImage.render)}:o.warnOnce(`Image "${v}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}h(null,_)}getPixelSize(){const{width:c,height:h}=this.atlasImage;return{width:c,height:h}}getPattern(c){const h=this.patterns[c],_=this.getImage(c);if(!_)return null;if(h&&h.position.version===_.version)return h.position;if(h)h.position.version=_.version;else{const v={w:_.data.width+2,h:_.data.height+2,x:0,y:0},w=new o.ImagePosition(v,_);this.patterns[c]={bin:v,position:w}}return this._updatePatternAtlas(),this.patterns[c].position}bind(c){const h=c.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new o.Texture(c,this.atlasImage,h.RGBA),this.atlasTexture.bind(h.LINEAR,h.CLAMP_TO_EDGE)}_updatePatternAtlas(){const c=[];for(const w in this.patterns)c.push(this.patterns[w].bin);const{w:h,h:_}=o.potpack(c),v=this.atlasImage;v.resize({width:h||1,height:_||1});for(const w in this.patterns){const{bin:S}=this.patterns[w],I=S.x+1,z=S.y+1,F=this.images[w].data,N=F.width,q=F.height;o.RGBAImage.copy(F,v,{x:0,y:0},{x:I,y:z},{width:N,height:q}),o.RGBAImage.copy(F,v,{x:0,y:q-1},{x:I,y:z-1},{width:N,height:1}),o.RGBAImage.copy(F,v,{x:0,y:0},{x:I,y:z+q},{width:N,height:1}),o.RGBAImage.copy(F,v,{x:N-1,y:0},{x:I-1,y:z},{width:1,height:q}),o.RGBAImage.copy(F,v,{x:0,y:0},{x:I+N,y:z},{width:1,height:q})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(c){for(const h of c){if(this.callbackDispatchedThisFrame[h])continue;this.callbackDispatchedThisFrame[h]=!0;const _=this.images[h];oe(_)&&this.updateImage(h,_)}}}const ce=new o.Properties({anchor:new o.DataConstantProperty(o.spec.light.anchor),position:new class{constructor(){this.specification=o.spec.light.position}possiblyEvaluate(m,c){return function([h,_,v]){const w=o.degToRad(_+90),S=o.degToRad(v);return{x:h*Math.cos(w)*Math.sin(S),y:h*Math.sin(w)*Math.sin(S),z:h*Math.cos(S),azimuthal:_,polar:v}}(m.expression.evaluate(c))}interpolate(m,c,h){return{x:o.number(m.x,c.x,h),y:o.number(m.y,c.y,h),z:o.number(m.z,c.z,h),azimuthal:o.number(m.azimuthal,c.azimuthal,h),polar:o.number(m.polar,c.polar,h)}}},color:new o.DataConstantProperty(o.spec.light.color),intensity:new o.DataConstantProperty(o.spec.light.intensity)}),Ue="-transition";class Ae extends o.Evented{constructor(c){super(),this._transitionable=new o.Transitionable(ce),this.setLight(c),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(c,h={}){if(!this._validate(o.validateLight,c,h))for(const _ in c){const v=c[_];o.endsWith(_,Ue)?this._transitionable.setTransition(_.slice(0,-Ue.length),v):this._transitionable.setValue(_,v)}}updateTransitions(c){this._transitioning=this._transitionable.transitioned(c,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(c){this.properties=this._transitioning.possiblyEvaluate(c)}_validate(c,h,_){return(!_||_.validate!==!1)&&o.emitValidationErrors(this,c.call(o.validateStyle,o.extend({value:h,style:{glyphs:!0,sprite:!0},styleSpec:o.spec})))}}const se=new o.Properties({source:new o.DataConstantProperty(o.spec.terrain.source),exaggeration:new o.DataConstantProperty(o.spec.terrain.exaggeration)}),Ze="-transition";class gn extends o.Evented{constructor(c,h){super(),this._transitionable=new o.Transitionable(se),this.set(c),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=h}get(){return this._transitionable.serialize()}set(c){for(const h in c){const _=c[h];o.endsWith(h,Ze)?this._transitionable.setTransition(h.slice(0,-Ze.length),_):this._transitionable.setValue(h,_)}}updateTransitions(c){this._transitioning=this._transitionable.transitioned(c,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(c){this.properties=this._transitioning.possiblyEvaluate(c)}}function _n(m,c,h,_){const v=o.smoothstep(45,65,h),[w,S]=Gn(m,_),I=o.length(c);let z=1-Math.min(1,Math.exp((I-w)/(S-w)*-6));return z*=z*z,z=Math.min(1,1.00747*z),z*v*m.alpha}function Gn(m,c){const h=.5/Math.tan(.5*c);return[m.range[0]+h,m.range[1]+h]}const Jn=new o.Properties({range:new o.DataConstantProperty(o.spec.fog.range),color:new o.DataConstantProperty(o.spec.fog.color),"high-color":new o.DataConstantProperty(o.spec.fog["high-color"]),"space-color":new o.DataConstantProperty(o.spec.fog["space-color"]),"horizon-blend":new o.DataConstantProperty(o.spec.fog["horizon-blend"]),"star-intensity":new o.DataConstantProperty(o.spec.fog["star-intensity"])}),Wn="-transition";class ur extends o.Evented{constructor(c,h){super(),this._transitionable=new o.Transitionable(Jn),this.set(c),this._transitioning=this._transitionable.untransitioned(),this._transform=h}get state(){const c=this._transform,h=c.projection.name==="globe",_=o.globeToMercatorTransition(c.zoom),v=this.properties.get("range"),w=[.5,3];return{range:h?[o.number(w[0],v[0],_),o.number(w[1],v[1],_)]:v,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(c,h={}){if(!this._validate(o.validateFog,c,h)){for(const _ of Object.keys(o.spec.fog))c&&c[_]===void 0&&(c[_]=o.spec.fog[_].default);for(const _ in c){const v=c[_];o.endsWith(_,Wn)?this._transitionable.setTransition(_.slice(0,-Wn.length),v):this._transitionable.setValue(_,v)}}}getOpacity(c){if(!this._transform.projection.supportsFog)return 0;const h=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:o.smoothstep(45,65,c))*h.a}getOpacityAtLatLng(c,h){return this._transform.projection.supportsFog?function(_,v,w){const S=o.MercatorCoordinate.fromLngLat(v),I=w.elevation?w.elevation.getAtPointOrZero(S):0,z=[S.x,S.y,I];return o.transformMat4(z,z,w.mercatorFogMatrix),_n(_,z,w.pitch,w._fov)}(this.state,c,h):0}getFovAdjustedRange(c){return this._transform.projection.supportsFog?Gn(this.state,c):[0,1]}updateTransitions(c){this._transitioning=this._transitionable.transitioned(c,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(c){this.properties=this._transitioning.possiblyEvaluate(c)}_validate(c,h,_){return(!_||_.validate!==!1)&&o.emitValidationErrors(this,c.call(o.validateStyle,o.extend({value:h,style:{glyphs:!0,sprite:!0},styleSpec:o.spec})))}}class Zn{constructor(c,h){this.workerPool=c,this.actors=[],this.currentActor=0,this.id=o.uniqueId();const _=this.workerPool.acquire(this.id);for(let v=0;v<_.length;v++){const w=new Zn.Actor(_[v],h,this.id);w.name=`Worker ${v}`,this.actors.push(w)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(c,h,_){o.asyncAll(this.actors,(v,w)=>{v.send(c,h,w)},_=_||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(c=>{c.remove()}),this.actors=[],this.workerPool.release(this.id)}}function _r(m,c,h){return c*(o.EXTENT/(m.tileSize*Math.pow(2,h-m.tileID.overscaledZ)))}Zn.Actor=o.Actor;class he{constructor(c,h,_,v){this.screenBounds=c,this.cameraPoint=h,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=_,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,v)}static createFromScreenPoints(c,h){let _,v;if(c instanceof o.pointGeometry||typeof c[0]=="number"){const w=o.pointGeometry.convert(c);_=[w],v=h.isPointAboveHorizon(w)}else{const w=o.pointGeometry.convert(c[0]),S=o.pointGeometry.convert(c[1]);_=[w,S],v=o.polygonizeBounds(w,S).every(I=>h.isPointAboveHorizon(I))}return new he(_,h.getCameraPoint(),v,h)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(c){return o.polygonizeBounds(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],c)}bufferedCameraGeometry(c){const h=this.screenBounds[0],_=this.screenBounds.length===1?this.screenBounds[0].add(new o.pointGeometry(1,1)):this.screenBounds[1],v=o.polygonizeBounds(h,_,0,!1);return this.cameraPoint.y>_.y&&(this.cameraPoint.x>h.x&&this.cameraPoint.x<_.x?v.splice(3,0,this.cameraPoint):this.cameraPoint.x>=_.x?v[2]=this.cameraPoint:this.cameraPoint.x<=h.x&&(v[3]=this.cameraPoint)),o.bufferConvexPolygon(v,c)}bufferedCameraGeometryGlobe(c){const h=this.screenBounds[0],_=this.screenBounds.length===1?this.screenBounds[0].add(new o.pointGeometry(1,1)):this.screenBounds[1],v=o.polygonizeBounds(h,_,c),w=this.cameraPoint.clone();switch(3*((w.y>h.y)+(w.y>_.y))+((w.x>h.x)+(w.x>_.x))){case 0:v[0]=w,v[4]=w.clone();break;case 1:v.splice(1,0,w);break;case 2:v[1]=w;break;case 3:v.splice(4,0,w);break;case 5:v.splice(2,0,w);break;case 6:v[3]=w;break;case 7:v.splice(3,0,w);break;case 8:v[2]=w}return v}containsTile(c,h,_,v=0){const w=c.queryPadding/h._pixelsPerMercatorPixel+1,S=_?this._bufferedCameraMercator(w,h):this._bufferedScreenMercator(w,h);let I=c.tileID.wrap+(S.unwrapped?v:0);const z=S.polygon.map(at=>o.getTilePoint(c.tileTransform,at,I));if(!o.polygonIntersectsBox(z,0,0,o.EXTENT,o.EXTENT))return;I=c.tileID.wrap+(this.screenGeometryMercator.unwrapped?v:0);const F=this.screenGeometryMercator.polygon.map(at=>o.getTileVec3(c.tileTransform,at,I)),N=F.map(at=>new o.pointGeometry(at[0],at[1])),q=h.getFreeCameraOptions().position||new o.MercatorCoordinate(0,0,0),Q=o.getTileVec3(c.tileTransform,q,I),it=F.map(at=>{const K=o.sub(at,at,Q);return o.normalize(K,K),new o.Ray(Q,K)}),rt=_r(c,1,h.zoom)*h._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:N,tilespaceRays:it,bufferedTilespaceGeometry:z,bufferedTilespaceBounds:(ot=o.getBounds(z),ot.min.x=o.clamp(ot.min.x,0,o.EXTENT),ot.min.y=o.clamp(ot.min.y,0,o.EXTENT),ot.max.x=o.clamp(ot.max.x,0,o.EXTENT),ot.max.y=o.clamp(ot.max.y,0,o.EXTENT),ot),tile:c,tileID:c.tileID,pixelToTileUnitsFactor:rt};var ot}_bufferedScreenMercator(c,h){const _=Te(c);if(this._screenRaycastCache[_])return this._screenRaycastCache[_];{let v;return v=h.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(c),h):{polygon:this.bufferedScreenGeometry(c).map(w=>h.pointCoordinate3D(w)),unwrapped:!0},this._screenRaycastCache[_]=v,v}}_bufferedCameraMercator(c,h){const _=Te(c);if(this._cameraRaycastCache[_])return this._cameraRaycastCache[_];{let v;return v=h.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(c),h):{polygon:this.bufferedCameraGeometry(c).map(w=>h.pointCoordinate3D(w)),unwrapped:!0},this._cameraRaycastCache[_]=v,v}}_projectAndResample(c,h){const _=function(w,S){const I=o.multiply([],S.pixelMatrix,S.globeMatrix),z=[0,-o.GLOBE_RADIUS,0,1],F=[0,o.GLOBE_RADIUS,0,1],N=[0,0,0,1];o.transformMat4$1(z,z,I),o.transformMat4$1(F,F,I),o.transformMat4$1(N,N,I);const q=new o.pointGeometry(z[0]/z[3],z[1]/z[3]),Q=new o.pointGeometry(F[0]/F[3],F[1]/F[3]),it=o.polygonContainsPoint(w,q)&&z[3]<N[3],rt=o.polygonContainsPoint(w,Q)&&F[3]<N[3];if(!it&&!rt)return null;const ot=function(Mt,Ft,Vt){for(let Ht=1;Ht<Mt.length;Ht++){const ke=Ce(Ft.pointCoordinate3D(Mt[Ht-1]).x),Nt=Ce(Ft.pointCoordinate3D(Mt[Ht]).x);if(Vt<0){if(ke<Nt)return{idx:Ht,t:-ke/(Nt-1-ke)}}else if(Nt<ke)return{idx:Ht,t:(1-ke)/(Nt+1-ke)}}return null}(w,S,it?-1:1);if(!ot)return null;const{idx:at,t:K}=ot;let ht=at>1?He(w.slice(0,at),S):[],ut=at<w.length?He(w.slice(at),S):[];ht=ht.map(Mt=>new o.pointGeometry(Ce(Mt.x),Mt.y)),ut=ut.map(Mt=>new o.pointGeometry(Ce(Mt.x),Mt.y));const mt=[...ht];mt.length===0&&mt.push(ut[ut.length-1]);const Tt=o.number(mt[mt.length-1].y,(ut.length===0?ht[0]:ut[0]).y,K);let wt;return wt=it?[new o.pointGeometry(0,Tt),new o.pointGeometry(0,0),new o.pointGeometry(1,0),new o.pointGeometry(1,Tt)]:[new o.pointGeometry(1,Tt),new o.pointGeometry(1,1),new o.pointGeometry(0,1),new o.pointGeometry(0,Tt)],mt.push(...wt),ut.length===0?mt.push(ht[0]):mt.push(...ut),{polygon:mt.map(Mt=>new o.MercatorCoordinate(Mt.x,Mt.y)),unwrapped:!1}}(c,h);if(_)return _;const v=function(w,S){let I=!1,z=-1/0,F=0;for(let q=0;q<w.length-1;q++)w[q].x>z&&(z=w[q].x,F=q);for(let q=0;q<w.length-1;q++){const Q=(F+q)%(w.length-1),it=w[Q],rt=w[Q+1];Math.abs(it.x-rt.x)>.5&&(it.x<rt.x?(it.x+=1,Q===0&&(w[w.length-1].x+=1)):(rt.x+=1,Q+1===w.length-1&&(w[0].x+=1)),I=!0)}const N=o.mercatorXfromLng(S.center.lng);return I&&N<Math.abs(N-1)&&w.forEach(q=>{q.x-=1}),{polygon:w,unwrapped:I}}(He(c,h).map(w=>new o.pointGeometry(Ce(w.x),w.y)),h);return{polygon:v.polygon.map(w=>new o.MercatorCoordinate(w.x,w.y)),unwrapped:v.unwrapped}}}function He(m,c){return o.resample(m,h=>{const _=c.pointCoordinate3D(h);h.x=_.x,h.y=_.y},1/256)}function Ce(m){return m<0?1+m%1:m%1}function Te(m){return 100*m|0}function Qn(m,c,h,_,v){const w=function(S,I){if(S)return v(S);if(I){m.url&&I.tiles&&m.tiles&&delete m.tiles;const z=o.pick(o.extend(I,m),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);I.vector_layers&&(z.vectorLayers=I.vector_layers,z.vectorLayerIds=z.vectorLayers.map(F=>F.id)),z.tiles=c.canonicalizeTileset(z,m.url),v(null,z)}};return m.url?o.getJSON(c.transformRequest(c.normalizeSourceURL(m.url,null,h,_),o.ResourceType.Source),w):o.exported.frame(()=>w(null,m))}class Bn{constructor(c,h,_){this.bounds=o.LngLatBounds.convert(this.validateBounds(c)),this.minzoom=h||0,this.maxzoom=_||24}validateBounds(c){return Array.isArray(c)&&c.length===4?[Math.max(-180,c[0]),Math.max(-90,c[1]),Math.min(180,c[2]),Math.min(90,c[3])]:[-180,-90,180,90]}contains(c){const h=Math.pow(2,c.z),_=Math.floor(o.mercatorXfromLng(this.bounds.getWest())*h),v=Math.floor(o.mercatorYfromLat(this.bounds.getNorth())*h),w=Math.ceil(o.mercatorXfromLng(this.bounds.getEast())*h),S=Math.ceil(o.mercatorYfromLat(this.bounds.getSouth())*h);return c.x>=_&&c.x<w&&c.y>=v&&c.y<S}}class Ln{constructor(c,h,_){this.context=c;const v=c.gl;this.buffer=v.createBuffer(),this.dynamicDraw=Boolean(_),this.context.unbindVAO(),c.bindElementBuffer.set(this.buffer),v.bufferData(v.ELEMENT_ARRAY_BUFFER,h.arrayBuffer,this.dynamicDraw?v.DYNAMIC_DRAW:v.STATIC_DRAW),this.dynamicDraw||h.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(c){const h=this.context.gl;this.context.unbindVAO(),this.bind(),h.bufferSubData(h.ELEMENT_ARRAY_BUFFER,0,c.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Qe={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class bt{constructor(c,h,_,v){this.length=h.length,this.attributes=_,this.itemSize=h.bytesPerElement,this.dynamicDraw=v,this.context=c;const w=c.gl;this.buffer=w.createBuffer(),c.bindVertexBuffer.set(this.buffer),w.bufferData(w.ARRAY_BUFFER,h.arrayBuffer,this.dynamicDraw?w.DYNAMIC_DRAW:w.STATIC_DRAW),this.dynamicDraw||h.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(c){const h=this.context.gl;this.bind(),h.bufferSubData(h.ARRAY_BUFFER,0,c.arrayBuffer)}enableAttributes(c,h){for(let _=0;_<this.attributes.length;_++){const v=h.attributes[this.attributes[_].name];v!==void 0&&c.enableVertexAttribArray(v)}}setVertexAttribPointers(c,h,_){for(let v=0;v<this.attributes.length;v++){const w=this.attributes[v],S=h.attributes[w.name];S!==void 0&&c.vertexAttribPointer(S,w.components,c[Qe[w.type]],!1,this.itemSize,w.offset+this.itemSize*(_||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class vt{constructor(c){this.gl=c.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(c){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Jt extends vt{getDefault(){return o.Color.transparent}set(c){const h=this.current;(c.r!==h.r||c.g!==h.g||c.b!==h.b||c.a!==h.a||this.dirty)&&(this.gl.clearColor(c.r,c.g,c.b,c.a),this.current=c,this.dirty=!1)}}class fe extends vt{getDefault(){return 1}set(c){(c!==this.current||this.dirty)&&(this.gl.clearDepth(c),this.current=c,this.dirty=!1)}}class be extends vt{getDefault(){return 0}set(c){(c!==this.current||this.dirty)&&(this.gl.clearStencil(c),this.current=c,this.dirty=!1)}}class Ie extends vt{getDefault(){return[!0,!0,!0,!0]}set(c){const h=this.current;(c[0]!==h[0]||c[1]!==h[1]||c[2]!==h[2]||c[3]!==h[3]||this.dirty)&&(this.gl.colorMask(c[0],c[1],c[2],c[3]),this.current=c,this.dirty=!1)}}class Ge extends vt{getDefault(){return!0}set(c){(c!==this.current||this.dirty)&&(this.gl.depthMask(c),this.current=c,this.dirty=!1)}}class Me extends vt{getDefault(){return 255}set(c){(c!==this.current||this.dirty)&&(this.gl.stencilMask(c),this.current=c,this.dirty=!1)}}class ze extends vt{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(c){const h=this.current;(c.func!==h.func||c.ref!==h.ref||c.mask!==h.mask||this.dirty)&&(this.gl.stencilFunc(c.func,c.ref,c.mask),this.current=c,this.dirty=!1)}}class ve extends vt{getDefault(){const c=this.gl;return[c.KEEP,c.KEEP,c.KEEP]}set(c){const h=this.current;(c[0]!==h[0]||c[1]!==h[1]||c[2]!==h[2]||this.dirty)&&(this.gl.stencilOp(c[0],c[1],c[2]),this.current=c,this.dirty=!1)}}class Ye extends vt{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const h=this.gl;c?h.enable(h.STENCIL_TEST):h.disable(h.STENCIL_TEST),this.current=c,this.dirty=!1}}class Ke extends vt{getDefault(){return[0,1]}set(c){const h=this.current;(c[0]!==h[0]||c[1]!==h[1]||this.dirty)&&(this.gl.depthRange(c[0],c[1]),this.current=c,this.dirty=!1)}}class on extends vt{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const h=this.gl;c?h.enable(h.DEPTH_TEST):h.disable(h.DEPTH_TEST),this.current=c,this.dirty=!1}}class vn extends vt{getDefault(){return this.gl.LESS}set(c){(c!==this.current||this.dirty)&&(this.gl.depthFunc(c),this.current=c,this.dirty=!1)}}class Mn extends vt{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const h=this.gl;c?h.enable(h.BLEND):h.disable(h.BLEND),this.current=c,this.dirty=!1}}class Xn extends vt{getDefault(){const c=this.gl;return[c.ONE,c.ZERO]}set(c){const h=this.current;(c[0]!==h[0]||c[1]!==h[1]||this.dirty)&&(this.gl.blendFunc(c[0],c[1]),this.current=c,this.dirty=!1)}}class Yn extends vt{getDefault(){return o.Color.transparent}set(c){const h=this.current;(c.r!==h.r||c.g!==h.g||c.b!==h.b||c.a!==h.a||this.dirty)&&(this.gl.blendColor(c.r,c.g,c.b,c.a),this.current=c,this.dirty=!1)}}class nr extends vt{getDefault(){return this.gl.FUNC_ADD}set(c){(c!==this.current||this.dirty)&&(this.gl.blendEquation(c),this.current=c,this.dirty=!1)}}class Rr extends vt{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const h=this.gl;c?h.enable(h.CULL_FACE):h.disable(h.CULL_FACE),this.current=c,this.dirty=!1}}class Io extends vt{getDefault(){return this.gl.BACK}set(c){(c!==this.current||this.dirty)&&(this.gl.cullFace(c),this.current=c,this.dirty=!1)}}class Ui extends vt{getDefault(){return this.gl.CCW}set(c){(c!==this.current||this.dirty)&&(this.gl.frontFace(c),this.current=c,this.dirty=!1)}}class Zi extends vt{getDefault(){return null}set(c){(c!==this.current||this.dirty)&&(this.gl.useProgram(c),this.current=c,this.dirty=!1)}}class xo extends vt{getDefault(){return this.gl.TEXTURE0}set(c){(c!==this.current||this.dirty)&&(this.gl.activeTexture(c),this.current=c,this.dirty=!1)}}class ni extends vt{getDefault(){const c=this.gl;return[0,0,c.drawingBufferWidth,c.drawingBufferHeight]}set(c){const h=this.current;(c[0]!==h[0]||c[1]!==h[1]||c[2]!==h[2]||c[3]!==h[3]||this.dirty)&&(this.gl.viewport(c[0],c[1],c[2],c[3]),this.current=c,this.dirty=!1)}}class di extends vt{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const h=this.gl;h.bindFramebuffer(h.FRAMEBUFFER,c),this.current=c,this.dirty=!1}}class hi extends vt{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const h=this.gl;h.bindRenderbuffer(h.RENDERBUFFER,c),this.current=c,this.dirty=!1}}class xa extends vt{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const h=this.gl;h.bindTexture(h.TEXTURE_2D,c),this.current=c,this.dirty=!1}}class us extends vt{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;const h=this.gl;h.bindBuffer(h.ARRAY_BUFFER,c),this.current=c,this.dirty=!1}}class Po extends vt{getDefault(){return null}set(c){const h=this.gl;h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,c),this.current=c,this.dirty=!1}}class ds extends vt{constructor(c){super(c),this.vao=c.extVertexArrayObject}getDefault(){return null}set(c){this.vao&&(c!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(c),this.current=c,this.dirty=!1)}}class mc extends vt{getDefault(){return 4}set(c){if(c===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_ALIGNMENT,c),this.current=c,this.dirty=!1}}class gc extends vt{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_PREMULTIPLY_ALPHA_WEBGL,c),this.current=c,this.dirty=!1}}class wa extends vt{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_FLIP_Y_WEBGL,c),this.current=c,this.dirty=!1}}class hs extends vt{constructor(c,h){super(c),this.context=c,this.parent=h}getDefault(){return null}}class Xi extends hs{setDirty(){this.dirty=!0}set(c){if(c===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,c,0),this.current=c,this.dirty=!1}}class Fa extends hs{attachment(){return this.gl.DEPTH_ATTACHMENT}set(c){if(c===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferRenderbuffer(h.FRAMEBUFFER,this.attachment(),h.RENDERBUFFER,c),this.current=c,this.dirty=!1}}class Yi extends Fa{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class Na{constructor(c,h,_,v){this.context=c,this.width=h,this.height=_;const w=this.framebuffer=c.gl.createFramebuffer();this.colorAttachment=new Xi(c,w),v&&(this.depthAttachment=new Fa(c,w))}destroy(){const c=this.context.gl,h=this.colorAttachment.get();if(h&&c.deleteTexture(h),this.depthAttachment){const _=this.depthAttachment.get();_&&c.deleteRenderbuffer(_)}c.deleteFramebuffer(this.framebuffer)}}class ct{constructor(c,h=!1){if(this.gl=c,this.isWebGL2=h,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),h){const _=c;this.extVertexArrayObject={createVertexArrayOES:_.createVertexArray.bind(c),deleteVertexArrayOES:_.deleteVertexArray.bind(c),bindVertexArrayOES:_.bindVertexArray.bind(c)}}this.clearColor=new Jt(this),this.clearDepth=new fe(this),this.clearStencil=new be(this),this.colorMask=new Ie(this),this.depthMask=new Ge(this),this.stencilMask=new Me(this),this.stencilFunc=new ze(this),this.stencilOp=new ve(this),this.stencilTest=new Ye(this),this.depthRange=new Ke(this),this.depthTest=new on(this),this.depthFunc=new vn(this),this.blend=new Mn(this),this.blendFunc=new Xn(this),this.blendColor=new Yn(this),this.blendEquation=new nr(this),this.cullFace=new Rr(this),this.cullFaceSide=new Io(this),this.frontFace=new Ui(this),this.program=new Zi(this),this.activeTexture=new xo(this),this.viewport=new ni(this),this.bindFramebuffer=new di(this),this.bindRenderbuffer=new hi(this),this.bindTexture=new xa(this),this.bindVertexBuffer=new us(this),this.bindElementBuffer=new Po(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new ds(this),this.pixelStoreUnpack=new mc(this),this.pixelStoreUnpackPremultiplyAlpha=new gc(this),this.pixelStoreUnpackFlipY=new wa(this),this.extTextureFilterAnisotropic=c.getExtension("EXT_texture_filter_anisotropic")||c.getExtension("MOZ_EXT_texture_filter_anisotropic")||c.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=c.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=c.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=c.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=c.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),h||(this.extTextureHalfFloat=c.getExtension("OES_texture_half_float")),(h||this.extTextureHalfFloat&&c.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=c.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=h||c.getExtension("OES_standard_derivatives"),this.extTimerQuery=c.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=c.getParameter(c.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(c,h){return new Ln(this,c,h)}createVertexBuffer(c,h,_){return new bt(this,c,h,_)}createRenderbuffer(c,h,_){const v=this.gl,w=v.createRenderbuffer();return this.bindRenderbuffer.set(w),v.renderbufferStorage(v.RENDERBUFFER,c,h,_),this.bindRenderbuffer.set(null),w}createFramebuffer(c,h,_){return new Na(this,c,h,_)}clear({color:c,depth:h,stencil:_}){const v=this.gl;let w=0;c&&(w|=v.COLOR_BUFFER_BIT,this.clearColor.set(c),this.colorMask.set([!0,!0,!0,!0])),h!==void 0&&(w|=v.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(h),this.depthMask.set(!0)),_!==void 0&&(w|=v.STENCIL_BUFFER_BIT,this.clearStencil.set(_),this.stencilMask.set(255)),v.clear(w)}setCullFace(c){c.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(c.mode),this.frontFace.set(c.frontFace))}setDepthMode(c){c.func!==this.gl.ALWAYS||c.mask?(this.depthTest.set(!0),this.depthFunc.set(c.func),this.depthMask.set(c.mask),this.depthRange.set(c.range)):this.depthTest.set(!1)}setStencilMode(c){c.test.func!==this.gl.ALWAYS||c.mask?(this.stencilTest.set(!0),this.stencilMask.set(c.mask),this.stencilOp.set([c.fail,c.depthFail,c.pass]),this.stencilFunc.set({func:c.test.func,ref:c.ref,mask:c.test.mask})):this.stencilTest.set(!1)}setColorMode(c){y(c.blendFunction,o.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(c.blendFunction),this.blendColor.set(c.blendColor)),this.colorMask.set(c.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class G extends o.Evented{constructor(c,h,_,v){if(super(),this.id=c,this.dispatcher=_,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.extend(this,o.pick(h,["url","scheme","tileSize","promoteId"])),this._options=o.extend({type:"vector"},h),this._collectResourceTiming=h.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(v),this._tileWorkers={},this._deduped=new o.DedupedRequest}load(c){this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"}));const h=Array.isArray(this.map._language)?this.map._language.join():this.map._language,_=this.map._worldview;this._tileJSONRequest=Qn(this._options,this.map._requestManager,h,_,(v,w)=>{this._tileJSONRequest=null,this._loaded=!0,v?(h&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${h}`),_&&_.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${_}`),this.fire(new o.ErrorEvent(v))):w&&(o.extend(this,w),w.bounds&&(this.tileBounds=new Bn(w.bounds,this.minzoom,this.maxzoom)),o.postTurnstileEvent(w.tiles,this.map._requestManager._customAccessToken),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"}))),c&&c(v)})}loaded(){return this._loaded}hasTile(c){return!this.tileBounds||this.tileBounds.contains(c.canonical)}onAdd(c){this.map=c,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(c){return this._options.tiles=c,this.reload(),this}setUrl(c){return this.url=c,this._options.url=c,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return o.extend({},this._options)}loadTile(c,h){const _=this.map._requestManager.normalizeTileURL(c.tileID.canonical.url(this.tiles,this.scheme)),v={request:this.map._requestManager.transformRequest(_,o.ResourceType.Tile),data:void 0,uid:c.uid,tileID:c.tileID,tileZoom:c.tileZoom,zoom:c.tileID.overscaledZ,tileSize:this.tileSize*c.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:o.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:c.isSymbolTile};if(v.request.collectResourceTiming=this._collectResourceTiming,c.actor&&c.state!=="expired")c.state==="loading"?c.reloadCallback=h:c.request=c.actor.send("reloadTile",v,w.bind(this));else if(c.actor=this._tileWorkers[_]=this._tileWorkers[_]||this.dispatcher.getActor(),this.dispatcher.ready)c.request=c.actor.send("loadTile",v,w.bind(this),void 0,!0);else{const S=o.loadVectorTile.call({deduped:this._deduped},v,(I,z)=>{I||!z?w.call(this,I):(v.data={cacheControl:z.cacheControl,expires:z.expires,rawData:z.rawData.slice(0)},c.actor&&c.actor.send("loadTile",v,w.bind(this),void 0,!0))},!0);c.request={cancel:S}}function w(S,I){return delete c.request,c.aborted?h(null):S&&S.status!==404?h(S):(I&&I.resourceTiming&&(c.resourceTiming=I.resourceTiming),this.map._refreshExpiredTiles&&I&&c.setExpiryData(I),c.loadVectorData(I,this.map.painter),o.cacheEntryPossiblyAdded(this.dispatcher),h(null),void(c.reloadCallback&&(this.loadTile(c,c.reloadCallback),c.reloadCallback=null)))}}abortTile(c){c.request&&(c.request.cancel(),delete c.request),c.actor&&c.actor.send("abortTile",{uid:c.uid,type:this.type,source:this.id})}unloadTile(c){c.unloadVectorData(),c.actor&&c.actor.send("removeTile",{uid:c.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Y extends o.Evented{constructor(c,h,_,v){super(),this.id=c,this.dispatcher=_,this.setEventedParent(v),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.extend({type:"raster"},h),o.extend(this,o.pick(h,["url","scheme","tileSize"]))}load(c){this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Qn(this._options,this.map._requestManager,null,null,(h,_)=>{this._tileJSONRequest=null,this._loaded=!0,h?this.fire(new o.ErrorEvent(h)):_&&(o.extend(this,_),_.bounds&&(this.tileBounds=new Bn(_.bounds,this.minzoom,this.maxzoom)),o.postTurnstileEvent(_.tiles),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"}))),c&&c(h)})}loaded(){return this._loaded}onAdd(c){this.map=c,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(c){return this._options.tiles=c,this.reload(),this}setUrl(c){return this.url=c,this._options.url=c,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return o.extend({},this._options)}hasTile(c){return!this.tileBounds||this.tileBounds.contains(c.canonical)}loadTile(c,h){const _=o.exported.devicePixelRatio>=2,v=this.map._requestManager.normalizeTileURL(c.tileID.canonical.url(this.tiles,this.scheme),_,this.tileSize);c.request=o.getImage(this.map._requestManager.transformRequest(v,o.ResourceType.Tile),(w,S,I,z)=>(delete c.request,c.aborted?(c.state="unloaded",h(null)):w?(c.state="errored",h(w)):S?(this.map._refreshExpiredTiles&&c.setExpiryData({cacheControl:I,expires:z}),c.setTexture(S,this.map.painter),c.state="loaded",o.cacheEntryPossiblyAdded(this.dispatcher),void h(null)):h(null)))}static loadTileData(c,h,_){c.setTexture(h,_)}static unloadTileData(c,h){c.texture&&h.saveTileTexture(c.texture)}abortTile(c,h){c.request&&(c.request.cancel(),delete c.request),h()}unloadTile(c,h){c.texture&&this.map.painter.saveTileTexture(c.texture),h()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}let st;function pt(m,c,h,_,v,w,S,I){const z=[m,h,v,c,_,w,1,1,1],F=[S,I,1],N=o.adjoint([],z),[q,Q,it]=o.transformMat3(F,F,o.transpose(N,N));return o.multiply$1(z,[q,0,0,0,Q,0,0,0,it],z)}class kt extends o.Evented{constructor(c,h,_,v){super(),this.id=c,this.dispatcher=_,this.coordinates=h.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(v),this.options=h,this._dirty=!1}load(c,h){this._loaded=h||!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=o.getImage(this.map._requestManager.transformRequest(this.url,o.ResourceType.Image),(_,v)=>{if(this._imageRequest=null,this._loaded=!0,_)this.fire(new o.ErrorEvent(_));else if(v){const{HTMLImageElement:w}=o.window;this.image=v instanceof w?o.exported.getImageData(v):v,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,c&&(this.coordinates=c),this._finishLoading()}})}loaded(){return this._loaded}updateImage(c){return this.image&&c.url?(this._imageRequest&&c.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=c.url,this.load(c.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(c){this.map=c,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(c){this.coordinates=c,this._boundsArray=void 0;const h=c.map(o.MercatorCoordinate.fromLngLat);return this.tileID=function(_){let v=1/0,w=1/0,S=-1/0,I=-1/0;for(const q of _)v=Math.min(v,q.x),w=Math.min(w,q.y),S=Math.max(S,q.x),I=Math.max(I,q.y);const z=Math.max(S-v,I-w),F=Math.max(0,Math.floor(-Math.log(z)/Math.LN2)),N=Math.pow(2,F);return new o.CanonicalTileID(F,Math.floor((v+S)/2*N),Math.floor((w+I)/2*N))}(h),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(c){for(const z in this.tiles){const F=this.tiles[z];F.state!=="loaded"&&(F.state="loaded",F.texture=this.texture)}if(this._boundsArray)return;const h=o.tileTransform(this.tileID,this.map.transform.projection),[_,v,w,S]=this.coordinates.map(z=>{const F=h.projection.project(z[0],z[1]);return o.getTilePoint(h,F)._round()});this.perspectiveTransform=function(z,F,N,q,Q,it,rt,ot,at,K){const ht=pt(0,0,z,0,0,F,z,F),ut=pt(N,q,Q,it,rt,ot,at,K);return o.multiply$1(ut,o.adjoint(ht,ht),ut),[ut[6]/ut[8]*z/o.EXTENT,ut[7]/ut[8]*F/o.EXTENT]}(this.width,this.height,_.x,_.y,v.x,v.y,S.x,S.y,w.x,w.y);const I=this._boundsArray=new o.StructArrayLayout4i8;I.emplaceBack(_.x,_.y,0,0),I.emplaceBack(v.x,v.y,o.EXTENT,0),I.emplaceBack(S.x,S.y,0,o.EXTENT),I.emplaceBack(w.x,w.y,o.EXTENT,o.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=c.createVertexBuffer(I,o.boundsAttributes.members),this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const c=this.map.painter.context,h=c.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new o.Texture(c,this.image,h.RGBA),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(c)}loadTile(c,h){this.tileID&&this.tileID.equals(c.tileID.canonical)?(this.tiles[String(c.tileID.wrap)]=c,c.buckets={},h(null)):(c.state="errored",h(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const Bt={vector:G,raster:Y,"raster-dem":class extends Y{constructor(m,c,h,_){super(m,c,h,_),this.type="raster-dem",this.maxzoom=22,this._options=o.extend({type:"raster-dem"},c),this.encoding=c.encoding||"mapbox"}loadTile(m,c){const h=this.map._requestManager.normalizeTileURL(m.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function _(v,w){v&&(m.state="errored",c(v)),w&&(m.dem=w,m.dem.onDeserialize(),m.needsHillshadePrepare=!0,m.needsDEMTextureUpload=!0,m.state="loaded",c(null))}m.request=o.getImage(this.map._requestManager.transformRequest(h,o.ResourceType.Tile),function(v,w,S,I){if(delete m.request,m.aborted)m.state="unloaded",c(null);else if(v)m.state="errored",c(v);else if(w){this.map._refreshExpiredTiles&&m.setExpiryData({cacheControl:S,expires:I});const z=o.window.ImageBitmap&&w instanceof o.window.ImageBitmap&&(st==null&&(st=o.window.OffscreenCanvas&&new o.window.OffscreenCanvas(1,1).getContext("2d")&&typeof o.window.createImageBitmap=="function"),st),F=1-(w.width-o.prevPowerOfTwo(w.width))/2;F<1||m.neighboringTiles||(m.neighboringTiles=this._getNeighboringTiles(m.tileID));const N=z?w:o.exported.getImageData(w,F),q={uid:m.uid,coord:m.tileID,source:this.id,rawImageData:N,encoding:this.encoding,padding:F};m.actor&&m.state!=="expired"||(m.actor=this.dispatcher.getActor(),m.actor.send("loadDEMTile",q,_.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(m){const c=m.canonical,h=Math.pow(2,c.z),_=(c.x-1+h)%h,v=c.x===0?m.wrap-1:m.wrap,w=(c.x+1+h)%h,S=c.x+1===h?m.wrap+1:m.wrap,I={};return I[new o.OverscaledTileID(m.overscaledZ,v,c.z,_,c.y).key]={backfilled:!1},I[new o.OverscaledTileID(m.overscaledZ,S,c.z,w,c.y).key]={backfilled:!1},c.y>0&&(I[new o.OverscaledTileID(m.overscaledZ,v,c.z,_,c.y-1).key]={backfilled:!1},I[new o.OverscaledTileID(m.overscaledZ,m.wrap,c.z,c.x,c.y-1).key]={backfilled:!1},I[new o.OverscaledTileID(m.overscaledZ,S,c.z,w,c.y-1).key]={backfilled:!1}),c.y+1<h&&(I[new o.OverscaledTileID(m.overscaledZ,v,c.z,_,c.y+1).key]={backfilled:!1},I[new o.OverscaledTileID(m.overscaledZ,m.wrap,c.z,c.x,c.y+1).key]={backfilled:!1},I[new o.OverscaledTileID(m.overscaledZ,S,c.z,w,c.y+1).key]={backfilled:!1}),I}unloadTile(m){m.demTexture&&this.map.painter.saveTileTexture(m.demTexture),m.fbo&&(m.fbo.destroy(),delete m.fbo),m.dem&&delete m.dem,delete m.neighboringTiles,m.state="unloaded"}},geojson:class extends o.Evented{constructor(m,c,h,_){super(),this.id=m,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=h.getActor(),this.setEventedParent(_),this._data=c.data,this._options=o.extend({},c),this._collectResourceTiming=c.collectResourceTiming,c.maxzoom!==void 0&&(this.maxzoom=c.maxzoom),c.type&&(this.type=c.type),c.attribution&&(this.attribution=c.attribution),this.promoteId=c.promoteId;const v=o.EXTENT/this.tileSize;this.workerOptions=o.extend({source:this.id,cluster:c.cluster||!1,geojsonVtOptions:{buffer:(c.buffer!==void 0?c.buffer:128)*v,tolerance:(c.tolerance!==void 0?c.tolerance:.375)*v,extent:o.EXTENT,maxZoom:this.maxzoom,lineMetrics:c.lineMetrics||!1,generateId:c.generateId||!1},superclusterOptions:{maxZoom:c.clusterMaxZoom!==void 0?c.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,c.clusterMinPoints||2),extent:o.EXTENT,radius:(c.clusterRadius!==void 0?c.clusterRadius:50)*v,log:!1,generateId:c.generateId||!1},clusterProperties:c.clusterProperties,filter:c.filter},c.workerOptions)}onAdd(m){this.map=m,this.setData(this._data)}setData(m){return this._data=m,this._updateWorkerData(),this}getClusterExpansionZoom(m,c){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:m,source:this.id},c),this}getClusterChildren(m,c){return this.actor.send("geojson.getClusterChildren",{clusterId:m,source:this.id},c),this}getClusterLeaves(m,c,h,_){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:m,limit:c,offset:h},_),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new o.Event("dataloading",{dataType:"source"})),this._loaded=!1;const m=o.extend({},this.workerOptions),c=this._data;typeof c=="string"?(m.request=this.map._requestManager.transformRequest(o.exported.resolveURL(c),o.ResourceType.Source),m.request.collectResourceTiming=this._collectResourceTiming):m.data=JSON.stringify(c),this._pendingLoad=this.actor.send(`${this.type}.loadData`,m,(h,_)=>{if(this._loaded=!0,this._pendingLoad=null,h)this.fire(new o.ErrorEvent(h));else{const v={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&_&&_.resourceTiming&&_.resourceTiming[this.id]&&(v.resourceTiming=_.resourceTiming[this.id]),this.fire(new o.Event("data",v)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(m,c){const h=m.actor?"reloadTile":"loadTile";m.actor=this.actor,m.request=this.actor.send(h,{type:this.type,uid:m.uid,tileID:m.tileID,tileZoom:m.tileZoom,zoom:m.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:o.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(_,v)=>(delete m.request,m.unloadVectorData(),m.aborted?c(null):_?c(_):(m.loadVectorData(v,this.map.painter,h==="reloadTile"),c(null))),void 0,h==="loadTile")}abortTile(m){m.request&&(m.request.cancel(),delete m.request),m.aborted=!0}unloadTile(m){m.unloadVectorData(),this.actor.send("removeTile",{uid:m.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return o.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends kt{constructor(m,c,h,_){super(m,c,h,_),this.roundZoom=!0,this.type="video",this.options=c}load(){this._loaded=!1;const m=this.options;this.urls=[];for(const c of m.urls)this.urls.push(this.map._requestManager.transformRequest(c,o.ResourceType.Source).url);o.getVideo(this.urls,(c,h)=>{this._loaded=!0,c?this.fire(new o.ErrorEvent(c)):h&&(this.video=h,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(m){if(this.video){const c=this.video.seekable;m<c.start(0)||m>c.end(0)?this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${c.start(0)} and ${c.end(0)}-second mark.`))):this.video.currentTime=m}}getVideo(){return this.video}onAdd(m){this.map||(this.map=m,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const m=this.map.painter.context,c=m.gl;this.texture?this.video.paused||(this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE),c.texSubImage2D(c.TEXTURE_2D,0,0,0,c.RGBA,c.UNSIGNED_BYTE,this.video)):(this.texture=new o.Texture(m,this.video,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(m)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:kt,canvas:class extends kt{constructor(m,c,h,_){super(m,c,h,_),c.coordinates?Array.isArray(c.coordinates)&&c.coordinates.length===4&&!c.coordinates.some(v=>!Array.isArray(v)||v.length!==2||v.some(w=>typeof w!="number"))||this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${m}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${m}`,null,'missing required property "coordinates"'))),c.animate&&typeof c.animate!="boolean"&&this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${m}`,null,'optional "animate" property must be a boolean value'))),c.canvas?typeof c.canvas=="string"||c.canvas instanceof o.window.HTMLCanvasElement||this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${m}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${m}`,null,'missing required property "canvas"'))),this.options=c,this.animate=c.animate===void 0||c.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof o.window.HTMLCanvasElement?this.options.canvas:o.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(m){this.map=m,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let m=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,m=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,m=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const c=this.map.painter.context;this.texture?(m||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new o.Texture(c,this.canvas,c.gl.RGBA,{premultiply:!0}),this._prepareData(c)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const m of[this.canvas.width,this.canvas.height])if(isNaN(m)||m<=0)return!0;return!1}},custom:class extends o.Evented{constructor(m,c,h,_){super(),this.id=m,this.type="custom",this._dataType="raster",this._dispatcher=h,this._implementation=c,this.setEventedParent(_),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new o.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new o.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Bn(this._implementation.bounds,this.minzoom,this.maxzoom)),c.update=this._update.bind(this),c.clearTiles=this._clearTiles.bind(this),c.coveringTiles=this._coveringTiles.bind(this),o.extend(this,o.pick(c,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return o.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(m){this._map=m,this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(m),this.load()}onRemove(m){this._implementation.onRemove&&this._implementation.onRemove(m)}hasTile(m){if(this._implementation.hasTile){const{x:c,y:h,z:_}=m.canonical;return this._implementation.hasTile({x:c,y:h,z:_})}return!this.tileBounds||this.tileBounds.contains(m.canonical)}loadTile(m,c){const{x:h,y:_,z:v}=m.tileID.canonical,w=new o.window.AbortController;m.request=Promise.resolve(this._implementation.loadTile({x:h,y:_,z:v},{signal:w.signal})).then(function(S){return delete m.request,m.aborted?(m.state="unloaded",c(null)):S===void 0?(m.state="errored",c(null)):S===null?(this.loadTileData(m,{width:this.tileSize,height:this.tileSize,data:null}),m.state="loaded",c(null)):function(I){return I instanceof o.window.ImageData||I instanceof o.window.HTMLCanvasElement||I instanceof o.window.ImageBitmap||I instanceof o.window.HTMLImageElement}(S)?(this.loadTileData(m,S),m.state="loaded",void c(null)):(m.state="errored",c(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}.bind(this)).catch(S=>{S.code!==20&&(m.state="errored",c(S))}),m.request.cancel=()=>w.abort()}loadTileData(m,c){Y.loadTileData(m,c,this._map.painter)}unloadTileData(m){Y.unloadTileData(m,this._map.painter)}unloadTile(m,c){if(this.unloadTileData(m),this._implementation.unloadTile){const{x:h,y:_,z:v}=m.tileID.canonical;this._implementation.unloadTile({x:h,y:_,z:v})}c()}abortTile(m,c){m.request&&m.request.cancel&&(m.request.cancel(),delete m.request),c()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(m=>({x:m.canonical.x,y:m.canonical.y,z:m.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"}))}}},Lt=function(m,c,h,_){const v=new Bt[c.type](m,c,h,_);if(v.id!==m)throw new Error(`Expected Source id to be ${m} instead of ${v.id}`);return o.bindAll(["load","abort","unload","serialize","prepare"],v),v};function At(m,c){const h=o.identity([]);return o.scale(h,h,[.5*m.width,.5*-m.height,1]),o.translate(h,h,[1,-1,0]),o.multiply(h,h,m.calculateProjMatrix(c.toUnwrapped())),Float32Array.from(h)}function Ut(m,c,h,_,v,w,S,I=!1){const z=m.tilesIn(_,S,I);z.sort(Oe);const F=[];for(const q of z)F.push({wrappedTileID:q.tile.tileID.wrapped().key,queryResults:q.tile.queryRenderedFeatures(c,h,m._state,q,v,w,At(m.transform,q.tile.tileID),I)});const N=function(q){const Q={},it={};for(const rt of q){const ot=rt.queryResults,at=rt.wrappedTileID,K=it[at]=it[at]||{};for(const ht in ot){const ut=ot[ht],mt=K[ht]=K[ht]||{},Tt=Q[ht]=Q[ht]||[];for(const wt of ut)mt[wt.featureIndex]||(mt[wt.featureIndex]=!0,Tt.push(wt))}}return Q}(F);for(const q in N)N[q].forEach(Q=>{const it=Q.feature,rt=it.layer;rt&&rt.type!=="background"&&rt.type!=="sky"&&(it.source=rt.source,rt["source-layer"]&&(it.sourceLayer=rt["source-layer"]),it.state=it.id!==void 0?m.getFeatureState(rt["source-layer"],it.id):{})});return N}function ae(m,c){const h=m.getRenderableIds().map(w=>m.getTileByID(w)),_=[],v={};for(let w=0;w<h.length;w++){const S=h[w],I=S.tileID.canonical.key;v[I]||(v[I]=!0,S.querySourceFeatures(_,c))}return _}function Oe(m,c){const h=m.tileID,_=c.tileID;return h.overscaledZ-_.overscaledZ||h.canonical.y-_.canonical.y||h.wrap-_.wrap||h.canonical.x-_.canonical.x}function me(){return Ju.workerClass!=null?new Ju.workerClass:new o.window.Worker(Ju.workerUrl)}const rn="mapboxgl_preloaded_worker_pool";class tn{constructor(){this.active={}}acquire(c){if(!this.workers)for(this.workers=[];this.workers.length<tn.workerCount;)this.workers.push(new me);return this.active[c]=!0,this.workers.slice()}release(c){delete this.active[c],this.numActive()===0&&(this.workers.forEach(h=>{h.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[rn]}numActive(){return Object.keys(this.active).length}}let en;function dn(){return en||(en=new tn),en}function an(m,c){const h={};for(const _ in m)_!=="ref"&&(h[_]=m[_]);return o.refProperties.forEach(_=>{_ in c&&(h[_]=c[_])}),h}function tr(m){m=m.slice();const c=Object.create(null);for(let h=0;h<m.length;h++)c[m[h].id]=m[h];for(let h=0;h<m.length;h++)"ref"in m[h]&&(m[h]=an(m[h],c[m[h].ref]));return m}tn.workerCount=2;const hn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function qn(m,c,h){h.push({command:hn.addSource,args:[m,c[m]]})}function Fn(m,c,h){c.push({command:hn.removeSource,args:[m]}),h[m]=!0}function Wo(m,c,h,_){Fn(m,h,_),qn(m,c,h)}function Ki(m,c,h){let _;for(_ in m[h])if(m[h].hasOwnProperty(_)&&_!=="data"&&!y(m[h][_],c[h][_]))return!1;for(_ in c[h])if(c[h].hasOwnProperty(_)&&_!=="data"&&!y(m[h][_],c[h][_]))return!1;return!0}function Kt(m,c,h,_,v,w){let S;for(S in c=c||{},m=m||{})m.hasOwnProperty(S)&&(y(m[S],c[S])||h.push({command:w,args:[_,S,c[S],v]}));for(S in c)c.hasOwnProperty(S)&&!m.hasOwnProperty(S)&&(y(m[S],c[S])||h.push({command:w,args:[_,S,c[S],v]}))}function ia(m){return m.id}function ri(m,c){return m[c.id]=c,m}class ja{constructor(c,h){this.reset(c,h)}reset(c,h){this.points=c||[],this._distances=[0];for(let _=1;_<this.points.length;_++)this._distances[_]=this._distances[_-1]+this.points[_].dist(this.points[_-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(h||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(c){if(this.points.length===1)return this.points[0];c=o.clamp(c,0,1);let h=1,_=this._distances[h];const v=c*this.paddedLength+this.padding;for(;_<v&&h<this._distances.length;)_=this._distances[++h];const w=h-1,S=this._distances[w],I=_-S,z=I>0?(v-S)/I:0;return this.points[w].mult(1-z).add(this.points[h].mult(z))}}class Xd{constructor(c,h,_){const v=this.boxCells=[],w=this.circleCells=[];this.xCellCount=Math.ceil(c/_),this.yCellCount=Math.ceil(h/_);for(let S=0;S<this.xCellCount*this.yCellCount;S++)v.push([]),w.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=c,this.height=h,this.xScale=this.xCellCount/c,this.yScale=this.yCellCount/h,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(c,h,_,v,w){this._forEachCell(h,_,v,w,this._insertBoxCell,this.boxUid++),this.boxKeys.push(c),this.bboxes.push(h),this.bboxes.push(_),this.bboxes.push(v),this.bboxes.push(w)}insertCircle(c,h,_,v){this._forEachCell(h-v,_-v,h+v,_+v,this._insertCircleCell,this.circleUid++),this.circleKeys.push(c),this.circles.push(h),this.circles.push(_),this.circles.push(v)}_insertBoxCell(c,h,_,v,w,S){this.boxCells[w].push(S)}_insertCircleCell(c,h,_,v,w,S){this.circleCells[w].push(S)}_query(c,h,_,v,w,S){if(_<0||c>this.width||v<0||h>this.height)return!w&&[];const I=[];if(c<=0&&h<=0&&this.width<=_&&this.height<=v){if(w)return!0;for(let z=0;z<this.boxKeys.length;z++)I.push({key:this.boxKeys[z],x1:this.bboxes[4*z],y1:this.bboxes[4*z+1],x2:this.bboxes[4*z+2],y2:this.bboxes[4*z+3]});for(let z=0;z<this.circleKeys.length;z++){const F=this.circles[3*z],N=this.circles[3*z+1],q=this.circles[3*z+2];I.push({key:this.circleKeys[z],x1:F-q,y1:N-q,x2:F+q,y2:N+q})}return S?I.filter(S):I}return this._forEachCell(c,h,_,v,this._queryCell,I,{hitTest:w,seenUids:{box:{},circle:{}}},S),w?I.length>0:I}_queryCircle(c,h,_,v,w){const S=c-_,I=c+_,z=h-_,F=h+_;if(I<0||S>this.width||F<0||z>this.height)return!v&&[];const N=[];return this._forEachCell(S,z,I,F,this._queryCellCircle,N,{hitTest:v,circle:{x:c,y:h,radius:_},seenUids:{box:{},circle:{}}},w),v?N.length>0:N}query(c,h,_,v,w){return this._query(c,h,_,v,!1,w)}hitTest(c,h,_,v,w){return this._query(c,h,_,v,!0,w)}hitTestCircle(c,h,_,v){return this._queryCircle(c,h,_,!0,v)}_queryCell(c,h,_,v,w,S,I,z){const F=I.seenUids,N=this.boxCells[w];if(N!==null){const Q=this.bboxes;for(const it of N)if(!F.box[it]){F.box[it]=!0;const rt=4*it;if(c<=Q[rt+2]&&h<=Q[rt+3]&&_>=Q[rt+0]&&v>=Q[rt+1]&&(!z||z(this.boxKeys[it]))){if(I.hitTest)return S.push(!0),!0;S.push({key:this.boxKeys[it],x1:Q[rt],y1:Q[rt+1],x2:Q[rt+2],y2:Q[rt+3]})}}}const q=this.circleCells[w];if(q!==null){const Q=this.circles;for(const it of q)if(!F.circle[it]){F.circle[it]=!0;const rt=3*it;if(this._circleAndRectCollide(Q[rt],Q[rt+1],Q[rt+2],c,h,_,v)&&(!z||z(this.circleKeys[it]))){if(I.hitTest)return S.push(!0),!0;{const ot=Q[rt],at=Q[rt+1],K=Q[rt+2];S.push({key:this.circleKeys[it],x1:ot-K,y1:at-K,x2:ot+K,y2:at+K})}}}}}_queryCellCircle(c,h,_,v,w,S,I,z){const F=I.circle,N=I.seenUids,q=this.boxCells[w];if(q!==null){const it=this.bboxes;for(const rt of q)if(!N.box[rt]){N.box[rt]=!0;const ot=4*rt;if(this._circleAndRectCollide(F.x,F.y,F.radius,it[ot+0],it[ot+1],it[ot+2],it[ot+3])&&(!z||z(this.boxKeys[rt])))return S.push(!0),!0}}const Q=this.circleCells[w];if(Q!==null){const it=this.circles;for(const rt of Q)if(!N.circle[rt]){N.circle[rt]=!0;const ot=3*rt;if(this._circlesCollide(it[ot],it[ot+1],it[ot+2],F.x,F.y,F.radius)&&(!z||z(this.circleKeys[rt])))return S.push(!0),!0}}}_forEachCell(c,h,_,v,w,S,I,z){const F=this._convertToXCellCoord(c),N=this._convertToYCellCoord(h),q=this._convertToXCellCoord(_),Q=this._convertToYCellCoord(v);for(let it=F;it<=q;it++)for(let rt=N;rt<=Q;rt++)if(w.call(this,c,h,_,v,this.xCellCount*rt+it,S,I,z))return}_convertToXCellCoord(c){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(c*this.xScale)))}_convertToYCellCoord(c){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(c*this.yScale)))}_circlesCollide(c,h,_,v,w,S){const I=v-c,z=w-h,F=_+S;return F*F>I*I+z*z}_circleAndRectCollide(c,h,_,v,w,S,I){const z=(S-v)/2,F=Math.abs(c-(v+z));if(F>z+_)return!1;const N=(I-w)/2,q=Math.abs(h-(w+N));if(q>N+_)return!1;if(F<=z||q<=N)return!0;const Q=F-z,it=q-N;return Q*Q+it*it<=_*_}}const Zo=Math.tan(85*Math.PI/180);function Ea(m,c,h,_,v,w,S){const I=o.create();if(h)if(w.name==="globe"){const z=o.calculateGlobeLabelMatrix(v,c);o.multiply(I,I,z)}else{const z=jt([],S);I[0]=z[0],I[1]=z[1],I[4]=z[2],I[5]=z[3],_||o.rotateZ(I,I,v.angle)}else o.multiply(I,v.labelPlaneMatrix,m);return I}function Yd(m,c,h,_,v,w,S){const I=Ea(m,c,h,_,v,w,S);return w.name==="globe"&&h||(I[2]=I[6]=I[10]=I[14]=0),I}function fs(m,c,h,_,v,w,S){if(h){if(w.name==="globe"){const I=Ea(m,c,h,_,v,w,S);return o.invert(I,I),o.multiply(I,m,I),I}{const I=o.clone(m),z=o.identity([]);return z[0]=S[0],z[1]=S[1],z[4]=S[2],z[5]=S[3],o.multiply(I,I,z),_||o.rotateZ(I,I,-v.angle),I}}return v.glCoordMatrix}function Se(m,c,h,_){const v=[m,c,h,1];h?o.transformMat4$1(v,v,_):xe(v,v,_);const w=v[3];return v[0]/=w,v[1]/=w,v[2]/=w,v}function Dn(m,c){return Math.min(.5+m/c*.5,1.5)}function zn(m,c){const h=m[0]/m[3],_=m[1]/m[3];return h>=-c[0]&&h<=c[0]&&_>=-c[1]&&_<=c[1]}function wo(m,c,h,_,v,w,S,I,z,F){const N=h.transform,q=_?m.textSizeData:m.iconSizeData,Q=o.evaluateSizeForZoom(q,h.transform.zoom),it=N.projection.name==="globe",rt=[256/h.width*2+1,256/h.height*2+1],ot=_?m.text.dynamicLayoutVertexArray:m.icon.dynamicLayoutVertexArray;ot.clear();let at=null;it&&(at=_?m.text.globeExtVertexArray:m.icon.globeExtVertexArray);const K=m.lineVertexArray,ht=_?m.text.placedSymbolArray:m.icon.placedSymbolArray,ut=h.transform.width/h.transform.height;let mt,Tt=!1;for(let wt=0;wt<ht.length;wt++){const Mt=ht.get(wt),{numGlyphs:Ft,writingMode:Vt}=Mt;if(Vt!==o.WritingMode.vertical||Tt||mt===o.WritingMode.horizontal||(Tt=!0),mt=Vt,(Mt.hidden||Vt===o.WritingMode.vertical)&&!Tt){It(Ft,ot);continue}Tt=!1;const Ht=new o.pointGeometry(Mt.tileAnchorX,Mt.tileAnchorY);let{x:ke,y:Nt,z:ne}=N.projection.projectTilePoint(Ht.x,Ht.y,F.canonical);if(z){const[Pn,We,je]=z(Ht);ke+=Pn,Nt+=We,ne+=je}const Xt=[ke,Nt,ne,1];if(o.transformMat4$1(Xt,Xt,c),!zn(Xt,rt)){It(Ft,ot);continue}const ue=Dn(h.transform.cameraToCenterDistance,Xt[3]),Gt=o.evaluateSizeForFeature(q,Q,Mt),Ot=S?Gt/ue:Gt*ue,Wt=Se(ke,Nt,ne,v);if(Wt[3]<=0){It(Ft,ot);continue}let ie={};const pe=S?null:z,Je=J(Mt,Ot,!1,I,c,v,w,m.glyphOffsetArray,K,ot,at,Wt,Ht,ie,ut,pe,N.projection,F,S);Tt=Je.useVertical,pe&&Je.needsFlipping&&(ie={}),(Je.notEnoughRoom||Tt||Je.needsFlipping&&J(Mt,Ot,!0,I,c,v,w,m.glyphOffsetArray,K,ot,at,Wt,Ht,ie,ut,pe,N.projection,F,S).notEnoughRoom)&&It(Ft,ot)}_?(m.text.dynamicLayoutVertexBuffer.updateData(ot),at&&m.text.globeExtVertexBuffer.updateData(at)):(m.icon.dynamicLayoutVertexBuffer.updateData(ot),at&&m.icon.globeExtVertexBuffer.updateData(at))}function M(m,c,h,_,v,w,S,I,z,F,N,q,Q,it,rt,ot){const{lineStartIndex:at,glyphStartIndex:K,segment:ht}=I,ut=K+I.numGlyphs,mt=at+I.lineLength,Tt=c.getoffsetX(K),wt=c.getoffsetX(ut-1),Mt=St(m*Tt,h,_,v,w,S,ht,at,mt,z,F,N,q,Q,!0,it,rt,ot);if(!Mt)return null;const Ft=St(m*wt,h,_,v,w,S,ht,at,mt,z,F,N,q,Q,!0,it,rt,ot);return Ft?{first:Mt,last:Ft}:null}function D(m,c,h,_){return m===o.WritingMode.horizontal&&Math.abs(_)>Math.abs(h)?{useVertical:!0}:m===o.WritingMode.vertical?_>0?{needsFlipping:!0}:null:c!==0&&function(v,w){return v===0||Math.abs(w/v)>Zo}(h,_)?c===1?{needsFlipping:!0}:null:h<0?{needsFlipping:!0}:null}function J(m,c,h,_,v,w,S,I,z,F,N,q,Q,it,rt,ot,at,K,ht){const ut=c/24,mt=m.lineOffsetX*ut,Tt=m.lineOffsetY*ut,{lineStartIndex:wt,glyphStartIndex:Mt,numGlyphs:Ft,segment:Vt,writingMode:Ht,flipState:ke}=m,Nt=wt+m.lineLength,ne=Xt=>{if(N){const[Wt,ie,pe]=Xt.up,Je=F.length;o.updateGlobeVertexNormal(N,Je+0,Wt,ie,pe),o.updateGlobeVertexNormal(N,Je+1,Wt,ie,pe),o.updateGlobeVertexNormal(N,Je+2,Wt,ie,pe),o.updateGlobeVertexNormal(N,Je+3,Wt,ie,pe)}const[ue,Gt,Ot]=Xt.point;o.addDynamicAttributes(F,ue,Gt,Ot,Xt.angle)};if(Ft>1){const Xt=M(ut,I,mt,Tt,h,q,Q,m,z,w,it,ot,!1,at,K,ht);if(!Xt)return{notEnoughRoom:!0};if(_&&!h){let[ue,Gt,Ot]=Xt.first.point,[Wt,ie,pe]=Xt.last.point;[ue,Gt]=Se(ue,Gt,Ot,S),[Wt,ie]=Se(Wt,ie,pe,S);const Je=D(Ht,ke,(Wt-ue)*rt,ie-Gt);if(m.flipState=Je&&Je.needsFlipping?1:2,Je)return Je}ne(Xt.first);for(let ue=Mt+1;ue<Mt+Ft-1;ue++){const Gt=St(ut*I.getoffsetX(ue),mt,Tt,h,q,Q,Vt,wt,Nt,z,w,it,ot,!1,!1,at,K,ht);if(!Gt)return F.length-=4*(ue-Mt),{notEnoughRoom:!0};ne(Gt)}ne(Xt.last)}else{if(_&&!h){const ue=Se(Q.x,Q.y,0,v),Gt=wt+Vt+1,Ot=new o.pointGeometry(z.getx(Gt),z.gety(Gt)),Wt=Se(Ot.x,Ot.y,0,v),ie=Wt[3]>0?Wt:Ct(Q,Ot,ue,1,v,void 0,at,K.canonical),pe=D(Ht,ke,(ie[0]-ue[0])*rt,ie[1]-ue[1]);if(m.flipState=pe&&pe.needsFlipping?1:2,pe)return pe}const Xt=St(ut*I.getoffsetX(Mt),mt,Tt,h,q,Q,Vt,wt,Nt,z,w,it,ot,!1,!1,at,K,ht);if(!Xt)return{notEnoughRoom:!0};ne(Xt)}return{}}function gt(m,c,h,_,v){const{x:w,y:S,z:I}=_.projectTilePoint(m.x,m.y,c);if(!v)return Se(w,S,I,h);const[z,F,N]=v(m);return Se(w+z,S+F,I+N,h)}function Ct(m,c,h,_,v,w,S,I){const z=gt(m.sub(c)._unit()._add(m),I,v,S,w);return o.sub(z,h,z),o.normalize(z,z),o.scaleAndAdd(z,h,z,_)}function St(m,c,h,_,v,w,S,I,z,F,N,q,Q,it,rt,ot,at,K){const ht=_?m-c:m+c;let ut=ht>0?1:-1,mt=0;_&&(ut*=-1,mt=Math.PI),ut<0&&(mt+=Math.PI);let Tt=I+S+(ut>0?0:1)|0,wt=v,Mt=v,Ft=0,Vt=0;const Ht=Math.abs(ht),ke=[],Nt=[];let ne=w,Xt=ne;const ue=()=>Ct(Xt,ne,Mt,Ht-Ft+1,N,Q,ot,at.canonical);for(;Ft+Vt<=Ht;){if(Tt+=ut,Tt<I||Tt>=z)return null;if(Mt=wt,Xt=ne,ke.push(Mt),it&&Nt.push(Xt),ne=new o.pointGeometry(F.getx(Tt),F.gety(Tt)),wt=q[Tt],!wt){const je=gt(ne,at.canonical,N,ot,Q);wt=je[3]>0?q[Tt]=je:ue()}Ft+=Vt,Vt=o.distance(Mt,wt)}rt&&Q&&(q[Tt]&&(wt=ue(),Vt=o.distance(Mt,wt)),q[Tt]=wt);const Gt=(Ht-Ft)/Vt,Ot=ne.sub(Xt)._mult(Gt)._add(Xt),Wt=o.sub([],wt,Mt),ie=o.scaleAndAdd([],Mt,Wt,Gt);let pe=[0,0,1],Je=Wt[0],Pn=Wt[1];if(K&&(pe=ot.upVector(at.canonical,Ot.x,Ot.y),pe[0]!==0||pe[1]!==0||pe[2]!==1)){const je=[pe[2],0,-pe[0]],nn=o.cross([],pe,je);o.normalize(je,je),o.normalize(nn,nn),Je=o.dot(Wt,je),Pn=o.dot(Wt,nn)}if(h){const je=o.cross([],pe,Wt);o.normalize(je,je),o.scaleAndAdd(ie,ie,je,h*ut)}const We=mt+Math.atan2(Pn,Je);return ke.push(ie),it&&Nt.push(Ot),{point:ie,angle:We,path:ke,tilePath:Nt,up:pe}}function It(m,c){const h=c.length,_=h+4*m;c.resize(_),c.float32.fill(-1/0,4*h,4*_)}function xe(m,c,h){const _=c[0],v=c[1];return m[0]=h[0]*_+h[4]*v+h[12],m[1]=h[1]*_+h[5]*v+h[13],m[3]=h[3]*_+h[7]*v+h[15],m}const we=100;class $e{constructor(c,h,_=new Xd(c.width+200,c.height+200,25),v=new Xd(c.width+200,c.height+200,25)){this.transform=c,this.grid=_,this.ignoredGrid=v,this.pitchfactor=Math.cos(c._pitch)*c.cameraToCenterDistance,this.screenRightBoundary=c.width+we,this.screenBottomBoundary=c.height+we,this.gridRightBoundary=c.width+200,this.gridBottomBoundary=c.height+200,this.fogState=h}placeCollisionBox(c,h,_,v,w,S,I,z){let F=_.projectedAnchorX,N=_.projectedAnchorY,q=_.projectedAnchorZ;const Q=_.elevation,it=_.tileID,rt=c.getProjection();if(Q&&it){const[wt,Mt,Ft]=rt.upVector(it.canonical,_.tileAnchorX,_.tileAnchorY),Vt=rt.upVectorScale(it.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;F+=wt*Q*Vt,N+=Mt*Q*Vt,q+=Ft*Q*Vt}const ot=this.projectAndGetPerspectiveRatio(I,F,N,q,_.tileID,rt.name==="globe"||!!Q||this.transform.pitch>0,rt),at=S*ot.perspectiveRatio,K=(_.x1*h+v.x-_.padding)*at+ot.point.x,ht=(_.y1*h+v.y-_.padding)*at+ot.point.y,ut=(_.x2*h+v.x+_.padding)*at+ot.point.x,mt=(_.y2*h+v.y+_.padding)*at+ot.point.y,Tt=ot.perspectiveRatio<=.55||ot.occluded;return!this.isInsideGrid(K,ht,ut,mt)||!w&&this.grid.hitTest(K,ht,ut,mt,z)||Tt?{box:[],offscreen:!1,occluded:ot.occluded}:{box:[K,ht,ut,mt],offscreen:this.isOffscreen(K,ht,ut,mt),occluded:!1}}placeCollisionCircles(c,h,_,v,w,S,I,z,F,N,q,Q,it,rt,ot){const at=[],K=this.transform.elevation,ht=c.getProjection(),ut=K?K.getAtTileOffsetFunc(ot,this.transform.center.lat,this.transform.worldSize,ht):null,mt=new o.pointGeometry(_.tileAnchorX,_.tileAnchorY);let{x:Tt,y:wt,z:Mt}=ht.projectTilePoint(mt.x,mt.y,ot.canonical);if(ut){const[Ot,Wt,ie]=ut(mt);Tt+=Ot,wt+=Wt,Mt+=ie}const Ft=ht.name==="globe",Vt=this.projectAndGetPerspectiveRatio(I,Tt,wt,Mt,ot,Ft||!!K||this.transform.pitch>0,ht),{perspectiveRatio:Ht}=Vt,ke=(q?S/Ht:S*Ht)/o.ONE_EM,Nt=Se(Tt,wt,Mt,z),ne=Vt.signedDistanceFromCamera>0?M(ke,w,_.lineOffsetX*ke,_.lineOffsetY*ke,!1,Nt,mt,_,v,z,{},K&&!q?ut:null,q&&!!K,ht,ot,q):null;let Xt=!1,ue=!1,Gt=!0;if(ne&&!Vt.occluded){const Ot=.5*it*Ht+rt,Wt=new o.pointGeometry(-100,-100),ie=new o.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),pe=new ja,{first:Je,last:Pn}=ne,We=Je.path.length;let je=[];for(let sn=We-1;sn>=1;sn--)je.push(Je.path[sn]);for(let sn=1;sn<Pn.path.length;sn++)je.push(Pn.path[sn]);const nn=2.5*Ot;F&&(je=je.map(([sn,ar,yr],Mr)=>(ut&&!Ft&&(yr=ut(Mr<We-1?Je.tilePath[We-1-Mr]:Pn.tilePath[Mr-We+2])[2]),Se(sn,ar,yr,F))),je.some(sn=>sn[3]<=0)&&(je=[]));let Nn=[];if(je.length>0){let sn=1/0,ar=-1/0,yr=1/0,Mr=-1/0;for(const wr of je)sn=Math.min(sn,wr[0]),yr=Math.min(yr,wr[1]),ar=Math.max(ar,wr[0]),Mr=Math.max(Mr,wr[1]);ar>=Wt.x&&sn<=ie.x&&Mr>=Wt.y&&yr<=ie.y&&(Nn=[je.map(wr=>new o.pointGeometry(wr[0],wr[1]))],(sn<Wt.x||ar>ie.x||yr<Wt.y||Mr>ie.y)&&(Nn=o.clipLine(Nn,Wt.x,Wt.y,ie.x,ie.y)))}for(const sn of Nn){pe.reset(sn,.25*Ot);let ar=0;ar=pe.length<=.5*Ot?1:Math.ceil(pe.paddedLength/nn)+1;for(let yr=0;yr<ar;yr++){const Mr=yr/Math.max(ar-1,1),wr=pe.lerp(Mr),vi=wr.x+we,zo=wr.y+we;at.push(vi,zo,Ot,0);const Ia=vi-Ot,Ss=zo-Ot,Fr=vi+Ot,Er=zo+Ot;if(Gt=Gt&&this.isOffscreen(Ia,Ss,Fr,Er),ue=ue||this.isInsideGrid(Ia,Ss,Fr,Er),!h&&this.grid.hitTestCircle(vi,zo,Ot,Q)&&(Xt=!0,!N))return{circles:[],offscreen:!1,collisionDetected:Xt,occluded:!1}}}}return{circles:!N&&Xt||!ue?[]:at,offscreen:Gt,collisionDetected:Xt,occluded:Vt.occluded}}queryRenderedSymbols(c){if(c.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const h=[];let _=1/0,v=1/0,w=-1/0,S=-1/0;for(const N of c){const q=new o.pointGeometry(N.x+we,N.y+we);_=Math.min(_,q.x),v=Math.min(v,q.y),w=Math.max(w,q.x),S=Math.max(S,q.y),h.push(q)}const I=this.grid.query(_,v,w,S).concat(this.ignoredGrid.query(_,v,w,S)),z={},F={};for(const N of I){const q=N.key;if(z[q.bucketInstanceId]===void 0&&(z[q.bucketInstanceId]={}),z[q.bucketInstanceId][q.featureIndex])continue;const Q=[new o.pointGeometry(N.x1,N.y1),new o.pointGeometry(N.x2,N.y1),new o.pointGeometry(N.x2,N.y2),new o.pointGeometry(N.x1,N.y2)];o.polygonIntersectsPolygon(h,Q)&&(z[q.bucketInstanceId][q.featureIndex]=!0,F[q.bucketInstanceId]===void 0&&(F[q.bucketInstanceId]=[]),F[q.bucketInstanceId].push(q.featureIndex))}return F}insertCollisionBox(c,h,_,v,w){(h?this.ignoredGrid:this.grid).insert({bucketInstanceId:_,featureIndex:v,collisionGroupID:w},c[0],c[1],c[2],c[3])}insertCollisionCircles(c,h,_,v,w){const S=h?this.ignoredGrid:this.grid,I={bucketInstanceId:_,featureIndex:v,collisionGroupID:w};for(let z=0;z<c.length;z+=4)S.insertCircle(I,c[z],c[z+1],c[z+2])}projectAndGetPerspectiveRatio(c,h,_,v,w,S,I){const z=[h,_,v,1];let F=!1;if(v||this.transform.pitch>0){o.transformMat4$1(z,z,c);const q=I.name==="globe";this.fogState&&w&&!q&&(F=function(it,rt,ot,at,K,ht){const ut=ht.calculateFogTileMatrix(K),mt=[rt,ot,at];return o.transformMat4(mt,mt,ut),_n(it,mt,ht.pitch,ht._fov)}(this.fogState,h,_,v,w.toUnwrapped(),this.transform)>.9)}else xe(z,z,c);const N=z[3];return{point:new o.pointGeometry((z[0]/N+1)/2*this.transform.width+we,(-z[1]/N+1)/2*this.transform.height+we),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(I)/N*.5,1.5),signedDistanceFromCamera:N,occluded:S&&z[2]>N||F}}isOffscreen(c,h,_,v){return _<we||c>=this.screenRightBoundary||v<we||h>this.screenBottomBoundary}isInsideGrid(c,h,_,v){return _>=0&&c<this.gridRightBoundary&&v>=0&&h<this.gridBottomBoundary}getViewportMatrix(){const c=o.identity([]);return o.translate(c,c,[-100,-100,0]),c}}function Re(m,c,h){const _=c.createTileMatrix(m,m.worldSize,h.toUnwrapped());return o.multiply(new Float32Array(16),m.projMatrix,_)}function De(m,c,h){if(c.projection.name===h.projection.name)return m.projMatrix;const _=h.clone();return _.setProjection(c.projection),Re(_,c.getProjection(),m)}function xn(m,c,h){return c.name===h.projection.name?m.projMatrix:Re(h,c,m)}class Cr{constructor(c,h,_,v){this.opacity=c?Math.max(0,Math.min(1,c.opacity+(c.placed?h:-h))):v&&_?1:0,this.placed=_}isHidden(){return this.opacity===0&&!this.placed}}class Tn{constructor(c,h,_,v,w,S=!1){this.text=new Cr(c?c.text:null,h,_,w),this.icon=new Cr(c?c.icon:null,h,v,w),this.clipped=S}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Br{constructor(c,h,_,v=!1){this.text=c,this.icon=h,this.skipFade=_,this.clipped=v}}class le{constructor(){this.invProjMatrix=o.create(),this.viewportMatrix=o.create(),this.circles=[]}}class Ve{constructor(c,h,_,v,w){this.bucketInstanceId=c,this.featureIndex=h,this.sourceLayerIndex=_,this.bucketIndex=v,this.tileID=w}}class kn{constructor(c){this.crossSourceCollisions=c,this.maxGroupID=0,this.collisionGroups={}}get(c){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[c]){const h=++this.maxGroupID;this.collisionGroups[c]={ID:h,predicate:_=>_.collisionGroupID===h}}return this.collisionGroups[c]}}function ii(m,c,h,_,v){const{horizontalAlign:w,verticalAlign:S}=o.getAnchorAlignment(m),I=-(w-.5)*c,z=-(S-.5)*h,F=o.evaluateVariableOffset(m,_);return new o.pointGeometry(I+F[0]*v,z+F[1]*v)}function Vr(m,c,h,_,v){const w=new o.pointGeometry(m,c);return h&&w._rotate(_?v:-v),w}class $i{constructor(c,h,_,v,w){this.transform=c.clone(),this.projection=c.projection.name,this.collisionIndex=new $e(this.transform,w),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=h,this.retainedQueryData={},this.collisionGroups=new kn(_),this.collisionCircleArrays={},this.prevPlacement=v,v&&(v.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(c,h,_,v){const w=_.getBucket(h),S=_.latestFeatureIndex;if(!w||!S||h.id!==w.layerIds[0])return;const I=w.layers[0].layout,z=_.collisionBoxArray,F=Math.pow(2,this.transform.zoom-_.tileID.overscaledZ),N=_.tileSize/o.EXTENT,q=_.tileID.toUnwrapped();this.transform.setProjection(w.projection);const Q=(it=_.tileID,rt=w.getProjection(),ot=this.transform,rt.name===this.projection?ot.calculateProjMatrix(it.toUnwrapped()):Re(ot,rt,it));var it,rt,ot;const at=I.get("text-pitch-alignment")==="map",K=I.get("text-rotation-alignment")==="map";h.compileFilter();const ht=h.dynamicFilter(),ut=h.dynamicFilterNeedsFeature(),mt=this.transform.calculatePixelsToTileUnitsMatrix(_),Tt=Yd(Q,_.tileID.canonical,at,K,this.transform,w.getProjection(),mt);let wt=null;if(at){const Vt=fs(Q,_.tileID.canonical,at,K,this.transform,w.getProjection(),mt);wt=o.multiply([],this.transform.labelPlaneMatrix,Vt)}let Mt=null;ht&&_.latestFeatureIndex&&(Mt={unwrappedTileID:q,dynamicFilter:ht,dynamicFilterNeedsFeature:ut,featureIndex:_.latestFeatureIndex}),this.retainedQueryData[w.bucketInstanceId]=new Ve(w.bucketInstanceId,S,w.sourceLayerIndex,w.index,_.tileID);const Ft={bucket:w,layout:I,posMatrix:Q,textLabelPlaneMatrix:Tt,labelToScreenMatrix:wt,clippingData:Mt,scale:F,textPixelRatio:N,holdingForFade:_.holdingForFade(),collisionBoxArray:z,partiallyEvaluatedTextSize:o.evaluateSizeForZoom(w.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:o.evaluateSizeForZoom(w.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(w.sourceID)};if(v)for(const Vt of w.sortKeyRanges){const{sortKey:Ht,symbolInstanceStart:ke,symbolInstanceEnd:Nt}=Vt;c.push({sortKey:Ht,symbolInstanceStart:ke,symbolInstanceEnd:Nt,parameters:Ft})}else c.push({symbolInstanceStart:0,symbolInstanceEnd:w.symbolInstances.length,parameters:Ft})}attemptAnchorPlacement(c,h,_,v,w,S,I,z,F,N,q,Q,it,rt,ot,at,K,ht){const{textOffset0:ut,textOffset1:mt,crossTileID:Tt}=Q,wt=[ut,mt],Mt=ii(c,_,v,wt,w),Ft=this.collisionIndex.placeCollisionBox(rt,w,h,Vr(Mt.x,Mt.y,S,I,this.transform.angle),q,z,F,N.predicate);if(at){const Vt=rt.getSymbolInstanceIconSize(ht,this.transform.zoom,Q.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(rt,Vt,at,Vr(Mt.x,Mt.y,S,I,this.transform.angle),q,z,F,N.predicate).box.length===0)return}if(Ft.box.length>0){let Vt;return this.prevPlacement&&this.prevPlacement.variableOffsets[Tt]&&this.prevPlacement.placements[Tt]&&this.prevPlacement.placements[Tt].text&&(Vt=this.prevPlacement.variableOffsets[Tt].anchor),this.variableOffsets[Tt]={textOffset:wt,width:_,height:v,anchor:c,textScale:w,prevAnchor:Vt},this.markUsedJustification(rt,c,Q,ot),rt.allowVerticalPlacement&&(this.markUsedOrientation(rt,ot,Q),this.placedOrientations[Tt]=ot),{shift:Mt,placedGlyphBoxes:Ft}}}placeLayerBucketPart(c,h,_,v){const{bucket:w,layout:S,posMatrix:I,textLabelPlaneMatrix:z,labelToScreenMatrix:F,clippingData:N,textPixelRatio:q,holdingForFade:Q,collisionBoxArray:it,partiallyEvaluatedTextSize:rt,partiallyEvaluatedIconSize:ot,collisionGroup:at}=c.parameters,K=S.get("text-optional"),ht=S.get("icon-optional"),ut=S.get("text-allow-overlap"),mt=S.get("icon-allow-overlap"),Tt=S.get("text-rotation-alignment")==="map",wt=S.get("text-pitch-alignment")==="map",Mt=S.get("icon-text-fit")!=="none",Ft=S.get("symbol-z-order")==="viewport-y";this.transform.setProjection(w.projection);let Vt=ut&&(mt||!w.hasIconData()||ht),Ht=mt&&(ut||!w.hasTextData()||K);!w.collisionArrays&&it&&w.deserializeCollisionBoxes(it),_&&v&&w.updateCollisionDebugBuffers(this.transform.zoom,it);const ke=(Nt,ne,Xt)=>{const{crossTileID:ue,numVerticalGlyphVertices:Gt}=Nt;if(N){const Fr={zoom:this.transform.zoom,pitch:this.transform.pitch};let Er=null;if(N.dynamicFilterNeedsFeature){const ir=this.retainedQueryData[w.bucketInstanceId];Er=N.featureIndex.loadFeature({featureIndex:Nt.featureIndex,bucketIndex:ir.bucketIndex,sourceLayerIndex:ir.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,N.dynamicFilter)(Fr,Er,this.retainedQueryData[w.bucketInstanceId].tileID.canonical,new o.pointGeometry(Nt.tileAnchorX,Nt.tileAnchorY),this.transform.calculateDistanceTileData(N.unwrappedTileID)))return this.placements[ue]=new Br(!1,!1,!1,!0),void(h[ue]=!0)}if(h[ue])return;if(Q)return void(this.placements[ue]=new Br(!1,!1,!1));let Ot=!1,Wt=!1,ie=!0,pe=!1,Je=!1,Pn=null,We={box:null,offscreen:null,occluded:null},je={box:null,offscreen:null,occluded:null},nn=null,Nn=null,sn=null,ar=0,yr=0,Mr=0;Xt.textFeatureIndex?ar=Xt.textFeatureIndex:Nt.useRuntimeCollisionCircles&&(ar=Nt.featureIndex),Xt.verticalTextFeatureIndex&&(yr=Xt.verticalTextFeatureIndex);const wr=Fr=>{Fr.tileID=this.retainedQueryData[w.bucketInstanceId].tileID;const Er=this.transform.elevation;(Er||Fr.elevation)&&(Fr.elevation=Er?Er.getAtTileOffset(Fr.tileID,Fr.tileAnchorX,Fr.tileAnchorY):0)},vi=Xt.textBox;if(vi){wr(vi);const Fr=ir=>{let si=o.WritingMode.horizontal;if(w.allowVerticalPlacement&&!ir&&this.prevPlacement){const ho=this.prevPlacement.placedOrientations[ue];ho&&(this.placedOrientations[ue]=ho,si=ho,this.markUsedOrientation(w,si,Nt))}return si},Er=(ir,si)=>{if(w.allowVerticalPlacement&&Gt>0&&Xt.verticalTextBox){for(const ho of w.writingModes)if(ho===o.WritingMode.vertical?(We=si(),je=We):We=ir(),We&&We.box&&We.box.length)break}else We=ir()};if(S.get("text-variable-anchor")){let ir=S.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[ue]){const zr=this.prevPlacement.variableOffsets[ue];ir.indexOf(zr.anchor)>0&&(ir=ir.filter(fo=>fo!==zr.anchor),ir.unshift(zr.anchor))}const si=(zr,fo,po)=>{const Js=w.getSymbolInstanceTextSize(rt,Nt,this.transform.zoom,ne),Fc=(zr.x2-zr.x1)*Js+2*zr.padding,Qo=(zr.y2-zr.y1)*Js+2*zr.padding,ua=Mt&&!mt?fo:null;ua&&wr(ua);let Ms={box:[],offscreen:!1,occluded:!1};const Qs=ut?2*ir.length:ir.length;for(let tl=0;tl<Qs;++tl){const Nc=this.attemptAnchorPlacement(ir[tl%ir.length],zr,Fc,Qo,Js,Tt,wt,q,I,at,tl>=ir.length,Nt,ne,w,po,ua,rt,ot);if(Nc&&(Ms=Nc.placedGlyphBoxes,Ms&&Ms.box&&Ms.box.length)){Ot=!0,Pn=Nc.shift;break}}return Ms};Er(()=>si(vi,Xt.iconBox,o.WritingMode.horizontal),()=>{const zr=Xt.verticalTextBox;return zr&&wr(zr),w.allowVerticalPlacement&&!(We&&We.box&&We.box.length)&&Gt>0&&zr?si(zr,Xt.verticalIconBox,o.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),We&&(Ot=We.box,ie=We.offscreen,pe=We.occluded);const ho=Fr(We&&We.box);if(!Ot&&this.prevPlacement){const zr=this.prevPlacement.variableOffsets[ue];zr&&(this.variableOffsets[ue]=zr,this.markUsedJustification(w,zr.anchor,Nt,ho))}}else{const ir=(si,ho)=>{const zr=w.getSymbolInstanceTextSize(rt,Nt,this.transform.zoom,ne),fo=this.collisionIndex.placeCollisionBox(w,zr,si,new o.pointGeometry(0,0),ut,q,I,at.predicate);return fo&&fo.box&&fo.box.length&&(this.markUsedOrientation(w,ho,Nt),this.placedOrientations[ue]=ho),fo};Er(()=>ir(vi,o.WritingMode.horizontal),()=>{const si=Xt.verticalTextBox;return w.allowVerticalPlacement&&Gt>0&&si?(wr(si),ir(si,o.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),Fr(We&&We.box&&We.box.length)}}if(nn=We,Ot=nn&&nn.box&&nn.box.length>0,ie=nn&&nn.offscreen,pe=nn&&nn.occluded,Nt.useRuntimeCollisionCircles){const Fr=w.text.placedSymbolArray.get(Nt.centerJustifiedTextSymbolIndex>=0?Nt.centerJustifiedTextSymbolIndex:Nt.verticalPlacedTextSymbolIndex),Er=o.evaluateSizeForFeature(w.textSizeData,rt,Fr),ir=S.get("text-padding");Nn=this.collisionIndex.placeCollisionCircles(w,ut,Fr,w.lineVertexArray,w.glyphOffsetArray,Er,I,z,F,_,wt,at.predicate,Nt.collisionCircleDiameter*Er/o.ONE_EM,ir,this.retainedQueryData[w.bucketInstanceId].tileID),Ot=ut||Nn.circles.length>0&&!Nn.collisionDetected,ie=ie&&Nn.offscreen,pe=Nn.occluded}if(Xt.iconFeatureIndex&&(Mr=Xt.iconFeatureIndex),Xt.iconBox){const Fr=Er=>{wr(Er);const ir=Mt&&Pn?Vr(Pn.x,Pn.y,Tt,wt,this.transform.angle):new o.pointGeometry(0,0),si=w.getSymbolInstanceIconSize(ot,this.transform.zoom,Nt.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(w,si,Er,ir,mt,q,I,at.predicate)};je&&je.box&&je.box.length&&Xt.verticalIconBox?(sn=Fr(Xt.verticalIconBox),Wt=sn.box.length>0):(sn=Fr(Xt.iconBox),Wt=sn.box.length>0),ie=ie&&sn.offscreen,Je=sn.occluded}const zo=K||Nt.numHorizontalGlyphVertices===0&&Gt===0,Ia=ht||Nt.numIconVertices===0;if(zo||Ia?Ia?zo||(Wt=Wt&&Ot):Ot=Wt&&Ot:Wt=Ot=Wt&&Ot,Ot&&nn&&nn.box&&this.collisionIndex.insertCollisionBox(nn.box,S.get("text-ignore-placement"),w.bucketInstanceId,je&&je.box&&yr?yr:ar,at.ID),Wt&&sn&&this.collisionIndex.insertCollisionBox(sn.box,S.get("icon-ignore-placement"),w.bucketInstanceId,Mr,at.ID),Nn&&(Ot&&this.collisionIndex.insertCollisionCircles(Nn.circles,S.get("text-ignore-placement"),w.bucketInstanceId,ar,at.ID),_)){const Fr=w.bucketInstanceId;let Er=this.collisionCircleArrays[Fr];Er===void 0&&(Er=this.collisionCircleArrays[Fr]=new le);for(let ir=0;ir<Nn.circles.length;ir+=4)Er.circles.push(Nn.circles[ir+0]),Er.circles.push(Nn.circles[ir+1]),Er.circles.push(Nn.circles[ir+2]),Er.circles.push(Nn.collisionDetected?1:0)}const Ss=w.projection.name!=="globe";Vt=Vt&&(Ss||!pe),Ht=Ht&&(Ss||!Je),this.placements[ue]=new Br(Ot||Vt,Wt||Ht,ie||w.justReloaded),h[ue]=!0};if(Ft){const Nt=w.getSortedSymbolIndexes(this.transform.angle);for(let ne=Nt.length-1;ne>=0;--ne){const Xt=Nt[ne];ke(w.symbolInstances.get(Xt),Xt,w.collisionArrays[Xt])}}else for(let Nt=c.symbolInstanceStart;Nt<c.symbolInstanceEnd;Nt++)ke(w.symbolInstances.get(Nt),Nt,w.collisionArrays[Nt]);if(_&&w.bucketInstanceId in this.collisionCircleArrays){const Nt=this.collisionCircleArrays[w.bucketInstanceId];o.invert(Nt.invProjMatrix,I),Nt.viewportMatrix=this.collisionIndex.getViewportMatrix()}w.justReloaded=!1}markUsedJustification(c,h,_,v){const{leftJustifiedTextSymbolIndex:w,centerJustifiedTextSymbolIndex:S,rightJustifiedTextSymbolIndex:I,verticalPlacedTextSymbolIndex:z,crossTileID:F}=_,N=o.getAnchorJustification(h),q=v===o.WritingMode.vertical?z:N==="left"?w:N==="center"?S:N==="right"?I:-1;w>=0&&(c.text.placedSymbolArray.get(w).crossTileID=q>=0&&w!==q?0:F),S>=0&&(c.text.placedSymbolArray.get(S).crossTileID=q>=0&&S!==q?0:F),I>=0&&(c.text.placedSymbolArray.get(I).crossTileID=q>=0&&I!==q?0:F),z>=0&&(c.text.placedSymbolArray.get(z).crossTileID=q>=0&&z!==q?0:F)}markUsedOrientation(c,h,_){const v=h===o.WritingMode.horizontal||h===o.WritingMode.horizontalOnly?h:0,w=h===o.WritingMode.vertical?h:0,{leftJustifiedTextSymbolIndex:S,centerJustifiedTextSymbolIndex:I,rightJustifiedTextSymbolIndex:z,verticalPlacedTextSymbolIndex:F}=_,N=c.text.placedSymbolArray;S>=0&&(N.get(S).placedOrientation=v),I>=0&&(N.get(I).placedOrientation=v),z>=0&&(N.get(z).placedOrientation=v),F>=0&&(N.get(F).placedOrientation=w)}commit(c){this.commitTime=c,this.zoomAtLastRecencyCheck=this.transform.zoom;const h=this.prevPlacement;let _=!1;this.prevZoomAdjustment=h?h.zoomAdjustment(this.transform.zoom):0;const v=h?h.symbolFadeChange(c):1,w=h?h.opacities:{},S=h?h.variableOffsets:{},I=h?h.placedOrientations:{};for(const z in this.placements){const F=this.placements[z],N=w[z];N?(this.opacities[z]=new Tn(N,v,F.text,F.icon,null,F.clipped),_=_||F.text!==N.text.placed||F.icon!==N.icon.placed):(this.opacities[z]=new Tn(null,v,F.text,F.icon,F.skipFade,F.clipped),_=_||F.text||F.icon)}for(const z in w){const F=w[z];if(!this.opacities[z]){const N=new Tn(F,v,!1,!1);N.isHidden()||(this.opacities[z]=N,_=_||F.text.placed||F.icon.placed)}}for(const z in S)this.variableOffsets[z]||!this.opacities[z]||this.opacities[z].isHidden()||(this.variableOffsets[z]=S[z]);for(const z in I)this.placedOrientations[z]||!this.opacities[z]||this.opacities[z].isHidden()||(this.placedOrientations[z]=I[z]);_?this.lastPlacementChangeTime=c:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=h?h.lastPlacementChangeTime:c)}updateLayerOpacities(c,h){const _={};for(const v of h){const w=v.getBucket(c);w&&v.latestFeatureIndex&&c.id===w.layerIds[0]&&this.updateBucketOpacities(w,_,v.collisionBoxArray)}}updateBucketOpacities(c,h,_){c.hasTextData()&&c.text.opacityVertexArray.clear(),c.hasIconData()&&c.icon.opacityVertexArray.clear(),c.hasIconCollisionBoxData()&&c.iconCollisionBox.collisionVertexArray.clear(),c.hasTextCollisionBoxData()&&c.textCollisionBox.collisionVertexArray.clear();const v=c.layers[0].layout,w=!!c.layers[0].dynamicFilter(),S=new Tn(null,0,!1,!1,!0),I=v.get("text-allow-overlap"),z=v.get("icon-allow-overlap"),F=v.get("text-variable-anchor"),N=v.get("text-rotation-alignment")==="map",q=v.get("text-pitch-alignment")==="map",Q=v.get("icon-text-fit")!=="none",it=new Tn(null,0,I&&(z||!c.hasIconData()||v.get("icon-optional")),z&&(I||!c.hasTextData()||v.get("text-optional")),!0);!c.collisionArrays&&_&&(c.hasIconCollisionBoxData()||c.hasTextCollisionBoxData())&&c.deserializeCollisionBoxes(_);const rt=(at,K,ht)=>{for(let ut=0;ut<K/4;ut++)at.opacityVertexArray.emplaceBack(ht)};let ot=0;for(let at=0;at<c.symbolInstances.length;at++){const K=c.symbolInstances.get(at),{numHorizontalGlyphVertices:ht,numVerticalGlyphVertices:ut,crossTileID:mt,numIconVertices:Tt}=K;let wt=this.opacities[mt];h[mt]?wt=S:wt||(wt=it,this.opacities[mt]=wt),h[mt]=!0;const Mt=ht>0||ut>0,Ft=Tt>0,Vt=this.placedOrientations[mt],Ht=Vt===o.WritingMode.vertical,ke=Vt===o.WritingMode.horizontal||Vt===o.WritingMode.horizontalOnly;if(!Mt&&!Ft||wt.isHidden()||ot++,Mt){const Nt=$s(wt.text);rt(c.text,ht,Ht?ps:Nt),rt(c.text,ut,ke?ps:Nt);const ne=wt.text.isHidden(),{leftJustifiedTextSymbolIndex:Xt,centerJustifiedTextSymbolIndex:ue,rightJustifiedTextSymbolIndex:Gt,verticalPlacedTextSymbolIndex:Ot}=K,Wt=c.text.placedSymbolArray,ie=ne||Ht?1:0;Xt>=0&&(Wt.get(Xt).hidden=ie),ue>=0&&(Wt.get(ue).hidden=ie),Gt>=0&&(Wt.get(Gt).hidden=ie),Ot>=0&&(Wt.get(Ot).hidden=ne||ke?1:0);const pe=this.variableOffsets[mt];pe&&this.markUsedJustification(c,pe.anchor,K,Vt);const Je=this.placedOrientations[mt];Je&&(this.markUsedJustification(c,"left",K,Je),this.markUsedOrientation(c,Je,K))}if(Ft){const Nt=$s(wt.icon),{placedIconSymbolIndex:ne,verticalPlacedIconSymbolIndex:Xt}=K,ue=c.icon.placedSymbolArray,Gt=wt.icon.isHidden()?1:0;ne>=0&&(rt(c.icon,Tt,Ht?ps:Nt),ue.get(ne).hidden=Gt),Xt>=0&&(rt(c.icon,K.numVerticalIconVertices,ke?ps:Nt),ue.get(Xt).hidden=Gt)}if(c.hasIconCollisionBoxData()||c.hasTextCollisionBoxData()){const Nt=c.collisionArrays[at];if(Nt){let ne=new o.pointGeometry(0,0),Xt=!0;if(Nt.textBox||Nt.verticalTextBox){if(F){const Gt=this.variableOffsets[mt];Gt?(ne=ii(Gt.anchor,Gt.width,Gt.height,Gt.textOffset,Gt.textScale),N&&ne._rotate(q?this.transform.angle:-this.transform.angle)):Xt=!1}w&&(Xt=!wt.clipped),Nt.textBox&&Ji(c.textCollisionBox.collisionVertexArray,wt.text.placed,!Xt||Ht,ne.x,ne.y),Nt.verticalTextBox&&Ji(c.textCollisionBox.collisionVertexArray,wt.text.placed,!Xt||ke,ne.x,ne.y)}const ue=Xt&&Boolean(!ke&&Nt.verticalIconBox);Nt.iconBox&&Ji(c.iconCollisionBox.collisionVertexArray,wt.icon.placed,ue,Q?ne.x:0,Q?ne.y:0),Nt.verticalIconBox&&Ji(c.iconCollisionBox.collisionVertexArray,wt.icon.placed,!ue,Q?ne.x:0,Q?ne.y:0)}}}if(c.fullyClipped=ot===0,c.sortFeatures(this.transform.angle),this.retainedQueryData[c.bucketInstanceId]&&(this.retainedQueryData[c.bucketInstanceId].featureSortOrder=c.featureSortOrder),c.hasTextData()&&c.text.opacityVertexBuffer&&c.text.opacityVertexBuffer.updateData(c.text.opacityVertexArray),c.hasIconData()&&c.icon.opacityVertexBuffer&&c.icon.opacityVertexBuffer.updateData(c.icon.opacityVertexArray),c.hasIconCollisionBoxData()&&c.iconCollisionBox.collisionVertexBuffer&&c.iconCollisionBox.collisionVertexBuffer.updateData(c.iconCollisionBox.collisionVertexArray),c.hasTextCollisionBoxData()&&c.textCollisionBox.collisionVertexBuffer&&c.textCollisionBox.collisionVertexBuffer.updateData(c.textCollisionBox.collisionVertexArray),c.bucketInstanceId in this.collisionCircleArrays){const at=this.collisionCircleArrays[c.bucketInstanceId];c.placementInvProjMatrix=at.invProjMatrix,c.placementViewportMatrix=at.viewportMatrix,c.collisionCircleArray=at.circles,delete this.collisionCircleArrays[c.bucketInstanceId]}}symbolFadeChange(c){return this.fadeDuration===0?1:(c-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(c){return Math.max(0,(this.transform.zoom-c)/1.5)}hasTransitions(c){return this.stale||c-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(c,h){const _=this.zoomAtLastRecencyCheck===h?1-this.zoomAdjustment(h):1;return this.zoomAtLastRecencyCheck=h,this.commitTime+this.fadeDuration*_>c}setStale(){this.stale=!0}}function Ji(m,c,h,_,v){m.emplaceBack(c?1:0,h?1:0,_||0,v||0),m.emplaceBack(c?1:0,h?1:0,_||0,v||0),m.emplaceBack(c?1:0,h?1:0,_||0,v||0),m.emplaceBack(c?1:0,h?1:0,_||0,v||0)}const Lr=Math.pow(2,25),Tl=Math.pow(2,24),fi=Math.pow(2,17),Eo=Math.pow(2,16),_c=Math.pow(2,9),Us=Math.pow(2,8),ki=Math.pow(2,1);function $s(m){if(m.opacity===0&&!m.placed)return 0;if(m.opacity===1&&m.placed)return 4294967295;const c=m.placed?1:0,h=Math.floor(127*m.opacity);return h*Lr+c*Tl+h*fi+c*Eo+h*_c+c*Us+h*ki+c}const ps=0;class oa{constructor(c){this._sortAcrossTiles=c.layout.get("symbol-z-order")!=="viewport-y"&&c.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(c,h,_,v,w){const S=this._bucketParts;for(;this._currentTileIndex<c.length;)if(h.getBucketParts(S,v,c[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,w())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,S.sort((I,z)=>I.sortKey-z.sortKey));this._currentPartIndex<S.length;){const I=S[this._currentPartIndex];if(h.placeLayerBucketPart(I,this._seenCrossTileIDs,_,I.symbolInstanceStart===0),this._currentPartIndex++,w())return!0}return!1}}class kl{constructor(c,h,_,v,w,S,I,z){this.placement=new $i(c,w,S,I,z),this._currentPlacementIndex=h.length-1,this._forceFullPlacement=_,this._showCollisionBoxes=v,this._done=!1}isDone(){return this._done}continuePlacement(c,h,_){const v=o.exported.now(),w=()=>{const S=o.exported.now()-v;return!this._forceFullPlacement&&S>2};for(;this._currentPlacementIndex>=0;){const S=h[c[this._currentPlacementIndex]],I=this.placement.collisionIndex.transform.zoom;if(S.type==="symbol"&&(!S.minzoom||S.minzoom<=I)&&(!S.maxzoom||S.maxzoom>I)){if(this._inProgressLayer||(this._inProgressLayer=new oa(S)),this._inProgressLayer.continuePlacement(_[S.source],this.placement,this._showCollisionBoxes,S,w))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(c){return this.placement.commit(c),this.placement}}const yc=512/o.EXTENT/2;class Tf{constructor(c,h,_){this.tileID=c,this.indexedSymbolInstances={},this.bucketInstanceId=_;for(let v=0;v<h.length;v++){const w=h.get(v),S=w.key;this.indexedSymbolInstances[S]||(this.indexedSymbolInstances[S]=[]),this.indexedSymbolInstances[S].push({crossTileID:w.crossTileID,coord:this.getScaledCoordinates(w,c)})}}getScaledCoordinates(c,h){const _=yc/Math.pow(2,h.canonical.z-this.tileID.canonical.z);return{x:Math.floor((h.canonical.x*o.EXTENT+c.tileAnchorX)*_),y:Math.floor((h.canonical.y*o.EXTENT+c.tileAnchorY)*_)}}findMatches(c,h,_){const v=this.tileID.canonical.z<h.canonical.z?1:Math.pow(2,this.tileID.canonical.z-h.canonical.z);for(let w=0;w<c.length;w++){const S=c.get(w);if(S.crossTileID)continue;const I=this.indexedSymbolInstances[S.key];if(!I)continue;const z=this.getScaledCoordinates(S,h);for(const F of I)if(Math.abs(F.coord.x-z.x)<=v&&Math.abs(F.coord.y-z.y)<=v&&!_[F.crossTileID]){_[F.crossTileID]=!0,S.crossTileID=F.crossTileID;break}}}}class bc{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class ms{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(c){const h=Math.round((c-this.lng)/360);if(h!==0)for(const _ in this.indexes){const v=this.indexes[_],w={};for(const S in v){const I=v[S];I.tileID=I.tileID.unwrapTo(I.tileID.wrap+h),w[I.tileID.key]=I}this.indexes[_]=w}this.lng=c}addBucket(c,h,_){if(this.indexes[c.overscaledZ]&&this.indexes[c.overscaledZ][c.key]){if(this.indexes[c.overscaledZ][c.key].bucketInstanceId===h.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(c.overscaledZ,this.indexes[c.overscaledZ][c.key])}for(let w=0;w<h.symbolInstances.length;w++)h.symbolInstances.get(w).crossTileID=0;this.usedCrossTileIDs[c.overscaledZ]||(this.usedCrossTileIDs[c.overscaledZ]={});const v=this.usedCrossTileIDs[c.overscaledZ];for(const w in this.indexes){const S=this.indexes[w];if(Number(w)>c.overscaledZ)for(const I in S){const z=S[I];z.tileID.isChildOf(c)&&z.findMatches(h.symbolInstances,c,v)}else{const I=S[c.scaledTo(Number(w)).key];I&&I.findMatches(h.symbolInstances,c,v)}}for(let w=0;w<h.symbolInstances.length;w++){const S=h.symbolInstances.get(w);S.crossTileID||(S.crossTileID=_.generate(),v[S.crossTileID]=!0)}return this.indexes[c.overscaledZ]===void 0&&(this.indexes[c.overscaledZ]={}),this.indexes[c.overscaledZ][c.key]=new Tf(c,h.symbolInstances,h.bucketInstanceId),!0}removeBucketCrossTileIDs(c,h){for(const _ in h.indexedSymbolInstances)for(const v of h.indexedSymbolInstances[_])delete this.usedCrossTileIDs[c][v.crossTileID]}removeStaleBuckets(c){let h=!1;for(const _ in this.indexes){const v=this.indexes[_];for(const w in v)c[v[w].bucketInstanceId]||(this.removeBucketCrossTileIDs(_,v[w]),delete v[w],h=!0)}return h}}class Lu{constructor(){this.layerIndexes={},this.crossTileIDs=new bc,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(c,h,_,v){let w=this.layerIndexes[c.id];w===void 0&&(w=this.layerIndexes[c.id]=new ms);let S=!1;const I={};v.name!=="globe"&&w.handleWrapJump(_);for(const z of h){const F=z.getBucket(c);F&&c.id===F.layerIds[0]&&(F.bucketInstanceId||(F.bucketInstanceId=++this.maxBucketInstanceId),w.addBucket(z.tileID,F,this.crossTileIDs)&&(S=!0),I[F.bucketInstanceId]=!0)}return w.removeStaleBuckets(I)&&(S=!0),S}pruneUnusedLayers(c){const h={};c.forEach(_=>{h[_]=!0});for(const _ in this.layerIndexes)h[_]||delete this.layerIndexes[_]}}const Cl=(m,c)=>o.emitValidationErrors(m,c&&c.filter(h=>h.identifier!=="source.canvas")),Vs=o.pick(hn,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),Xo=o.pick(hn,["setCenter","setZoom","setBearing","setPitch"]),Gs={version:8,layers:[],sources:{}},Ta={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class oi extends o.Evented{constructor(c,h={}){super(),this.map=c,this.dispatcher=new Zn(dn(),this),this.imageManager=new ge,this.imageManager.setEventedParent(this),this.glyphManager=new o.GlyphManager(c._requestManager,h.localFontFamily?o.LocalGlyphMode.all:h.localIdeographFontFamily?o.LocalGlyphMode.ideographs:o.LocalGlyphMode.none,h.localFontFamily||h.localIdeographFontFamily),this.crossTileSymbolIndex=new Lu,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",o.getReferrer());const _=this;this._rtlTextPluginCallback=oi.registerForPluginStateChange(v=>{_.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:v.pluginStatus,pluginURL:v.pluginURL},(w,S)=>{if(o.triggerPluginCompletionEvent(w),S&&S.every(I=>I))for(const I in _._sourceCaches){const z=_._sourceCaches[I],F=z.getSource().type;F!=="vector"&&F!=="geojson"||z.reload()}})}),this.on("data",v=>{if(v.dataType!=="source"||v.sourceDataType!=="metadata")return;const w=this.getSource(v.sourceId);if(w&&w.vectorLayerIds)for(const S in this._layers){const I=this._layers[S];I.source===w.id&&this._validateLayer(I)}})}loadURL(c,h={}){this.fire(new o.Event("dataloading",{dataType:"style"}));const _=typeof h.validate=="boolean"?h.validate:!o.isMapboxURL(c);c=this.map._requestManager.normalizeStyleURL(c,h.accessToken);const v=this.map._requestManager.transformRequest(c,o.ResourceType.Style);this._request=o.getJSON(v,(w,S)=>{this._request=null,w?this.fire(new o.ErrorEvent(w)):S&&this._load(S,_)})}loadJSON(c,h={}){this.fire(new o.Event("dataloading",{dataType:"style"})),this._request=o.exported.frame(()=>{this._request=null,this._load(c,h.validate!==!1)})}loadEmpty(){this.fire(new o.Event("dataloading",{dataType:"style"})),this._load(Gs,!1)}_updateLayerCount(c,h){const _=h?1:-1;c.is3D()&&(this._num3DLayers+=_),c.type==="circle"&&(this._numCircleLayers+=_),c.type==="symbol"&&(this._numSymbolLayers+=_)}_load(c,h){if(h&&Cl(this,o.validateStyle(c)))return;this._loaded=!0,this.stylesheet=o.clone$1(c),this._updateMapProjection();for(const v in c.sources)this.addSource(v,c.sources[v],{validate:!1});this._changed=!1,c.sprite?this._loadSprite(c.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(c.glyphs);const _=tr(this.stylesheet.layers);this._order=_.map(v=>v.id),this._layers={},this._serializedLayers={};for(let v of _)v=o.createStyleLayer(v),v.setEventedParent(this,{layer:{id:v.id}}),this._layers[v.id]=v,this._serializedLayers[v.id]=v.serialize(),this._updateLayerCount(v,!0);this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Ae(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new o.Event("data",{dataType:"style"})),this.fire(new o.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}setProjection(c){c?this.stylesheet.projection=c:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(c){this._spriteRequest=function(h,_,v){let w,S,I;const z=o.exported.devicePixelRatio>1?"@2x":"";let F=o.getJSON(_.transformRequest(_.normalizeSpriteURL(h,z,".json"),o.ResourceType.SpriteJSON),(Q,it)=>{F=null,I||(I=Q,w=it,q())}),N=o.getImage(_.transformRequest(_.normalizeSpriteURL(h,z,".png"),o.ResourceType.SpriteImage),(Q,it)=>{N=null,I||(I=Q,S=it,q())});function q(){if(I)v(I);else if(w&&S){const Q=o.exported.getImageData(S),it={};for(const rt in w){const{width:ot,height:at,x:K,y:ht,sdf:ut,pixelRatio:mt,stretchX:Tt,stretchY:wt,content:Mt}=w[rt],Ft=new o.RGBAImage({width:ot,height:at});o.RGBAImage.copy(Q,Ft,{x:K,y:ht},{x:0,y:0},{width:ot,height:at}),it[rt]={data:Ft,pixelRatio:mt,sdf:ut,stretchX:Tt,stretchY:wt,content:Mt}}v(null,it)}}return{cancel(){F&&(F.cancel(),F=null),N&&(N.cancel(),N=null)}}}(c,this.map._requestManager,(h,_)=>{if(this._spriteRequest=null,h)this.fire(new o.ErrorEvent(h));else if(_)for(const v in _)this.imageManager.addImage(v,_[v]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new o.Event("data",{dataType:"style"}))})}_validateLayer(c){const h=this.getSource(c.source);if(!h)return;const _=c.sourceLayer;_&&(h.type==="geojson"||h.vectorLayerIds&&h.vectorLayerIds.indexOf(_)===-1)&&this.fire(new o.ErrorEvent(new Error(`Source layer "${_}" does not exist on source "${h.id}" as specified by style layer "${c.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const c in this._sourceCaches)if(!this._sourceCaches[c].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(c){const h=[];for(const _ of c){const v=this._layers[_];v.type!=="custom"&&h.push(v.serialize())}return h}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const c in this._sourceCaches)if(this._sourceCaches[c].hasTransition())return!0;for(const c in this._layers)if(this._layers[c].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(c){return!!this.terrain&&(typeof c.isLayerDraped=="function"?c.isLayerDraped():Ta[c.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(c){if(!this._loaded)return;const h=this._changed;if(this._changed){const v=Object.keys(this._updatedLayers),w=Object.keys(this._removedLayers);(v.length||w.length)&&this._updateWorkerLayers(v,w);for(const S in this._updatedSources){const I=this._updatedSources[S];I==="reload"?this._reloadSource(S):I==="clear"&&this._clearSource(S)}this._updateTilesForChangedImages();for(const S in this._updatedPaintProps)this._layers[S].updateTransitions(c);this.light.updateTransitions(c),this.fog&&this.fog.updateTransitions(c),this._resetUpdates()}const _={};for(const v in this._sourceCaches){const w=this._sourceCaches[v];_[v]=w.used,w.used=!1}for(const v of this._order){const w=this._layers[v];if(w.recalculate(c,this._availableImages),!w.isHidden(c.zoom)){const I=this._getLayerSourceCache(w);I&&(I.used=!0)}const S=this.map.painter;if(S){const I=w.getProgramIds();if(!I)continue;const z=w.getProgramConfiguration(c.zoom);for(const F of I)S.useProgram(F,z)}}for(const v in _){const w=this._sourceCaches[v];_[v]!==w.used&&w.getSource().fire(new o.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:w.getSource().id}))}this.light.recalculate(c),this.terrain&&this.terrain.recalculate(c),this.fog&&this.fog.recalculate(c),this.z=c.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),h&&this.fire(new o.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const c=Object.keys(this._changedImages);if(c.length){for(const h in this._sourceCaches)this._sourceCaches[h].reloadTilesForDependencies(["icons","patterns"],c);this._changedImages={}}}_updateWorkerLayers(c,h){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(c),removedIds:h})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(c){if(this._checkLoaded(),Cl(this,o.validateStyle(c)))return!1;(c=o.clone$1(c)).layers=tr(c.layers);const h=function(v,w){if(!v)return[{command:hn.setStyle,args:[w]}];let S=[];try{if(!y(v.version,w.version))return[{command:hn.setStyle,args:[w]}];y(v.center,w.center)||S.push({command:hn.setCenter,args:[w.center]}),y(v.zoom,w.zoom)||S.push({command:hn.setZoom,args:[w.zoom]}),y(v.bearing,w.bearing)||S.push({command:hn.setBearing,args:[w.bearing]}),y(v.pitch,w.pitch)||S.push({command:hn.setPitch,args:[w.pitch]}),y(v.sprite,w.sprite)||S.push({command:hn.setSprite,args:[w.sprite]}),y(v.glyphs,w.glyphs)||S.push({command:hn.setGlyphs,args:[w.glyphs]}),y(v.transition,w.transition)||S.push({command:hn.setTransition,args:[w.transition]}),y(v.light,w.light)||S.push({command:hn.setLight,args:[w.light]}),y(v.fog,w.fog)||S.push({command:hn.setFog,args:[w.fog]}),y(v.projection,w.projection)||S.push({command:hn.setProjection,args:[w.projection]});const I={},z=[];(function(q,Q,it,rt){let ot;for(ot in Q=Q||{},q=q||{})q.hasOwnProperty(ot)&&(Q.hasOwnProperty(ot)||Fn(ot,it,rt));for(ot in Q)Q.hasOwnProperty(ot)&&(q.hasOwnProperty(ot)?y(q[ot],Q[ot])||(q[ot].type==="geojson"&&Q[ot].type==="geojson"&&Ki(q,Q,ot)?it.push({command:hn.setGeoJSONSourceData,args:[ot,Q[ot].data]}):Wo(ot,Q,it,rt)):qn(ot,Q,it))})(v.sources,w.sources,z,I);const F=[];v.layers&&v.layers.forEach(q=>{q.source&&I[q.source]?S.push({command:hn.removeLayer,args:[q.id]}):F.push(q)});let N=v.terrain;N&&I[N.source]&&(S.push({command:hn.setTerrain,args:[void 0]}),N=void 0),S=S.concat(z),y(N,w.terrain)||S.push({command:hn.setTerrain,args:[w.terrain]}),function(q,Q,it){Q=Q||[];const rt=(q=q||[]).map(ia),ot=Q.map(ia),at=q.reduce(ri,{}),K=Q.reduce(ri,{}),ht=rt.slice(),ut=Object.create(null);let mt,Tt,wt,Mt,Ft,Vt,Ht;for(mt=0,Tt=0;mt<rt.length;mt++)wt=rt[mt],K.hasOwnProperty(wt)?Tt++:(it.push({command:hn.removeLayer,args:[wt]}),ht.splice(ht.indexOf(wt,Tt),1));for(mt=0,Tt=0;mt<ot.length;mt++)wt=ot[ot.length-1-mt],ht[ht.length-1-mt]!==wt&&(at.hasOwnProperty(wt)?(it.push({command:hn.removeLayer,args:[wt]}),ht.splice(ht.lastIndexOf(wt,ht.length-Tt),1)):Tt++,Vt=ht[ht.length-mt],it.push({command:hn.addLayer,args:[K[wt],Vt]}),ht.splice(ht.length-mt,0,wt),ut[wt]=!0);for(mt=0;mt<ot.length;mt++)if(wt=ot[mt],Mt=at[wt],Ft=K[wt],!ut[wt]&&!y(Mt,Ft))if(y(Mt.source,Ft.source)&&y(Mt["source-layer"],Ft["source-layer"])&&y(Mt.type,Ft.type)){for(Ht in Kt(Mt.layout,Ft.layout,it,wt,null,hn.setLayoutProperty),Kt(Mt.paint,Ft.paint,it,wt,null,hn.setPaintProperty),y(Mt.filter,Ft.filter)||it.push({command:hn.setFilter,args:[wt,Ft.filter]}),y(Mt.minzoom,Ft.minzoom)&&y(Mt.maxzoom,Ft.maxzoom)||it.push({command:hn.setLayerZoomRange,args:[wt,Ft.minzoom,Ft.maxzoom]}),Mt)Mt.hasOwnProperty(Ht)&&Ht!=="layout"&&Ht!=="paint"&&Ht!=="filter"&&Ht!=="metadata"&&Ht!=="minzoom"&&Ht!=="maxzoom"&&(Ht.indexOf("paint.")===0?Kt(Mt[Ht],Ft[Ht],it,wt,Ht.slice(6),hn.setPaintProperty):y(Mt[Ht],Ft[Ht])||it.push({command:hn.setLayerProperty,args:[wt,Ht,Ft[Ht]]}));for(Ht in Ft)Ft.hasOwnProperty(Ht)&&!Mt.hasOwnProperty(Ht)&&Ht!=="layout"&&Ht!=="paint"&&Ht!=="filter"&&Ht!=="metadata"&&Ht!=="minzoom"&&Ht!=="maxzoom"&&(Ht.indexOf("paint.")===0?Kt(Mt[Ht],Ft[Ht],it,wt,Ht.slice(6),hn.setPaintProperty):y(Mt[Ht],Ft[Ht])||it.push({command:hn.setLayerProperty,args:[wt,Ht,Ft[Ht]]}))}else it.push({command:hn.removeLayer,args:[wt]}),Vt=ht[ht.lastIndexOf(wt)+1],it.push({command:hn.addLayer,args:[Ft,Vt]})}(F,w.layers,S)}catch(I){console.warn("Unable to compute style diff:",I),S=[{command:hn.setStyle,args:[w]}]}return S}(this.serialize(),c).filter(v=>!(v.command in Xo));if(h.length===0)return!1;const _=h.filter(v=>!(v.command in Vs));if(_.length>0)throw new Error(`Unimplemented: ${_.map(v=>v.command).join(", ")}.`);return h.forEach(v=>{v.command!=="setTransition"&&v.command!=="setProjection"&&this[v.command].apply(this,v.args)}),this.stylesheet=c,this._updateMapProjection(),!0}addImage(c,h){return this.getImage(c)?this.fire(new o.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(c,h),this._afterImageUpdated(c),this)}updateImage(c,h){this.imageManager.updateImage(c,h)}getImage(c){return this.imageManager.getImage(c)}removeImage(c){return this.getImage(c)?(this.imageManager.removeImage(c),this._afterImageUpdated(c),this):this.fire(new o.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(c){this._availableImages=this.imageManager.listImages(),this._changedImages[c]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new o.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(c,h,_={}){if(this._checkLoaded(),this.getSource(c)!==void 0)throw new Error("There is already a source with this ID");if(!h.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(h).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(h.type)>=0&&this._validate(o.validateSource,`sources.${c}`,h,null,_))return;this.map&&this.map._collectResourceTiming&&(h.collectResourceTiming=!0);const v=Lt(c,h,this.dispatcher,this);v.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(c),source:v.serialize(),sourceId:c}));const w=S=>{const I=(S?"symbol:":"other:")+c,z=this._sourceCaches[I]=new o.SourceCache(I,v,S);(S?this._symbolSourceCaches:this._otherSourceCaches)[c]=z,z.style=this,z.onAdd(this.map)};w(!1),h.type!=="vector"&&h.type!=="geojson"||w(!0),v.onAdd&&v.onAdd(this.map),this._changed=!0}removeSource(c){this._checkLoaded();const h=this.getSource(c);if(!h)throw new Error("There is no source with this ID");for(const v in this._layers)if(this._layers[v].source===c)return this.fire(new o.ErrorEvent(new Error(`Source "${c}" cannot be removed while layer "${v}" is using it.`)));if(this.terrain&&this.terrain.get().source===c)return this.fire(new o.ErrorEvent(new Error(`Source "${c}" cannot be removed while terrain is using it.`)));const _=this._getSourceCaches(c);for(const v of _)delete this._sourceCaches[v.id],delete this._updatedSources[v.id],v.fire(new o.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:v.getSource().id})),v.setEventedParent(null),v.clearTiles();return delete this._otherSourceCaches[c],delete this._symbolSourceCaches[c],h.setEventedParent(null),h.onRemove&&h.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(c,h){this._checkLoaded(),this.getSource(c).setData(h),this._changed=!0}getSource(c){const h=this._getSourceCache(c);return h&&h.getSource()}_getSources(){const c=[];for(const h in this._otherSourceCaches){const _=this._getSourceCache(h);_&&c.push(_.getSource())}return c}addLayer(c,h,_={}){this._checkLoaded();const v=c.id;if(this.getLayer(v))return void this.fire(new o.ErrorEvent(new Error(`Layer with id "${v}" already exists on this map`)));let w;if(c.type==="custom"){if(Cl(this,o.validateCustomStyleLayer(c)))return;w=o.createStyleLayer(c)}else{if(typeof c.source=="object"&&(this.addSource(v,c.source),c=o.clone$1(c),c=o.extend(c,{source:v})),this._validate(o.validateLayer,`layers.${v}`,c,{arrayIndex:-1},_))return;w=o.createStyleLayer(c),this._validateLayer(w),w.setEventedParent(this,{layer:{id:v}}),this._serializedLayers[w.id]=w.serialize(),this._updateLayerCount(w,!0)}const S=h?this._order.indexOf(h):this._order.length;if(h&&S===-1)return void this.fire(new o.ErrorEvent(new Error(`Layer with id "${h}" does not exist on this map.`)));this._order.splice(S,0,v),this._layerOrderChanged=!0,this._layers[v]=w;const I=this._getLayerSourceCache(w);if(this._removedLayers[v]&&w.source&&I&&w.type!=="custom"){const z=this._removedLayers[v];delete this._removedLayers[v],z.type!==w.type?this._updatedSources[w.source]="clear":(this._updatedSources[w.source]="reload",I.pause())}this._updateLayer(w),w.onAdd&&w.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(c,h){if(this._checkLoaded(),this._changed=!0,!this._layers[c])return void this.fire(new o.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot be moved.`)));if(c===h)return;const _=this._order.indexOf(c);this._order.splice(_,1);const v=h?this._order.indexOf(h):this._order.length;h&&v===-1?this.fire(new o.ErrorEvent(new Error(`Layer with id "${h}" does not exist on this map.`))):(this._order.splice(v,0,c),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(c){this._checkLoaded();const h=this._layers[c];if(!h)return void this.fire(new o.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot be removed.`)));h.setEventedParent(null),this._updateLayerCount(h,!1);const _=this._order.indexOf(c);this._order.splice(_,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[c]=h,delete this._layers[c],delete this._serializedLayers[c],delete this._updatedLayers[c],delete this._updatedPaintProps[c],h.onRemove&&h.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(c){return this._layers[c]}hasLayer(c){return c in this._layers}hasLayerType(c){for(const h in this._layers)if(this._layers[h].type===c)return!0;return!1}setLayerZoomRange(c,h,_){this._checkLoaded();const v=this.getLayer(c);v?v.minzoom===h&&v.maxzoom===_||(h!=null&&(v.minzoom=h),_!=null&&(v.maxzoom=_),this._updateLayer(v)):this.fire(new o.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(c,h,_={}){this._checkLoaded();const v=this.getLayer(c);if(v){if(!y(v.filter,h))return h==null?(v.filter=void 0,void this._updateLayer(v)):void(this._validate(o.validateFilter,`layers.${v.id}.filter`,h,{layerType:v.type},_)||(v.filter=o.clone$1(h),this._updateLayer(v)))}else this.fire(new o.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot be filtered.`)))}getFilter(c){const h=this.getLayer(c);return h&&o.clone$1(h.filter)}setLayoutProperty(c,h,_,v={}){this._checkLoaded();const w=this.getLayer(c);w?y(w.getLayoutProperty(h),_)||(w.setLayoutProperty(h,_,v),this._updateLayer(w)):this.fire(new o.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(c,h){const _=this.getLayer(c);if(_)return _.getLayoutProperty(h);this.fire(new o.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style.`)))}setPaintProperty(c,h,_,v={}){this._checkLoaded();const w=this.getLayer(c);w?y(w.getPaintProperty(h),_)||(w.setPaintProperty(h,_,v)&&this._updateLayer(w),this._changed=!0,this._updatedPaintProps[c]=!0):this.fire(new o.ErrorEvent(new Error(`The layer '${c}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(c,h){const _=this.getLayer(c);return _&&_.getPaintProperty(h)}setFeatureState(c,h){this._checkLoaded();const _=c.source,v=c.sourceLayer,w=this.getSource(_);if(!w)return void this.fire(new o.ErrorEvent(new Error(`The source '${_}' does not exist in the map's style.`)));const S=w.type;if(S==="geojson"&&v)return void this.fire(new o.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(S==="vector"&&!v)return void this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));c.id===void 0&&this.fire(new o.ErrorEvent(new Error("The feature id parameter must be provided.")));const I=this._getSourceCaches(_);for(const z of I)z.setFeatureState(v,c.id,h)}removeFeatureState(c,h){this._checkLoaded();const _=c.source,v=this.getSource(_);if(!v)return void this.fire(new o.ErrorEvent(new Error(`The source '${_}' does not exist in the map's style.`)));const w=v.type,S=w==="vector"?c.sourceLayer:void 0;if(w==="vector"&&!S)return void this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(h&&typeof c.id!="string"&&typeof c.id!="number")return void this.fire(new o.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const I=this._getSourceCaches(_);for(const z of I)z.removeFeatureState(S,c.id,h)}getFeatureState(c){this._checkLoaded();const h=c.source,_=c.sourceLayer,v=this.getSource(h);if(v){if(v.type!=="vector"||_)return c.id===void 0&&this.fire(new o.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(h)[0].getFeatureState(_,c.id);this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new o.ErrorEvent(new Error(`The source '${h}' does not exist in the map's style.`)))}getTransition(){return o.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const c={};for(const h in this._sourceCaches){const _=this._sourceCaches[h].getSource();c[_.id]||(c[_.id]=_.serialize())}return o.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:c,layers:this._serializeLayers(this._order)},h=>h!==void 0)}_updateLayer(c){this._updatedLayers[c.id]=!0;const h=this._getLayerSourceCache(c);c.source&&!this._updatedSources[c.source]&&h&&h.getSource().type!=="raster"&&(this._updatedSources[c.source]="reload",h.pause()),this._changed=!0,c.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(c){const h=S=>this._layers[S].type==="fill-extrusion",_={},v=[];for(let S=this._order.length-1;S>=0;S--){const I=this._order[S];if(h(I)){_[I]=S;for(const z of c){const F=z[I];if(F)for(const N of F)v.push(N)}}}v.sort((S,I)=>I.intersectionZ-S.intersectionZ);const w=[];for(let S=this._order.length-1;S>=0;S--){const I=this._order[S];if(h(I))for(let z=v.length-1;z>=0;z--){const F=v[z].feature;if(_[F.layer.id]<S)break;w.push(F),v.pop()}else for(const z of c){const F=z[I];if(F)for(const N of F)w.push(N.feature)}}return w}queryRenderedFeatures(c,h,_){h&&h.filter&&this._validate(o.validateFilter,"queryRenderedFeatures.filter",h.filter,null,h);const v={};if(h&&h.layers){if(!Array.isArray(h.layers))return this.fire(new o.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const z of h.layers){const F=this._layers[z];if(!F)return this.fire(new o.ErrorEvent(new Error(`The layer '${z}' does not exist in the map's style and cannot be queried for features.`))),[];v[F.source]=!0}}const w=[];h.availableImages=this._availableImages;const S=h&&h.layers?h.layers.some(z=>{const F=this.getLayer(z);return F&&F.is3D()}):this.has3DLayers(),I=he.createFromScreenPoints(c,_);for(const z in this._sourceCaches){const F=this._sourceCaches[z].getSource().id;h.layers&&!v[F]||w.push(Ut(this._sourceCaches[z],this._layers,this._serializedLayers,I,h,_,S,!!this.map._showQueryGeometry))}return this.placement&&w.push(function(z,F,N,q,Q,it,rt){const ot={},at=it.queryRenderedSymbols(q),K=[];for(const ht of Object.keys(at).map(Number))K.push(rt[ht]);K.sort(Oe);for(const ht of K){const ut=ht.featureIndex.lookupSymbolFeatures(at[ht.bucketInstanceId],F,ht.bucketIndex,ht.sourceLayerIndex,Q.filter,Q.layers,Q.availableImages,z);for(const mt in ut){const Tt=ot[mt]=ot[mt]||[],wt=ut[mt];wt.sort((Mt,Ft)=>{const Vt=ht.featureSortOrder;if(Vt){const Ht=Vt.indexOf(Mt.featureIndex);return Vt.indexOf(Ft.featureIndex)-Ht}return Ft.featureIndex-Mt.featureIndex});for(const Mt of wt)Tt.push(Mt)}}for(const ht in ot)ot[ht].forEach(ut=>{const mt=ut.feature,Tt=N(z[ht]).getFeatureState(mt.layer["source-layer"],mt.id);mt.source=mt.layer.source,mt.layer["source-layer"]&&(mt.sourceLayer=mt.layer["source-layer"]),mt.state=Tt});return ot}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),I.screenGeometry,h,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(w)}querySourceFeatures(c,h){h&&h.filter&&this._validate(o.validateFilter,"querySourceFeatures.filter",h.filter,null,h);const _=this._getSourceCaches(c);let v=[];for(const w of _)v=v.concat(ae(w,h));return v}addSourceType(c,h,_){return oi.getSourceType(c)?_(new Error(`A source type called "${c}" already exists.`)):(oi.setSourceType(c,h),h.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:c,url:h.workerSourceURL},_):_(null,null))}getLight(){return this.light.getLight()}setLight(c,h={}){this._checkLoaded();const _=this.light.getLight();let v=!1;for(const S in c)if(!y(c[S],_[S])){v=!0;break}if(!v)return;const w=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(c,h),this.light.updateTransitions(w)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(c,h=1){if(this._checkLoaded(),!c)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);if(h===1){if(typeof c.source=="object"){const _="terrain-dem-src";this.addSource(_,c.source),c=o.clone$1(c),c=o.extend(c,{source:_})}if(this._validate(o.validateTerrain,"terrain",c))return}if(!this.terrain||this.terrain&&h!==this.terrain.drapeRenderMode)this._createTerrain(c,h);else{const _=this.terrain,v=_.get();for(const w of Object.keys(o.spec.terrain))!c.hasOwnProperty(w)&&o.spec.terrain[w].default&&(c[w]=o.spec.terrain[w].default);for(const w in c)if(!y(c[w],v[w])){_.set(c),this.stylesheet.terrain=c;const S=this._setTransitionParameters({duration:0});_.updateTransitions(S);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(c){const h=this.fog=new ur(c,this.map.transform);this.stylesheet.fog=c;const _=this._setTransitionParameters({duration:0});h.updateTransitions(_)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const c of this.map._markers)c._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(c){if(this._checkLoaded(),!c)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const h=this.fog,_=h.get();Object.keys(c).length===0&&h.set(c);for(const v in c)if(!y(c[v],_[v])){h.set(c),this.stylesheet.fog=c;const w=this._setTransitionParameters({duration:0});h.updateTransitions(w);break}}else this._createFog(c);this._markersNeedUpdate=!0}_setTransitionParameters(c){return{now:o.exported.now(),transition:o.extend(c,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const c=this._order.filter(_=>this.isLayerDraped(this._layers[_])),h=this._order.filter(_=>!this.isLayerDraped(this._layers[_]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...c),this._drapedFirstOrder.push(...h)}_createTerrain(c,h){const _=this.terrain=new gn(c,h);this.stylesheet.terrain=c,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const v=this._setTransitionParameters({duration:0});_.updateTransitions(v)}_force3DLayerUpdate(){for(const c in this._layers){const h=this._layers[c];h.type==="fill-extrusion"&&this._updateLayer(h)}}_forceSymbolLayerUpdate(){for(const c in this._layers){const h=this._layers[c];h.type==="symbol"&&this._updateLayer(h)}}_validate(c,h,_,v,w={}){return(!w||w.validate!==!1)&&Cl(this,c.call(o.validateStyle,o.extend({key:h,style:this.serialize(),value:_,styleSpec:o.spec},v)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),o.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const c in this._layers)this._layers[c].setEventedParent(null);for(const c in this._sourceCaches)this._sourceCaches[c].clearTiles(),this._sourceCaches[c].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(c){const h=this._getSourceCaches(c);for(const _ of h)_.clearTiles()}_reloadSource(c){const h=this._getSourceCaches(c);for(const _ of h)_.resume(),_.reload()}_reloadSources(){for(const c of this._getSources())c.reload&&c.reload()}_updateSources(c){for(const h in this._sourceCaches)this._sourceCaches[h].update(c)}_generateCollisionBoxes(){for(const c in this._sourceCaches){const h=this._sourceCaches[c];h.resume(),h.reload()}}_updatePlacement(c,h,_,v,w=!1){let S=!1,I=!1;const z={};for(const F of this._order){const N=this._layers[F];if(N.type!=="symbol")continue;if(!z[N.source]){const Q=this._getLayerSourceCache(N);if(!Q)continue;z[N.source]=Q.getRenderableIds(!0).map(it=>Q.getTileByID(it)).sort((it,rt)=>rt.tileID.overscaledZ-it.tileID.overscaledZ||(it.tileID.isLessThan(rt.tileID)?-1:1))}const q=this.crossTileSymbolIndex.addLayer(N,z[N.source],c.center.lng,c.projection);S=S||q}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),w=w||this._layerOrderChanged||_===0,this._layerOrderChanged&&this.fire(new o.Event("neworder")),(w||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(o.exported.now(),c.zoom))&&(this.pauseablePlacement=new kl(c,this._order,w,h,_,v,this.placement,this.fog&&c.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,z),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(o.exported.now()),I=!0),S&&this.pauseablePlacement.placement.setStale()),I||S)for(const F of this._order){const N=this._layers[F];N.type==="symbol"&&this.placement.updateLayerOpacities(N,z[N.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(o.exported.now())}_releaseSymbolFadeTiles(){for(const c in this._sourceCaches)this._sourceCaches[c].releaseSymbolFadeTiles()}getImages(c,h,_){this.imageManager.getImages(h.icons,_),this._updateTilesForChangedImages();const v=w=>{w&&w.setDependencies(h.tileID.key,h.type,h.icons)};v(this._otherSourceCaches[h.source]),v(this._symbolSourceCaches[h.source])}getGlyphs(c,h,_){this.glyphManager.getGlyphs(h.stacks,_)}getResource(c,h,_){return o.makeRequest(h,_)}_getSourceCache(c){return this._otherSourceCaches[c]}_getLayerSourceCache(c){return c.type==="symbol"?this._symbolSourceCaches[c.source]:this._otherSourceCaches[c.source]}_getSourceCaches(c){const h=[];return this._otherSourceCaches[c]&&h.push(this._otherSourceCaches[c]),this._symbolSourceCaches[c]&&h.push(this._symbolSourceCaches[c]),h}_isSourceCacheLoaded(c){const h=this._getSourceCaches(c);return h.length===0?(this.fire(new o.ErrorEvent(new Error(`There is no source with ID '${c}'`))),!1):h.every(_=>_.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}oi.getSourceType=function(m){return Bt[m]},oi.setSourceType=function(m,c){Bt[m]=c},oi.registerForPluginStateChange=o.registerForPluginStateChange;var qs=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#define HALF_PI PI/2.0
#define QUARTER_PI PI/4.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0`,zu="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",Kd=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform sampler2D u_dem;uniform sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,Sl=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,Ml=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`;let vc={},xc={};const Hs=[];ka(qs,Hs),ka(Kd,Hs),ka(Sl,Hs),ka(Ml,Hs),vc=Hn("",Kd),xc=Hn(Ml,Sl);const Ua=Hn(`
#if __VERSION__ >=300
#define varying in
#define gl_FragColor glFragColor
#define texture2D texture
#define textureCube texture
out vec4 glFragColor;
#endif
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}`,`
#if __VERSION__ >=300
#define attribute in
#define varying out
#define texture2D texture
#endif
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),Al=qs,wc=`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`;var Ou={background:Hn(`uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
varying vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform vec4 u_color;varying vec4 v_color;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(u_color);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Hn(`uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Hn(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Hn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Hn(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Hn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Hn("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Hn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Hn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Hn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:Hn(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Hn(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Hn(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Hn(`varying vec4 v_color;
#ifdef RENDER_SHADOWS
varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
vec3 normal=v_normal;
#endif
float z;vec4 color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);
#else
color=v_color;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;
#endif
#ifdef RENDER_SHADOWS
#ifdef ZERO_ROOF_RADIUS
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#endif
color.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec4 v_color;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
v_normal=normal;
#endif
base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
v_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(color,NdotL);
#else
v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_color*=u_opacity;
#ifdef ZERO_ROOF_RADIUS
v_roof_color=vec4(0.0,0.0,0.0,1.0);
#ifdef LIGHTING_3D_MODE
v_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));
#else
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionPattern:Hn(`uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
varying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,v_NdotL)*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos;varying vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_NdotL=NdotL;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),hillshadePrepare:Hn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Hn(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
gl_FragColor=apply_lighting(gl_FragColor);
#endif
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Hn(`uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
uniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture2D(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trimmed=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef RENDER_LINE_ALPHA_DISCARD
if (alpha < u_alpha_discard_threshold) {discard;}
#endif
#ifdef RENDER_LINE_BORDER
float edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);
#ifdef RENDER_LINE_BORDER_AUTO
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}
#else
out_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);
#endif
}
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
attribute highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:Hn(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
color=apply_lighting(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:Hn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:Hn(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}`),symbolSDF:Hn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}`),symbolTextAndIcon:Hn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}`),terrainRaster:Hn(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
void main() {vec4 color=texture2D(u_image0,v_pos0);
#ifdef RENDER_SHADOWS
color.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
const float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;
#ifdef TERRAIN_WIREFRAME
elevation+=wireframeOffset;
#endif
v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;
#endif
}`),terrainDepth:Hn(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Hn(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,zu),skyboxGradient:Hn(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,zu),skyboxCapture:Hn(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Hn(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);
#else
color=texture2D(u_image0,v_pos0);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
attribute vec3 a_globe_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;
#endif
varying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);
#ifdef TERRAIN_WIREFRAME
height+=wireframeOffset;
#endif
globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Hn(`uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:
(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:
uv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}`,`attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`)};function ka(m,c){const h=m.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let _ of h)if(_=_.trim(),_[0]==="#"&&_.includes("if")&&!_.includes("endif")){_=_.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const v=_.split(" ");for(const w of v)c.includes(w)||c.push(w)}}function Hn(m,c){const h=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,_=c.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),v={},w=[...Hs];return ka(m,w),ka(c,w),{fragmentSource:m=m.replace(h,(S,I,z,F,N)=>(v[N]=!0,I==="define"?`
#ifndef HAS_UNIFORM_u_${N}
varying ${z} ${F} ${N};
#else
uniform ${z} ${F} u_${N};
#endif
`:`
#ifdef HAS_UNIFORM_u_${N}
    ${z} ${F} ${N} = u_${N};
#endif
`)),vertexSource:c=c.replace(h,(S,I,z,F,N)=>{const q=F==="float"?"vec2":"vec4",Q=N.match(/color/)?"color":q;return v[N]?I==="define"?`
#ifndef HAS_UNIFORM_u_${N}
uniform lowp float u_${N}_t;
attribute ${z} ${q} a_${N};
varying ${z} ${F} ${N};
#else
uniform ${z} ${F} u_${N};
#endif
`:Q==="vec4"?`
#ifndef HAS_UNIFORM_u_${N}
    ${N} = a_${N};
#else
    ${z} ${F} ${N} = u_${N};
#endif
`:`
#ifndef HAS_UNIFORM_u_${N}
    ${N} = unpack_mix_${Q}(a_${N}, u_${N}_t);
#else
    ${z} ${F} ${N} = u_${N};
#endif
`:I==="define"?`
#ifndef HAS_UNIFORM_u_${N}
uniform lowp float u_${N}_t;
attribute ${z} ${q} a_${N};
#else
uniform ${z} ${F} u_${N};
#endif
`:Q==="vec4"?`
#ifndef HAS_UNIFORM_u_${N}
    ${z} ${F} ${N} = a_${N};
#else
    ${z} ${F} ${N} = u_${N};
#endif
`:`
#ifndef HAS_UNIFORM_u_${N}
    ${z} ${F} ${N} = unpack_mix_${Q}(a_${N}, u_${N}_t);
#else
    ${z} ${F} ${N} = u_${N};
#endif
`}),staticAttributes:_,usedDefines:w}}class gs{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(c,h,_,v,w,S,I){this.context=c;let z=this.boundPaintVertexBuffers.length!==v.length;for(let N=0;!z&&N<v.length;N++)this.boundPaintVertexBuffers[N]!==v[N]&&(z=!0);let F=this.boundDynamicVertexBuffers.length!==I.length;for(let N=0;!F&&N<I.length;N++)this.boundDynamicVertexBuffers[N]!==I[N]&&(F=!0);if(!c.extVertexArrayObject||!this.vao||this.boundProgram!==h||this.boundLayoutVertexBuffer!==_||z||F||this.boundIndexBuffer!==w||this.boundVertexOffset!==S)this.freshBind(h,_,v,w,S,I);else{c.bindVertexArrayOES.set(this.vao);for(const N of I)N&&N.bind();w&&w.dynamicDraw&&w.bind()}}freshBind(c,h,_,v,w,S){let I;const z=c.numAttributes,F=this.context,N=F.gl;if(F.extVertexArrayObject)this.vao&&this.destroy(),this.vao=F.extVertexArrayObject.createVertexArrayOES(),F.bindVertexArrayOES.set(this.vao),I=0,this.boundProgram=c,this.boundLayoutVertexBuffer=h,this.boundPaintVertexBuffers=_,this.boundIndexBuffer=v,this.boundVertexOffset=w,this.boundDynamicVertexBuffers=S;else{I=F.currentNumAttributes||0;for(let q=z;q<I;q++)N.disableVertexAttribArray(q)}h.enableAttributes(N,c),h.bind(),h.setVertexAttribPointers(N,c,w);for(const q of _)q.enableAttributes(N,c),q.bind(),q.setVertexAttribPointers(N,c,w);for(const q of S)q&&(q.enableAttributes(N,c),q.bind(),q.setVertexAttribPointers(N,c,w));v&&v.bind(),F.currentNumAttributes=z}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function Il(m,c){const h=Math.pow(2,c.canonical.z),_=c.canonical.y;return[new o.MercatorCoordinate(0,_/h).toLngLat().lat,new o.MercatorCoordinate(0,(_+1)/h).toLngLat().lat]}function _s(m,c,h,_,v,w,S){const I=m.context,z=I.gl,F=h.fbo;if(!F)return;m.prepareDrawTile();const N=m.useProgram("hillshade");I.activeTexture.set(z.TEXTURE0),z.bindTexture(z.TEXTURE_2D,F.colorAttachment.get());const q=((ot,at,K,ht)=>{const ut=K.paint.get("hillshade-shadow-color"),mt=K.paint.get("hillshade-highlight-color"),Tt=K.paint.get("hillshade-accent-color");let wt=K.paint.get("hillshade-illumination-direction")*(Math.PI/180);K.paint.get("hillshade-illumination-anchor")==="viewport"&&(wt-=ot.transform.angle);const Mt=!ot.options.moving;return{u_matrix:ht||ot.transform.calculateProjMatrix(at.tileID.toUnwrapped(),Mt),u_image:0,u_latrange:Il(0,at.tileID),u_light:[K.paint.get("hillshade-exaggeration"),wt],u_shadow:ut,u_highlight:mt,u_accent:Tt}})(m,h,_,m.terrain?c.projMatrix:null);m.prepareDrawProgram(I,N,c.toUnwrapped());const{tileBoundsBuffer:Q,tileBoundsIndexBuffer:it,tileBoundsSegments:rt}=m.getTileBoundsBuffers(h);N.draw(I,z.TRIANGLES,v,w,S,o.CullFaceMode.disabled,q,_.id,Q,it,rt)}function Ca(m,c,h){if(!c.needsDEMTextureUpload)return;const _=m.context,v=_.gl;_.pixelStoreUnpackPremultiplyAlpha.set(!1),c.demTexture=c.demTexture||m.getTileTexture(h.stride);const w=h.getPixels();c.demTexture?c.demTexture.update(w,{premultiply:!1}):c.demTexture=new o.Texture(_,w,v.RGBA,{premultiply:!1}),c.needsDEMTextureUpload=!1}function Ec(m,c,h,_,v,w){const S=m.context,I=S.gl;if(!c.dem)return;const z=c.dem;if(S.activeTexture.set(I.TEXTURE1),Ca(m,c,z),!c.demTexture)return;c.demTexture.bind(I.NEAREST,I.CLAMP_TO_EDGE);const F=z.dim;S.activeTexture.set(I.TEXTURE0);let N=c.fbo;if(!N){const rt=new o.Texture(S,{width:F,height:F,data:null},I.RGBA);rt.bind(I.LINEAR,I.CLAMP_TO_EDGE),N=c.fbo=S.createFramebuffer(F,F,!0),N.colorAttachment.set(rt.texture)}S.bindFramebuffer.set(N.framebuffer),S.viewport.set([0,0,F,F]);const{tileBoundsBuffer:q,tileBoundsIndexBuffer:Q,tileBoundsSegments:it}=m.getMercatorTileBoundsBuffers();m.useProgram("hillshadePrepare").draw(S,I.TRIANGLES,_,v,w,o.CullFaceMode.disabled,((rt,ot)=>{const at=ot.stride,K=o.create();return o.ortho(K,0,o.EXTENT,-o.EXTENT,0,0,1),o.translate(K,K,[0,-o.EXTENT,0]),{u_matrix:K,u_image:1,u_dimension:[at,at],u_zoom:rt.overscaledZ,u_unpack:ot.unpackVector}})(c.tileID,z),h.id,q,Q,it),c.needsHillshadePrepare=!1}const Tc=m=>({u_matrix:new o.UniformMatrix4f(m),u_image0:new o.Uniform1i(m),u_skirt_height:new o.Uniform1f(m)}),Du=(m,c)=>({u_matrix:m,u_image0:0,u_skirt_height:c}),kc=(m,c,h,_,v,w,S,I,z,F,N,q,Q,it,rt)=>({u_proj_matrix:Float32Array.from(m),u_globe_matrix:c,u_normalize_matrix:Float32Array.from(_),u_merc_matrix:h,u_zoom_transition:v,u_merc_center:w,u_image0:0,u_frustum_tl:S,u_frustum_tr:I,u_frustum_br:z,u_frustum_bl:F,u_globe_pos:N,u_globe_radius:q,u_viewport:Q,u_grid_matrix:rt?Float32Array.from(rt):new Float32Array(9),u_skirt_height:it});function Ru(m,c){return m!=null&&c!=null&&!(!m.hasData()||!c.hasData())&&m.demTexture!=null&&c.demTexture!=null&&m.tileID.key!==c.tileID.key}const Sa=new class{constructor(){this.operations={}}newMorphing(m,c,h,_,v){if(m in this.operations){const w=this.operations[m];w.to.tileID.key!==h.tileID.key&&(w.queued=h)}else this.operations[m]={startTime:_,phase:0,duration:v,from:c,to:h,queued:null}}getMorphValuesForProxy(m){if(!(m in this.operations))return null;const c=this.operations[m];return{from:c.from,to:c.to,phase:c.phase}}update(m){for(const c in this.operations){const h=this.operations[c];for(h.phase=(m-h.startTime)/h.duration;h.phase>=1||!this._validOp(h);)if(!this._nextOp(h,m)){delete this.operations[c];break}}}_nextOp(m,c){return!!m.queued&&(m.from=m.to,m.to=m.queued,m.queued=null,m.phase=0,m.startTime=c,!0)}_validOp(m){return m.from.hasData()&&m.to.hasData()}},Ma={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function aa(m){return 6*Math.pow(1.5,22-m)}function Yo(m,c){const h=1<<m.z;return!c&&(m.x===0||m.x===h-1)||m.y===0||m.y===h-1}const An=m=>({u_matrix:m});function $a(m,c,h,_,v){if(v>0){const w=o.exported.now(),S=(w-m.timeAdded)/v,I=c?(w-c.timeAdded)/v:-1,z=h.getSource(),F=_.coveringZoomLevel({tileSize:z.tileSize,roundZoom:z.roundZoom}),N=!c||Math.abs(c.tileID.overscaledZ-F)>Math.abs(m.tileID.overscaledZ-F),q=N&&m.refreshedUponExpiration?1:o.clamp(N?S:1-I,0,1);return m.refreshedUponExpiration&&S>=1&&(m.refreshedUponExpiration=!1),c?{opacity:1,mix:1-q}:{opacity:q,mix:0}}return{opacity:1,mix:0}}class Aa extends o.SourceCache{constructor(c){const h={type:"raster-dem",maxzoom:c.transform.maxZoom},_=new Zn(dn(),null),v=Lt("mock-dem",h,_,c.style);super("mock-dem",v,!1),v.setEventedParent(this),this._sourceLoaded=!0}_loadTile(c,h){c.state="loaded",h(null)}}class Jd extends o.SourceCache{constructor(c){const h=Lt("proxy",{type:"geojson",maxzoom:c.transform.maxZoom},new Zn(dn(),null),c.style);super("proxy",h,!1),h.setEventedParent(this),this.map=this.getSource().map=c,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(c,h,_){if(c.freezeTileCoverage)return;this.transform=c;const v=c.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((w,S)=>{if(w[S.key]="",!this._tiles[S.key]){const I=new o.Tile(S,this._source.tileSize*S.overscaleFactor(),c.tileZoom);I.state="loaded",this._tiles[S.key]=I}return w},{});for(const w in this._tiles)w in v||(this.freeFBO(w),this._tiles[w].unloadVectorData(),delete this._tiles[w])}freeFBO(c){const h=this.proxyCachedFBO[c];if(h!==void 0){const _=Object.values(h);this.renderCachePool.push(..._),delete this.proxyCachedFBO[c]}}deallocRenderCache(){this.renderCache.forEach(c=>c.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Ws extends o.OverscaledTileID{constructor(c,h,_){super(c.overscaledZ,c.wrap,c.canonical.z,c.canonical.x,c.canonical.y),this.proxyTileKey=h,this.projMatrix=_}}class ys extends o.Elevation{constructor(c,h){super(),this.painter=c,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[_,v,w]=function(z){const F=new o.StructArrayLayout2i4,N=new o.StructArrayLayout3ui6,q=131;F.reserve(17161),N.reserve(33800);const Q=o.EXTENT/128,it=o.EXTENT+Q/2,rt=it+Q;for(let at=-Q;at<rt;at+=Q)for(let K=-Q;K<rt;K+=Q){const ht=K<0||K>it||at<0||at>it?24575:0,ut=o.clamp(Math.round(K),0,o.EXTENT),mt=o.clamp(Math.round(at),0,o.EXTENT);F.emplaceBack(ut+ht,mt)}const ot=(at,K)=>{const ht=K*q+at;N.emplaceBack(ht+1,ht,ht+q),N.emplaceBack(ht+q,ht+q+1,ht+1)};for(let at=1;at<129;at++)for(let K=1;K<129;K++)ot(K,at);return[0,129].forEach(at=>{for(let K=0;K<130;K++)ot(K,at),ot(at,K)}),[F,N,32768]}(),S=c.context;this.gridBuffer=S.createVertexBuffer(_,o.posAttributes.members),this.gridIndexBuffer=S.createIndexBuffer(v),this.gridSegments=o.SegmentVector.simpleSegment(0,0,_.length,v.length),this.gridNoSkirtSegments=o.SegmentVector.simpleSegment(0,0,_.length,w),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Jd(h.map),this.orthoMatrix=o.create(),o.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,o.EXTENT,0,o.EXTENT,0,1);const I=S.gl;this._overlapStencilMode=new o.StencilMode({func:I.GEQUAL,mask:255},0,255,I.KEEP,I.KEEP,I.REPLACE),this._previousZoom=c.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=h,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Aa(h.map)}set style(c){c.on("data",this._onStyleDataEvent.bind(this)),c.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=c,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(c,h,_){if(c&&c.terrain){this._style!==c&&(this.style=c),this.enabled=!0;const v=c.terrain.properties;this.sourceCache=c.terrain.drapeRenderMode===0?this._mockSourceCache:c._getSourceCache(v.get("source")),this._exaggeration=v.get("exaggeration");const w=()=>{this.sourceCache.used&&o.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const S=this.getScaledDemTileSize();this.sourceCache.update(h,S,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,w(),this._initializing=!0),w(),h.updateElevation(!0,_),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(h),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(c){this._findCoveringTileCache[c]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const c=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||c.efficiency!==100&&o.warnOnce(`Terrain render cache efficiency is not optimal (${c.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${c.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(c){c.coord&&c.dataType==="source"?this._clearRenderCacheForTile(c.sourceCacheId,c.coord):c.dataType==="style"&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const c in this._style._sourceCaches)this._style._sourceCaches[c].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(c=>c.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const c=2*this.proxySourceCache.getSource().tileSize;return[c,c]}set useVertexMorphing(c){this._useVertexMorphing=c}updateTileBinding(c){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const h=this.proxySourceCache,_=this.painter.transform;this._initializing&&(this._initializing=_._centerAltitude===0&&this.getAtPointOrZero(o.MercatorCoordinate.fromLngLat(_.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const v=this.proxyCoords=h.getIds().map(z=>{const F=h.getTileByID(z).tileID;return F.projMatrix=_.calculateProjMatrix(F.toUnwrapped()),F});(function(z,F){const N=F.transform.pointCoordinate(F.transform.getCameraPoint()),q=new o.pointGeometry(N.x,N.y);z.sort((Q,it)=>{if(it.overscaledZ-Q.overscaledZ)return it.overscaledZ-Q.overscaledZ;const rt=new o.pointGeometry(Q.canonical.x+(1<<Q.canonical.z)*Q.wrap,Q.canonical.y),ot=new o.pointGeometry(it.canonical.x+(1<<it.canonical.z)*it.wrap,it.canonical.y),at=q.mult(1<<Q.canonical.z);return at.x-=.5,at.y-=.5,at.distSqr(rt)-at.distSqr(ot)})})(v,this.painter),this._previousZoom=_.zoom;const w=this.proxyToSource||{};this.proxyToSource={},v.forEach(z=>{this.proxyToSource[z.key]={}}),this.terrainTileForTile={};const S=this._style._sourceCaches;for(const z in S){const F=S[z];if(!F.used||(F!==this.sourceCache&&this.resetTileLookupCache(F.id),this._setupProxiedCoordsForOrtho(F,c[z],w),F.usedForTerrain))continue;const N=c[z];F.getSource().reparseOverscaled&&this._assignTerrainTiles(N)}this.proxiedCoords[h.id]=v.map(z=>new Ws(z,z.key,this.orthoMatrix)),this._assignTerrainTiles(v),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(w),this.renderingToTexture=!1,this._updateTimestamp=o.exported.now();const I={};this._visibleDemTiles=[];for(const z of this.proxyCoords){const F=this.terrainTileForTile[z.key];if(!F)continue;const N=F.tileID.key;N in I||(this._visibleDemTiles.push(F),I[N]=N)}}_assignTerrainTiles(c){this._initializing||c.forEach(h=>{if(this.terrainTileForTile[h.key])return;const _=this._findTileCoveringTileID(h,this.sourceCache);_&&(this.terrainTileForTile[h.key]=_)})}_prepareDEMTextures(){const c=this.painter.context,h=c.gl;for(const _ in this.terrainTileForTile){const v=this.terrainTileForTile[_],w=v.dem;!w||v.demTexture&&!v.needsDEMTextureUpload||(c.activeTexture.set(h.TEXTURE1),Ca(this.painter,v,w))}}_prepareDemTileUniforms(c,h,_,v){if(!h||h.demTexture==null)return!1;const w=c.tileID.canonical,S=Math.pow(2,h.tileID.canonical.z-w.z),I=v||"";return _[`u_dem_tl${I}`]=[w.x*S%1,w.y*S%1],_[`u_dem_scale${I}`]=S,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const c=this.painter.context,h=c.gl;if(!this._emptyDepthBufferTexture){const _=new o.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new o.Texture(c,_,h.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let c=0;const h=this._visibleDemTiles.reduce((_,v)=>{if(!v.dem)return _;const w=v.dem.tree.minimums[0];return w>0&&c++,_+w},0);return c?h/c:0}_updateEmptyDEMTexture(){const c=this.painter.context,h=c.gl;c.activeTexture.set(h.TEXTURE2);const _=this._getLoadedAreaMinimum(),v=new o.RGBAImage({width:1,height:1},new Uint8Array(o.DEMData.pack(_,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let w=this._emptyDEMTexture;return w?w.update(v,{premultiply:!1}):w=this._emptyDEMTexture=new o.Texture(c,v,h.RGBA,{premultiply:!1}),w}setupElevationDraw(c,h,_){const v=this.painter.context,w=v.gl,S=(I=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:o.DEMData.getUnpackVector(I),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var I;S.u_dem_size=this.sourceCache.getSource().tileSize,S.u_exaggeration=this.exaggeration();let z=null,F=null,N=1;if(_&&_.morphing&&this._useVertexMorphing){const q=_.morphing.srcDemTile,Q=_.morphing.dstDemTile;N=_.morphing.phase,q&&Q&&(this._prepareDemTileUniforms(c,q,S,"_prev")&&(F=q),this._prepareDemTileUniforms(c,Q,S)&&(z=Q))}if(F&&z?(v.activeTexture.set(w.TEXTURE2),z.demTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE,w.NEAREST),v.activeTexture.set(w.TEXTURE4),F.demTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE,w.NEAREST),S.u_dem_lerp=N):(z=this.terrainTileForTile[c.tileID.key],v.activeTexture.set(w.TEXTURE2),(this._prepareDemTileUniforms(c,z,S)?z.demTexture:this.emptyDEMTexture).bind(w.NEAREST,w.CLAMP_TO_EDGE)),v.activeTexture.set(w.TEXTURE3),_&&_.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE),this._depthFBO&&(S.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE),S.u_depth_size_inv=[1,1]),_&&_.useMeterToDem&&z){const q=(1<<z.tileID.canonical.z)*o.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;S.u_meter_to_dem=q}if(_&&_.labelPlaneMatrixInv&&(S.u_label_plane_matrix_inv=_.labelPlaneMatrixInv),h.setTerrainUniformValues(v,S),this.painter.transform.projection.name==="globe"){const q=this.globeUniformValues(this.painter.transform,c.tileID.canonical,_&&_.useDenormalizedUpVectorScale);h.setGlobeUniformValues(v,q)}}globeUniformValues(c,h,_){const v=c.projection;return{u_tile_tl_up:v.upVector(h,0,0),u_tile_tr_up:v.upVector(h,o.EXTENT,0),u_tile_br_up:v.upVector(h,o.EXTENT,o.EXTENT),u_tile_bl_up:v.upVector(h,0,o.EXTENT),u_tile_up_scale:_?o.globeMetersToEcef(1):v.upVectorScale(h,c.center.lat,c.worldSize).metersToTile}}renderToBackBuffer(c){const h=this.painter,_=this.painter.context;c.length!==0&&(_.bindFramebuffer.set(null),_.viewport.set([0,0,h.width,h.height]),h.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(v,w,S,I,z){if(v.transform.projection.name==="globe")(function(F,N,q,Q,it){const rt=F.context,ot=rt.gl;let at,K;const ht=F.options.showTerrainWireframe?2:0,ut=F.transform,mt=o.globeUseCustomAntiAliasing(F,rt,ut),Tt=(ue,Gt)=>{if(K===ue)return;const Ot=[Ma[ue],"PROJECTION_GLOBE_VIEW"];mt&&Ot.push("CUSTOM_ANTIALIASING"),Gt&&Ot.push(Ma[ht]),at=F.useProgram("globeRaster",null,Ot),K=ue},wt=F.colorModeForRenderPass(),Mt=new o.DepthMode(ot.LEQUAL,o.DepthMode.ReadWrite,F.depthRangeFor3D);Sa.update(it);const Ft=o.calculateGlobeMercatorMatrix(ut),Vt=[o.mercatorXfromLng(ut.center.lng),o.mercatorYfromLat(ut.center.lat)],Ht=ht?[!1,!0]:[!1],ke=F.globeSharedBuffers,Nt=[ut.width*o.exported.devicePixelRatio,ut.height*o.exported.devicePixelRatio],ne=Float32Array.from(ut.globeMatrix),Xt={useDenormalizedUpVectorScale:!0};if(Ht.forEach(ue=>{const Gt=F.transform,Ot=aa(Gt.zoom)*N.exaggeration();K=-1;const Wt=ue?ot.LINES:ot.TRIANGLES;for(const ie of Q){const pe=q.getTile(ie),Je=o.StencilMode.disabled,Pn=N.prevTerrainTileForTile[ie.key],We=N.terrainTileForTile[ie.key];Ru(Pn,We)&&Sa.newMorphing(ie.key,Pn,We,it,250),rt.activeTexture.set(ot.TEXTURE0),pe.texture.bind(ot.LINEAR,ot.CLAMP_TO_EDGE);const je=Sa.getMorphValuesForProxy(ie.key),nn=je?1:0;je&&o.extend$1(Xt,{morphing:{srcDemTile:je.from,dstDemTile:je.to,phase:o.easeCubicInOut(je.phase)}});const Nn=o.tileCornersToBounds(ie.canonical),sn=o.getLatitudinalLod(Nn.getCenter().lat),ar=o.getGridMatrix(ie.canonical,Nn,sn,Gt.worldSize/Gt._pixelsPerMercatorPixel),yr=o.globeNormalizeECEF(o.globeTileBounds(ie.canonical)),Mr=kc(Gt.projMatrix,ne,Ft,yr,o.globeToMercatorTransition(Gt.zoom),Vt,Gt.frustumCorners.TL,Gt.frustumCorners.TR,Gt.frustumCorners.BR,Gt.frustumCorners.BL,Gt.globeCenterInViewSpace,Gt.globeRadius,Nt,Ot,ar);if(Tt(nn,ue),N.setupElevationDraw(pe,at,Xt),F.prepareDrawProgram(rt,at,ie.toUnwrapped()),ke){const[wr,vi,zo]=ue?ke.getWirefameBuffers(F.context,sn):ke.getGridBuffers(sn,Ot!==0);at.draw(rt,Wt,Mt,Je,wt,o.CullFaceMode.backCCW,Mr,"globe_raster",wr,vi,zo)}}}),ke){const ue=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];mt&&ue.push("CUSTOM_ANTIALIASING"),at=F.useProgram("globeRaster",null,ue);for(const Gt of Q){const{x:Ot,y:Wt,z:ie}=Gt.canonical,pe=Wt===0,Je=Wt===(1<<ie)-1,[Pn,We,je,nn]=ke.getPoleBuffers(ie);if(nn&&(pe||Je)){const Nn=q.getTile(Gt);rt.activeTexture.set(ot.TEXTURE0),Nn.texture.bind(ot.LINEAR,ot.CLAMP_TO_EDGE);let sn=o.globePoleMatrixForTile(ie,Ot,ut);const ar=o.globeNormalizeECEF(o.globeTileBounds(Gt.canonical)),yr=(Mr,wr)=>Mr.draw(rt,ot.TRIANGLES,Mt,o.StencilMode.disabled,wt,o.CullFaceMode.disabled,kc(ut.projMatrix,sn,sn,ar,0,Vt,ut.frustumCorners.TL,ut.frustumCorners.TR,ut.frustumCorners.BR,ut.frustumCorners.BL,ut.globeCenterInViewSpace,ut.globeRadius,Nt,0),"globe_pole_raster",wr,je,nn);N.setupElevationDraw(Nn,at,Xt),F.prepareDrawProgram(rt,at,Gt.toUnwrapped()),pe&&yr(at,Pn),Je&&(sn=o.scale(o.create(),sn,[1,-1,1]),yr(at,We))}}}})(v,w,S,I,z);else{const F=v.context,N=F.gl;let q,Q;const it=v.options.showTerrainWireframe?2:0,rt=(ut,mt)=>{if(Q===ut)return;const Tt=[Ma[ut]];mt&&Tt.push(Ma[it]),q=v.useProgram("terrainRaster",null,Tt),Q=ut},ot=v.colorModeForRenderPass(),at=new o.DepthMode(N.LEQUAL,o.DepthMode.ReadWrite,v.depthRangeFor3D);Sa.update(z);const K=v.transform,ht=aa(K.zoom)*w.exaggeration();(it?[!1,!0]:[!1]).forEach(ut=>{Q=-1;const mt=ut?N.LINES:N.TRIANGLES,[Tt,wt]=ut?w.getWirefameBuffer():[w.gridIndexBuffer,w.gridSegments];for(const Mt of I){const Ft=S.getTile(Mt),Vt=o.StencilMode.disabled,Ht=w.prevTerrainTileForTile[Mt.key],ke=w.terrainTileForTile[Mt.key];Ru(Ht,ke)&&Sa.newMorphing(Mt.key,Ht,ke,z,250),F.activeTexture.set(N.TEXTURE0),Ft.texture.bind(N.LINEAR,N.CLAMP_TO_EDGE,N.LINEAR_MIPMAP_NEAREST);const Nt=Sa.getMorphValuesForProxy(Mt.key),ne=Nt?1:0;let Xt;Nt&&(Xt={morphing:{srcDemTile:Nt.from,dstDemTile:Nt.to,phase:o.easeCubicInOut(Nt.phase)}});const ue=Du(Mt.projMatrix,Yo(Mt.canonical,K.renderWorldCopies)?ht/10:ht);rt(ne,ut),w.setupElevationDraw(Ft,q,Xt),v.prepareDrawProgram(F,q,Mt.toUnwrapped()),q.draw(F,mt,at,Vt,ot,o.CullFaceMode.backCCW,ue,"terrain_raster",w.gridBuffer,Tt,wt)}})}}(h,this,this.proxySourceCache,c,this._updateTimestamp),this.renderingToTexture=!0,h.gpuTimingDeferredRenderEnd(),c.splice(0,c.length))}renderBatch(c){if(this._drapedRenderBatches.length===0)return c+1;this.renderingToTexture=!0;const h=this.painter,_=this.painter.context,v=this.proxySourceCache,w=this.proxiedCoords[v.id],S=this._drapedRenderBatches.shift(),I=[],z=h.style.order;let F=0;for(const N of w){const q=v.getTileByID(N.proxyTileKey),Q=v.proxyCachedFBO[N.key]?v.proxyCachedFBO[N.key][c]:void 0,it=Q!==void 0?v.renderCache[Q]:this.pool[F++],rt=Q!==void 0;if(q.texture=it.tex,rt&&!it.dirty){I.push(q.tileID);continue}let ot;_.bindFramebuffer.set(it.fb.framebuffer),this.renderedToTile=!1,it.dirty&&(_.clear({color:o.Color.transparent,stencil:0}),it.dirty=!1);for(let at=S.start;at<=S.end;++at){const K=h.style._layers[z[at]];if(K.isHidden(h.transform.zoom))continue;const ht=h.style._getLayerSourceCache(K),ut=ht?this.proxyToSource[N.key][ht.id]:[N];if(!ut)continue;const mt=ut;_.viewport.set([0,0,it.fb.width,it.fb.height]),ot!==(ht?ht.id:null)&&(this._setupStencil(it,ut,K,ht),ot=ht?ht.id:null),h.renderLayer(h,ht,K,mt)}this.renderedToTile?(it.dirty=!0,I.push(q.tileID)):rt||--F,F===5&&(F=0,this.renderToBackBuffer(I))}return this.renderToBackBuffer(I),this.renderingToTexture=!1,_.bindFramebuffer.set(null),_.viewport.set([0,0,h.width,h.height]),S.end+1}postRender(){}renderCacheEfficiency(c){const h=c.order.length;if(h===0)return{efficiency:100};let _,v=0,w=0,S=!1;for(let I=0;I<h;++I){const z=c._layers[c.order[I]];this._style.isLayerDraped(z)?(S&&++v,++w):S||(S=!0,_=z.id)}return w===0?{efficiency:100}:{efficiency:100*(1-v/w),firstUndrapedLayer:_}}getMinElevationBelowMSL(){let c=0;return this._visibleDemTiles.filter(h=>h.dem).forEach(h=>{c=Math.min(c,h.dem.tree.minimums[0])}),c===0?c:(c-30)*this._exaggeration}raycast(c,h,_){if(!this._visibleDemTiles)return null;const v=this._visibleDemTiles.filter(w=>w.dem).map(w=>{const S=w.tileID,I=1<<S.overscaledZ,{x:z,y:F}=S.canonical,N=z/I,q=(z+1)/I,Q=F/I,it=(F+1)/I;return{minx:N,miny:Q,maxx:q,maxy:it,t:w.dem.tree.raycastRoot(N,Q,q,it,c,h,_),tile:w}});v.sort((w,S)=>(w.t!==null?w.t:Number.MAX_VALUE)-(S.t!==null?S.t:Number.MAX_VALUE));for(const w of v){if(w.t==null)return null;const S=w.tile.dem.tree.raycast(w.minx,w.miny,w.maxx,w.maxy,c,h,_);if(S!=null)return S}return null}_createFBO(){const c=this.painter.context,h=c.gl,_=this.drapeBufferSize;c.activeTexture.set(h.TEXTURE0);const v=new o.Texture(c,{width:_[0],height:_[1],data:null},h.RGBA);v.bind(h.LINEAR,h.CLAMP_TO_EDGE);const w=c.createFramebuffer(_[0],_[1],!1);return w.colorAttachment.set(v.texture),w.depthAttachment=new Yi(c,w.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=c.createRenderbuffer(c.gl.DEPTH_STENCIL,_[0],_[1]),this._stencilRef=0,w.depthAttachment.set(this._sharedDepthStencil),c.clear({stencil:0})):w.depthAttachment.set(this._sharedDepthStencil),c.extTextureFilterAnisotropic&&!c.extTextureFilterAnisotropicForceOff&&h.texParameterf(h.TEXTURE_2D,c.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,c.extTextureFilterAnisotropicMax),{fb:w,tex:v,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const c in this._style._sourceCaches)if(this._style._sourceCaches[c].hasTransition())return!0;return this._style.order.some(c=>{const h=this._style._layers[c],_=h.isHidden(this.painter.transform.zoom);return h.type==="custom"?!_&&h.shouldRedrape():!_&&h.hasTransition()})}_clearLineLayersFromRenderCache(){let c=!1;for(const _ of this._style._getSources())if(_ instanceof G){c=!0;break}if(!c)return;const h={};for(let _=0;_<this._style.order.length;++_){const v=this._style._layers[this._style.order[_]],w=this._style._getLayerSourceCache(v);if(w&&!h[w.id]&&!v.isHidden(this.painter.transform.zoom)&&v.type==="line"&&v.widthExpression()instanceof o.ZoomDependentExpression){h[w.id]=!0;for(const S of this.proxyCoords){const I=this.proxyToSource[S.key][w.id];if(I)for(const z of I)this._clearRenderCacheForTile(w.id,z)}}}}_clearRasterLayersFromRenderCache(){let c=!1;for(const _ in this._style._sourceCaches)if(this._style._sourceCaches[_]._source instanceof Y){c=!0;break}if(!c)return;const h={};for(let _=0;_<this._style.order.length;++_){const v=this._style._layers[this._style.order[_]],w=this._style._getLayerSourceCache(v);if(!w||h[w.id]||v.isHidden(this.painter.transform.zoom)||v.type!=="raster")continue;const S=v.paint.get("raster-fade-duration");for(const I of this.proxyCoords){const z=this.proxyToSource[I.key][w.id];if(z)for(const F of z){const N=$a(w.getTile(F),w.findLoadedParent(F,0),w,this.painter.transform,S);(N.opacity!==1||N.mix!==0)&&this._clearRenderCacheForTile(w.id,F)}}}}_setupDrapedRenderBatches(){const c=this._style.order,h=c.length;if(h===0)return;const _=[];let v,w=0,S=this._style._layers[c[w]];for(;!this._style.isLayerDraped(S)&&S.isHidden(this.painter.transform.zoom)&&++w<h;)S=this._style._layers[c[w]];for(;w<h;++w){const I=this._style._layers[c[w]];I.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(I)?v===void 0&&(v=w):v!==void 0&&(_.push({start:v,end:w-1}),v=void 0))}v!==void 0&&_.push({start:v,end:w-1}),this._drapedRenderBatches=_}_setupRenderCache(c){const h=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,h.renderCache.length>h.renderCachePool.length){const S=Object.values(h.proxyCachedFBO);h.proxyCachedFBO={};for(let I=0;I<S.length;++I){const z=Object.values(S[I]);h.renderCachePool.push(...z)}}return}this._clearRasterLayersFromRenderCache();const _=this.proxyCoords,v=this._tilesDirty;for(let S=_.length-1;S>=0;S--){const I=_[S];if(h.getTileByID(I.key),h.proxyCachedFBO[I.key]!==void 0){const z=c[I.key],F=this.proxyToSource[I.key];let N=0;for(const q in F){const Q=F[q],it=z[q];if(!it||it.length!==Q.length||Q.some((rt,ot)=>rt!==it[ot]||v[q]&&v[q].hasOwnProperty(rt.key))){N=-1;break}++N}for(const q in h.proxyCachedFBO[I.key])h.renderCache[h.proxyCachedFBO[I.key][q]].dirty=N<0||N!==Object.values(z).length}}const w=[...this._drapedRenderBatches];w.sort((S,I)=>I.end-I.start-(S.end-S.start));for(const S of w)for(const I of _){if(h.proxyCachedFBO[I.key])continue;let z=h.renderCachePool.pop();z===void 0&&h.renderCache.length<50&&(z=h.renderCache.length,h.renderCache.push(this._createFBO())),z!==void 0&&(h.proxyCachedFBO[I.key]={},h.proxyCachedFBO[I.key][S.start]=z,h.renderCache[z].dirty=!0)}this._tilesDirty={}}_setupStencil(c,h,_,v){if(!v||!this._sourceTilesOverlap[v.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const w=this.painter.context,S=w.gl;if(h.length<=1)return void(this._overlapStencilType=!1);let I;if(_.isTileClipped())I=h.length,this._overlapStencilMode.test={func:S.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(h[0].overscaledZ>h[h.length-1].overscaledZ))return void(this._overlapStencilType=!1);I=1,this._overlapStencilMode.test={func:S.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+I>255&&(w.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=I,this._overlapStencilMode.ref=this._stencilRef,_.isTileClipped()&&this._renderTileClippingMasks(h,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(c){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[c.key]),this._overlapStencilMode):o.StencilMode.disabled}_renderTileClippingMasks(c,h){const _=this.painter,v=this.painter.context,w=v.gl;_._tileClippingMaskIDs={},v.setColorMode(o.ColorMode.disabled),v.setDepthMode(o.DepthMode.disabled);const S=_.useProgram("clippingMask");for(const I of c){const z=_._tileClippingMaskIDs[I.key]=--h;S.draw(v,w.TRIANGLES,o.DepthMode.disabled,new o.StencilMode({func:w.ALWAYS,mask:0},z,255,w.KEEP,w.KEEP,w.REPLACE),o.ColorMode.disabled,o.CullFaceMode.disabled,An(I.projMatrix),"$clipping",_.tileExtentBuffer,_.quadTriangleIndexBuffer,_.tileExtentSegments)}}pointCoordinate(c){const h=this.painter.transform;if(c.x<0||c.x>h.width||c.y<0||c.y>h.height)return null;const _=[c.x,c.y,1,1];o.transformMat4$1(_,_,h.pixelMatrixInverse),o.scale$1(_,_,1/_[3]),_[0]/=h.worldSize,_[1]/=h.worldSize;const v=h._camera.position,w=o.mercatorZfromAltitude(1,h.center.lat),S=[v[0],v[1],v[2]/w,0],I=o.subtract([],_.slice(0,3),S);o.normalize(I,I);const z=this.raycast(S,I,this._exaggeration);return z!==null&&z?(o.scaleAndAdd(S,S,I,z),S[3]=S[2],S[2]*=w,S):null}drawDepth(){const c=this.painter,h=c.context,_=this.proxySourceCache,v=Math.ceil(c.width),w=Math.ceil(c.height);if(!this._depthFBO||this._depthFBO.width===v&&this._depthFBO.height===w||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const S=h.gl,I=h.createFramebuffer(v,w,!0);h.activeTexture.set(S.TEXTURE0);const z=new o.Texture(h,{width:v,height:w,data:null},S.RGBA);z.bind(S.NEAREST,S.CLAMP_TO_EDGE),I.colorAttachment.set(z.texture);const F=h.createRenderbuffer(h.gl.DEPTH_COMPONENT16,v,w);I.depthAttachment.set(F),this._depthFBO=I,this._depthTexture=z}h.bindFramebuffer.set(this._depthFBO.framebuffer),h.viewport.set([0,0,v,w]),function(S,I,z,F){if(S.transform.projection.name==="globe")return;const N=S.context,q=N.gl;N.clear({depth:1});const Q=S.useProgram("terrainDepth"),it=new o.DepthMode(q.LESS,o.DepthMode.ReadWrite,S.depthRangeFor3D);for(const rt of F){const ot=z.getTile(rt),at=Du(rt.projMatrix,0);I.setupElevationDraw(ot,Q),Q.draw(N,q.TRIANGLES,it,o.StencilMode.disabled,o.ColorMode.unblended,o.CullFaceMode.backCCW,at,"terrain_depth",I.gridBuffer,I.gridIndexBuffer,I.gridNoSkirtSegments)}}(c,this,_,this.proxyCoords)}_setupProxiedCoordsForOrtho(c,h,_){if(c.getSource()instanceof kt)return this._setupProxiedCoordsForImageSource(c,h,_);this._findCoveringTileCache[c.id]=this._findCoveringTileCache[c.id]||{};const v=this.proxiedCoords[c.id]=[],w=this.proxyCoords;for(let I=0;I<w.length;I++){const z=w[I],F=this._findTileCoveringTileID(z,c);if(F){const N=this._createProxiedId(z,F,_[z.key]&&_[z.key][c.id]);v.push(N),this.proxyToSource[z.key][c.id]=[N]}}let S=!1;for(let I=0;I<h.length;I++){const z=c.getTile(h[I]);if(!z||!z.hasData())continue;const F=this._findTileCoveringTileID(z.tileID,this.proxySourceCache);if(F&&F.tileID.canonical.z!==z.tileID.canonical.z){const N=this.proxyToSource[F.tileID.key][c.id],q=this._createProxiedId(F.tileID,z,_[F.tileID.key]&&_[F.tileID.key][c.id]);N?N.splice(N.length-1,0,q):this.proxyToSource[F.tileID.key][c.id]=[q],v.push(q),S=!0}}this._sourceTilesOverlap[c.id]=S}_setupProxiedCoordsForImageSource(c,h,_){if(!c.getSource().loaded())return;const v=this.proxiedCoords[c.id]=[],w=this.proxyCoords,S=c.getSource(),I=new o.pointGeometry(S.tileID.x,S.tileID.y)._div(1<<S.tileID.z),z=S.coordinates.map(o.MercatorCoordinate.fromLngLat).reduce((N,q)=>(N.min.x=Math.min(N.min.x,q.x-I.x),N.min.y=Math.min(N.min.y,q.y-I.y),N.max.x=Math.max(N.max.x,q.x-I.x),N.max.y=Math.max(N.max.y,q.y-I.y),N),{min:new o.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new o.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),F=(N,q)=>{const Q=N.wrap+N.canonical.x/(1<<N.canonical.z),it=N.canonical.y/(1<<N.canonical.z),rt=o.EXTENT/(1<<N.canonical.z),ot=q.wrap+q.canonical.x/(1<<q.canonical.z),at=q.canonical.y/(1<<q.canonical.z);return Q+rt<ot+z.min.x||Q>ot+z.max.x||it+rt<at+z.min.y||it>at+z.max.y};for(let N=0;N<w.length;N++){const q=w[N];for(let Q=0;Q<h.length;Q++){const it=c.getTile(h[Q]);if(!it||!it.hasData()||F(q,it.tileID))continue;const rt=this._createProxiedId(q,it,_[q.key]&&_[q.key][c.id]),ot=this.proxyToSource[q.key][c.id];ot?ot.push(rt):this.proxyToSource[q.key][c.id]=[rt],v.push(rt)}}}_createProxiedId(c,h,_){let v=this.orthoMatrix;if(_){const w=_.find(S=>S.key===h.tileID.key);if(w)return w}if(h.tileID.key!==c.key){const w=c.canonical.z-h.tileID.canonical.z;let S,I,z;v=o.create();const F=h.tileID.wrap-c.wrap<<c.overscaledZ;w>0?(S=o.EXTENT>>w,I=S*((h.tileID.canonical.x<<w)-c.canonical.x+F),z=S*((h.tileID.canonical.y<<w)-c.canonical.y)):(S=o.EXTENT<<-w,I=o.EXTENT*(h.tileID.canonical.x-(c.canonical.x+F<<-w)),z=o.EXTENT*(h.tileID.canonical.y-(c.canonical.y<<-w))),o.ortho(v,0,S,0,S,0,1),o.translate(v,v,[I,z,0])}return new Ws(h.tileID,c.key,v)}_findTileCoveringTileID(c,h){let _=h.getTile(c);if(_&&_.hasData())return _;const v=this._findCoveringTileCache[h.id],w=v[c.key];if(_=w?h.getTileByID(w):null,_&&_.hasData()||w===null)return _;let S=_?_.tileID:c,I=S.overscaledZ;const z=h.getSource().minzoom,F=[];if(!w){const q=h.getSource().maxzoom;if(c.canonical.z>=q){const Q=c.canonical.z-q;h.getSource().reparseOverscaled?(I=Math.max(c.canonical.z+2,h.transform.tileZoom),S=new o.OverscaledTileID(I,c.wrap,q,c.canonical.x>>Q,c.canonical.y>>Q)):Q!==0&&(I=q,S=new o.OverscaledTileID(I,c.wrap,q,c.canonical.x>>Q,c.canonical.y>>Q))}S.key!==c.key&&(F.push(S.key),_=h.getTile(S))}const N=q=>{F.forEach(Q=>{v[Q]=q}),F.length=0};for(I-=1;I>=z&&(!_||!_.hasData());I--){_&&N(_.tileID.key);const q=S.calculateScaledKey(I);if(_=h.getTileByID(q),_&&_.hasData())break;const Q=v[q];if(Q===null)break;Q===void 0?F.push(q):_=h.getTileByID(Q)}return N(_?_.tileID.key:null),_&&_.hasData()?_:null}findDEMTileFor(c){return this.enabled?this._findTileCoveringTileID(c,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(c,h){let _=this._tilesDirty[c];_||(_=this._tilesDirty[c]={}),_[h.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const c=function(h){let _=0;const v=new o.StructArrayLayout2ui4,w=131;for(let S=1;S<129;S++){for(let I=1;I<129;I++)_=S*w+I,v.emplaceBack(_,_+1),v.emplaceBack(_,_+w),v.emplaceBack(_+1,_+w),S===128&&v.emplaceBack(_+w,_+w+1);v.emplaceBack(_+1,_+1+w)}return v}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(c),this.wireframeSegments=o.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,c.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class Cc{static cacheKey(c,h,_,v){let w=`${h}${v?v.cacheKey:""}`;for(const S of _)c.usedDefines.includes(S)&&(w+=`/${S}`);return w}constructor(c,h,_,v,w,S){const I=c.gl;this.program=I.createProgram();const z=function(K){const ht=[];for(let ut=0;ut<K.length;ut++){if(K[ut]===null)continue;const mt=K[ut].split(" ");ht.push(mt.pop())}return ht}(_.staticAttributes),F=v?v.getBinderAttributes():[],N=z.concat(F);let q=v?v.defines():[];q=q.concat(S.map(K=>`#define ${K}`));const Q=c.isWebGL2?`#version 300 es
`:"",it=Q+q.concat(c.extStandardDerivatives&&Q.length===0?`#extension GL_OES_standard_derivatives : enable
`.concat(wc):wc,wc,Al,Ua.fragmentSource,xc.fragmentSource,_.fragmentSource).join(`
`),rt=Q+q.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,Al,Ua.vertexSource,xc.vertexSource,vc.vertexSource,_.vertexSource).join(`
`),ot=I.createShader(I.FRAGMENT_SHADER);if(I.isContextLost())return void(this.failedToCreate=!0);I.shaderSource(ot,it),I.compileShader(ot),I.attachShader(this.program,ot);const at=I.createShader(I.VERTEX_SHADER);if(I.isContextLost())this.failedToCreate=!0;else{I.shaderSource(at,rt),I.compileShader(at),I.attachShader(this.program,at),this.attributes={},this.numAttributes=N.length;for(let K=0;K<this.numAttributes;K++)N[K]&&(I.bindAttribLocation(this.program,K,N[K]),this.attributes[N[K]]=K);I.linkProgram(this.program),I.deleteShader(at),I.deleteShader(ot),this.fixedUniforms=w(c),this.binderUniforms=v?v.getUniforms(c):[],S.includes("TERRAIN")&&(this.terrainUniforms=(K=>({u_dem:new o.Uniform1i(K),u_dem_prev:new o.Uniform1i(K),u_dem_unpack:new o.Uniform4f(K),u_dem_tl:new o.Uniform2f(K),u_dem_scale:new o.Uniform1f(K),u_dem_tl_prev:new o.Uniform2f(K),u_dem_scale_prev:new o.Uniform1f(K),u_dem_size:new o.Uniform1f(K),u_dem_lerp:new o.Uniform1f(K),u_exaggeration:new o.Uniform1f(K),u_depth:new o.Uniform1i(K),u_depth_size_inv:new o.Uniform2f(K),u_meter_to_dem:new o.Uniform1f(K),u_label_plane_matrix_inv:new o.UniformMatrix4f(K)}))(c)),S.includes("GLOBE")&&(this.globeUniforms=(K=>({u_tile_tl_up:new o.Uniform3f(K),u_tile_tr_up:new o.Uniform3f(K),u_tile_br_up:new o.Uniform3f(K),u_tile_bl_up:new o.Uniform3f(K),u_tile_up_scale:new o.Uniform1f(K)}))(c)),S.includes("FOG")&&(this.fogUniforms=(K=>({u_fog_matrix:new o.UniformMatrix4f(K),u_fog_range:new o.Uniform2f(K),u_fog_color:new o.Uniform4f(K),u_fog_horizon_blend:new o.Uniform1f(K),u_fog_temporal_offset:new o.Uniform1f(K),u_frustum_tl:new o.Uniform3f(K),u_frustum_tr:new o.Uniform3f(K),u_frustum_br:new o.Uniform3f(K),u_frustum_bl:new o.Uniform3f(K),u_globe_pos:new o.Uniform3f(K),u_globe_radius:new o.Uniform1f(K),u_globe_transition:new o.Uniform1f(K),u_is_globe:new o.Uniform1i(K),u_viewport:new o.Uniform2f(K)}))(c))}}setTerrainUniformValues(c,h){if(!this.terrainUniforms)return;const _=this.terrainUniforms;if(!this.failedToCreate){c.program.set(this.program);for(const v in h)_[v]&&_[v].set(this.program,v,h[v])}}setGlobeUniformValues(c,h){if(!this.globeUniforms)return;const _=this.globeUniforms;if(!this.failedToCreate){c.program.set(this.program);for(const v in h)_[v]&&_[v].set(this.program,v,h[v])}}setFogUniformValues(c,h){if(!this.fogUniforms)return;const _=this.fogUniforms;if(!this.failedToCreate){c.program.set(this.program);for(const v in h)_[v].set(this.program,v,h[v])}}draw(c,h,_,v,w,S,I,z,F,N,q,Q,it,rt,ot){const at=c.gl;if(this.failedToCreate)return;c.program.set(this.program),c.setDepthMode(_),c.setStencilMode(v),c.setColorMode(w),c.setCullFace(S);for(const ht of Object.keys(this.fixedUniforms))this.fixedUniforms[ht].set(this.program,ht,I[ht]);rt&&rt.setUniforms(this.program,c,this.binderUniforms,Q,{zoom:it});const K={[at.LINES]:2,[at.TRIANGLES]:3,[at.LINE_STRIP]:1}[h];for(const ht of q.get()){const ut=ht.vaos||(ht.vaos={});(ut[z]||(ut[z]=new gs)).bind(c,this,F,rt?rt.getPaintVertexBuffers():[],N,ht.vertexOffset,ot||[]),at.drawElements(h,ht.primitiveLength*K,at.UNSIGNED_SHORT,ht.primitiveOffset*K*2)}}}function Bu(m,c){const h=Math.pow(2,c.tileID.overscaledZ),_=c.tileSize*Math.pow(2,m.transform.tileZoom)/h,v=_*(c.tileID.canonical.x+c.tileID.wrap*h),w=_*c.tileID.canonical.y;return{u_image:0,u_texsize:c.imageAtlasTexture.size,u_tile_units_to_pixels:1/_r(c,1,m.transform.tileZoom),u_pixel_coord_upper:[v>>16,w>>16],u_pixel_coord_lower:[65535&v,65535&w]}}const kf=o.create(),Sc=(m,c,h,_,v,w,S,I,z,F,N)=>{const q=c.style.light,Q=q.properties.get("position"),it=[Q.x,Q.y,Q.z],rt=o.create$1();q.properties.get("anchor")==="viewport"&&(o.fromRotation(rt,-c.transform.angle),o.transformMat3(it,it,rt));const ot=q.properties.get("color"),at=c.transform,K={u_matrix:m,u_lightpos:it,u_lightintensity:q.properties.get("intensity"),u_lightcolor:[ot.r,ot.g,ot.b],u_vertical_gradient:+h,u_opacity:_,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:kf,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:v,u_edge_radius:w};return at.projection.name==="globe"&&(K.u_tile_id=[S.canonical.x,S.canonical.y,1<<S.canonical.z],K.u_zoom_transition=z,K.u_inv_rot_matrix=N,K.u_merc_center=F,K.u_up_dir=at.projection.upVector(new o.CanonicalTileID(0,0,0),F[0]*o.EXTENT,F[1]*o.EXTENT),K.u_height_lift=I),K},Mc=(m,c,h,_,v,w,S,I,z,F,N,q)=>{const Q=Sc(m,c,h,_,v,w,S,z,F,N,q),it={u_height_factor:-Math.pow(2,S.overscaledZ)/I.tileSize/8};return o.extend(Q,Bu(c,I),it)},Pl=m=>({u_matrix:m}),bs=(m,c,h)=>o.extend(Pl(m),Bu(c,h)),vs=(m,c)=>({u_matrix:m,u_world:c}),Qd=(m,c,h,_)=>o.extend(bs(m,c,h),{u_world:_}),Va=o.create(),Ll=(m,c,h,_,v,w)=>{const S=m.transform,I=S.projection.name==="globe";let z;if(w.paint.get("circle-pitch-alignment")==="map")if(I){const N=o.globePixelsToTileUnits(S.zoom,c.canonical)*S._pixelsPerMercatorPixel;z=Float32Array.from([N,0,0,N])}else z=S.calculatePixelsToTileUnitsMatrix(h);else z=new Float32Array([S.pixelsToGLUnits[0],0,0,S.pixelsToGLUnits[1]]);const F={u_camera_to_center_distance:S.cameraToCenterDistance,u_matrix:m.translatePosMatrix(c.projMatrix,h,w.paint.get("circle-translate"),w.paint.get("circle-translate-anchor")),u_device_pixel_ratio:o.exported.devicePixelRatio,u_extrude_scale:z,u_inv_rot_matrix:Va,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(I){F.u_inv_rot_matrix=_,F.u_merc_center=v,F.u_tile_id=[c.canonical.x,c.canonical.y,1<<c.canonical.z],F.u_zoom_transition=o.globeToMercatorTransition(S.zoom);const N=v[0]*o.EXTENT,q=v[1]*o.EXTENT;F.u_up_dir=S.projection.upVector(new o.CanonicalTileID(0,0,0),N,q)}return F},Ko=m=>{const c=[];return m.paint.get("circle-pitch-alignment")==="map"&&c.push("PITCH_WITH_MAP"),m.paint.get("circle-pitch-scale")==="map"&&c.push("SCALE_WITH_MAP"),c},Fu=(m,c,h,_)=>{const v=o.EXTENT/h.tileSize;return{u_matrix:m,u_camera_to_center_distance:c.getCameraToCenterDistance(_),u_extrude_scale:[c.pixelsToGLUnits[0]/v,c.pixelsToGLUnits[1]/v]}},zl=(m,c,h=1)=>({u_matrix:m,u_color:c,u_overlay:0,u_overlay_scale:h}),Zs=o.create(),Lo=(m,c,h,_,v,w,S)=>{const I=m.transform,z=I.projection.name==="globe",F=z?o.globePixelsToTileUnits(I.zoom,c.canonical)*I._pixelsPerMercatorPixel:_r(h,1,w),N={u_matrix:c.projMatrix,u_extrude_scale:F,u_intensity:S,u_inv_rot_matrix:Zs,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(z){N.u_inv_rot_matrix=_,N.u_merc_center=v,N.u_tile_id=[c.canonical.x,c.canonical.y,1<<c.canonical.z],N.u_zoom_transition=o.globeToMercatorTransition(I.zoom);const q=v[0]*o.EXTENT,Q=v[1]*o.EXTENT;N.u_up_dir=I.projection.upVector(new o.CanonicalTileID(0,0,0),q,Q)}return N},Ac=(m,c,h,_,v,w,S)=>{const I=m.transform,z=I.calculatePixelsToTileUnitsMatrix(c);return{u_matrix:xs(m,c,h,_),u_pixels_to_tile_units:z,u_device_pixel_ratio:w,u_units_to_pixels:[1/I.pixelsToGLUnits[0],1/I.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:v,u_texsize:Dl(h)?c.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:Ol(c,m.transform),u_alpha_discard_threshold:0,u_trim_offset:S}},Nu=(m,c,h,_,v)=>{const w=m.transform;return{u_matrix:xs(m,c,h,_),u_texsize:c.imageAtlasTexture.size,u_pixels_to_tile_units:w.calculatePixelsToTileUnitsMatrix(c),u_device_pixel_ratio:v,u_image:0,u_tile_units_to_pixels:Ol(c,w),u_units_to_pixels:[1/w.pixelsToGLUnits[0],1/w.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function Ol(m,c){return 1/_r(m,1,c.tileZoom)}function xs(m,c,h,_){return m.translatePosMatrix(_||c.tileID.projMatrix,c,h.paint.get("line-translate"),h.paint.get("line-translate-anchor"))}function Dl(m){const c=m.paint.get("line-dasharray").value;return c.value||c.kind!=="constant"}const Cf=(m,c,h,_,v,w)=>{return{u_matrix:m,u_tl_parent:c,u_scale_parent:h,u_fade_t:_.mix,u_opacity:_.opacity*v.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:v.paint.get("raster-brightness-min"),u_brightness_high:v.paint.get("raster-brightness-max"),u_saturation_factor:(I=v.paint.get("raster-saturation"),I>0?1-1/(1.001-I):-I),u_contrast_factor:(S=v.paint.get("raster-contrast"),S>0?1/(1-S):1+S),u_spin_weights:Dt(v.paint.get("raster-hue-rotate")),u_perspective_transform:w};var S,I};function Dt(m){m*=Math.PI/180;const c=Math.sin(m),h=Math.cos(m);return[(2*h+1)/3,(-Math.sqrt(3)*c-h+1)/3,(Math.sqrt(3)*c-h+1)/3]}const te=o.create(),Be=(m,c,h,_,v,w,S,I,z,F,N,q,Q,it,rt,ot)=>{const at=v.transform,K={u_is_size_zoom_constant:+(m==="constant"||m==="source"),u_is_size_feature_constant:+(m==="constant"||m==="camera"),u_size_t:c?c.uSizeT:0,u_size:c?c.uSize:0,u_camera_to_center_distance:at.cameraToCenterDistance,u_rotate_symbol:+h,u_aspect_ratio:at.width/at.height,u_fade_change:v.options.fadeDuration?v.symbolFadeChange:1,u_matrix:w,u_label_plane_matrix:S,u_coord_matrix:I,u_is_text:+z,u_pitch_with_map:+_,u_texsize:F,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:te,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:te,u_up_vector:[0,-1,0]};return ot.name==="globe"&&(K.u_tile_id=[N.canonical.x,N.canonical.y,1<<N.canonical.z],K.u_zoom_transition=q,K.u_inv_rot_matrix=it,K.u_merc_center=Q,K.u_camera_forward=at._camera.forward(),K.u_ecef_origin=o.globeECEFOrigin(at.globeMatrix,N.toUnwrapped()),K.u_tile_matrix=Float32Array.from(at.globeMatrix),K.u_up_vector=rt),K},pn=(m,c,h,_,v,w,S,I,z,F,N,q,Q,it,rt,ot,at)=>o.extend(Be(m,c,h,_,v,w,S,I,z,F,q,Q,it,rt,ot,at),{u_gamma_scale:_?v.transform.cameraToCenterDistance*Math.cos(v.terrain?0:v.transform._pitch):1,u_device_pixel_ratio:o.exported.devicePixelRatio,u_is_halo:+N}),Sr=(m,c,h,_,v,w,S,I,z,F,N,q,Q,it,rt,ot)=>o.extend(pn(m,c,h,_,v,w,S,I,!0,z,!0,N,q,Q,it,rt,ot),{u_texsize_icon:F,u_texture_icon:1}),er=(m,c,h)=>({u_matrix:m,u_opacity:c,u_color:h}),Gr=(m,c,h,_,v)=>o.extend(function(w,S,I){const z=S.imageManager.getPattern(w.toString()),{width:F,height:N}=S.imageManager.getPixelSize(),q=Math.pow(2,I.tileID.overscaledZ),Q=I.tileSize*Math.pow(2,S.transform.tileZoom)/q,it=Q*(I.tileID.canonical.x+I.tileID.wrap*q),rt=Q*I.tileID.canonical.y;return{u_image:0,u_pattern_tl:z.tl,u_pattern_br:z.br,u_texsize:[F,N],u_pattern_size:z.displaySize,u_tile_units_to_pixels:1/_r(I,1,S.transform.tileZoom),u_pixel_coord_upper:[it>>16,rt>>16],u_pixel_coord_lower:[65535&it,65535&rt]}}(_,h,v),{u_matrix:m,u_opacity:c}),pi={fillExtrusion:m=>({u_matrix:new o.UniformMatrix4f(m),u_lightpos:new o.Uniform3f(m),u_lightintensity:new o.Uniform1f(m),u_lightcolor:new o.Uniform3f(m),u_vertical_gradient:new o.Uniform1f(m),u_opacity:new o.Uniform1f(m),u_edge_radius:new o.Uniform1f(m),u_ao:new o.Uniform2f(m),u_tile_id:new o.Uniform3f(m),u_zoom_transition:new o.Uniform1f(m),u_inv_rot_matrix:new o.UniformMatrix4f(m),u_merc_center:new o.Uniform2f(m),u_up_dir:new o.Uniform3f(m),u_height_lift:new o.Uniform1f(m)}),fillExtrusionPattern:m=>({u_matrix:new o.UniformMatrix4f(m),u_lightpos:new o.Uniform3f(m),u_lightintensity:new o.Uniform1f(m),u_lightcolor:new o.Uniform3f(m),u_vertical_gradient:new o.Uniform1f(m),u_height_factor:new o.Uniform1f(m),u_edge_radius:new o.Uniform1f(m),u_ao:new o.Uniform2f(m),u_tile_id:new o.Uniform3f(m),u_zoom_transition:new o.Uniform1f(m),u_inv_rot_matrix:new o.UniformMatrix4f(m),u_merc_center:new o.Uniform2f(m),u_up_dir:new o.Uniform3f(m),u_height_lift:new o.Uniform1f(m),u_image:new o.Uniform1i(m),u_texsize:new o.Uniform2f(m),u_pixel_coord_upper:new o.Uniform2f(m),u_pixel_coord_lower:new o.Uniform2f(m),u_tile_units_to_pixels:new o.Uniform1f(m),u_opacity:new o.Uniform1f(m)}),fill:m=>({u_matrix:new o.UniformMatrix4f(m)}),fillPattern:m=>({u_matrix:new o.UniformMatrix4f(m),u_image:new o.Uniform1i(m),u_texsize:new o.Uniform2f(m),u_pixel_coord_upper:new o.Uniform2f(m),u_pixel_coord_lower:new o.Uniform2f(m),u_tile_units_to_pixels:new o.Uniform1f(m)}),fillOutline:m=>({u_matrix:new o.UniformMatrix4f(m),u_world:new o.Uniform2f(m)}),fillOutlinePattern:m=>({u_matrix:new o.UniformMatrix4f(m),u_world:new o.Uniform2f(m),u_image:new o.Uniform1i(m),u_texsize:new o.Uniform2f(m),u_pixel_coord_upper:new o.Uniform2f(m),u_pixel_coord_lower:new o.Uniform2f(m),u_tile_units_to_pixels:new o.Uniform1f(m)}),circle:m=>({u_camera_to_center_distance:new o.Uniform1f(m),u_extrude_scale:new o.UniformMatrix2f(m),u_device_pixel_ratio:new o.Uniform1f(m),u_matrix:new o.UniformMatrix4f(m),u_inv_rot_matrix:new o.UniformMatrix4f(m),u_merc_center:new o.Uniform2f(m),u_tile_id:new o.Uniform3f(m),u_zoom_transition:new o.Uniform1f(m),u_up_dir:new o.Uniform3f(m)}),collisionBox:m=>({u_matrix:new o.UniformMatrix4f(m),u_camera_to_center_distance:new o.Uniform1f(m),u_extrude_scale:new o.Uniform2f(m)}),collisionCircle:m=>({u_matrix:new o.UniformMatrix4f(m),u_inv_matrix:new o.UniformMatrix4f(m),u_camera_to_center_distance:new o.Uniform1f(m),u_viewport_size:new o.Uniform2f(m)}),debug:m=>({u_color:new o.UniformColor(m),u_matrix:new o.UniformMatrix4f(m),u_overlay:new o.Uniform1i(m),u_overlay_scale:new o.Uniform1f(m)}),clippingMask:m=>({u_matrix:new o.UniformMatrix4f(m)}),heatmap:m=>({u_extrude_scale:new o.Uniform1f(m),u_intensity:new o.Uniform1f(m),u_matrix:new o.UniformMatrix4f(m),u_inv_rot_matrix:new o.UniformMatrix4f(m),u_merc_center:new o.Uniform2f(m),u_tile_id:new o.Uniform3f(m),u_zoom_transition:new o.Uniform1f(m),u_up_dir:new o.Uniform3f(m)}),heatmapTexture:m=>({u_image:new o.Uniform1i(m),u_color_ramp:new o.Uniform1i(m),u_opacity:new o.Uniform1f(m)}),hillshade:m=>({u_matrix:new o.UniformMatrix4f(m),u_image:new o.Uniform1i(m),u_latrange:new o.Uniform2f(m),u_light:new o.Uniform2f(m),u_shadow:new o.UniformColor(m),u_highlight:new o.UniformColor(m),u_accent:new o.UniformColor(m)}),hillshadePrepare:m=>({u_matrix:new o.UniformMatrix4f(m),u_image:new o.Uniform1i(m),u_dimension:new o.Uniform2f(m),u_zoom:new o.Uniform1f(m),u_unpack:new o.Uniform4f(m)}),line:m=>({u_matrix:new o.UniformMatrix4f(m),u_pixels_to_tile_units:new o.UniformMatrix2f(m),u_device_pixel_ratio:new o.Uniform1f(m),u_units_to_pixels:new o.Uniform2f(m),u_dash_image:new o.Uniform1i(m),u_gradient_image:new o.Uniform1i(m),u_image_height:new o.Uniform1f(m),u_texsize:new o.Uniform2f(m),u_tile_units_to_pixels:new o.Uniform1f(m),u_alpha_discard_threshold:new o.Uniform1f(m),u_trim_offset:new o.Uniform2f(m)}),linePattern:m=>({u_matrix:new o.UniformMatrix4f(m),u_texsize:new o.Uniform2f(m),u_pixels_to_tile_units:new o.UniformMatrix2f(m),u_device_pixel_ratio:new o.Uniform1f(m),u_image:new o.Uniform1i(m),u_units_to_pixels:new o.Uniform2f(m),u_tile_units_to_pixels:new o.Uniform1f(m),u_alpha_discard_threshold:new o.Uniform1f(m)}),raster:m=>({u_matrix:new o.UniformMatrix4f(m),u_tl_parent:new o.Uniform2f(m),u_scale_parent:new o.Uniform1f(m),u_fade_t:new o.Uniform1f(m),u_opacity:new o.Uniform1f(m),u_image0:new o.Uniform1i(m),u_image1:new o.Uniform1i(m),u_brightness_low:new o.Uniform1f(m),u_brightness_high:new o.Uniform1f(m),u_saturation_factor:new o.Uniform1f(m),u_contrast_factor:new o.Uniform1f(m),u_spin_weights:new o.Uniform3f(m),u_perspective_transform:new o.Uniform2f(m)}),symbolIcon:m=>({u_is_size_zoom_constant:new o.Uniform1i(m),u_is_size_feature_constant:new o.Uniform1i(m),u_size_t:new o.Uniform1f(m),u_size:new o.Uniform1f(m),u_camera_to_center_distance:new o.Uniform1f(m),u_rotate_symbol:new o.Uniform1i(m),u_aspect_ratio:new o.Uniform1f(m),u_fade_change:new o.Uniform1f(m),u_matrix:new o.UniformMatrix4f(m),u_label_plane_matrix:new o.UniformMatrix4f(m),u_coord_matrix:new o.UniformMatrix4f(m),u_is_text:new o.Uniform1i(m),u_pitch_with_map:new o.Uniform1i(m),u_texsize:new o.Uniform2f(m),u_tile_id:new o.Uniform3f(m),u_zoom_transition:new o.Uniform1f(m),u_inv_rot_matrix:new o.UniformMatrix4f(m),u_merc_center:new o.Uniform2f(m),u_camera_forward:new o.Uniform3f(m),u_tile_matrix:new o.UniformMatrix4f(m),u_up_vector:new o.Uniform3f(m),u_ecef_origin:new o.Uniform3f(m),u_texture:new o.Uniform1i(m)}),symbolSDF:m=>({u_is_size_zoom_constant:new o.Uniform1i(m),u_is_size_feature_constant:new o.Uniform1i(m),u_size_t:new o.Uniform1f(m),u_size:new o.Uniform1f(m),u_camera_to_center_distance:new o.Uniform1f(m),u_rotate_symbol:new o.Uniform1i(m),u_aspect_ratio:new o.Uniform1f(m),u_fade_change:new o.Uniform1f(m),u_matrix:new o.UniformMatrix4f(m),u_label_plane_matrix:new o.UniformMatrix4f(m),u_coord_matrix:new o.UniformMatrix4f(m),u_is_text:new o.Uniform1i(m),u_pitch_with_map:new o.Uniform1i(m),u_texsize:new o.Uniform2f(m),u_texture:new o.Uniform1i(m),u_gamma_scale:new o.Uniform1f(m),u_device_pixel_ratio:new o.Uniform1f(m),u_tile_id:new o.Uniform3f(m),u_zoom_transition:new o.Uniform1f(m),u_inv_rot_matrix:new o.UniformMatrix4f(m),u_merc_center:new o.Uniform2f(m),u_camera_forward:new o.Uniform3f(m),u_tile_matrix:new o.UniformMatrix4f(m),u_up_vector:new o.Uniform3f(m),u_ecef_origin:new o.Uniform3f(m),u_is_halo:new o.Uniform1i(m)}),symbolTextAndIcon:m=>({u_is_size_zoom_constant:new o.Uniform1i(m),u_is_size_feature_constant:new o.Uniform1i(m),u_size_t:new o.Uniform1f(m),u_size:new o.Uniform1f(m),u_camera_to_center_distance:new o.Uniform1f(m),u_rotate_symbol:new o.Uniform1i(m),u_aspect_ratio:new o.Uniform1f(m),u_fade_change:new o.Uniform1f(m),u_matrix:new o.UniformMatrix4f(m),u_label_plane_matrix:new o.UniformMatrix4f(m),u_coord_matrix:new o.UniformMatrix4f(m),u_is_text:new o.Uniform1i(m),u_pitch_with_map:new o.Uniform1i(m),u_texsize:new o.Uniform2f(m),u_texsize_icon:new o.Uniform2f(m),u_texture:new o.Uniform1i(m),u_texture_icon:new o.Uniform1i(m),u_gamma_scale:new o.Uniform1f(m),u_device_pixel_ratio:new o.Uniform1f(m),u_is_halo:new o.Uniform1i(m)}),background:m=>({u_matrix:new o.UniformMatrix4f(m),u_opacity:new o.Uniform1f(m),u_color:new o.UniformColor(m)}),backgroundPattern:m=>({u_matrix:new o.UniformMatrix4f(m),u_opacity:new o.Uniform1f(m),u_image:new o.Uniform1i(m),u_pattern_tl:new o.Uniform2f(m),u_pattern_br:new o.Uniform2f(m),u_texsize:new o.Uniform2f(m),u_pattern_size:new o.Uniform2f(m),u_pixel_coord_upper:new o.Uniform2f(m),u_pixel_coord_lower:new o.Uniform2f(m),u_tile_units_to_pixels:new o.Uniform1f(m)}),terrainRaster:Tc,terrainDepth:Tc,skybox:m=>({u_matrix:new o.UniformMatrix4f(m),u_sun_direction:new o.Uniform3f(m),u_cubemap:new o.Uniform1i(m),u_opacity:new o.Uniform1f(m),u_temporal_offset:new o.Uniform1f(m)}),skyboxGradient:m=>({u_matrix:new o.UniformMatrix4f(m),u_color_ramp:new o.Uniform1i(m),u_center_direction:new o.Uniform3f(m),u_radius:new o.Uniform1f(m),u_opacity:new o.Uniform1f(m),u_temporal_offset:new o.Uniform1f(m)}),skyboxCapture:m=>({u_matrix_3f:new o.UniformMatrix3f(m),u_sun_direction:new o.Uniform3f(m),u_sun_intensity:new o.Uniform1f(m),u_color_tint_r:new o.Uniform4f(m),u_color_tint_m:new o.Uniform4f(m),u_luminance:new o.Uniform1f(m)}),globeRaster:m=>({u_proj_matrix:new o.UniformMatrix4f(m),u_globe_matrix:new o.UniformMatrix4f(m),u_normalize_matrix:new o.UniformMatrix4f(m),u_merc_matrix:new o.UniformMatrix4f(m),u_zoom_transition:new o.Uniform1f(m),u_merc_center:new o.Uniform2f(m),u_image0:new o.Uniform1i(m),u_grid_matrix:new o.UniformMatrix3f(m),u_skirt_height:new o.Uniform1f(m),u_frustum_tl:new o.Uniform3f(m),u_frustum_tr:new o.Uniform3f(m),u_frustum_br:new o.Uniform3f(m),u_frustum_bl:new o.Uniform3f(m),u_globe_pos:new o.Uniform3f(m),u_globe_radius:new o.Uniform1f(m),u_viewport:new o.Uniform2f(m)}),globeAtmosphere:m=>({u_frustum_tl:new o.Uniform3f(m),u_frustum_tr:new o.Uniform3f(m),u_frustum_br:new o.Uniform3f(m),u_frustum_bl:new o.Uniform3f(m),u_horizon:new o.Uniform1f(m),u_transition:new o.Uniform1f(m),u_fadeout_range:new o.Uniform1f(m),u_color:new o.Uniform4f(m),u_high_color:new o.Uniform4f(m),u_space_color:new o.Uniform4f(m),u_star_intensity:new o.Uniform1f(m),u_star_density:new o.Uniform1f(m),u_star_size:new o.Uniform1f(m),u_temporal_offset:new o.Uniform1f(m),u_horizon_angle:new o.Uniform1f(m),u_rotation_matrix:new o.UniformMatrix4f(m)})};let Li;function mi(m,c,h,_,v,w,S){const I=m.context,z=I.gl,F=m.transform,N=m.useProgram("collisionBox"),q=[];let Q=0,it=0;for(let mt=0;mt<_.length;mt++){const Tt=_[mt],wt=c.getTile(Tt),Mt=wt.getBucket(h);if(!Mt)continue;const Ft=De(Tt,Mt,F);let Vt=Ft;v[0]===0&&v[1]===0||(Vt=m.translatePosMatrix(Ft,wt,v,w));const Ht=S?Mt.textCollisionBox:Mt.iconCollisionBox,ke=Mt.collisionCircleArray;if(ke.length>0){const Nt=o.create(),ne=Vt;o.mul(Nt,Mt.placementInvProjMatrix,F.glCoordMatrix),o.mul(Nt,Nt,Mt.placementViewportMatrix),q.push({circleArray:ke,circleOffset:it,transform:ne,invTransform:Nt,projection:Mt.getProjection()}),Q+=ke.length/4,it=Q}Ht&&(m.terrain&&m.terrain.setupElevationDraw(wt,N),N.draw(I,z.LINES,o.DepthMode.disabled,o.StencilMode.disabled,m.colorModeForRenderPass(),o.CullFaceMode.disabled,Fu(Vt,F,wt,Mt.getProjection()),h.id,Ht.layoutVertexBuffer,Ht.indexBuffer,Ht.segments,null,F.zoom,null,[Ht.collisionVertexBuffer,Ht.collisionVertexBufferExt]))}if(!S||!q.length)return;const rt=m.useProgram("collisionCircle"),ot=new o.StructArrayLayout2f1f2i16;ot.resize(4*Q),ot._trim();let at=0;for(const mt of q)for(let Tt=0;Tt<mt.circleArray.length/4;Tt++){const wt=4*Tt,Mt=mt.circleArray[wt+0],Ft=mt.circleArray[wt+1],Vt=mt.circleArray[wt+2],Ht=mt.circleArray[wt+3];ot.emplace(at++,Mt,Ft,Vt,Ht,0),ot.emplace(at++,Mt,Ft,Vt,Ht,1),ot.emplace(at++,Mt,Ft,Vt,Ht,2),ot.emplace(at++,Mt,Ft,Vt,Ht,3)}(!Li||Li.length<2*Q)&&(Li=function(mt){const Tt=2*mt,wt=new o.StructArrayLayout3ui6;wt.resize(Tt),wt._trim();for(let Mt=0;Mt<Tt;Mt++){const Ft=6*Mt;wt.uint16[Ft+0]=4*Mt+0,wt.uint16[Ft+1]=4*Mt+1,wt.uint16[Ft+2]=4*Mt+2,wt.uint16[Ft+3]=4*Mt+2,wt.uint16[Ft+4]=4*Mt+3,wt.uint16[Ft+5]=4*Mt+0}return wt}(Q));const K=I.createIndexBuffer(Li,!0),ht=I.createVertexBuffer(ot,o.collisionCircleLayout.members,!0);for(const mt of q){const Tt={u_matrix:mt.transform,u_inv_matrix:mt.invTransform,u_camera_to_center_distance:(ut=F).getCameraToCenterDistance(mt.projection),u_viewport_size:[ut.width,ut.height]};rt.draw(I,z.TRIANGLES,o.DepthMode.disabled,o.StencilMode.disabled,m.colorModeForRenderPass(),o.CullFaceMode.disabled,Tt,h.id,ht,K,o.SegmentVector.simpleSegment(0,2*mt.circleOffset,mt.circleArray.length,mt.circleArray.length/2),null,F.zoom)}var ut;ht.destroy(),K.destroy()}const ai=o.create();function Jo({width:m,height:c,anchor:h,textOffset:_,textScale:v},w){const{horizontalAlign:S,verticalAlign:I}=o.getAnchorAlignment(h),z=-(S-.5)*m,F=-(I-.5)*c,N=o.evaluateVariableOffset(h,_);return new o.pointGeometry((z/v+N[0])*w,(F/v+N[1])*w)}function lo(m,c,h,_,v,w,S,I,z,F,N){const q=m.text.placedSymbolArray,Q=m.text.dynamicLayoutVertexArray,it=m.icon.dynamicLayoutVertexArray,rt={},ot=m.getProjection(),at=xn(I,ot,w),K=w.elevation,ht=ot.upVectorScale(I.canonical,w.center.lat,w.worldSize).metersToTile;Q.clear();for(let ut=0;ut<q.length;ut++){const mt=q.get(ut),{tileAnchorX:Tt,tileAnchorY:wt,numGlyphs:Mt}=mt,Ft=m.allowVerticalPlacement&&!mt.placedOrientation,Vt=mt.hidden||!mt.crossTileID||Ft?null:_[mt.crossTileID];if(Vt){let Ht=0,ke=0,Nt=0;if(K){const Je=K?K.getAtTileOffset(I,Tt,wt):0,[Pn,We,je]=ot.upVector(I.canonical,Tt,wt);Ht=Je*Pn*ht,ke=Je*We*ht,Nt=Je*je*ht}let[ne,Xt,ue,Gt]=Se(mt.projectedAnchorX+Ht,mt.projectedAnchorY+ke,mt.projectedAnchorZ+Nt,h?at:S);const Ot=Dn(w.getCameraToCenterDistance(ot),Gt);let Wt=v.evaluateSizeForFeature(m.textSizeData,F,mt)*Ot/o.ONE_EM;h&&(Wt*=m.tilePixelRatio/z);const ie=Jo(Vt,Wt);h?({x:ne,y:Xt,z:ue}=ot.projectTilePoint(Tt+ie.x,wt+ie.y,I.canonical),[ne,Xt,ue]=Se(ne+Ht,Xt+ke,ue+Nt,S)):(c&&ie._rotate(-w.angle),ne+=ie.x,Xt+=ie.y,ue=0);const pe=m.allowVerticalPlacement&&mt.placedOrientation===o.WritingMode.vertical?Math.PI/2:0;for(let Je=0;Je<Mt;Je++)o.addDynamicAttributes(Q,ne,Xt,ue,pe);N&&mt.associatedIconIndex>=0&&(rt[mt.associatedIconIndex]={x:ne,y:Xt,z:ue,angle:pe})}else It(Mt,Q)}if(N){it.clear();const ut=m.icon.placedSymbolArray;for(let mt=0;mt<ut.length;mt++){const Tt=ut.get(mt),{numGlyphs:wt}=Tt,Mt=rt[mt];if(Tt.hidden||!Mt)It(wt,it);else{const{x:Ft,y:Vt,z:Ht,angle:ke}=Mt;for(let Nt=0;Nt<wt;Nt++)o.addDynamicAttributes(it,Ft,Vt,Ht,ke)}}m.icon.dynamicLayoutVertexBuffer.updateData(it)}m.text.dynamicLayoutVertexBuffer.updateData(Q)}function Qi(m,c,h){return h.iconsInText&&c?"symbolTextAndIcon":m?"symbolSDF":"symbolIcon"}function sa(m,c,h,_,v,w,S,I,z,F,N,q){const Q=m.context,it=Q.gl,rt=m.transform,ot=I==="map",at=z==="map",K=ot&&h.layout.get("symbol-placement")!=="point",ht=ot&&!at&&!K,ut=h.layout.get("symbol-sort-key").constantOr(1)!==void 0;let mt=!1;const Tt=m.depthModeForSublayer(0,o.DepthMode.ReadOnly),wt=[o.mercatorXfromLng(rt.center.lng),o.mercatorYfromLat(rt.center.lat)],Mt=h.layout.get("text-variable-anchor"),Ft=rt.projection.name==="globe",Vt=[],Ht=[0,-1,0];let ke=Ht;!Ft&&!rt.mercatorFromTransition||ot||(ke=function(Nt){const ne=Nt._camera.getWorldToCamera(Nt.worldSize,1),Xt=o.multiply([],ne,Nt.globeMatrix);o.invert(Xt,Xt);const ue=[0,0,0],Gt=[0,1,0,0];return o.transformMat4$1(Gt,Gt,Xt),ue[0]=Gt[0],ue[1]=Gt[1],ue[2]=Gt[2],o.normalize(ue,ue),ue}(rt));for(const Nt of _){const ne=c.getTile(Nt),Xt=ne.getBucket(h);if(!Xt||Xt.projection.name==="mercator"&&Ft)continue;const ue=v?Xt.text:Xt.icon;if(!ue||Xt.fullyClipped||!ue.segments.get().length)continue;const Gt=ue.programConfigurations.get(h.id),Ot=v||Xt.sdfIcons,Wt=v?Xt.textSizeData:Xt.iconSizeData,ie=at||rt.pitch!==0,pe=o.evaluateSizeForZoom(Wt,rt.zoom);let Je,Pn,We,je,nn=[0,0],Nn=null;if(v){if(Pn=ne.glyphAtlasTexture,We=it.LINEAR,Je=ne.glyphAtlasTexture.size,Xt.iconsInText){nn=ne.imageAtlasTexture.size,Nn=ne.imageAtlasTexture;const Qo=Wt.kind==="composite"||Wt.kind==="camera";je=ie||m.options.rotating||m.options.zooming||Qo?it.LINEAR:it.NEAREST}}else{const Qo=h.layout.get("icon-size").constantOr(0)!==1||Xt.iconsNeedLinear;Pn=ne.imageAtlasTexture,We=Ot||m.options.rotating||m.options.zooming||Qo||ie?it.LINEAR:it.NEAREST,Je=ne.imageAtlasTexture.size}const sn=Xt.projection.name==="globe",ar=sn?ke:Ht,yr=sn?o.globeToMercatorTransition(rt.zoom):0,Mr=xn(Nt,Xt.getProjection(),rt),wr=rt.calculatePixelsToTileUnitsMatrix(ne),vi=Ea(Mr,ne.tileID.canonical,at,ot,rt,Xt.getProjection(),wr),zo=m.terrain&&at&&K?o.invert(o.create(),vi):ai,Ia=fs(Mr,ne.tileID.canonical,at,ot,rt,Xt.getProjection(),wr),Ss=Mt&&Xt.hasTextData(),Fr=h.layout.get("icon-text-fit")!=="none"&&Ss&&Xt.hasIconData();if(K){const Qo=rt.elevation,ua=Qo?Qo.getAtTileOffsetFunc(Nt,rt.center.lat,rt.worldSize,Xt.getProjection()):null,Ms=Yd(Mr,ne.tileID.canonical,at,ot,rt,Xt.getProjection(),wr);wo(Xt,Mr,m,v,Ms,Ia,at,F,ua,Nt)}const Er=K||v&&Mt||Fr,ir=m.translatePosMatrix(Mr,ne,w,S),si=Er?ai:vi,ho=m.translatePosMatrix(Ia,ne,w,S,!0),zr=Xt.getProjection().createInversionMatrix(rt,Nt.canonical),fo=[];m.terrainRenderModeElevated()&&at&&fo.push("PITCH_WITH_MAP_TERRAIN"),sn&&fo.push("PROJECTION_GLOBE_VIEW"),Er&&fo.push("PROJECTED_POS_ON_VIEWPORT");const po=Ot&&h.paint.get(v?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Js;Js=Ot?Xt.iconsInText?Sr(Wt.kind,pe,ht,at,m,ir,si,ho,Je,nn,Nt,yr,wt,zr,ar,Xt.getProjection()):pn(Wt.kind,pe,ht,at,m,ir,si,ho,v,Je,!0,Nt,yr,wt,zr,ar,Xt.getProjection()):Be(Wt.kind,pe,ht,at,m,ir,si,ho,v,Je,Nt,yr,wt,zr,ar,Xt.getProjection());const Fc={program:m.useProgram(Qi(Ot,v,Xt),Gt,fo),buffers:ue,uniformValues:Js,atlasTexture:Pn,atlasTextureIcon:Nn,atlasInterpolation:We,atlasInterpolationIcon:je,isSDF:Ot,hasHalo:po,tile:ne,labelPlaneMatrixInv:zo};if(ut&&Xt.canOverlap){mt=!0;const Qo=ue.segments.get();for(const ua of Qo)Vt.push({segments:new o.SegmentVector([ua]),sortKey:ua.sortKey,state:Fc})}else Vt.push({segments:ue.segments,sortKey:0,state:Fc})}mt&&Vt.sort((Nt,ne)=>Nt.sortKey-ne.sortKey);for(const Nt of Vt){const ne=Nt.state;if(m.terrain&&m.terrain.setupElevationDraw(ne.tile,ne.program,{useDepthForOcclusion:!Ft,labelPlaneMatrixInv:ne.labelPlaneMatrixInv}),Q.activeTexture.set(it.TEXTURE0),ne.atlasTexture.bind(ne.atlasInterpolation,it.CLAMP_TO_EDGE),ne.atlasTextureIcon&&(Q.activeTexture.set(it.TEXTURE1),ne.atlasTextureIcon&&ne.atlasTextureIcon.bind(ne.atlasInterpolationIcon,it.CLAMP_TO_EDGE)),ne.isSDF){const Xt=ne.uniformValues;ne.hasHalo&&(Xt.u_is_halo=1,ws(ne.buffers,Nt.segments,h,m,ne.program,Tt,N,q,Xt)),Xt.u_is_halo=0}ws(ne.buffers,Nt.segments,h,m,ne.program,Tt,N,q,ne.uniformValues)}}function ws(m,c,h,_,v,w,S,I,z){const F=_.context,N=[m.dynamicLayoutVertexBuffer,m.opacityVertexBuffer,m.globeExtVertexBuffer];v.draw(F,F.gl.TRIANGLES,w,S,I,o.CullFaceMode.disabled,z,h.id,m.layoutVertexBuffer,m.indexBuffer,c,h.paint,_.transform.zoom,m.programConfigurations.get(h.id),N)}function Rl(m,c,h,_,v,w,S){const I=m.context.gl,z=h.paint.get("fill-pattern"),F=z&&z.constantOr(1);let N,q,Q,it,rt;S?(q=F&&!h.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",N=I.LINES):(q=F?"fillPattern":"fill",N=I.TRIANGLES);for(const ot of _){const at=c.getTile(ot);if(F&&!at.patternsLoaded())continue;const K=at.getBucket(h);if(!K)continue;m.prepareDrawTile();const ht=K.programConfigurations.get(h.id),ut=m.useProgram(q,ht);F&&(m.context.activeTexture.set(I.TEXTURE0),at.imageAtlasTexture.bind(I.LINEAR,I.CLAMP_TO_EDGE),ht.updatePaintBuffers());const mt=z.constantOr(null);if(mt&&at.imageAtlas){const wt=at.imageAtlas.patternPositions[mt.toString()];wt&&ht.setConstantPatternPositions(wt)}const Tt=m.translatePosMatrix(ot.projMatrix,at,h.paint.get("fill-translate"),h.paint.get("fill-translate-anchor"));if(S){it=K.indexBuffer2,rt=K.segments2;const wt=m.terrain&&m.terrain.renderingToTexture?m.terrain.drapeBufferSize:[I.drawingBufferWidth,I.drawingBufferHeight];Q=q==="fillOutlinePattern"&&F?Qd(Tt,m,at,wt):vs(Tt,wt)}else it=K.indexBuffer,rt=K.segments,Q=F?bs(Tt,m,at):Pl(Tt);m.prepareDrawProgram(m.context,ut,ot.toUnwrapped()),ut.draw(m.context,N,v,m.stencilModeForClipping(ot),w,o.CullFaceMode.disabled,Q,h.id,K.layoutVertexBuffer,it,rt,h.paint,m.transform.zoom,ht)}}function Ga(m,c,h,_,v,w,S){const I=m.context,z=I.gl,F=m.transform,N=h.paint.get("fill-extrusion-pattern"),q=N.constantOr(1),Q=h.paint.get("fill-extrusion-opacity"),it=[h.paint.get("fill-extrusion-ambient-occlusion-intensity"),h.paint.get("fill-extrusion-ambient-occlusion-radius")],rt=h.layout.get("fill-extrusion-edge-radius"),ot=F.projection.name==="globe"?o.fillExtrusionHeightLift():0,at=F.projection.name==="globe",K=at?o.globeToMercatorTransition(F.zoom):0,ht=[o.mercatorXfromLng(F.center.lng),o.mercatorYfromLat(F.center.lat)],ut=[];at&&ut.push("PROJECTION_GLOBE_VIEW"),it[0]>0&&ut.push("FAUX_AO");for(const mt of _){const Tt=c.getTile(mt),wt=Tt.getBucket(h);if(!wt||wt.projection.name!==F.projection.name)continue;const Mt=wt.programConfigurations.get(h.id),Ft=m.useProgram(q?"fillExtrusionPattern":"fillExtrusion",Mt,ut);if(m.terrain){const ue=m.terrain;if(m.style.terrainSetForDrapingOnly())ue.setupElevationDraw(Tt,Ft,{useMeterToDem:!0});else{if(!wt.enableTerrain)continue;if(ue.setupElevationDraw(Tt,Ft,{useMeterToDem:!0}),Bl(I,c,mt,wt,h,ue),!wt.centroidVertexBuffer){const Gt=Ft.attributes.a_centroid_pos;Gt!==void 0&&z.vertexAttrib2f(Gt,0,0)}}}q&&(m.context.activeTexture.set(z.TEXTURE0),Tt.imageAtlasTexture.bind(z.LINEAR,z.CLAMP_TO_EDGE),Mt.updatePaintBuffers());const Vt=N.constantOr(null);if(Vt&&Tt.imageAtlas){const ue=Tt.imageAtlas.patternPositions[Vt.toString()];ue&&Mt.setConstantPatternPositions(ue)}const Ht=m.translatePosMatrix(mt.projMatrix,Tt,h.paint.get("fill-extrusion-translate"),h.paint.get("fill-extrusion-translate-anchor")),ke=F.projection.createInversionMatrix(F,mt.canonical),Nt=h.paint.get("fill-extrusion-vertical-gradient"),ne=q?Mc(Ht,m,Nt,Q,it,rt,mt,Tt,ot,K,ht,ke):Sc(Ht,m,Nt,Q,it,rt,mt,ot,K,ht,ke);m.prepareDrawProgram(I,Ft,mt.toUnwrapped());const Xt=[];m.terrain&&Xt.push(wt.centroidVertexBuffer),at&&Xt.push(wt.layoutVertexExtBuffer),Ft.draw(I,I.gl.TRIANGLES,v,w,S,o.CullFaceMode.backCCW,ne,h.id,wt.layoutVertexBuffer,wt.indexBuffer,wt.segments,h.paint,m.transform.zoom,Mt,Xt)}}function Bl(m,c,h,_,v,w){const S=[K=>{let ht=K.canonical.x-1,ut=K.wrap;return ht<0&&(ht=(1<<K.canonical.z)-1,ut--),new o.OverscaledTileID(K.overscaledZ,ut,K.canonical.z,ht,K.canonical.y)},K=>{let ht=K.canonical.x+1,ut=K.wrap;return ht===1<<K.canonical.z&&(ht=0,ut++),new o.OverscaledTileID(K.overscaledZ,ut,K.canonical.z,ht,K.canonical.y)},K=>new o.OverscaledTileID(K.overscaledZ,K.wrap,K.canonical.z,K.canonical.x,(K.canonical.y===0?1<<K.canonical.z:K.canonical.y)-1),K=>new o.OverscaledTileID(K.overscaledZ,K.wrap,K.canonical.z,K.canonical.x,K.canonical.y===(1<<K.canonical.z)-1?0:K.canonical.y+1)],I=K=>{const ht=c.getSource().minzoom,ut=Tt=>{const wt=c.getTileByID(Tt);if(wt&&wt.hasData())return wt.getBucket(v)},mt=[0,-1,1];for(const Tt of mt){if(K.overscaledZ+Tt<ht)continue;const wt=ut(K.calculateScaledKey(K.overscaledZ+Tt));if(wt)return wt}},z=[0,0,0],F=(K,ht)=>(z[0]=Math.min(K.min.y,ht.min.y),z[1]=Math.max(K.max.y,ht.max.y),z[2]=o.EXTENT-ht.min.x>K.max.x?ht.min.x-o.EXTENT:K.max.x,z),N=(K,ht)=>(z[0]=Math.min(K.min.x,ht.min.x),z[1]=Math.max(K.max.x,ht.max.x),z[2]=o.EXTENT-ht.min.y>K.max.y?ht.min.y-o.EXTENT:K.max.y,z),q=[(K,ht)=>F(K,ht),(K,ht)=>F(ht,K),(K,ht)=>N(K,ht),(K,ht)=>N(ht,K)],Q=new o.pointGeometry(0,0);let it,rt,ot;const at=(K,ht,ut,mt,Tt)=>{const wt=[[mt?ut:K,mt?K:ut,0],[mt?ut:ht,mt?ht:ut,0]],Mt=Tt<0?o.EXTENT+Tt:Tt,Ft=[mt?Mt:(K+ht)/2,mt?(K+ht)/2:Mt,0];return ut===0&&Tt<0||ut!==0&&Tt>0?w.getForTilePoints(ot,[Ft],!0,rt):wt.push(Ft),w.getForTilePoints(h,wt,!0,it),Math.max(wt[0][2],wt[1][2],Ft[2])/w.exaggeration()};for(let K=0;K<4;K++){const ht=(K<2?1:5)-K,ut=_.borders[K];if(ut.length===0)continue;const mt=ot=S[K](h),Tt=I(mt);if(!(Tt&&Tt instanceof o.FillExtrusionBucket&&Tt.enableTerrain)||_.borderDoneWithNeighborZ[K]===Tt.canonical.z&&Tt.borderDoneWithNeighborZ[ht]===_.canonical.z||(rt=w.findDEMTileFor(mt),!rt||!rt.dem))continue;if(!it){const Vt=w.findDEMTileFor(h);if(!Vt||!Vt.dem)return;it=Vt}const wt=Tt.borders[ht];let Mt=0;const Ft=Tt.borderDoneWithNeighborZ[ht]!==_.canonical.z;if(_.canonical.z===Tt.canonical.z){for(let Vt=0;Vt<ut.length;Vt++){const Ht=_.featuresOnBorder[ut[Vt]],ke=Ht.borders[K];let Nt;for(;Mt<wt.length&&(Nt=Tt.featuresOnBorder[wt[Mt]],!(Nt.borders[ht][1]>ke[0]+3));)Ft&&Tt.encodeCentroid(void 0,Nt,!1),Mt++;if(Nt&&Mt<wt.length){const ne=Mt;let Xt=0;for(;!(Nt.borders[ht][0]>ke[1]-3)&&(Xt++,++Mt!==wt.length);)Nt=Tt.featuresOnBorder[wt[Mt]];if(Nt=Tt.featuresOnBorder[wt[ne]],Ht.intersectsCount()>1||Nt.intersectsCount()>1||Xt!==1){Xt!==1&&(Mt=ne),_.encodeCentroid(void 0,Ht,!1),Ft&&Tt.encodeCentroid(void 0,Nt,!1);continue}const ue=q[K](Ht,Nt),Gt=K%2?o.EXTENT-1:0;Q.x=at(ue[0],Math.min(o.EXTENT-1,ue[1]),Gt,K<2,ue[2]),Q.y=0,_.encodeCentroid(Q,Ht,!1),Ft&&Tt.encodeCentroid(Q,Nt,!1)}else _.encodeCentroid(void 0,Ht,!1)}_.borderDoneWithNeighborZ[K]=Tt.canonical.z,_.needsCentroidUpdate=!0,Ft&&(Tt.borderDoneWithNeighborZ[ht]=_.canonical.z,Tt.needsCentroidUpdate=!0)}else{for(const Vt of ut)_.encodeCentroid(void 0,_.featuresOnBorder[Vt],!1);if(Ft){for(const Vt of wt)Tt.encodeCentroid(void 0,Tt.featuresOnBorder[Vt],!1);Tt.borderDoneWithNeighborZ[ht]=_.canonical.z,Tt.needsCentroidUpdate=!0}_.borderDoneWithNeighborZ[K]=Tt.canonical.z,_.needsCentroidUpdate=!0}}(_.needsCentroidUpdate||!_.centroidVertexBuffer&&_.centroidVertexArray.length!==0)&&_.uploadCentroid(m)}const Ic=new o.Color(1,0,0,1),ju=new o.Color(0,1,0,1),th=new o.Color(0,0,1,1),xr=new o.Color(1,0,1,1),dr=new o.Color(0,1,1,1);function Xs(m,c,h){const _=m.context,v=m.transform,w=_.gl,S=v.projection.name==="globe",I=S?["PROJECTION_GLOBE_VIEW"]:null;let z=h.projMatrix;if(S&&o.globeToMercatorTransition(v.zoom)>0){const Ht=o.transitionTileAABBinECEF(h.canonical,v),ke=o.globeDenormalizeECEF(Ht);z=o.multiply(new Float32Array(16),v.globeMatrix,ke),o.multiply(z,v.projMatrix,z)}const F=m.useProgram("debug",null,I),N=c.getTileByID(h.key);m.terrain&&m.terrain.setupElevationDraw(N,F);const q=o.DepthMode.disabled,Q=o.StencilMode.disabled,it=m.colorModeForRenderPass(),rt="$debug";_.activeTexture.set(w.TEXTURE0),m.emptyTexture.bind(w.LINEAR,w.CLAMP_TO_EDGE),S?N._makeGlobeTileDebugBuffers(m.context,v):N._makeDebugTileBoundsBuffers(m.context,v.projection);const ot=N._tileDebugBuffer||m.debugBuffer,at=N._tileDebugIndexBuffer||m.debugIndexBuffer,K=N._tileDebugSegments||m.debugSegments;F.draw(_,w.LINE_STRIP,q,Q,it,o.CullFaceMode.disabled,zl(z,o.Color.red),rt,ot,at,K,null,null,null,[N._globeTileDebugBorderBuffer]);const ht=N.latestRawTileData,ut=Math.floor((ht&&ht.byteLength||0)/1024),mt=c.getTile(h).tileSize,Tt=512/Math.min(mt,512)*(h.overscaledZ/v.zoom)*.5;let wt=h.canonical.toString();h.overscaledZ!==h.canonical.z&&(wt+=` => ${h.overscaledZ}`),wt+=` ${ut}kb`,function(Ht,ke){Ht.initDebugOverlayCanvas();const Nt=Ht.debugOverlayCanvas,ne=Ht.context.gl,Xt=Ht.debugOverlayCanvas.getContext("2d");Xt.clearRect(0,0,Nt.width,Nt.height),Xt.shadowColor="white",Xt.shadowBlur=2,Xt.lineWidth=1.5,Xt.strokeStyle="white",Xt.textBaseline="top",Xt.font="bold 36px Open Sans, sans-serif",Xt.fillText(ke,5,5),Xt.strokeText(ke,5,5),Ht.debugOverlayTexture.update(Nt),Ht.debugOverlayTexture.bind(ne.LINEAR,ne.CLAMP_TO_EDGE)}(m,wt);const Mt=N._tileDebugTextBuffer||m.debugBuffer,Ft=N._tileDebugTextIndexBuffer||m.quadTriangleIndexBuffer,Vt=N._tileDebugTextSegments||m.debugSegments;F.draw(_,w.TRIANGLES,q,Q,o.ColorMode.alphaBlended,o.CullFaceMode.disabled,zl(z,o.Color.transparent,Tt),rt,Mt,Ft,Vt,null,null,null,[N._globeTileDebugTextBuffer])}function to(m,c,h,_){Vi(m,0,c+h/2,m.transform.width,h,_)}function qa(m,c,h,_){Vi(m,c-h/2,0,h,m.transform.height,_)}function Vi(m,c,h,_,v,w){const S=m.context,I=S.gl;I.enable(I.SCISSOR_TEST),I.scissor(c*o.exported.devicePixelRatio,h*o.exported.devicePixelRatio,_*o.exported.devicePixelRatio,v*o.exported.devicePixelRatio),S.clear({color:w}),I.disable(I.SCISSOR_TEST)}const co=o.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:To}=co;function ko(m,c,h,_){m.emplaceBack(c,h,_)}class Es{constructor(c){this.vertexArray=new o.StructArrayLayout3f12,this.indices=new o.StructArrayLayout3ui6,ko(this.vertexArray,-1,-1,1),ko(this.vertexArray,1,-1,1),ko(this.vertexArray,-1,1,1),ko(this.vertexArray,1,1,1),ko(this.vertexArray,-1,-1,-1),ko(this.vertexArray,1,-1,-1),ko(this.vertexArray,-1,1,-1),ko(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=c.createVertexBuffer(this.vertexArray,To),this.indexBuffer=c.createIndexBuffer(this.indices),this.segment=o.SegmentVector.simpleSegment(0,0,36,12)}}function In(m,c,h,_,v,w){const S=m.gl,I=c.paint.get("sky-atmosphere-color"),z=c.paint.get("sky-atmosphere-halo-color"),F=c.paint.get("sky-atmosphere-sun-intensity"),N=((q,Q,it,rt,ot)=>({u_matrix_3f:q,u_sun_direction:Q,u_sun_intensity:it,u_color_tint_r:[rt.r,rt.g,rt.b,rt.a],u_color_tint_m:[ot.r,ot.g,ot.b,ot.a],u_luminance:5e-5}))(o.fromMat4(o.create$1(),_),v,F,I,z);S.framebufferTexture2D(S.FRAMEBUFFER,S.COLOR_ATTACHMENT0,S.TEXTURE_CUBE_MAP_POSITIVE_X+w,c.skyboxTexture,0),h.draw(m,S.TRIANGLES,o.DepthMode.disabled,o.StencilMode.disabled,o.ColorMode.unblended,o.CullFaceMode.frontCW,N,"skyboxCapture",c.skyboxGeometry.vertexBuffer,c.skyboxGeometry.indexBuffer,c.skyboxGeometry.segment)}const la=o.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class eh{constructor(c){const h=new o.StructArrayLayout5f20;h.emplaceBack(-1,1,1,0,0),h.emplaceBack(1,1,1,1,0),h.emplaceBack(1,-1,1,1,1),h.emplaceBack(-1,-1,1,0,1);const _=new o.StructArrayLayout3ui6;_.emplaceBack(0,1,2),_.emplaceBack(2,3,0),this.vertexBuffer=c.createVertexBuffer(h,la.members),this.indexBuffer=c.createIndexBuffer(_),this.segments=o.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Ys={symbol:function(m,c,h,_,v){if(m.renderPass!=="translucent")return;const w=o.StencilMode.disabled,S=m.colorModeForRenderPass();h.layout.get("text-variable-anchor")&&function(I,z,F,N,q,Q,it){const rt=z.transform,ot=q==="map",at=Q==="map";for(const K of I){const ht=N.getTile(K),ut=ht.getBucket(F);if(!ut||!ut.text||!ut.text.segments.get().length)continue;const mt=o.evaluateSizeForZoom(ut.textSizeData,rt.zoom),Tt=xn(K,ut.getProjection(),rt),wt=rt.calculatePixelsToTileUnitsMatrix(ht),Mt=Ea(Tt,ht.tileID.canonical,at,ot,rt,ut.getProjection(),wt),Ft=F.layout.get("icon-text-fit")!=="none"&&ut.hasIconData();if(mt){const Vt=Math.pow(2,rt.zoom-ht.tileID.overscaledZ);lo(ut,ot,at,it,o.symbolSize,rt,Mt,K,Vt,mt,Ft)}}}(_,m,h,c,h.layout.get("text-rotation-alignment"),h.layout.get("text-pitch-alignment"),v),h.paint.get("icon-opacity").constantOr(1)!==0&&sa(m,c,h,_,!1,h.paint.get("icon-translate"),h.paint.get("icon-translate-anchor"),h.layout.get("icon-rotation-alignment"),h.layout.get("icon-pitch-alignment"),h.layout.get("icon-keep-upright"),w,S),h.paint.get("text-opacity").constantOr(1)!==0&&sa(m,c,h,_,!0,h.paint.get("text-translate"),h.paint.get("text-translate-anchor"),h.layout.get("text-rotation-alignment"),h.layout.get("text-pitch-alignment"),h.layout.get("text-keep-upright"),w,S),c.map.showCollisionBoxes&&(mi(m,c,h,_,h.paint.get("text-translate"),h.paint.get("text-translate-anchor"),!0),mi(m,c,h,_,h.paint.get("icon-translate"),h.paint.get("icon-translate-anchor"),!1))},circle:function(m,c,h,_){if(m.renderPass!=="translucent")return;const v=h.paint.get("circle-opacity"),w=h.paint.get("circle-stroke-width"),S=h.paint.get("circle-stroke-opacity"),I=h.layout.get("circle-sort-key").constantOr(1)!==void 0;if(v.constantOr(1)===0&&(w.constantOr(1)===0||S.constantOr(1)===0))return;const z=m.context,F=z.gl,N=m.transform,q=m.depthModeForSublayer(0,o.DepthMode.ReadOnly),Q=o.StencilMode.disabled,it=m.colorModeForRenderPass(),rt=N.projection.name==="globe",ot=[o.mercatorXfromLng(N.center.lng),o.mercatorYfromLat(N.center.lat)],at=[];for(let ht=0;ht<_.length;ht++){const ut=_[ht],mt=c.getTile(ut),Tt=mt.getBucket(h);if(!Tt||Tt.projection.name!==N.projection.name)continue;const wt=Tt.programConfigurations.get(h.id),Mt=Ko(h);rt&&Mt.push("PROJECTION_GLOBE_VIEW");const Ft=m.useProgram("circle",wt,Mt),Vt=Tt.layoutVertexBuffer,Ht=Tt.globeExtVertexBuffer,ke=Tt.indexBuffer,Nt=N.projection.createInversionMatrix(N,ut.canonical),ne={programConfiguration:wt,program:Ft,layoutVertexBuffer:Vt,globeExtVertexBuffer:Ht,indexBuffer:ke,uniformValues:Ll(m,ut,mt,Nt,ot,h),tile:mt};if(I){const Xt=Tt.segments.get();for(const ue of Xt)at.push({segments:new o.SegmentVector([ue]),sortKey:ue.sortKey,state:ne})}else at.push({segments:Tt.segments,sortKey:0,state:ne})}I&&at.sort((ht,ut)=>ht.sortKey-ut.sortKey);const K={useDepthForOcclusion:!rt};for(const ht of at){const{programConfiguration:ut,program:mt,layoutVertexBuffer:Tt,globeExtVertexBuffer:wt,indexBuffer:Mt,uniformValues:Ft,tile:Vt}=ht.state,Ht=ht.segments;m.terrain&&m.terrain.setupElevationDraw(Vt,mt,K),m.prepareDrawProgram(z,mt,Vt.tileID.toUnwrapped()),mt.draw(z,F.TRIANGLES,q,Q,it,o.CullFaceMode.disabled,Ft,h.id,Tt,Mt,Ht,h.paint,N.zoom,ut,[wt])}},heatmap:function(m,c,h,_){if(h.paint.get("heatmap-opacity")!==0)if(m.renderPass==="offscreen"){const v=m.context,w=v.gl,S=o.StencilMode.disabled,I=new o.ColorMode([w.ONE,w.ONE],o.Color.transparent,[!0,!0,!0,!0]);(function(it,rt,ot,at){const K=it.gl,ht=rt.width*at,ut=rt.height*at;it.activeTexture.set(K.TEXTURE1),it.viewport.set([0,0,ht,ut]);let mt=ot.heatmapFbo;if(!mt||mt&&(mt.width!==ht||mt.height!==ut)){mt&&mt.destroy();const Tt=K.createTexture();K.bindTexture(K.TEXTURE_2D,Tt),K.texParameteri(K.TEXTURE_2D,K.TEXTURE_WRAP_S,K.CLAMP_TO_EDGE),K.texParameteri(K.TEXTURE_2D,K.TEXTURE_WRAP_T,K.CLAMP_TO_EDGE),K.texParameteri(K.TEXTURE_2D,K.TEXTURE_MIN_FILTER,K.LINEAR),K.texParameteri(K.TEXTURE_2D,K.TEXTURE_MAG_FILTER,K.LINEAR),mt=ot.heatmapFbo=it.createFramebuffer(ht,ut,!1),function(wt,Mt,Ft,Vt,Ht,ke){const Nt=wt.gl;Nt.texImage2D(Nt.TEXTURE_2D,0,wt.isWebGL2&&wt.extRenderToTextureHalfFloat?Nt.RGBA16F:Nt.RGBA,Ht,ke,0,Nt.RGBA,wt.extRenderToTextureHalfFloat?wt.isWebGL2?Nt.HALF_FLOAT:wt.extTextureHalfFloat.HALF_FLOAT_OES:Nt.UNSIGNED_BYTE,null),Vt.colorAttachment.set(Ft)}(it,0,Tt,mt,ht,ut)}else K.bindTexture(K.TEXTURE_2D,mt.colorAttachment.get()),it.bindFramebuffer.set(mt.framebuffer)})(v,m,h,m.transform.projection.name==="globe"?.5:.25),v.clear({color:o.Color.transparent});const z=m.transform,F=z.projection.name==="globe",N=F?["PROJECTION_GLOBE_VIEW"]:null,q=F?o.CullFaceMode.frontCCW:o.CullFaceMode.disabled,Q=[o.mercatorXfromLng(z.center.lng),o.mercatorYfromLat(z.center.lat)];for(let it=0;it<_.length;it++){const rt=_[it];if(c.hasRenderableParent(rt))continue;const ot=c.getTile(rt),at=ot.getBucket(h);if(!at||at.projection.name!==z.projection.name)continue;const K=at.programConfigurations.get(h.id),ht=m.useProgram("heatmap",K,N),{zoom:ut}=m.transform;m.terrain&&m.terrain.setupElevationDraw(ot,ht),m.prepareDrawProgram(v,ht,rt.toUnwrapped());const mt=z.projection.createInversionMatrix(z,rt.canonical);ht.draw(v,w.TRIANGLES,o.DepthMode.disabled,S,I,q,Lo(m,rt,ot,mt,Q,ut,h.paint.get("heatmap-intensity")),h.id,at.layoutVertexBuffer,at.indexBuffer,at.segments,h.paint,m.transform.zoom,K,F?[at.globeExtVertexBuffer]:null)}v.viewport.set([0,0,m.width,m.height])}else m.renderPass==="translucent"&&(m.context.setColorMode(m.colorModeForRenderPass()),function(v,w){const S=v.context,I=S.gl,z=w.heatmapFbo;if(!z)return;S.activeTexture.set(I.TEXTURE0),I.bindTexture(I.TEXTURE_2D,z.colorAttachment.get()),S.activeTexture.set(I.TEXTURE1);let F=w.colorRampTexture;F||(F=w.colorRampTexture=new o.Texture(S,w.colorRamp,I.RGBA)),F.bind(I.LINEAR,I.CLAMP_TO_EDGE),v.useProgram("heatmapTexture").draw(S,I.TRIANGLES,o.DepthMode.disabled,o.StencilMode.disabled,v.colorModeForRenderPass(),o.CullFaceMode.disabled,((N,q,Q,it)=>({u_image:0,u_color_ramp:1,u_opacity:q.paint.get("heatmap-opacity")}))(0,w),w.id,v.viewportBuffer,v.quadTriangleIndexBuffer,v.viewportSegments,w.paint,v.transform.zoom)}(m,h))},line:function(m,c,h,_){if(m.renderPass!=="translucent")return;const v=h.paint.get("line-opacity"),w=h.paint.get("line-width");if(v.constantOr(1)===0||w.constantOr(1)===0)return;const S=m.depthModeForSublayer(0,o.DepthMode.ReadOnly),I=m.colorModeForRenderPass(),z=m.terrain&&m.terrain.renderingToTexture?1:o.exported.devicePixelRatio,F=h.paint.get("line-dasharray"),N=F.constantOr(1),q=h.layout.get("line-cap"),Q=h.paint.get("line-pattern"),it=Q.constantOr(1),rt=h.paint.get("line-gradient"),ot=it?"linePattern":"line",at=m.context,K=at.gl,ht=(mt=>{const Tt=[];Dl(mt)&&Tt.push("RENDER_LINE_DASH"),mt.paint.get("line-gradient")&&Tt.push("RENDER_LINE_GRADIENT");const wt=mt.paint.get("line-trim-offset");wt[0]===0&&wt[1]===0||Tt.push("RENDER_LINE_TRIM_OFFSET");const Mt=mt.paint.get("line-pattern").constantOr(1),Ft=mt.paint.get("line-opacity").constantOr(1)!==1;return!Mt&&Ft&&Tt.push("RENDER_LINE_ALPHA_DISCARD"),Tt})(h);let ut=ht.includes("RENDER_LINE_ALPHA_DISCARD");m.terrain&&m.terrain.clipOrMaskOverlapStencilType()&&(ut=!1);for(const mt of _){const Tt=c.getTile(mt);if(it&&!Tt.patternsLoaded())continue;const wt=Tt.getBucket(h);if(!wt)continue;m.prepareDrawTile();const Mt=wt.programConfigurations.get(h.id),Ft=m.useProgram(ot,Mt,ht),Vt=Q.constantOr(null);if(Vt&&Tt.imageAtlas){const Ot=Tt.imageAtlas.patternPositions[Vt.toString()];Ot&&Mt.setConstantPatternPositions(Ot)}const Ht=F.constantOr(null),ke=q.constantOr(null);if(!it&&Ht&&ke&&Tt.lineAtlas){const Ot=Tt.lineAtlas.getDash(Ht,ke);Ot&&Mt.setConstantPatternPositions(Ot)}let[Nt,ne]=h.paint.get("line-trim-offset");(ke==="round"||ke==="square")&&Nt!==ne&&(Nt===0&&(Nt-=1),ne===1&&(ne+=1));const Xt=m.terrain?mt.projMatrix:null,ue=it?Nu(m,Tt,h,Xt,z):Ac(m,Tt,h,Xt,wt.lineClipsArray.length,z,[Nt,ne]);if(rt){const Ot=wt.gradients[h.id];let Wt=Ot.texture;if(h.gradientVersion!==Ot.version){let ie=256;if(h.stepInterpolant){const pe=c.getSource().maxzoom,Je=mt.canonical.z===pe?Math.ceil(1<<m.transform.maxZoom-mt.canonical.z):1;ie=o.clamp(o.nextPowerOfTwo(wt.maxLineLength/o.EXTENT*1024*Je),256,at.maxTextureSize)}Ot.gradient=o.renderColorRamp({expression:h.gradientExpression(),evaluationKey:"lineProgress",resolution:ie,image:Ot.gradient||void 0,clips:wt.lineClipsArray}),Ot.texture?Ot.texture.update(Ot.gradient):Ot.texture=new o.Texture(at,Ot.gradient,K.RGBA),Ot.version=h.gradientVersion,Wt=Ot.texture}at.activeTexture.set(K.TEXTURE1),Wt.bind(h.stepInterpolant?K.NEAREST:K.LINEAR,K.CLAMP_TO_EDGE)}N&&(at.activeTexture.set(K.TEXTURE0),Tt.lineAtlasTexture.bind(K.LINEAR,K.REPEAT),Mt.updatePaintBuffers()),it&&(at.activeTexture.set(K.TEXTURE0),Tt.imageAtlasTexture.bind(K.LINEAR,K.CLAMP_TO_EDGE),Mt.updatePaintBuffers()),m.prepareDrawProgram(at,Ft,mt.toUnwrapped());const Gt=Ot=>{Ft.draw(at,K.TRIANGLES,S,Ot,I,o.CullFaceMode.disabled,ue,h.id,wt.layoutVertexBuffer,wt.indexBuffer,wt.segments,h.paint,m.transform.zoom,Mt,[wt.layoutVertexBuffer2])};if(ut){const Ot=m.stencilModeForClipping(mt).ref;Ot===0&&m.terrain&&at.clear({stencil:0});const Wt={func:K.EQUAL,mask:255};ue.u_alpha_discard_threshold=.8,Gt(new o.StencilMode(Wt,Ot,255,K.KEEP,K.KEEP,K.INVERT)),ue.u_alpha_discard_threshold=0,Gt(new o.StencilMode(Wt,Ot,255,K.KEEP,K.KEEP,K.KEEP))}else Gt(m.stencilModeForClipping(mt))}ut&&(m.resetStencilClippingMasks(),m.terrain&&at.clear({stencil:0}))},fill:function(m,c,h,_){const v=h.paint.get("fill-color"),w=h.paint.get("fill-opacity");if(w.constantOr(1)===0)return;const S=m.colorModeForRenderPass(),I=h.paint.get("fill-pattern"),z=m.opaquePassEnabledForLayer()&&!I.constantOr(1)&&v.constantOr(o.Color.transparent).a===1&&w.constantOr(0)===1?"opaque":"translucent";if(m.renderPass===z){const F=m.depthModeForSublayer(1,m.renderPass==="opaque"?o.DepthMode.ReadWrite:o.DepthMode.ReadOnly);Rl(m,c,h,_,F,S,!1)}if(m.renderPass==="translucent"&&h.paint.get("fill-antialias")){const F=m.depthModeForSublayer(h.getPaintProperty("fill-outline-color")?2:0,o.DepthMode.ReadOnly);Rl(m,c,h,_,F,S,!0)}},"fill-extrusion":function(m,c,h,_){const v=h.paint.get("fill-extrusion-opacity");if(v!==0&&m.renderPass==="translucent"){const w=new o.DepthMode(m.context.gl.LEQUAL,o.DepthMode.ReadWrite,m.depthRangeFor3D);if(v!==1||h.paint.get("fill-extrusion-pattern").constantOr(1))Ga(m,c,h,_,w,o.StencilMode.disabled,o.ColorMode.disabled),Ga(m,c,h,_,w,m.stencilModeFor3D(),m.colorModeForRenderPass()),m.resetStencilClippingMasks();else{const S=m.colorModeForRenderPass();Ga(m,c,h,_,w,o.StencilMode.disabled,S)}}},hillshade:function(m,c,h,_){if(m.renderPass!=="offscreen"&&m.renderPass!=="translucent")return;const v=m.context,w=m.depthModeForSublayer(0,o.DepthMode.ReadOnly),S=m.colorModeForRenderPass(),I=m.terrain&&m.terrain.renderingToTexture,[z,F]=m.renderPass!=="translucent"||I?[{},_]:m.stencilConfigForOverlap(_);for(const N of F){const q=c.getTile(N);if(q.needsHillshadePrepare&&m.renderPass==="offscreen")Ec(m,q,h,w,o.StencilMode.disabled,S);else if(m.renderPass==="translucent"){const Q=I&&m.terrain?m.terrain.stencilModeForRTTOverlap(N):z[N.overscaledZ];_s(m,N,q,h,w,Q,S)}}v.viewport.set([0,0,m.width,m.height]),m.resetStencilClippingMasks()},raster:function(m,c,h,_,v,w){if(m.renderPass!=="translucent"||h.paint.get("raster-opacity")===0||!_.length)return;const S=m.context,I=S.gl,z=c.getSource(),F=m.useProgram("raster"),N=m.colorModeForRenderPass(),q=m.terrain&&m.terrain.renderingToTexture,[Q,it]=z instanceof kt||q?[{},_]:m.stencilConfigForOverlap(_),rt=it[it.length-1].overscaledZ,ot=!m.options.moving;for(const at of it){const K=q?o.DepthMode.disabled:m.depthModeForSublayer(at.overscaledZ-rt,h.paint.get("raster-opacity")===1?o.DepthMode.ReadWrite:o.DepthMode.ReadOnly,I.LESS),ht=at.toUnwrapped(),ut=c.getTile(at);if(q&&(!ut||!ut.hasData()))continue;const mt=q?at.projMatrix:m.transform.calculateProjMatrix(ht,ot),Tt=m.terrain&&q?m.terrain.stencilModeForRTTOverlap(at):Q[at.overscaledZ],wt=w?0:h.paint.get("raster-fade-duration");ut.registerFadeDuration(wt);const Mt=c.findLoadedParent(at,0),Ft=$a(ut,Mt,c,m.transform,wt);let Vt,Ht;m.terrain&&m.terrain.prepareDrawTile();const ke=h.paint.get("raster-resampling")==="nearest"?I.NEAREST:I.LINEAR;S.activeTexture.set(I.TEXTURE0),ut.texture.bind(ke,I.CLAMP_TO_EDGE),S.activeTexture.set(I.TEXTURE1),Mt?(Mt.texture.bind(ke,I.CLAMP_TO_EDGE),Vt=Math.pow(2,Mt.tileID.overscaledZ-ut.tileID.overscaledZ),Ht=[ut.tileID.canonical.x*Vt%1,ut.tileID.canonical.y*Vt%1]):ut.texture.bind(ke,I.CLAMP_TO_EDGE);const Nt=Cf(mt,Ht||[0,0],Vt||1,Ft,h,z instanceof kt?z.perspectiveTransform:[0,0]);if(m.prepareDrawProgram(S,F,ht),z instanceof kt)z.boundsBuffer&&z.boundsSegments&&F.draw(S,I.TRIANGLES,K,o.StencilMode.disabled,N,o.CullFaceMode.disabled,Nt,h.id,z.boundsBuffer,m.quadTriangleIndexBuffer,z.boundsSegments);else{const{tileBoundsBuffer:ne,tileBoundsIndexBuffer:Xt,tileBoundsSegments:ue}=m.getTileBoundsBuffers(ut);F.draw(S,I.TRIANGLES,K,Tt,N,o.CullFaceMode.disabled,Nt,h.id,ne,Xt,ue)}}m.resetStencilClippingMasks()},background:function(m,c,h,_){const v=h.paint.get("background-color"),w=h.paint.get("background-opacity");if(w===0)return;const S=m.context,I=S.gl,z=m.transform,F=z.tileSize,N=h.paint.get("background-pattern");if(m.isPatternMissing(N))return;const q=!N&&v.a===1&&w===1&&m.opaquePassEnabledForLayer()?"opaque":"translucent";if(m.renderPass!==q)return;const Q=o.StencilMode.disabled,it=m.depthModeForSublayer(0,q==="opaque"?o.DepthMode.ReadWrite:o.DepthMode.ReadOnly),rt=m.colorModeForRenderPass(),ot=m.useProgram(N?"backgroundPattern":"background");let at,K=_;K||(at=m.getBackgroundTiles(),K=Object.values(at).map(ht=>ht.tileID)),N&&(S.activeTexture.set(I.TEXTURE0),m.imageManager.bind(m.context));for(const ht of K){const ut=ht.toUnwrapped(),mt=_?ht.projMatrix:m.transform.calculateProjMatrix(ut);m.prepareDrawTile();const Tt=c?c.getTile(ht):at?at[ht.key]:new o.Tile(ht,F,z.zoom,m),wt=N?Gr(mt,w,m,N,{tileID:ht,tileSize:F}):er(mt,w,v);m.prepareDrawProgram(S,ot,ut);const{tileBoundsBuffer:Mt,tileBoundsIndexBuffer:Ft,tileBoundsSegments:Vt}=m.getTileBoundsBuffers(Tt);ot.draw(S,I.TRIANGLES,it,Q,rt,o.CullFaceMode.disabled,wt,h.id,Mt,Ft,Vt)}},sky:function(m,c,h){const _=m.transform,v=_.projection.name==="mercator"||_.projection.name==="globe"?1:o.smoothstep(7,8,_.zoom),w=h.paint.get("sky-opacity")*v;if(w===0)return;const S=m.context,I=h.paint.get("sky-type"),z=new o.DepthMode(S.gl.LEQUAL,o.DepthMode.ReadOnly,[0,1]),F=m.frameCounter/1e3%1;I==="atmosphere"?m.renderPass==="offscreen"?h.needsSkyboxCapture(m)&&(function(N,q,Q,it){const rt=N.context,ot=rt.gl;let at=q.skyboxFbo;if(!at){at=q.skyboxFbo=rt.createFramebuffer(32,32,!1),q.skyboxGeometry=new Es(rt),q.skyboxTexture=rt.gl.createTexture(),ot.bindTexture(ot.TEXTURE_CUBE_MAP,q.skyboxTexture),ot.texParameteri(ot.TEXTURE_CUBE_MAP,ot.TEXTURE_WRAP_S,ot.CLAMP_TO_EDGE),ot.texParameteri(ot.TEXTURE_CUBE_MAP,ot.TEXTURE_WRAP_T,ot.CLAMP_TO_EDGE),ot.texParameteri(ot.TEXTURE_CUBE_MAP,ot.TEXTURE_MIN_FILTER,ot.LINEAR),ot.texParameteri(ot.TEXTURE_CUBE_MAP,ot.TEXTURE_MAG_FILTER,ot.LINEAR);for(let mt=0;mt<6;++mt)ot.texImage2D(ot.TEXTURE_CUBE_MAP_POSITIVE_X+mt,0,ot.RGBA,32,32,0,ot.RGBA,ot.UNSIGNED_BYTE,null)}rt.bindFramebuffer.set(at.framebuffer),rt.viewport.set([0,0,32,32]);const K=q.getCenter(N,!0),ht=N.useProgram("skyboxCapture"),ut=new Float64Array(16);o.identity(ut),o.rotateY(ut,ut,.5*-Math.PI),In(rt,q,ht,ut,K,0),o.identity(ut),o.rotateY(ut,ut,.5*Math.PI),In(rt,q,ht,ut,K,1),o.identity(ut),o.rotateX(ut,ut,.5*-Math.PI),In(rt,q,ht,ut,K,2),o.identity(ut),o.rotateX(ut,ut,.5*Math.PI),In(rt,q,ht,ut,K,3),o.identity(ut),In(rt,q,ht,ut,K,4),o.identity(ut),o.rotateY(ut,ut,Math.PI),In(rt,q,ht,ut,K,5),rt.viewport.set([0,0,N.width,N.height])}(m,h),h.markSkyboxValid(m)):m.renderPass==="sky"&&function(N,q,Q,it,rt){const ot=N.context,at=ot.gl,K=N.transform,ht=N.useProgram("skybox");ot.activeTexture.set(at.TEXTURE0),at.bindTexture(at.TEXTURE_CUBE_MAP,q.skyboxTexture);const ut=((mt,Tt,wt,Mt,Ft)=>({u_matrix:mt,u_sun_direction:Tt,u_cubemap:0,u_opacity:Mt,u_temporal_offset:Ft}))(K.skyboxMatrix,q.getCenter(N,!1),0,it,rt);N.prepareDrawProgram(ot,ht),ht.draw(ot,at.TRIANGLES,Q,o.StencilMode.disabled,N.colorModeForRenderPass(),o.CullFaceMode.backCW,ut,"skybox",q.skyboxGeometry.vertexBuffer,q.skyboxGeometry.indexBuffer,q.skyboxGeometry.segment)}(m,h,z,w,F):I==="gradient"&&m.renderPass==="sky"&&function(N,q,Q,it,rt){const ot=N.context,at=ot.gl,K=N.transform,ht=N.useProgram("skyboxGradient");q.skyboxGeometry||(q.skyboxGeometry=new Es(ot)),ot.activeTexture.set(at.TEXTURE0);let ut=q.colorRampTexture;ut||(ut=q.colorRampTexture=new o.Texture(ot,q.colorRamp,at.RGBA)),ut.bind(at.LINEAR,at.CLAMP_TO_EDGE);const mt=((Tt,wt,Mt,Ft,Vt)=>({u_matrix:Tt,u_color_ramp:0,u_center_direction:wt,u_radius:o.degToRad(Mt),u_opacity:Ft,u_temporal_offset:Vt}))(K.skyboxMatrix,q.getCenter(N,!1),q.paint.get("sky-gradient-radius"),it,rt);N.prepareDrawProgram(ot,ht),ht.draw(ot,at.TRIANGLES,Q,o.StencilMode.disabled,N.colorModeForRenderPass(),o.CullFaceMode.backCW,mt,"skyboxGradient",q.skyboxGeometry.vertexBuffer,q.skyboxGeometry.indexBuffer,q.skyboxGeometry.segment)}(m,h,z,w,F)},debug:function(m,c,h){for(let _=0;_<h.length;_++)Xs(m,c,h[_])},custom:function(m,c,h,_){const v=m.context,w=h.implementation;if(!m.transform.projection.unsupportedLayers||!m.transform.projection.unsupportedLayers.includes("custom")||m.terrain&&(m.terrain.renderingToTexture||m.renderPass==="offscreen")&&h.isLayerDraped()){if(m.renderPass==="offscreen"){const S=w.prerender;if(S){if(m.setCustomLayerDefaults(),v.setColorMode(m.colorModeForRenderPass()),m.transform.projection.name==="globe"){const I=m.transform.pointMerc;S.call(w,v.gl,m.transform.customLayerMatrix(),m.transform.getProjection(),m.transform.globeToMercatorMatrix(),o.globeToMercatorTransition(m.transform.zoom),[I.x,I.y],m.transform.pixelsPerMeterRatio)}else S.call(w,v.gl,m.transform.customLayerMatrix());v.setDirty(),m.setBaseState()}}else if(m.renderPass==="translucent"){if(m.terrain&&m.terrain.renderingToTexture){const I=w.renderToTile;if(I){const z=_[0].canonical,F=new o.MercatorCoordinate(z.x+_[0].wrap*(1<<z.z),z.y,z.z);v.setDepthMode(o.DepthMode.disabled),v.setStencilMode(o.StencilMode.disabled),v.setColorMode(m.colorModeForRenderPass()),m.setCustomLayerDefaults(),I.call(w,v.gl,F),v.setDirty(),m.setBaseState()}return}m.setCustomLayerDefaults(),v.setColorMode(m.colorModeForRenderPass()),v.setStencilMode(o.StencilMode.disabled);const S=w.renderingMode==="3d"?new o.DepthMode(m.context.gl.LEQUAL,o.DepthMode.ReadWrite,m.depthRangeFor3D):m.depthModeForSublayer(0,o.DepthMode.ReadOnly);if(v.setDepthMode(S),m.transform.projection.name==="globe"){const I=m.transform.pointMerc;w.render(v.gl,m.transform.customLayerMatrix(),m.transform.getProjection(),m.transform.globeToMercatorMatrix(),o.globeToMercatorTransition(m.transform.zoom),[I.x,I.y],m.transform.pixelsPerMeterRatio)}else w.render(v.gl,m.transform.customLayerMatrix());v.setDirty(),m.setBaseState(),v.bindFramebuffer.set(null)}}else o.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class Ts{constructor(c,h,_=!1){this.context=new ct(c,_),this.transform=h,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=o.SourceCache.maxUnderzooming+o.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Lu,this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(c,h){const _=!!c&&!!c.terrain&&this.transform.projection.supportsTerrain;if(!(_||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new ys(this,c));const v=this._terrain;this.transform.elevation=_?v:null,v.update(c,this.transform,h)}_updateFog(c){const h=c.fog;if(!h||this.transform.projection.name==="globe"||h.getOpacity(this.transform.pitch)<1||h.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[_,v]=h.getFovAdjustedRange(this.transform._fov);if(_>v)return void(this.transform.fogCullDistSq=null);const w=_+.78*(v-_);this.transform.fogCullDistSq=w*w}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(c,h){if(this.width=c*o.exported.devicePixelRatio,this.height=h*o.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const _ of this.style.order)this.style._layers[_].resize()}setup(){const c=this.context,h=new o.StructArrayLayout2i4;h.emplaceBack(0,0),h.emplaceBack(o.EXTENT,0),h.emplaceBack(0,o.EXTENT),h.emplaceBack(o.EXTENT,o.EXTENT),this.tileExtentBuffer=c.createVertexBuffer(h,o.posAttributes.members),this.tileExtentSegments=o.SegmentVector.simpleSegment(0,0,4,2);const _=new o.StructArrayLayout2i4;_.emplaceBack(0,0),_.emplaceBack(o.EXTENT,0),_.emplaceBack(0,o.EXTENT),_.emplaceBack(o.EXTENT,o.EXTENT),this.debugBuffer=c.createVertexBuffer(_,o.posAttributes.members),this.debugSegments=o.SegmentVector.simpleSegment(0,0,4,5);const v=new o.StructArrayLayout2i4;v.emplaceBack(-1,-1),v.emplaceBack(1,-1),v.emplaceBack(-1,1),v.emplaceBack(1,1),this.viewportBuffer=c.createVertexBuffer(v,o.posAttributes.members),this.viewportSegments=o.SegmentVector.simpleSegment(0,0,4,2);const w=new o.StructArrayLayout4i8;w.emplaceBack(0,0,0,0),w.emplaceBack(o.EXTENT,0,o.EXTENT,0),w.emplaceBack(0,o.EXTENT,0,o.EXTENT),w.emplaceBack(o.EXTENT,o.EXTENT,o.EXTENT,o.EXTENT),this.mercatorBoundsBuffer=c.createVertexBuffer(w,o.boundsAttributes.members),this.mercatorBoundsSegments=o.SegmentVector.simpleSegment(0,0,4,2);const S=new o.StructArrayLayout3ui6;S.emplaceBack(0,1,2),S.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=c.createIndexBuffer(S);const I=new o.StructArrayLayout1ui2;for(const F of[0,1,3,2,0])I.emplaceBack(F);this.debugIndexBuffer=c.createIndexBuffer(I),this.emptyTexture=new o.Texture(c,new o.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),c.gl.RGBA),this.identityMat=o.create();const z=this.context.gl;this.stencilClearMode=new o.StencilMode({func:z.ALWAYS,mask:0},0,255,z.ZERO,z.ZERO,z.ZERO),this.loadTimeStamps.push(o.window.performance.now()),this.atmosphereBuffer=new eh(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(c){return c._makeTileBoundsBuffers(this.context,this.transform.projection),c._tileBoundsBuffer?{tileBoundsBuffer:c._tileBoundsBuffer,tileBoundsIndexBuffer:c._tileBoundsIndexBuffer,tileBoundsSegments:c._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const c=this.context,h=c.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(c,h.TRIANGLES,o.DepthMode.disabled,this.stencilClearMode,o.ColorMode.disabled,o.CullFaceMode.disabled,An(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(c,h,_){if(!h||this.currentStencilSource===h.id||!c.isTileClipped()||!_||_.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let I=!1;for(const z of _)if(this._tileClippingMaskIDs[z.key]===void 0){I=!0;break}if(!I)return}this.currentStencilSource=h.id;const v=this.context,w=v.gl;this.nextStencilID+_.length>256&&this.clearStencil(),v.setColorMode(o.ColorMode.disabled),v.setDepthMode(o.DepthMode.disabled);const S=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const I of _){const z=h.getTile(I),F=this._tileClippingMaskIDs[I.key]=this.nextStencilID++,{tileBoundsBuffer:N,tileBoundsIndexBuffer:q,tileBoundsSegments:Q}=this.getTileBoundsBuffers(z);S.draw(v,w.TRIANGLES,o.DepthMode.disabled,new o.StencilMode({func:w.ALWAYS,mask:0},F,255,w.KEEP,w.KEEP,w.REPLACE),o.ColorMode.disabled,o.CullFaceMode.disabled,An(I.projMatrix),"$clipping",N,q,Q)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const c=this.nextStencilID++,h=this.context.gl;return new o.StencilMode({func:h.NOTEQUAL,mask:255},c,255,h.KEEP,h.KEEP,h.REPLACE)}stencilModeForClipping(c){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(c);const h=this.context.gl;return new o.StencilMode({func:h.EQUAL,mask:255},this._tileClippingMaskIDs[c.key],0,h.KEEP,h.KEEP,h.REPLACE)}stencilConfigForOverlap(c){const h=this.context.gl,_=c.sort((S,I)=>I.overscaledZ-S.overscaledZ),v=_[_.length-1].overscaledZ,w=_[0].overscaledZ-v+1;if(w>1){this.currentStencilSource=void 0,this.nextStencilID+w>256&&this.clearStencil();const S={};for(let I=0;I<w;I++)S[I+v]=new o.StencilMode({func:h.GEQUAL,mask:255},I+this.nextStencilID,255,h.KEEP,h.KEEP,h.REPLACE);return this.nextStencilID+=w,[S,_]}return[{[v]:o.StencilMode.disabled},_]}colorModeForRenderPass(){const c=this.context.gl;return this._showOverdrawInspector?new o.ColorMode([c.CONSTANT_COLOR,c.ONE],new o.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?o.ColorMode.unblended:o.ColorMode.alphaBlended}depthModeForSublayer(c,h,_){if(!this.opaquePassEnabledForLayer())return o.DepthMode.disabled;const v=1-((1+this.currentLayer)*this.numSublayers+c)*this.depthEpsilon;return new o.DepthMode(_||this.context.gl.LEQUAL,h,[v,v])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(c,h){this.style=c,this.options=h,this.imageManager=c.imageManager,this.glyphManager=c.glyphManager,this.symbolFadeChange=c.placement.symbolFadeChange(o.exported.now()),this.imageManager.beginFrame();const _=this.style.order,v=this.style._sourceCaches;for(const z in v){const F=v[z];F.used&&F.prepare(this.context)}const w={},S={},I={};for(const z in v){const F=v[z];w[z]=F.getVisibleCoordinates(),S[z]=w[z].slice().reverse(),I[z]=F.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let z=0;z<_.length;z++)if(this.style._layers[_[z]].is3D()){this.opaquePassCutoff=z;break}if(this.terrain&&(this.terrain.updateTileBinding(I),this.opaquePassCutoff=0),this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new o.GlobeSharedBuffers(this.context)),o.isMapAuthenticated(this.context.gl)){this.renderPass="offscreen";for(const z of _){const F=this.style._layers[z],N=c._getLayerSourceCache(F);if(!F.hasOffscreenPass()||F.isHidden(this.transform.zoom))continue;const q=N?S[N.id]:void 0;(F.type==="custom"||F.isSky()||q&&q.length)&&this.renderLayer(this,N,F,q)}if(this.depthRangeFor3D=[0,1-(c.order.length+2)*this.numSublayers*this.depthEpsilon],this.terrain&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&this.terrain.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:h.showOverdrawInspector?o.Color.black:o.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=h.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=_.length-1;this.currentLayer>=0;this.currentLayer--){const z=this.style._layers[_[this.currentLayer]],F=c._getLayerSourceCache(z);if(z.isSky())continue;const N=F?S[F.id]:void 0;this._renderTileClippingMasks(z,F,N),this.renderLayer(this,F,z,N)}if(this.style.fog&&this.transform.projection.supportsFog&&function(z,F){const N=z.context,q=N.gl,Q=z.transform,it=new o.DepthMode(q.LEQUAL,o.DepthMode.ReadOnly,[0,1]),rt=z.useProgram("globeAtmosphere",null,Q.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),ot=o.globeToMercatorTransition(Q.zoom),at=F.properties.get("color").toArray01(),K=F.properties.get("high-color").toArray01(),ht=F.properties.get("space-color").toArray01PremultipliedAlpha(),ut=o.identity$1([]);o.rotateY$1(ut,ut,-o.degToRad(Q._center.lng)),o.rotateX$1(ut,ut,o.degToRad(Q._center.lat)),o.rotateZ$1(ut,ut,Q.angle),o.rotateX$1(ut,ut,-Q._pitch);const mt=o.fromQuat(new Float32Array(16),ut),Tt=o.mapValue(F.properties.get("star-intensity"),0,1,0,.25),wt=5e-4,Mt=o.mapValue(F.properties.get("horizon-blend"),0,1,wt,.25),Ft=o.globeUseCustomAntiAliasing(z,N,Q)&&Mt===wt?Q.worldSize/(2*Math.PI*1.025)-1:Q.globeRadius,Vt=z.frameCounter/1e3%1,Ht=o.length(Q.globeCenterInViewSpace),ke=Math.sqrt(Math.pow(Ht,2)-Math.pow(Ft,2)),Nt=Math.acos(ke/Ht),ne=((ue,Gt,Ot,Wt,ie,pe,Je,Pn,We,je,nn,Nn,sn,ar)=>({u_frustum_tl:ue,u_frustum_tr:Gt,u_frustum_br:Ot,u_frustum_bl:Wt,u_horizon:ie,u_transition:pe,u_fadeout_range:Je,u_color:Pn,u_high_color:We,u_space_color:je,u_star_intensity:nn,u_star_size:5*o.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:Nn,u_horizon_angle:sn,u_rotation_matrix:ar}))(Q.frustumCorners.TL,Q.frustumCorners.TR,Q.frustumCorners.BR,Q.frustumCorners.BL,Q.frustumCorners.horizon,ot,Mt,at,K,ht,Tt,Vt,Nt,mt);z.prepareDrawProgram(N,rt);const Xt=z.atmosphereBuffer;Xt&&rt.draw(N,q.TRIANGLES,it,o.StencilMode.disabled,o.ColorMode.alphaBlended,o.CullFaceMode.backCW,ne,"skybox",Xt.vertexBuffer,Xt.indexBuffer,Xt.segments)}(this,this.style.fog),this.renderPass="sky",(o.globeToMercatorTransition(this.transform.zoom)>0||this.transform.projection.name!=="globe")&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<_.length;this.currentLayer++){const z=this.style._layers[_[this.currentLayer]],F=c._getLayerSourceCache(z);z.isSky()&&this.renderLayer(this,F,z,F?S[F.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<_.length;){const z=this.style._layers[_[this.currentLayer]],F=c._getLayerSourceCache(z);if(z.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(z)){if(z.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const N=F?(z.type==="symbol"?I:S)[F.id]:void 0;this._renderTileClippingMasks(z,F,F?w[F.id]:void 0),this.renderLayer(this,F,z,N),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let z=null;o.values(this.style._layers).forEach(F=>{const N=c._getLayerSourceCache(F);N&&!F.isHidden(this.transform.zoom)&&(!z||z.getSource().maxzoom<N.getSource().maxzoom)&&(z=N)}),z&&this.options.showTileBoundaries&&Ys.debug(this,z,z.getVisibleCoordinates())}this.options.showPadding&&function(z){const F=z.transform.padding;to(z,z.transform.height-(F.top||0),3,Ic),to(z,F.bottom||0,3,ju),qa(z,F.left||0,3,th),qa(z,z.transform.width-(F.right||0),3,xr);const N=z.transform.centerPoint;(function(q,Q,it,rt){Vi(q,Q-1,it-10,2,20,rt),Vi(q,Q-10,it-1,20,2,rt)})(z,N.x,z.transform.height-N.y,dr)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(o.window.performance.now()),this.saveCanvasCopy())}}renderLayer(c,h,_,v){_.isHidden(this.transform.zoom)||(_.type==="background"||_.type==="sky"||_.type==="custom"||v&&v.length)&&(this.id=_.id,this.gpuTimingStart(_),(!c.transform.projection.unsupportedLayers||!c.transform.projection.unsupportedLayers.includes(_.type)||c.terrain&&_.type==="custom")&&Ys[_.type](c,h,_,v,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(c){if(!this.options.gpuTiming)return;const h=this.context.extTimerQuery;let _=this.gpuTimers[c.id];_||(_=this.gpuTimers[c.id]={calls:0,cpuTime:0,query:h.createQueryEXT()}),_.calls++,h.beginQueryEXT(h.TIME_ELAPSED_EXT,_.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const c=this.context.extTimerQuery,h=c.createQueryEXT();this.deferredRenderGpuTimeQueries.push(h),c.beginQueryEXT(c.TIME_ELAPSED_EXT,h)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const c=this.context.extTimerQuery;c.endQueryEXT(c.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const c=this.context.extTimerQuery;c.endQueryEXT(c.TIME_ELAPSED_EXT)}collectGpuTimers(){const c=this.gpuTimers;return this.gpuTimers={},c}collectDeferredRenderGpuQueries(){const c=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],c}queryGpuTimers(c){const h={};for(const _ in c){const v=c[_],w=this.context.extTimerQuery,S=w.getQueryObjectEXT(v.query,w.QUERY_RESULT_EXT)/1e6;w.deleteQueryEXT(v.query),h[_]=S}return h}queryGpuTimeDeferredRender(c){if(!this.options.gpuTimingDeferredRender)return 0;const h=this.context.extTimerQuery;let _=0;for(const v of c)_+=h.getQueryObjectEXT(v,h.QUERY_RESULT_EXT)/1e6,h.deleteQueryEXT(v);return _}translatePosMatrix(c,h,_,v,w){if(!_[0]&&!_[1])return c;const S=w?v==="map"?this.transform.angle:0:v==="viewport"?-this.transform.angle:0;if(S){const F=Math.sin(S),N=Math.cos(S);_=[_[0]*N-_[1]*F,_[0]*F+_[1]*N]}const I=[w?_[0]:_r(h,_[0],this.transform.zoom),w?_[1]:_r(h,_[1],this.transform.zoom),0],z=new Float32Array(16);return o.translate(z,c,I),z}saveTileTexture(c){const h=this._tileTextures[c.size[0]];h?h.push(c):this._tileTextures[c.size[0]]=[c]}getTileTexture(c){const h=this._tileTextures[c];return h&&h.length>0?h.pop():null}isPatternMissing(c){return c===null||c!==void 0&&!this.imageManager.getPattern(c.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const c=this.terrain&&this.terrain.renderingToTexture,h=this.terrain&&this.terrain.exaggeration()===0,_=this.style&&this.style.fog,v=[];return this.terrainRenderModeElevated()&&v.push("TERRAIN"),this.transform.projection.name==="globe"&&v.push("GLOBE"),h&&v.push("ZERO_EXAGGERATION"),_&&!c&&_.getOpacity(this.transform.pitch)!==0&&v.push("FOG"),c&&v.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&v.push("OVERDRAW_INSPECTOR"),v}useProgram(c,h,_){this.cache=this.cache||{};const v=_||[],w=this.currentGlobalDefines().concat(v),S=Cc.cacheKey(Ou[c],c,w,h);return this.cache[S]||(this.cache[S]=new Cc(this.context,c,Ou[c],h,pi[c],w)),this.cache[S]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const c=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(c.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=o.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new o.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(c,h,_){if(this.terrain&&this.terrain.renderingToTexture)return;const v=this.style.fog;if(v){const w=v.getOpacity(this.transform.pitch),S=((I,z,F,N,q,Q,it,rt,ot,at,K)=>{const ht=I.transform,ut=z.properties.get("color").toArray01();ut[3]=N;const mt=I.frameCounter/1e3%1;return{u_fog_matrix:F?ht.calculateFogTileMatrix(F):I.identityMat,u_fog_range:z.getFovAdjustedRange(ht._fov),u_fog_color:ut,u_fog_horizon_blend:z.properties.get("horizon-blend"),u_fog_temporal_offset:mt,u_frustum_tl:q,u_frustum_tr:Q,u_frustum_br:it,u_frustum_bl:rt,u_globe_pos:ot,u_globe_radius:at,u_viewport:K,u_globe_transition:o.globeToMercatorTransition(ht.zoom),u_is_globe:+(ht.projection.name==="globe")}})(this,v,_,w,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*o.exported.devicePixelRatio,this.transform.height*o.exported.devicePixelRatio]);h.setFogUniformValues(c,S)}}setTileLoadedFlag(c){this.tileLoaded=c}saveCanvasCopy(){const c=this.canvasCopy();c&&(this.frameCopies.push(c),this.tileLoaded=!1)}canvasCopy(){const c=this.context.gl,h=c.createTexture();return c.bindTexture(c.TEXTURE_2D,h),c.copyTexImage2D(c.TEXTURE_2D,0,c.RGBA,0,0,c.drawingBufferWidth,c.drawingBufferHeight,0),h}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const c=this.style&&this.style.fog;return!!c&&c.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const c=this._backgroundTiles,h=this._backgroundTiles={},_=this.transform.coveringTiles({tileSize:512});for(const v of _)h[v.key]=c[v.key]||new o.Tile(v,512,this.transform.tileZoom,this);return h}clearBackgroundTiles(){this._backgroundTiles={}}}class Ks{constructor(c=0,h=0,_=0,v=0){if(isNaN(c)||c<0||isNaN(h)||h<0||isNaN(_)||_<0||isNaN(v)||v<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=c,this.bottom=h,this.left=_,this.right=v}interpolate(c,h,_){return h.top!=null&&c.top!=null&&(this.top=o.number(c.top,h.top,_)),h.bottom!=null&&c.bottom!=null&&(this.bottom=o.number(c.bottom,h.bottom,_)),h.left!=null&&c.left!=null&&(this.left=o.number(c.left,h.left,_)),h.right!=null&&c.right!=null&&(this.right=o.number(c.right,h.right,_)),this}getCenter(c,h){const _=o.clamp((this.left+c-this.right)/2,0,c),v=o.clamp((this.top+h-this.bottom)/2,0,h);return new o.pointGeometry(_,v)}equals(c){return this.top===c.top&&this.bottom===c.bottom&&this.left===c.left&&this.right===c.right}clone(){return new Ks(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Fl(m,c){const h=o.getColumn(m,3);o.fromQuat(m,c),o.setColumn(m,3,h)}function Nl(m,c){const h=o.identity$1([]);return o.rotateZ$1(h,h,-c),o.rotateX$1(h,h,-m),h}function jl(m,c){const h=[m[0],m[1],0],_=[c[0],c[1],0];if(o.length(h)>=1e-15){const S=o.normalize([],h);o.scale$2(_,S,o.dot(_,S)),c[0]=_[0],c[1]=_[1]}const v=o.cross([],c,m);if(o.len(v)<1e-15)return null;const w=Math.atan2(-v[1],v[0]);return Nl(Math.atan2(Math.sqrt(m[0]*m[0]+m[1]*m[1]),-m[2]),w)}class ks{constructor(c,h){this.position=c,this.orientation=h}get position(){return this._position}set position(c){if(c){const h=c instanceof o.MercatorCoordinate?c:new o.MercatorCoordinate(c[0],c[1],c[2]);this._renderWorldCopies&&(h.x=o.wrap(h.x,0,1)),this._position=h}else this._position=null}lookAtPoint(c,h){if(this.orientation=null,!this.position)return;const _=this._elevation?this._elevation.getAtPointOrZero(o.MercatorCoordinate.fromLngLat(c)):0,v=this.position,w=o.MercatorCoordinate.fromLngLat(c,_),S=[w.x-v.x,w.y-v.y,w.z-v.z];h||(h=[0,0,1]),h[2]=Math.abs(h[2]),this.orientation=jl(S,h)}setPitchBearing(c,h){this.orientation=Nl(o.degToRad(c),o.degToRad(-h))}}class Pc{constructor(c,h){this._transform=o.identity([]),this.orientation=h,this.position=c}get mercatorPosition(){const c=this.position;return new o.MercatorCoordinate(c[0],c[1],c[2])}get position(){const c=o.getColumn(this._transform,3);return[c[0],c[1],c[2]]}set position(c){var h;c&&o.setColumn(this._transform,3,[(h=c)[0],h[1],h[2],1])}get orientation(){return this._orientation}set orientation(c){this._orientation=c||o.identity$1([]),c&&Fl(this._transform,this._orientation)}getPitchBearing(){const c=this.forward(),h=this.right();return{bearing:Math.atan2(-h[1],h[0]),pitch:Math.atan2(Math.sqrt(c[0]*c[0]+c[1]*c[1]),-c[2])}}setPitchBearing(c,h){this._orientation=Nl(c,h),Fl(this._transform,this._orientation)}forward(){const c=o.getColumn(this._transform,2);return[-c[0],-c[1],-c[2]]}up(){const c=o.getColumn(this._transform,1);return[-c[0],-c[1],-c[2]]}right(){const c=o.getColumn(this._transform,0);return[c[0],c[1],c[2]]}getCameraToWorld(c,h){const _=new Float64Array(16);return o.invert(_,this.getWorldToCamera(c,h)),_}getWorldToCameraPosition(c,h,_){const v=this.position;o.scale$2(v,v,-c);const w=new Float64Array(16);return o.fromScaling(w,[_,_,_]),o.translate(w,w,v),w[10]*=h,w}getWorldToCamera(c,h){const _=new Float64Array(16),v=new Float64Array(4),w=this.position;return o.conjugate(v,this._orientation),o.scale$2(w,w,-c),o.fromQuat(_,v),o.translate(_,_,w),_[1]*=-1,_[5]*=-1,_[9]*=-1,_[13]*=-1,_[8]*=h,_[9]*=h,_[10]*=h,_[11]*=h,_}getCameraToClipPerspective(c,h,_,v){const w=new Float64Array(16);return o.perspective(w,c,h,_,v),w}getDistanceToElevation(c,h=!1){const _=c===0?0:o.mercatorZfromAltitude(c,h?o.latFromMercatorY(this.position[1]):this.position[1]),v=this.forward();return(_-this.position[2])/v[2]}clone(){return new Pc([...this.position],[...this.orientation])}}function Lc(m,c){const h=Ul(m.projection,m.zoom,m.width,m.height),_=function(w,S,I,z,F){const N=new o.LngLat(I.lng-180*$l,I.lat),q=new o.LngLat(I.lng+180*$l,I.lat),Q=w.project(N.lng,N.lat),it=w.project(q.lng,q.lat),rt=-Math.atan2(it.y-Q.y,it.x-Q.x),ot=o.MercatorCoordinate.fromLngLat(I);ot.y=o.clamp(ot.y,-.999975,.999975);const at=ot.toLngLat(),K=w.project(at.lng,at.lat),ht=o.MercatorCoordinate.fromLngLat(at);ht.x+=$l;const ut=ht.toLngLat(),mt=w.project(ut.lng,ut.lat),Tt=$u(mt.x-K.x,mt.y-K.y,rt),wt=o.MercatorCoordinate.fromLngLat(at);wt.y+=$l;const Mt=wt.toLngLat(),Ft=w.project(Mt.lng,Mt.lat),Vt=$u(Ft.x-K.x,Ft.y-K.y,rt),Ht=Math.abs(Tt.x)/Math.abs(Vt.y),ke=o.identity([]);o.rotateZ(ke,ke,-rt*(1-(F?0:z)));const Nt=o.identity([]);return o.scale(Nt,Nt,[1,1-(1-Ht)*z,1]),Nt[4]=-Vt.x/Vt.y*z,o.rotateZ(Nt,Nt,rt),o.multiply(Nt,ke,Nt),Nt}(m.projection,0,m.center,h,c),v=nh(m);return o.scale(_,_,[v,v,1]),_}function nh(m){const c=m.projection,h=Ul(m.projection,m.zoom,m.width,m.height),_=Uu(c,m.center),v=Uu(c,o.LngLat.convert(c.center));return Math.pow(2,_*h+(1-h)*v)}function Ul(m,c,h,_,v=1/0){const w=m.range;if(!w)return 0;const S=Math.min(v,Math.max(h,_)),I=Math.log(S/1024)/Math.LN2;return o.smoothstep(w[0]+I,w[1]+I,c)}const $l=1/4e4;function Uu(m,c){const h=o.clamp(c.lat,-o.MAX_MERCATOR_LATITUDE,o.MAX_MERCATOR_LATITUDE),_=new o.LngLat(c.lng-180*$l,h),v=new o.LngLat(c.lng+180*$l,h),w=m.project(_.lng,h),S=m.project(v.lng,h),I=o.MercatorCoordinate.fromLngLat(_),z=o.MercatorCoordinate.fromLngLat(v),F=S.x-w.x,N=S.y-w.y,q=z.x-I.x,Q=z.y-I.y,it=Math.sqrt((q*q+Q*Q)/(F*F+N*N));return Math.log(it)/Math.LN2}function $u(m,c,h){const _=Math.cos(h),v=Math.sin(h);return{x:m*_-c*v,y:m*v+c*_}}class Ne{constructor(c,h,_,v,w,S,I){this.tileSize=512,this._renderWorldCopies=w===void 0||w,this._minZoom=c||0,this._maxZoom=h||22,this._minPitch=_==null?0:_,this._maxPitch=v==null?60:v,this.setProjection(S),this.setMaxBounds(I),this.width=0,this.height=0,this._center=new o.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Ks,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new Pc,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const c=new Ne(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return c._elevation=this._elevation,c._centerAltitude=this._centerAltitude,c._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,c.tileSize=this.tileSize,c.mercatorFromTransition=this.mercatorFromTransition,c.width=this.width,c.height=this.height,c.cameraElevationReference=this.cameraElevationReference,c._center=this._center,c._setZoom(this.zoom),c._seaLevelZoom=this._seaLevelZoom,c.angle=this.angle,c._fov=this._fov,c._pitch=this._pitch,c._nearZ=this._nearZ,c._farZ=this._farZ,c._averageElevation=this._averageElevation,c._unmodified=this._unmodified,c._edgeInsets=this._edgeInsets.clone(),c._camera=this._camera.clone(),c._calcMatrices(),c.freezeTileCoverage=this.freezeTileCoverage,c.frustumCorners=this.frustumCorners,c}get elevation(){return this._elevation}set elevation(c){this._elevation!==c&&(this._elevation=c,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(c,h=!1){const _=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||_)&&this._updateCameraOnTerrain(),(c||_)&&this._constrainCamera(h),this._calcMatrices()}getProjection(){return o.pick(this.projection,["name","center","parallels"])}setProjection(c){this.projectionOptions=c||{name:"mercator"};const h=this.projection?this.getProjection():void 0;this.projection=o.getProjection(this.projectionOptions);const _=!y(h,this.getProjection());return _&&this._calcMatrices(),this.mercatorFromTransition=!1,_}setMercatorFromTransition(){const c=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=o.getProjection({name:"mercator"});const h=c!==this.projection.name;return h&&this._calcMatrices(),h}get minZoom(){return this._minZoom}set minZoom(c){this._minZoom!==c&&(this._minZoom=c,this.zoom=Math.max(this.zoom,c))}get maxZoom(){return this._maxZoom}set maxZoom(c){this._maxZoom!==c&&(this._maxZoom=c,this.zoom=Math.min(this.zoom,c))}get minPitch(){return this._minPitch}set minPitch(c){this._minPitch!==c&&(this._minPitch=c,this.pitch=Math.max(this.pitch,c))}get maxPitch(){return this._maxPitch}set maxPitch(c){this._maxPitch!==c&&(this._maxPitch=c,this.pitch=Math.min(this.pitch,c))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(c){c===void 0?c=!0:c===null&&(c=!1),this._renderWorldCopies=c}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const c=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(c))}get cameraWorldSize(){const c=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(c))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return o.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new o.pointGeometry(this.width,this.height)}get bearing(){return o.wrap(this.rotation,-180,180)}set bearing(c){this.rotation=c}get rotation(){return-this.angle/Math.PI*180}set rotation(c){const h=-c*Math.PI/180;var _;this.angle!==h&&(this._unmodified=!1,this.angle=h,this._calcMatrices(),this.rotationMatrix=(_=new o.ARRAY_TYPE(4),o.ARRAY_TYPE!=Float32Array&&(_[1]=0,_[2]=0),_[0]=1,_[3]=1,_),function(v,w,S){var I=w[0],z=w[1],F=w[2],N=w[3],q=Math.sin(S),Q=Math.cos(S);v[0]=I*Q+F*q,v[1]=z*Q+N*q,v[2]=I*-q+F*Q,v[3]=z*-q+N*Q}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(c){const h=o.clamp(c,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==h&&(this._unmodified=!1,this._pitch=h,this._calcMatrices())}get aspect(){return this.width/this.height}get fovX(){return this._fov}get fovY(){const c=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/c)}set fov(c){c=Math.max(.01,Math.min(60,c)),this._fov!==c&&(this._unmodified=!1,this._fov=o.degToRad(c),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(c){this._averageElevation=c,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(c){const h=Math.min(Math.max(c,this.minZoom),this.maxZoom);this._zoom!==h&&(this._unmodified=!1,this._setZoom(h),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(c){this._zoom=c,this.scale=this.zoomScale(c),this.tileZoom=Math.floor(c),this.zoomFraction=c-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const c=this._elevation;this._centerAltitude=c.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=c.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const c=this._elevation,h=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],_=this.horizonLineFromTop();let v=0,w=0;for(let S=0;S<h.length;S++){const I=new o.pointGeometry(h[S][0]*this.width,_+h[S][1]*(this.height-_)),z=c.pointCoordinate(I);if(!z)continue;const F=1/Math.hypot(z[0]-this._camera.position[0],z[1]-this._camera.position[1]);v+=z[3]*F,w+=F}return w===0?NaN:v/w}get center(){return this._center}set center(c){c.lat===this._center.lat&&c.lng===this._center.lng||(this._unmodified=!1,this._center=c,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const c=this._seaLevelZoom,h=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),_=this.pixelsPerMeter/this.worldSize*h,v=this._mercatorZfromZoom(c),w=this._mercatorZfromZoom(this._maxZoom),S=Math.max(v-_,w);this._setZoom(this._zoomFromMercatorZ(S))}get padding(){return this._edgeInsets.toJSON()}set padding(c){this._edgeInsets.equals(c)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,c,1),this._calcMatrices())}computeZoomRelativeTo(c){const h=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,c.toAltitude()));let _;_=c.z<this._camera.position[2]?[h.x,h.y,h.z]:[c.x,c.y,c.z];const v=o.length(o.sub([],this._camera.position,_));return o.clamp(this._zoomFromMercatorZ(v),this._minZoom,this._maxZoom)}setFreeCameraOptions(c){if(!this.height||!c.position&&!c.orientation)return;this._updateCameraState();let h=!1;if(c.orientation&&!o.exactEquals(c.orientation,this._camera.orientation)&&(h=this._setCameraOrientation(c.orientation)),c.position){const _=[c.position.x,c.position.y,c.position.z];o.exactEquals$1(_,this._camera.position)||(this._setCameraPosition(_),h=!0)}h&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const c=this._camera.position,h=new ks;return h.position=new o.MercatorCoordinate(c[0],c[1],c[2]),h.orientation=this._camera.orientation,h._elevation=this.elevation,h._renderWorldCopies=this.renderWorldCopies,h}_setCameraOrientation(c){if(!o.length$1(c))return!1;o.normalize$1(c,c);const h=o.transformQuat([],[0,0,-1],c),_=o.transformQuat([],[0,-1,0],c);if(_[2]<0)return!1;const v=jl(h,_);return!!v&&(this._camera.orientation=v,!0)}_setCameraPosition(c){const h=this.zoomScale(this.minZoom)*this.tileSize,_=this.zoomScale(this.maxZoom)*this.tileSize,v=this.cameraToCenterDistance;c[2]=o.clamp(c[2],v/_,v/h),this._camera.position=c}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(c){return this._edgeInsets.equals(c)}interpolatePadding(c,h,_){this._unmodified=!1,this._edgeInsets.interpolate(c,h,_),this._constrain(),this._calcMatrices()}coveringZoomLevel(c){const h=(c.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/c.tileSize));return Math.max(0,h)}getVisibleUnwrappedCoordinates(c){const h=[new o.UnwrappedTileID(0,c)];if(this.renderWorldCopies){const _=this.pointCoordinate(new o.pointGeometry(0,0)),v=this.pointCoordinate(new o.pointGeometry(this.width,0)),w=this.pointCoordinate(new o.pointGeometry(this.width,this.height)),S=this.pointCoordinate(new o.pointGeometry(0,this.height)),I=Math.floor(Math.min(_.x,v.x,w.x,S.x)),z=Math.floor(Math.max(_.x,v.x,w.x,S.x)),F=1;for(let N=I-F;N<=z+F;N++)N!==0&&h.push(new o.UnwrappedTileID(N,c))}return h}coveringTiles(c){let h=this.coveringZoomLevel(c);const _=h,v=this.elevation&&!c.isTerrainDEM,w=this.projection.name==="mercator";if(c.minzoom!==void 0&&h<c.minzoom)return[];c.maxzoom!==void 0&&h>c.maxzoom&&(h=c.maxzoom);const S=this.locationCoordinate(this.center),I=this.center.lat,z=1<<h,F=[z*S.x,z*S.y,0],N=this.projection.name==="globe",q=!N,Q=o.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,h,q),it=N?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),rt=z*o.mercatorZfromAltitude(1,this.center.lat),ot=this._camera.position[2]/o.mercatorZfromAltitude(1,this.center.lat),at=[z*it.x,z*it.y,ot*(q?1:rt)],K=this.cameraToCenterDistance/c.tileSize*(c.roundZoom?1:.502),ht=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?h:0,ut=c.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,mt=c.isTerrainDEM?-ut:this._elevation?this._elevation.getMinElevationBelowMSL():0,Tt=this.projection.isReprojectedInTileSpace?nh(this):1,wt=Gt=>{const Wt=new o.MercatorCoordinate(Gt.x+25e-6,Gt.y,Gt.z),ie=new o.MercatorCoordinate(Gt.x,Gt.y+25e-6,Gt.z),pe=Gt.toLngLat(),Je=Wt.toLngLat(),Pn=ie.toLngLat(),We=this.locationCoordinate(pe),je=this.locationCoordinate(Je),nn=this.locationCoordinate(Pn),Nn=Math.hypot(je.x-We.x,je.y-We.y),sn=Math.hypot(nn.x-We.x,nn.y-We.y);return Math.sqrt(Nn*sn)*Tt/25e-6},Mt=Gt=>{const Ot=ut,Wt=mt;return{aabb:o.tileAABB(this,z,0,0,0,Gt,Wt,Ot,this.projection),zoom:0,x:0,y:0,minZ:Wt,maxZ:Ot,wrap:Gt,fullyVisible:!1}},Ft=[];let Vt=[];const Ht=h,ke=c.reparseOverscaled?_:h,Nt=Gt=>Gt*Gt,ne=Nt((ot-this._centerAltitude)*rt),Xt=Gt=>{if(!this._elevation||!Gt.tileID||!w)return;const Ot=this._elevation.getMinMaxForTile(Gt.tileID),Wt=Gt.aabb;Ot?(Wt.min[2]=Ot.min,Wt.max[2]=Ot.max,Wt.center[2]=(Wt.min[2]+Wt.max[2])/2):(Gt.shouldSplit=ue(Gt),Gt.shouldSplit||(Wt.min[2]=Wt.max[2]=Wt.center[2]=this._centerAltitude))},ue=Gt=>{if(Gt.zoom<ht)return!0;if(Gt.zoom===Ht)return!1;if(Gt.shouldSplit!=null)return Gt.shouldSplit;const Ot=Gt.aabb.distanceX(at),Wt=Gt.aabb.distanceY(at);let ie=ne,pe=1;if(N){ie=Nt(Gt.aabb.distanceZ(at));const We=Math.pow(2,Gt.zoom),je=o.latFromMercatorY((Gt.y+1)/We),nn=o.latFromMercatorY(Gt.y/We),Nn=Math.min(Math.max(I,je),nn),sn=o.circumferenceAtLatitude(Nn)/o.circumferenceAtLatitude(I);if(pe=Nn===I?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,sn/this._mercatorScaleRatio),this.zoom<=o.GLOBE_ZOOM_THRESHOLD_MIN&&Gt.zoom===Ht-1&&sn>=.9)return!0}else if(v&&(ie=Nt(Gt.aabb.distanceZ(at)*rt)),this.projection.isReprojectedInTileSpace&&_<=5){const We=Math.pow(2,Gt.zoom),je=wt(new o.MercatorCoordinate((Gt.x+.5)/We,(Gt.y+.5)/We));pe=je>.85?1:je}const Je=Ot*Ot+Wt*Wt+ie,Pn=Nt((1<<Ht-Gt.zoom)*K*pe*((We,je)=>{if(je*Nt(.707)<We)return 1;const nn=Math.sqrt(je/We);return nn/(1.4144271570014144+(Math.pow(1.1,nn-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(ie,ne),Je));return Je<Pn};if(this.renderWorldCopies)for(let Gt=1;Gt<=3;Gt++)Ft.push(Mt(-Gt)),Ft.push(Mt(Gt));for(Ft.push(Mt(0));Ft.length>0;){const Gt=Ft.pop(),Ot=Gt.x,Wt=Gt.y;let ie=Gt.fullyVisible;if(!ie){const pe=Gt.aabb.intersects(Q);if(pe===0)continue;ie=pe===2}if(Gt.zoom!==Ht&&ue(Gt))for(let pe=0;pe<4;pe++){const Je=(Ot<<1)+pe%2,Pn=(Wt<<1)+(pe>>1),We={aabb:w?Gt.aabb.quadrant(pe):o.tileAABB(this,z,Gt.zoom+1,Je,Pn,Gt.wrap,Gt.minZ,Gt.maxZ,this.projection),zoom:Gt.zoom+1,x:Je,y:Pn,wrap:Gt.wrap,fullyVisible:ie,tileID:void 0,shouldSplit:void 0,minZ:Gt.minZ,maxZ:Gt.maxZ};v&&!N&&(We.tileID=new o.OverscaledTileID(Gt.zoom+1===Ht?ke:Gt.zoom+1,Gt.wrap,Gt.zoom+1,Je,Pn),Xt(We)),Ft.push(We)}else{const pe=Gt.zoom===Ht?ke:Gt.zoom;if(c.minzoom&&c.minzoom>pe)continue;const Je=F[0]-(.5+Ot+(Gt.wrap<<Gt.zoom))*(1<<h-Gt.zoom),Pn=F[1]-.5-Wt,We=Gt.tileID?Gt.tileID:new o.OverscaledTileID(pe,Gt.wrap,Gt.zoom,Ot,Wt);Vt.push({tileID:We,distanceSq:Je*Je+Pn*Pn})}}if(this.fogCullDistSq){const Gt=this.fogCullDistSq,Ot=this.horizonLineFromTop();Vt=Vt.filter(Wt=>{const ie=[0,0,0,1],pe=[o.EXTENT,o.EXTENT,0,1],Je=this.calculateFogTileMatrix(Wt.tileID.toUnwrapped());o.transformMat4$1(ie,ie,Je),o.transformMat4$1(pe,pe,Je);const Pn=o.getAABBPointSquareDist(ie,pe);if(Pn===0)return!0;let We=!1;const je=this._elevation;if(je&&Pn>Gt&&Ot!==0){const nn=this.calculateProjMatrix(Wt.tileID.toUnwrapped());let Nn;c.isTerrainDEM||(Nn=je.getMinMaxForTile(Wt.tileID)),Nn||(Nn={min:mt,max:ut});const sn=o.furthestTileCorner(this.rotation),ar=[sn[0]*o.EXTENT,sn[1]*o.EXTENT,Nn.max];o.transformMat4(ar,ar,nn),We=(1-ar[1])*this.height*.5<Ot}return Pn<Gt||We})}return Vt.sort((Gt,Ot)=>Gt.distanceSq-Ot.distanceSq).map(Gt=>Gt.tileID)}resize(c,h){this.width=c,this.height=h,this.pixelsToGLUnits=[2/c,-2/h],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(c){return Math.pow(2,c)}scaleZoom(c){return Math.log(c)/Math.LN2}project(c){const h=o.clamp(c.lat,-o.MAX_MERCATOR_LATITUDE,o.MAX_MERCATOR_LATITUDE),_=this.projection.project(c.lng,h);return new o.pointGeometry(_.x*this.worldSize,_.y*this.worldSize)}unproject(c){return this.projection.unproject(c.x/this.worldSize,c.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/o.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(c,h){let _,v;const w=this.centerPoint;if(this.projection.name==="globe"){const I=this.worldSize;_=(h.x-w.x)/I,v=(h.y-w.y)/I}else{const I=this.pointCoordinate(h),z=this.pointCoordinate(w);_=I.x-z.x,v=I.y-z.y}const S=this.locationCoordinate(c);this.setLocation(new o.MercatorCoordinate(S.x-_,S.y-v))}setLocation(c){this.center=this.coordinateLocation(c),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(c){return this.projection.locationPoint(this,c)}locationPoint3D(c){return this.projection.locationPoint(this,c,!0)}pointLocation(c){return this.coordinateLocation(this.pointCoordinate(c))}pointLocation3D(c){return this.coordinateLocation(this.pointCoordinate3D(c))}locationCoordinate(c,h){const _=h?o.mercatorZfromAltitude(h,c.lat):void 0,v=this.projection.project(c.lng,c.lat);return new o.MercatorCoordinate(v.x,v.y,_)}coordinateLocation(c){return this.projection.unproject(c.x,c.y)}pointRayIntersection(c,h){const _=h!=null?h:this._centerAltitude,v=[c.x,c.y,0,1],w=[c.x,c.y,1,1];o.transformMat4$1(v,v,this.pixelMatrixInverse),o.transformMat4$1(w,w,this.pixelMatrixInverse);const S=w[3];o.scale$1(v,v,1/v[3]),o.scale$1(w,w,1/S);const I=v[2],z=w[2];return{p0:v,p1:w,t:I===z?0:(_-I)/(z-I)}}screenPointToMercatorRay(c){const h=[c.x,c.y,0,1],_=[c.x,c.y,1,1];return o.transformMat4$1(h,h,this.pixelMatrixInverse),o.transformMat4$1(_,_,this.pixelMatrixInverse),o.scale$1(h,h,1/h[3]),o.scale$1(_,_,1/_[3]),h[2]=o.mercatorZfromAltitude(h[2],this._center.lat)*this.worldSize,_[2]=o.mercatorZfromAltitude(_[2],this._center.lat)*this.worldSize,o.scale$1(h,h,1/this.worldSize),o.scale$1(_,_,1/this.worldSize),new o.Ray([h[0],h[1],h[2]],o.normalize([],o.sub([],_,h)))}rayIntersectionCoordinate(c){const{p0:h,p1:_,t:v}=c,w=o.mercatorZfromAltitude(h[2],this._center.lat),S=o.mercatorZfromAltitude(_[2],this._center.lat);return new o.MercatorCoordinate(o.number(h[0],_[0],v)/this.worldSize,o.number(h[1],_[1],v)/this.worldSize,o.number(w,S,v))}pointCoordinate(c,h=this._centerAltitude){return this.projection.pointCoordinate(this,c.x,c.y,h)}pointCoordinate3D(c){if(!this.elevation)return this.pointCoordinate(c);let h=this.projection.pointCoordinate3D(this,c.x,c.y);if(h)return new o.MercatorCoordinate(h[0],h[1],h[2]);let _=0,v=this.horizonLineFromTop();if(c.y>v)return this.pointCoordinate(c);const w=.02*v,S=c.clone();for(let I=0;I<10&&v-_>w;I++){S.y=o.number(_,v,.66);const z=this.projection.pointCoordinate3D(this,S.x,S.y);z?(v=S.y,h=z):_=S.y}return h?new o.MercatorCoordinate(h[0],h[1],h[2]):this.pointCoordinate(c)}isPointAboveHorizon(c){return this.projection.isPointAboveHorizon(this,c)}_coordinatePoint(c,h){const _=h&&this.elevation?this.elevation.getAtPointOrZero(c,this._centerAltitude):this._centerAltitude,v=[c.x*this.worldSize,c.y*this.worldSize,_+c.toAltitude(),1];return o.transformMat4$1(v,v,this.pixelMatrix),v[3]>0?new o.pointGeometry(v[0]/v[3],v[1]/v[3]):new o.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:c,left:h}=this._edgeInsets,_=this.height-this._edgeInsets.bottom,v=this.width-this._edgeInsets.right,w=this.pointLocation3D(new o.pointGeometry(h,c)),S=this.pointLocation3D(new o.pointGeometry(v,c)),I=this.pointLocation3D(new o.pointGeometry(v,_)),z=this.pointLocation3D(new o.pointGeometry(h,_));let F=Math.min(w.lng,S.lng,I.lng,z.lng),N=Math.max(w.lng,S.lng,I.lng,z.lng),q=Math.min(w.lat,S.lat,I.lat,z.lat),Q=Math.max(w.lat,S.lat,I.lat,z.lat);const it=Math.pow(2,-this.zoom)/16*270,rt=this.projection.name==="globe"?1:4,ot=(at,K,ht,ut,mt)=>{const Tt=(at+ht)/2,wt=(K+ut)/2,Mt=new o.pointGeometry(Tt,wt),{lng:Ft,lat:Vt}=this.pointLocation3D(Mt),Ht=Math.max(0,F-Ft,q-Vt,Ft-N,Vt-Q);F=Math.min(F,Ft),N=Math.max(N,Ft),q=Math.min(q,Vt),Q=Math.max(Q,Vt),(mt<rt||Ht>it)&&(ot(at,K,Tt,wt,mt+1),ot(Tt,wt,ht,ut,mt+1))};if(ot(h,c,v,c,1),ot(v,c,v,_,1),ot(v,_,h,_,1),ot(h,_,h,c,1),this.projection.name==="globe"){const[at,K]=o.polesInViewport(this);at?(Q=90,N=180,F=-180):K&&(q=-90,N=180,F=-180)}return new o.LngLatBounds(new o.LngLat(F,q),new o.LngLat(N,Q))}_getBoundsRectangular(c,h){const{top:_,left:v}=this._edgeInsets,w=this.height-this._edgeInsets.bottom,S=this.width-this._edgeInsets.right,I=new o.pointGeometry(v,_),z=new o.pointGeometry(S,_),F=new o.pointGeometry(S,w),N=new o.pointGeometry(v,w);let q=this.pointCoordinate(I,c),Q=this.pointCoordinate(z,c);const it=this.pointCoordinate(F,h),rt=this.pointCoordinate(N,h),ot=(at,K)=>(K.y-at.y)/(K.x-at.x);return q.y>1&&Q.y>=0?q=new o.MercatorCoordinate((1-rt.y)/ot(rt,q)+rt.x,1):q.y<0&&Q.y<=1&&(q=new o.MercatorCoordinate(-rt.y/ot(rt,q)+rt.x,0)),Q.y>1&&q.y>=0?Q=new o.MercatorCoordinate((1-it.y)/ot(it,Q)+it.x,1):Q.y<0&&q.y<=1&&(Q=new o.MercatorCoordinate(-it.y/ot(it,Q)+it.x,0)),new o.LngLatBounds().extend(this.coordinateLocation(q)).extend(this.coordinateLocation(Q)).extend(this.coordinateLocation(rt)).extend(this.coordinateLocation(it))}_getBoundsRectangularTerrain(){const c=this.elevation;if(!c.visibleDemTiles.length||c.isUsingMockSource())return this._getBoundsRectangular(0,0);const h=c.visibleDemTiles.reduce((_,v)=>{if(v.dem){const w=v.dem.tree;_.min=Math.min(_.min,w.minimums[0]),_.max=Math.max(_.max,w.maximums[0])}return _},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(h.min*c.exaggeration(),h.max*c.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(c=!0){const h=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,_=this.height/2-h*(1-this._horizonShift);return c?Math.max(0,_):_}getMaxBounds(){return this.maxBounds}setMaxBounds(c){this.maxBounds=c,this.minLat=-o.MAX_MERCATOR_LATITUDE,this.maxLat=o.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,c&&(this.minLat=c.getSouth(),this.maxLat=c.getNorth(),this.minLng=c.getWest(),this.maxLng=c.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=o.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=o.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=o.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=o.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(c,h){return this.projection.createTileMatrix(this,h,c)}calculateDistanceTileData(c){const h=c.key,_=this._distanceTileDataCache;if(_[h])return _[h];const v=c.canonical,w=1/this.height,S=this.cameraWorldSize,I=S/this.zoomScale(v.z),z=(v.x+Math.pow(2,v.z)*c.wrap)*I,F=v.y*I,N=this.point;N.x*=S/this.worldSize,N.y*=S/this.worldSize;const q=this.angle,Q=Math.sin(-q),it=-Math.cos(-q);return _[h]={bearing:[Q,it],center:[(N.x-z)*w,(N.y-F)*w],scale:I/o.EXTENT*w},_[h]}calculateFogTileMatrix(c){const h=c.key,_=this._fogTileMatrixCache;if(_[h])return _[h];const v=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,c);return o.multiply(v,this.worldToFogMatrix,v),_[h]=new Float32Array(v),_[h]}calculateProjMatrix(c,h=!1){const _=c.key,v=h?this._alignedProjMatrixCache:this._projMatrixCache;if(v[_])return v[_];const w=this.calculatePosMatrix(c,this.worldSize);return o.multiply(w,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:h?this.alignedProjMatrix:this.projMatrix,w),v[_]=new Float32Array(w),v[_]}calculatePixelsToTileUnitsMatrix(c){const h=c.tileID.key,_=this._pixelsToTileUnitsCache;if(_[h])return _[h];const v=function(w,S){const{scale:I}=w.tileTransform,z=I*o.EXTENT/(w.tileSize*Math.pow(2,S.zoom-w.tileID.overscaledZ+w.tileID.canonical.z));return F=new Float32Array(4),Q=(N=S.inverseAdjustmentMatrix)[1],it=N[2],rt=N[3],at=(q=[z,z])[1],F[0]=N[0]*(ot=q[0]),F[1]=Q*ot,F[2]=it*at,F[3]=rt*at,F;var F,N,q,Q,it,rt,ot,at}(c,this);return _[h]=v,_[h]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const c=1/this.worldSize,h=o.fromScaling([],[c,c,c]);return o.multiply(h,h,this.globeMatrix),h}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const c=this._elevation;this._updateCameraState();const h=o.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,_=this._computeCameraPosition(h),v=this._camera.forward(),w=o.mercatorZfromAltitude(1,this._center.lat);_[2]/=w,v[2]/=w,o.normalize(v,v);const S=c.raycast(_,v,c.exaggeration());if(S){const I=o.scaleAndAdd([],_,v,S),z=new o.MercatorCoordinate(I[0],I[1],o.mercatorZfromAltitude(I[2],o.latFromMercatorY(I[1]))),F=(z.z+o.length([z.x-_[0],z.y-_[1],z.z-_[2]*w]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(F),this._centerAltitude=z.toAltitude(),this._center=this.coordinateLocation(z),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(c=!1){if(!this._elevation)return;const h=this._elevation,_=o.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,v=this._computeCameraPosition(_),w=h.getAtPointOrZero(new o.MercatorCoordinate(...v)),S=this.pixelsPerMeter/this.worldSize*w,I=this._minimumHeightOverTerrain(),z=v[2]-S;if(z<=I)if(z<0||c){const F=this.locationCoordinate(this._center,this._centerAltitude),N=[v[0],v[1],F.z-v[2]],q=o.length(N);N[2]-=(I-z)/this._pixelsPerMercatorPixel;const Q=o.length(N);if(Q===0)return;o.scale$2(N,N,q/Q*this._pixelsPerMercatorPixel),this._camera.position=[v[0],v[1],F.z*this._pixelsPerMercatorPixel-N[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const c=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||c){const Q=this.center;return Q.lat=o.clamp(Q.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!c)&&(Q.lng=o.clamp(Q.lng,this.minLng,this.maxLng)),this.center=Q,void(this._constraining=!1)}const h=this._unmodified,{x:_,y:v}=this.point;let w=0,S=_,I=v;const z=this.width/2,F=this.height/2,N=this.worldMinY*this.scale,q=this.worldMaxY*this.scale;if(v-F<N&&(I=N+F),v+F>q&&(I=q-F),q-N<this.height&&(w=Math.max(w,this.height/(q-N)),I=(q+N)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const Q=this.worldMinX*this.scale,it=this.worldMaxX*this.scale,rt=this.worldSize/2-(Q+it)/2;S=(_+rt+this.worldSize)%this.worldSize-rt,S-z<Q&&(S=Q+z),S+z>it&&(S=it-z),it-Q<this.width&&(w=Math.max(w,this.width/(it-Q)),S=(it+Q)/2)}S===_&&I===v||(this.center=this.unproject(new o.pointGeometry(S,I))),w&&(this.zoom+=this.scaleZoom(w)),this._constrainCamera(),this._unmodified=h,this._constraining=!1}_minZoomForBounds(){let c=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(c=Math.max(c,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),c}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const c=this.centerOffset,h=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=o.mercatorZfromAltitude(1,this.center.lat)/o.mercatorZfromAltitude(1,o.GLOBE_SCALE_MATCH_LATITUDE));const _=Ul(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,_),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const v=this.projection.zAxisUnit==="meters"?h:1,w=this._camera.getWorldToCamera(this.worldSize,v),S=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);S[8]=2*-c.x/this.width,S[9]=2*c.y/this.height;let I=o.mul([],S,w);if(this.projection.isReprojectedInTileSpace){const wt=this.locationCoordinate(this.center),Mt=o.identity([]);o.translate(Mt,Mt,[wt.x*this.worldSize,wt.y*this.worldSize,0]),o.multiply(Mt,Mt,Lc(this)),o.translate(Mt,Mt,[-wt.x*this.worldSize,-wt.y*this.worldSize,0]),o.multiply(I,I,Mt),this.inverseAdjustmentMatrix=function(Ft){const Vt=Lc(Ft,!0);return jt([],[Vt[0],Vt[1],Vt[4],Vt[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=o.scale([],I,[this.worldSize,this.worldSize,this.worldSize/v,1]),this.projMatrix=I,this.invProjMatrix=o.invert(new Float64Array(16),this.projMatrix);const z=o.invert([],S);this.frustumCorners=o.FrustumCorners.fromInvProjectionMatrix(z,this.horizonLineFromTop(),this.height);const F=new Float32Array(16);o.identity(F),o.scale(F,F,[1,-1,1]),o.rotateX(F,F,this._pitch),o.rotateZ(F,F,this.angle);const N=o.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),q=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;N[8]=2*-c.x/this.width,N[9]=2*(c.y+q)/this.height,this.skyboxMatrix=o.multiply(F,N,F);const Q=this.point,it=Q.x,rt=Q.y,ot=this.width%2/2,at=this.height%2/2,K=Math.cos(this.angle),ht=Math.sin(this.angle),ut=it-Math.round(it)+K*ot+ht*at,mt=rt-Math.round(rt)+K*at+ht*ot,Tt=new Float64Array(I);if(o.translate(Tt,Tt,[ut>.5?ut-1:ut,mt>.5?mt-1:mt,0]),this.alignedProjMatrix=Tt,I=o.create(),o.scale(I,I,[this.width/2,-this.height/2,1]),o.translate(I,I,[1,-1,0]),this.labelPlaneMatrix=I,I=o.create(),o.scale(I,I,[1,-1,1]),o.translate(I,I,[-1,-1,0]),o.scale(I,I,[2/this.width,2/this.height,1]),this.glCoordMatrix=I,this.pixelMatrix=o.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},I=o.invert(new Float64Array(16),this.pixelMatrix),!I)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=I,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=o.calculateGlobeMatrix(this);const wt=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=o.transformMat4(wt,wt,w),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=I;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const c=this.cameraWorldSizeForFog,h=this.cameraPixelsPerMeter,_=this._camera.position,v=1/this.height/this._pixelsPerMercatorPixel,w=[c,c,h];o.scale$2(w,w,v),o.scale$2(_,_,-1),o.multiply$2(_,_,w);const S=o.create();o.translate(S,S,_),o.scale(S,S,w),this.mercatorFogMatrix=S,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(c,h,v)}_computeCameraPosition(c){const h=(c=c||this.pixelsPerMeter)/this.pixelsPerMeter,_=this._camera.forward(),v=this.point,w=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*h-c/this.worldSize*this._centerAltitude;return[v.x/this.worldSize-_[0]*w,v.y/this.worldSize-_[1]*w,c/this.worldSize*this._centerAltitude-_[2]*w]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(c){const h=this._maxCameraBoundsDistance()*Math.cos(this._pitch),_=this._camera.position[2],v=c[2];let w=1;this.projection.wrap&&(this.center=this.center.wrap()),v>0&&(w=Math.min((h-_)/v,1)),this._camera.position=o.scaleAndAdd([],this._camera.position,c,w),this._updateStateFromCamera()}_updateStateFromCamera(){const c=this._camera.position,h=this._camera.forward(),{pitch:_,bearing:v}=this._camera.getPitchBearing(),w=o.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,S=this._mercatorZfromZoom(this._maxZoom)*Math.cos(o.degToRad(this._maxPitch)),I=Math.max((c[2]-w)/Math.cos(_),S),z=this._zoomFromMercatorZ(I);o.scaleAndAdd(c,c,h,I),this._pitch=o.clamp(_,o.degToRad(this.minPitch),o.degToRad(this.maxPitch)),this.angle=o.wrap(v,-Math.PI,Math.PI),this._setZoom(o.clamp(z,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new o.MercatorCoordinate(c[0],c[1],c[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(c){return Math.pow(2,c)*this.tileSize}_mercatorZfromZoom(c){return this.cameraToCenterDistance/this._worldSizeFromZoom(c)}_minimumHeightOverTerrain(){const c=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(c)}_zoomFromMercatorZ(c){return this.scaleZoom(this.cameraToCenterDistance/(c*this.tileSize))}zoomFromMercatorZAdjusted(c){let h=0,_=o.GLOBE_ZOOM_THRESHOLD_MAX,v=0,w=1/0;for(;_-h>1e-6&&_>h;){const S=h+.5*(_-h),I=this.tileSize*Math.pow(2,S),z=this.getCameraToCenterDistance(this.projection,S,I),F=this.scaleZoom(z/(c*this.tileSize)),N=Math.abs(S-F);N<w&&(w=N,v=S),S<F?h=S:_=S}return v}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(o.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(c,h){const _=Math.min(c.x,h.x),v=Math.max(c.x,h.x),w=Math.min(c.y,h.y),S=Math.max(c.y,h.y);if(w<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const I=[new o.pointGeometry(_,w),new o.pointGeometry(v,S),new o.pointGeometry(_,S),new o.pointGeometry(v,w)],z=this.renderWorldCopies?-3:0,F=this.renderWorldCopies?4:1;for(const N of I){const q=this.pointRayIntersection(N);if(q.t<0)return!0;const Q=this.rayIntersectionCoordinate(q);if(Q.x<z||Q.y<0||Q.x>F||Q.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+o.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new o.pointGeometry(0,0),new o.pointGeometry(this.width,this.height))}zoomDeltaToMovement(c,h){const _=o.length(o.sub([],this._camera.position,c)),v=this._zoomFromMercatorZ(_)+h;return _-this._mercatorZfromZoom(v)}getCameraPoint(){if(this.projection.name==="globe"){const c=function([h,_,v],w){const S=[h,_,v,1];o.transformMat4$1(S,S,w);const I=S[3]=Math.max(S[3],1e-6);return S[0]/=I,S[1]/=I,S[2]/=I,S}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new o.pointGeometry(c[0],c[1])}{const c=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.pointGeometry(0,c))}}getCameraToCenterDistance(c,h=this.zoom,_=this.worldSize){const v=Ul(c,h,this.width,this.height,1024),w=c.pixelSpaceConversion(this.center.lat,_,v);return .5/Math.tan(.5*this._fov)*this.height*w}getWorldToCameraMatrix(){const c=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&o.multiply(c,c,this.globeMatrix),c}}function ca(m,c){let h=!1,_=null;const v=()=>{_=null,h&&(m(),_=setTimeout(v,c),h=!1)};return()=>(h=!0,_||v(),_)}class Wm{constructor(c){this._hashName=c&&encodeURIComponent(c),o.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=ca(this._updateHashUnthrottled.bind(this),300)}addTo(c){return this._map=c,o.window.addEventListener("hashchange",this._onHashChange,!1),c.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),o.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const c=this._map;if(!c)return"";const h=Sf(c);if(this._hashName){const _=this._hashName;let v=!1;const w=o.window.location.hash.slice(1).split("&").map(S=>{const I=S.split("=")[0];return I===_?(v=!0,`${I}=${h}`):S}).filter(S=>S);return v||w.push(`${_}=${h}`),`#${w.join("&")}`}return`#${h}`}_getCurrentHash(){const c=o.window.location.hash.replace("#","");if(this._hashName){let h;return c.split("&").map(_=>_.split("=")).forEach(_=>{_[0]===this._hashName&&(h=_)}),(h&&h[1]||"").split("/")}return c.split("/")}_onHashChange(){const c=this._map;if(!c)return!1;const h=this._getCurrentHash();if(h.length>=3&&!h.some(_=>isNaN(_))){const _=c.dragRotate.isEnabled()&&c.touchZoomRotate.isEnabled()?+(h[3]||0):c.getBearing();return c.jumpTo({center:[+h[2],+h[1]],zoom:+h[0],bearing:_,pitch:+(h[4]||0)}),!0}return!1}_updateHashUnthrottled(){const c=o.window.location.href.replace(/(#.+)?$/,this.getHashString());o.window.history.replaceState(o.window.history.state,null,c)}}function Sf(m,c){const h=m.getCenter(),_=Math.round(100*m.getZoom())/100,v=Math.ceil((_*Math.LN2+Math.log(512/360/.5))/Math.LN10),w=Math.pow(10,v),S=Math.round(h.lng*w)/w,I=Math.round(h.lat*w)/w,z=m.getBearing(),F=m.getPitch();let N=c?`/${S}/${I}/${_}`:`${_}/${I}/${S}`;return(z||F)&&(N+="/"+Math.round(10*z)/10),F&&(N+=`/${Math.round(F)}`),N}const Vu={linearity:.3,easing:o.bezier(0,0,.3,1)},zc=o.extend({deceleration:2500,maxSpeed:1400},Vu),Zm=o.extend({deceleration:20,maxSpeed:1400},Vu),rh=o.extend({deceleration:1e3,maxSpeed:360},Vu),Mf=o.extend({deceleration:1e3,maxSpeed:90},Vu);class ih{constructor(c){this._map=c,this.clear()}clear(){this._inertiaBuffer=[]}record(c){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:o.exported.now(),settings:c})}_drainInertiaBuffer(){const c=this._inertiaBuffer,h=o.exported.now();for(;c.length>0&&h-c[0].time>160;)c.shift()}_onMoveEnd(c){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const h={zoom:0,bearing:0,pitch:0,pan:new o.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:w}of this._inertiaBuffer)h.zoom+=w.zoomDelta||0,h.bearing+=w.bearingDelta||0,h.pitch+=w.pitchDelta||0,w.panDelta&&h.pan._add(w.panDelta),w.around&&(h.around=w.around),w.pinchAround&&(h.pinchAround=w.pinchAround);const _=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,v={};if(h.pan.mag()){const w=qu(h.pan.mag(),_,o.extend({},zc,c||{}));v.offset=h.pan.mult(w.amount/h.pan.mag()),v.center=this._map.transform.center,Gu(v,w)}if(h.zoom){const w=qu(h.zoom,_,Zm);v.zoom=this._map.transform.zoom+w.amount,Gu(v,w)}if(h.bearing){const w=qu(h.bearing,_,rh);v.bearing=this._map.transform.bearing+o.clamp(w.amount,-179,179),Gu(v,w)}if(h.pitch){const w=qu(h.pitch,_,Mf);v.pitch=this._map.transform.pitch+w.amount,Gu(v,w)}if(v.zoom||v.bearing){const w=h.pinchAround===void 0?h.around:h.pinchAround;v.around=w?this._map.unproject(w):this._map.getCenter()}return this.clear(),v.noMoveStart=!0,v}}function Gu(m,c){(!m.duration||m.duration<c.duration)&&(m.duration=c.duration,m.easing=c.easing)}function qu(m,c,h){const{maxSpeed:_,linearity:v,deceleration:w}=h,S=o.clamp(m*v/(c/1e3),-_,_),I=Math.abs(S)/(w*v);return{easing:h.easing,duration:1e3*I,amount:S*(I/2)}}class Gi extends o.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(c,h,_,v={}){const w=et(h.getCanvasContainer(),_),S=h.unproject(w);super(c,o.extend({point:w,lngLat:S,originalEvent:_},v)),this._defaultPrevented=!1,this.target=h}}class oh extends o.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(c,h,_){const v=c==="touchend"?_.changedTouches:_.touches,w=Pt(h.getCanvasContainer(),v),S=w.map(z=>h.unproject(z)),I=w.reduce((z,F,N,q)=>z.add(F.div(q.length)),new o.pointGeometry(0,0));super(c,{points:w,point:I,lngLats:S,lngLat:h.unproject(I),originalEvent:_}),this._defaultPrevented=!1}}class Ey extends o.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(c,h,_){super(c,{originalEvent:_}),this._defaultPrevented=!1}}class Xm{constructor(c,h){this._map=c,this._clickTolerance=h.clickTolerance}reset(){this._mousedownPos=void 0}wheel(c){return this._firePreventable(new Ey(c.type,this._map,c))}mousedown(c,h){return this._mousedownPos=h,this._firePreventable(new Gi(c.type,this._map,c))}mouseup(c){this._map.fire(new Gi(c.type,this._map,c))}preclick(c){const h=o.extend({},c);h.type="preclick",this._map.fire(new Gi(h.type,this._map,h))}click(c,h){this._mousedownPos&&this._mousedownPos.dist(h)>=this._clickTolerance||(this.preclick(c),this._map.fire(new Gi(c.type,this._map,c)))}dblclick(c){return this._firePreventable(new Gi(c.type,this._map,c))}mouseover(c){this._map.fire(new Gi(c.type,this._map,c))}mouseout(c){this._map.fire(new Gi(c.type,this._map,c))}touchstart(c){return this._firePreventable(new oh(c.type,this._map,c))}touchmove(c){this._map.fire(new oh(c.type,this._map,c))}touchend(c){this._map.fire(new oh(c.type,this._map,c))}touchcancel(c){this._map.fire(new oh(c.type,this._map,c))}_firePreventable(c){if(this._map.fire(c),c.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ah{constructor(c){this._map=c}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(c){this._map.fire(new Gi(c.type,this._map,c))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Gi("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(c){this._delayContextMenu?this._contextMenuEvent=c:this._map.fire(new Gi(c.type,this._map,c)),this._map.listens("contextmenu")&&c.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Af{constructor(c,h){this._map=c,this._el=c.getCanvasContainer(),this._container=c.getContainer(),this._clickTolerance=h.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(c,h){this.isEnabled()&&c.shiftKey&&c.button===0&&(H(),this._startPos=this._lastPos=h,this._active=!0)}mousemoveWindow(c,h){if(!this._active)return;const _=h,v=this._startPos,w=this._lastPos;if(!v||!w||w.equals(_)||!this._box&&_.dist(v)<this._clickTolerance)return;this._lastPos=_,this._box||(this._box=P("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",c));const S=Math.min(v.x,_.x),I=Math.max(v.x,_.x),z=Math.min(v.y,_.y),F=Math.max(v.y,_.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${S}px,${z}px)`,this._box.style.width=I-S+"px",this._box.style.height=F-z+"px")})}mouseupWindow(c,h){if(!this._active)return;const _=this._startPos,v=h;if(_&&c.button===0){if(this.reset(),ft(),_.x!==v.x||_.y!==v.y)return this._map.fire(new o.Event("boxzoomend",{originalEvent:c})),{cameraAnimation:w=>w.fitScreenCoordinates(_,v,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",c)}}keydown(c){this._active&&c.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",c))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),V(),delete this._startPos,delete this._lastPos}_fireEvent(c,h){return this._map.fire(new o.Event(c,{originalEvent:h}))}}function sh(m,c){const h={};for(let _=0;_<m.length;_++)h[m[_].identifier]=c[_];return h}class Ym{constructor(c){this.reset(),this.numTouches=c.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(c,h,_){(this.centroid||_.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=c.timeStamp),_.length===this.numTouches&&(this.centroid=function(v){const w=new o.pointGeometry(0,0);for(const S of v)w._add(S);return w.div(v.length)}(h),this.touches=sh(_,h)))}touchmove(c,h,_){if(this.aborted||!this.centroid)return;const v=sh(_,h);for(const w in this.touches){const S=this.touches[w],I=v[w];(!I||I.dist(S)>30)&&(this.aborted=!0)}}touchend(c,h,_){if((!this.centroid||c.timeStamp-this.startTime>500)&&(this.aborted=!0),_.length===0){const v=!this.aborted&&this.centroid;if(this.reset(),v)return v}}}class Oc{constructor(c){this.singleTap=new Ym(c),this.numTaps=c.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(c,h,_){this.singleTap.touchstart(c,h,_)}touchmove(c,h,_){this.singleTap.touchmove(c,h,_)}touchend(c,h,_){const v=this.singleTap.touchend(c,h,_);if(v){const w=c.timeStamp-this.lastTime<500,S=!this.lastTap||this.lastTap.dist(v)<30;if(w&&S||this.reset(),this.count++,this.lastTime=c.timeStamp,this.lastTap=v,this.count===this.numTaps)return this.reset(),v}}}class If{constructor(){this._zoomIn=new Oc({numTouches:1,numTaps:2}),this._zoomOut=new Oc({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(c,h,_){this._zoomIn.touchstart(c,h,_),this._zoomOut.touchstart(c,h,_)}touchmove(c,h,_){this._zoomIn.touchmove(c,h,_),this._zoomOut.touchmove(c,h,_)}touchend(c,h,_){const v=this._zoomIn.touchend(c,h,_),w=this._zoomOut.touchend(c,h,_);return v?(this._active=!0,c.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:S=>S.easeTo({duration:300,zoom:S.getZoom()+1,around:S.unproject(v)},{originalEvent:c})}):w?(this._active=!0,c.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:S=>S.easeTo({duration:300,zoom:S.getZoom()-1,around:S.unproject(w)},{originalEvent:c})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Km={0:1,2:2};class lh{constructor(c){this.reset(),this._clickTolerance=c.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(c,h){return!1}_move(c,h){return{}}mousedown(c,h){if(this._lastPoint)return;const _=Rt(c);this._correctButton(c,_)&&(this._lastPoint=h,this._eventButton=_)}mousemoveWindow(c,h){const _=this._lastPoint;if(_){if(c.preventDefault(),this._eventButton!=null&&function(v,w){const S=Km[w];return v.buttons===void 0||(v.buttons&S)!==S}(c,this._eventButton))this.reset();else if(this._moved||!(h.dist(_)<this._clickTolerance))return this._moved=!0,this._lastPoint=h,this._move(_,h)}}mouseupWindow(c){this._lastPoint&&Rt(c)===this._eventButton&&(this._moved&&ft(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Jm extends lh{mousedown(c,h){super.mousedown(c,h),this._lastPoint&&(this._active=!0)}_correctButton(c,h){return h===0&&!c.ctrlKey}_move(c,h){return{around:h,panDelta:h.sub(c)}}}class Pf extends lh{_correctButton(c,h){return h===0&&c.ctrlKey||h===2}_move(c,h){const _=.8*(h.x-c.x);if(_)return this._active=!0,{bearingDelta:_}}contextmenu(c){c.preventDefault()}}class Lf extends lh{_correctButton(c,h){return h===0&&c.ctrlKey||h===2}_move(c,h){const _=-.5*(h.y-c.y);if(_)return this._active=!0,{pitchDelta:_}}contextmenu(c){c.preventDefault()}}class Dc{constructor(c,h){this._map=c,this._el=c.getCanvasContainer(),this._minTouches=1,this._clickTolerance=h.clickTolerance||1,this.reset(),o.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new o.pointGeometry(0,0)}touchstart(c,h,_){return this._calculateTransform(c,h,_)}touchmove(c,h,_){if(this._active&&!(_.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(_.length===1&&!o.isFullscreen())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return c.cancelable&&c.preventDefault(),this._calculateTransform(c,h,_)}}touchend(c,h,_){this._calculateTransform(c,h,_),this._active&&_.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(c,h,_){_.length>0&&(this._active=!0);const v=sh(_,h),w=new o.pointGeometry(0,0),S=new o.pointGeometry(0,0);let I=0;for(const F in v){const N=v[F],q=this._touches[F];q&&(w._add(N),S._add(N.sub(q)),I++,v[F]=N)}if(this._touches=v,I<this._minTouches||!S.mag())return;const z=S.div(I);return this._sum._add(z),this._sum.mag()<this._clickTolerance?void 0:{around:w.div(I),panDelta:z}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=P("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class ch{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(c){}_move(c,h,_){return{}}touchstart(c,h,_){this._firstTwoTouches||_.length<2||(this._firstTwoTouches=[_[0].identifier,_[1].identifier],this._start([h[0],h[1]]))}touchmove(c,h,_){const v=this._firstTwoTouches;if(!v)return;c.preventDefault();const[w,S]=v,I=Hu(_,h,w),z=Hu(_,h,S);if(!I||!z)return;const F=this._aroundCenter?null:I.add(z).div(2);return this._move([I,z],F,c)}touchend(c,h,_){if(!this._firstTwoTouches)return;const[v,w]=this._firstTwoTouches,S=Hu(_,h,v),I=Hu(_,h,w);S&&I||(this._active&&ft(),this.reset())}touchcancel(){this.reset()}enable(c){this._enabled=!0,this._aroundCenter=!!c&&c.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Hu(m,c,h){for(let _=0;_<m.length;_++)if(m[_].identifier===h)return c[_]}function Qm(m,c){return Math.log(m/c)/Math.LN2}class tg extends ch{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(c){this._startDistance=this._distance=c[0].dist(c[1])}_move(c,h){const _=this._distance;if(this._distance=c[0].dist(c[1]),this._active||!(Math.abs(Qm(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Qm(this._distance,_),pinchAround:h}}}function zf(m,c){return 180*m.angleWith(c)/Math.PI}class eg extends ch{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(c){this._startVector=this._vector=c[0].sub(c[1]),this._minDiameter=c[0].dist(c[1])}_move(c,h){const _=this._vector;if(this._vector=c[0].sub(c[1]),_&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:zf(this._vector,_),pinchAround:h}}_isBelowThreshold(c){this._minDiameter=Math.min(this._minDiameter,c.mag());const h=25/(Math.PI*this._minDiameter)*360,_=this._startVector;if(!_)return!1;const v=zf(c,_);return Math.abs(v)<h}}function uh(m){return Math.abs(m.y)>Math.abs(m.x)}class uo extends ch{constructor(c){super(),this._map=c}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(c){this._lastPoints=c,uh(c[0].sub(c[1]))&&(this._valid=!1)}_move(c,h,_){const v=this._lastPoints;if(!v)return;const w=c[0].sub(v[0]),S=c[1].sub(v[1]);return this._map._cooperativeGestures&&!o.isFullscreen()&&_.touches.length<3||(this._valid=this.gestureBeginsVertically(w,S,_.timeStamp),!this._valid)?void 0:(this._lastPoints=c,this._active=!0,{pitchDelta:(w.y+S.y)/2*-.5})}gestureBeginsVertically(c,h,_){if(this._valid!==void 0)return this._valid;const v=c.mag()>=2,w=h.mag()>=2;if(!v&&!w)return;if(!v||!w)return this._firstMove==null&&(this._firstMove=_),_-this._firstMove<100&&void 0;const S=c.y>0==h.y>0;return uh(c)&&uh(h)&&S}}const Ty={panStep:100,bearingStep:15,pitchStep:10};class ng{constructor(){const c=Ty;this._panStep=c.panStep,this._bearingStep=c.bearingStep,this._pitchStep=c.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(c){if(c.altKey||c.ctrlKey||c.metaKey)return;let h=0,_=0,v=0,w=0,S=0;switch(c.keyCode){case 61:case 107:case 171:case 187:h=1;break;case 189:case 109:case 173:h=-1;break;case 37:c.shiftKey?_=-1:(c.preventDefault(),w=-1);break;case 39:c.shiftKey?_=1:(c.preventDefault(),w=1);break;case 38:c.shiftKey?v=1:(c.preventDefault(),S=-1);break;case 40:c.shiftKey?v=-1:(c.preventDefault(),S=1);break;default:return}return this._rotationDisabled&&(_=0,v=0),{cameraAnimation:I=>{const z=I.getZoom();I.easeTo({duration:300,easeId:"keyboardHandler",easing:ky,zoom:h?Math.round(z)+h*(c.shiftKey?2:1):z,bearing:I.getBearing()+_*this._bearingStep,pitch:I.getPitch()+v*this._pitchStep,offset:[-w*this._panStep,-S*this._panStep],center:I.getCenter()},{originalEvent:c})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function ky(m){return m*(2-m)}const rg=4.000244140625;class Cs{constructor(c,h){this._map=c,this._el=c.getCanvasContainer(),this._handler=h,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,o.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(c){this._defaultZoomRate=c}setWheelZoomRate(c){this._wheelZoomRate=c}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(c){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!c&&c.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(c){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(c.ctrlKey||c.metaKey||this.isZooming()||o.isFullscreen()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let h=c.deltaMode===o.window.WheelEvent.DOM_DELTA_LINE?40*c.deltaY:c.deltaY;const _=o.exported.now(),v=_-(this._lastWheelEventTime||0);this._lastWheelEventTime=_,h!==0&&h%rg==0?this._type="wheel":h!==0&&Math.abs(h)<4?this._type="trackpad":v>400?(this._type=null,this._lastValue=h,this._timeout=setTimeout(this._onTimeout,40,c)):this._type||(this._type=Math.abs(v*h)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,h+=this._lastValue)),c.shiftKey&&h&&(h/=4),this._type&&(this._lastWheelEvent=c,this._delta-=h,this._active||this._start(c)),c.preventDefault()}_onTimeout(c){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(c)}_start(c){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const h=et(this._el,c);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:h,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const c=this._map.transform;this._type==="wheel"&&c.projection.wrap&&(c._center.lng>=180||c._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const h=()=>c._terrainEnabled()&&this._aroundCoord?c.computeZoomRelativeTo(this._aroundCoord):c.zoom;if(this._delta!==0){const z=this._type==="wheel"&&Math.abs(this._delta)>rg?this._wheelZoomRate:this._defaultZoomRate;let F=2/(1+Math.exp(-Math.abs(this._delta*z)));this._delta<0&&F!==0&&(F=1/F);const N=h(),q=Math.pow(2,N),Q=typeof this._targetZoom=="number"?c.zoomScale(this._targetZoom):q;this._targetZoom=Math.min(c.maxZoom,Math.max(c.minZoom,c.scaleZoom(Q*F))),this._type==="wheel"&&(this._startZoom=N,this._easing=this._smoothOutEasing(200)),this._delta=0}const _=typeof this._targetZoom=="number"?this._targetZoom:h(),v=this._startZoom,w=this._easing;let S,I=!1;if(this._type==="wheel"&&v&&w){const z=Math.min((o.exported.now()-this._lastWheelEventTime)/200,1),F=w(z);S=o.number(v,_,F),z<1?this._frameId||(this._frameId=!0):I=!0}else S=_,I=!0;return this._active=!0,I&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!I,zoomDelta:S-h(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(c){let h=o.ease;if(this._prevEase){const _=this._prevEase,v=(o.exported.now()-_.start)/_.duration,w=_.easing(v+.01)-_.easing(v),S=.27/Math.sqrt(w*w+1e-4)*.01,I=Math.sqrt(.0729-S*S);h=o.bezier(S,I,.25,1)}return this._prevEase={start:o.exported.now(),duration:c,easing:h},h}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=P("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(o.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class ig{constructor(c,h){this._clickZoom=c,this._tapZoom=h}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Rc{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(c,h){return c.preventDefault(),{cameraAnimation:_=>{_.easeTo({duration:300,zoom:_.getZoom()+(c.shiftKey?-1:1),around:_.unproject(h)},{originalEvent:c})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ha{constructor(){this._tap=new Oc({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(c,h,_){this._swipePoint||(this._tapTime&&c.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?_.length>0&&(this._swipePoint=h[0],this._swipeTouch=_[0].identifier):this._tap.touchstart(c,h,_))}touchmove(c,h,_){if(this._tapTime){if(this._swipePoint){if(_[0].identifier!==this._swipeTouch)return;const v=h[0],w=v.y-this._swipePoint.y;return this._swipePoint=v,c.preventDefault(),this._active=!0,{zoomDelta:w/128}}}else this._tap.touchmove(c,h,_)}touchend(c,h,_){this._tapTime?this._swipePoint&&_.length===0&&this.reset():this._tap.touchend(c,h,_)&&(this._tapTime=c.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class dh{constructor(c,h,_){this._el=c,this._mousePan=h,this._touchPan=_}enable(c){this._inertiaOptions=c||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class qe{constructor(c,h,_){this._pitchWithRotate=c.pitchWithRotate,this._mouseRotate=h,this._mousePitch=_}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class og{constructor(c,h,_,v){this._el=c,this._touchZoom=h,this._touchRotate=_,this._tapDragZoom=v,this._rotationDisabled=!1,this._enabled=!0}enable(c){this._touchZoom.enable(c),this._rotationDisabled||this._touchRotate.enable(c),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Wu=m=>m.zoom||m.drag||m.pitch||m.rotate;class Zu extends o.Event{}class Xu{constructor(){this.constants=[1,1,.01],this.radius=0}setup(c,h){const _=o.sub([],h,c);this.radius=o.length(_[2]<0?o.div([],_,this.constants):[_[0],_[1],0])}projectRay(c){o.div(c,c,this.constants),o.normalize(c,c),o.mul$1(c,c,this.constants);const h=o.scale$2([],c,this.radius);if(h[2]>0){const _=o.scale$2([],[0,0,1],o.dot(h,[0,0,1])),v=o.scale$2([],o.normalize([],[h[0],h[1],0]),this.radius),w=o.add([],h,o.scale$2([],o.sub([],o.add([],v,_),h),2));h[0]=w[0],h[1]=w[1]}return h}}function Yu(m){return m.panDelta&&m.panDelta.mag()||m.zoomDelta||m.bearingDelta||m.pitchDelta}class ag{constructor(c,h){this._map=c,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new ih(c),this._bearingSnap=h.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Xu,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(h),o.bindAll(["handleEvent","handleWindowEvent"],this);const _=this._el;this._listeners=[[_,"touchstart",{passive:!0}],[_,"touchmove",{passive:!1}],[_,"touchend",void 0],[_,"touchcancel",void 0],[_,"mousedown",void 0],[_,"mousemove",void 0],[_,"mouseup",void 0],[o.window.document,"mousemove",{capture:!0}],[o.window.document,"mouseup",void 0],[_,"mouseover",void 0],[_,"mouseout",void 0],[_,"dblclick",void 0],[_,"click",void 0],[_,"keydown",{capture:!1}],[_,"keyup",void 0],[_,"wheel",{passive:!1}],[_,"contextmenu",void 0],[o.window,"blur",void 0]];for(const[v,w,S]of this._listeners)v.addEventListener(w,v===o.window.document?this.handleWindowEvent:this.handleEvent,S)}destroy(){for(const[c,h,_]of this._listeners)c.removeEventListener(h,c===o.window.document?this.handleWindowEvent:this.handleEvent,_)}_addDefaultHandlers(c){const h=this._map,_=h.getCanvasContainer();this._add("mapEvent",new Xm(h,c));const v=h.boxZoom=new Af(h,c);this._add("boxZoom",v);const w=new If,S=new Rc;h.doubleClickZoom=new ig(S,w),this._add("tapZoom",w),this._add("clickZoom",S);const I=new Ha;this._add("tapDragZoom",I);const z=h.touchPitch=new uo(h);this._add("touchPitch",z);const F=new Pf(c),N=new Lf(c);h.dragRotate=new qe(c,F,N),this._add("mouseRotate",F,["mousePitch"]),this._add("mousePitch",N,["mouseRotate"]);const q=new Jm(c),Q=new Dc(h,c);h.dragPan=new dh(_,q,Q),this._add("mousePan",q),this._add("touchPan",Q,["touchZoom","touchRotate"]);const it=new eg,rt=new tg;h.touchZoomRotate=new og(_,rt,it,I),this._add("touchRotate",it,["touchPan","touchZoom"]),this._add("touchZoom",rt,["touchPan","touchRotate"]),this._add("blockableMapEvent",new ah(h));const ot=h.scrollZoom=new Cs(h,this);this._add("scrollZoom",ot,["mousePan"]);const at=h.keyboard=new ng;this._add("keyboard",at);for(const K of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])c.interactive&&c[K]&&h[K].enable(c[K])}_add(c,h,_){this._handlers.push({handlerName:c,handler:h,allowed:_}),this._handlersById[c]=h}stop(c){if(!this._updatingCamera){for(const{handler:h}of this._handlers)h.reset();this._inertia.clear(),this._fireEvents({},{},c),this._changes=[]}}isActive(){for(const{handler:c}of this._handlers)if(c.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Wu(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(c,h,_){for(const v in c)if(v!==_&&(!h||h.indexOf(v)<0))return!0;return!1}handleWindowEvent(c){this.handleEvent(c,`${c.type}Window`)}_getMapTouches(c){const h=[];for(const _ of c)this._el.contains(_.target)&&h.push(_);return h}handleEvent(c,h){this._updatingCamera=!0;const _=c.type==="renderFrame",v=_?void 0:c,w={needsRenderFrame:!1},S={},I={},z=c.touches?this._getMapTouches(c.touches):void 0,F=z?Pt(this._el,z):_?void 0:et(this._el,c);for(const{handlerName:Q,handler:it,allowed:rt}of this._handlers){if(!it.isEnabled())continue;let ot;this._blockedByActive(I,rt,Q)?it.reset():it[h||c.type]&&(ot=it[h||c.type](c,F,z),this.mergeHandlerResult(w,S,ot,Q,v),ot&&ot.needsRenderFrame&&this._triggerRenderFrame()),(ot||it.isActive())&&(I[Q]=it)}const N={};for(const Q in this._previousActiveHandlers)I[Q]||(N[Q]=v);this._previousActiveHandlers=I,(Object.keys(N).length||Yu(w))&&(this._changes.push([w,S,N]),this._triggerRenderFrame()),(Object.keys(I).length||Yu(w))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:q}=w;q&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],q(this._map))}mergeHandlerResult(c,h,_,v,w){if(!_)return;o.extend(c,_);const S={handlerName:v,originalEvent:_.originalEvent||w};_.zoomDelta!==void 0&&(h.zoom=S),_.panDelta!==void 0&&(h.drag=S),_.pitchDelta!==void 0&&(h.pitch=S),_.bearingDelta!==void 0&&(h.rotate=S)}_applyChanges(){const c={},h={},_={};for(const[v,w,S]of this._changes)v.panDelta&&(c.panDelta=(c.panDelta||new o.pointGeometry(0,0))._add(v.panDelta)),v.zoomDelta&&(c.zoomDelta=(c.zoomDelta||0)+v.zoomDelta),v.bearingDelta&&(c.bearingDelta=(c.bearingDelta||0)+v.bearingDelta),v.pitchDelta&&(c.pitchDelta=(c.pitchDelta||0)+v.pitchDelta),v.around!==void 0&&(c.around=v.around),v.aroundCoord!==void 0&&(c.aroundCoord=v.aroundCoord),v.pinchAround!==void 0&&(c.pinchAround=v.pinchAround),v.noInertia&&(c.noInertia=v.noInertia),o.extend(h,w),o.extend(_,S);this._updateMapTransform(c,h,_),this._changes=[]}_updateMapTransform(c,h,_){const v=this._map,w=v.transform,S=ht=>[ht.x,ht.y,ht.z];if((ht=>{const ut=this._eventsInProgress.drag;return ut&&!this._handlersById[ut.handlerName].isActive()})()&&!Yu(c)){const ht=w.zoom;w.cameraElevationReference="sea",w.recenterOnTerrain(),w.cameraElevationReference="ground",ht!==w.zoom&&this._map._update(!0)}if(w._isCameraConstrained&&v._stop(!0),!Yu(c))return void this._fireEvents(h,_,!0);let{panDelta:I,zoomDelta:z,bearingDelta:F,pitchDelta:N,around:q,aroundCoord:Q,pinchAround:it}=c;w._isCameraConstrained&&(z>0&&(z=0),w._isCameraConstrained=!1),it!==void 0&&(q=it),(z||(ht=>h.drag&&!this._eventsInProgress.drag)())&&q&&(this._dragOrigin=S(w.pointCoordinate3D(q)),this._trackingEllipsoid.setup(w._camera.position,this._dragOrigin)),w.cameraElevationReference="sea",v._stop(!0),q=q||v.transform.centerPoint,F&&(w.bearing+=F),N&&(w.pitch+=N),w._updateCameraState();const rt=[0,0,0];if(I)if(w.projection.name==="mercator"){const ht=this._trackingEllipsoid.projectRay(w.screenPointToMercatorRay(q).dir),ut=this._trackingEllipsoid.projectRay(w.screenPointToMercatorRay(q.sub(I)).dir);rt[0]=ut[0]-ht[0],rt[1]=ut[1]-ht[1]}else{const ht=w.pointCoordinate(q);if(w.projection.name==="globe"){I=I.rotate(-w.angle);const ut=w._pixelsPerMercatorPixel/w.worldSize;rt[0]=-I.x*o.mercatorScale(o.latFromMercatorY(ht.y))*ut,rt[1]=-I.y*o.mercatorScale(w.center.lat)*ut}else{const ut=w.pointCoordinate(q.sub(I));ht&&ut&&(rt[0]=ut.x-ht.x,rt[1]=ut.y-ht.y)}}const ot=w.zoom,at=[0,0,0];if(z){const ht=S(Q||w.pointCoordinate3D(q)),ut={dir:o.normalize([],o.sub([],ht,w._camera.position))};if(ut.dir[2]<0){const mt=w.zoomDeltaToMovement(ht,z);o.scale$2(at,ut.dir,mt)}}const K=o.add(rt,rt,at);w._translateCameraConstrained(K),z&&Math.abs(w.zoom-ot)>1e-4&&w.recenterOnTerrain(),w.cameraElevationReference="ground",this._map._update(),c.noInertia||this._inertia.record(c),this._fireEvents(h,_,!0)}_fireEvents(c,h,_){const v=Wu(this._eventsInProgress),w=Wu(c),S={};for(const N in c){const{originalEvent:q}=c[N];this._eventsInProgress[N]||(S[`${N}start`]=q),this._eventsInProgress[N]=c[N]}!v&&w&&this._fireEvent("movestart",w.originalEvent);for(const N in S)this._fireEvent(N,S[N]);w&&this._fireEvent("move",w.originalEvent);for(const N in c){const{originalEvent:q}=c[N];this._fireEvent(N,q)}const I={};let z;for(const N in this._eventsInProgress){const{handlerName:q,originalEvent:Q}=this._eventsInProgress[N];this._handlersById[q].isActive()||(delete this._eventsInProgress[N],z=h[q]||Q,I[`${N}end`]=z)}for(const N in I)this._fireEvent(N,I[N]);const F=Wu(this._eventsInProgress);if(_&&(v||w)&&!F){this._updatingCamera=!0;const N=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),q=Q=>Q!==0&&-this._bearingSnap<Q&&Q<this._bearingSnap;N?(q(N.bearing||this._map.getBearing())&&(N.bearing=0),this._map.easeTo(N,{originalEvent:z})):(this._map.fire(new o.Event("moveend",{originalEvent:z})),q(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(c,h){this._map.fire(new o.Event(c,h?{originalEvent:h}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(c=>{this._frameId=void 0,this.handleEvent(new Zu("renderFrame",{timeStamp:c})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Of="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class sg extends o.Evented{constructor(c,h){super(),this._moving=!1,this._zooming=!1,this.transform=c,this._bearingSnap=h.bearingSnap,o.bindAll(["_renderFrameCallback"],this)}getCenter(){return new o.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(c,h){return this.jumpTo({center:c},h)}panBy(c,h,_){return c=o.pointGeometry.convert(c).mult(-1),this.panTo(this.transform.center,o.extend({offset:c},h),_)}panTo(c,h,_){return this.easeTo(o.extend({center:c},h),_)}getZoom(){return this.transform.zoom}setZoom(c,h){return this.jumpTo({zoom:c},h),this}zoomTo(c,h,_){return this.easeTo(o.extend({zoom:c},h),_)}zoomIn(c,h){return this.zoomTo(this.getZoom()+1,c,h),this}zoomOut(c,h){return this.zoomTo(this.getZoom()-1,c,h),this}getBearing(){return this.transform.bearing}setBearing(c,h){return this.jumpTo({bearing:c},h),this}getPadding(){return this.transform.padding}setPadding(c,h){return this.jumpTo({padding:c},h),this}rotateTo(c,h,_){return this.easeTo(o.extend({bearing:c},h),_)}resetNorth(c,h){return this.rotateTo(0,o.extend({duration:1e3},c),h),this}resetNorthPitch(c,h){return this.easeTo(o.extend({bearing:0,pitch:0,duration:1e3},c),h),this}snapToNorth(c,h){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(c,h):this}getPitch(){return this.transform.pitch}setPitch(c,h){return this.jumpTo({pitch:c},h),this}cameraForBounds(c,h){c=o.LngLatBounds.convert(c);const _=h&&h.bearing||0,v=h&&h.pitch||0,w=c.getNorthWest(),S=c.getSouthEast();return this._cameraForBounds(this.transform,w,S,_,v,h)}_extendCameraOptions(c){const h={top:0,bottom:0,right:0,left:0};if(typeof(c=o.extend({padding:h,offset:[0,0],maxZoom:this.transform.maxZoom},c)).padding=="number"){const _=c.padding;c.padding={top:_,bottom:_,right:_,left:_}}return c.padding=o.extend(h,c.padding),c}_minimumAABBFrustumDistance(c,h){const _=h.max[0]-h.min[0],v=h.max[1]-h.min[1];return _/v>c.aspect?_/(2*Math.tan(.5*c.fovX)*c.aspect):v/(2*Math.tan(.5*c.fovY)*c.aspect)}_cameraForBoundsOnGlobe(c,h,_,v,w,S){const I=c.clone(),z=this._extendCameraOptions(S);I.bearing=v,I.pitch=w;const F=o.LngLat.convert(h),N=o.LngLat.convert(_),q=.5*(F.lat+N.lat),Q=.5*(F.lng+N.lng),it=o.latLngToECEF(q,Q),rt=o.normalize([],it),ot=o.normalize([],o.cross([],rt,[0,1,0])),at=o.cross([],ot,rt),K=[ot[0],ot[1],ot[2],0,at[0],at[1],at[2],0,rt[0],rt[1],rt[2],0,0,0,0,1],ht=[it,o.latLngToECEF(F.lat,F.lng),o.latLngToECEF(N.lat,F.lng),o.latLngToECEF(N.lat,N.lng),o.latLngToECEF(F.lat,N.lng),o.latLngToECEF(q,F.lng),o.latLngToECEF(q,N.lng),o.latLngToECEF(F.lat,Q),o.latLngToECEF(N.lat,Q)];let ut=o.Aabb.fromPoints(ht.map(ie=>[o.dot(ot,ie),o.dot(at,ie),o.dot(rt,ie)]));const mt=o.transformMat4([],ut.center,K);o.squaredLength(mt)===0&&o.set(mt,0,0,1),o.normalize(mt,mt),o.scale$2(mt,mt,o.GLOBE_RADIUS),I.center=o.ecefToLatLng(mt);const Tt=I.getWorldToCameraMatrix(),wt=o.invert(new Float64Array(16),Tt);ut=o.Aabb.applyTransform(ut,o.multiply([],Tt,K)),o.transformMat4(mt,mt,Tt);const Mt=.5*(ut.max[2]-ut.min[2]),Ft=this._minimumAABBFrustumDistance(I,ut),Vt=o.scale$2([],[0,0,1],Mt),Ht=o.add(Vt,mt,Vt),ke=Ft+(I.pitch===0?0:o.distance(mt,Ht)),Nt=I.globeCenterInViewSpace,ne=o.sub([],mt,[Nt[0],Nt[1],Nt[2]]);o.normalize(ne,ne),o.scale$2(ne,ne,ke);const Xt=o.add([],mt,ne);o.transformMat4(Xt,Xt,wt);const ue=o.earthRadius/o.GLOBE_RADIUS,Gt=o.length(Xt),Ot=o.mercatorZfromAltitude(Math.max(Gt*ue-o.earthRadius,Number.EPSILON),0),Wt=Math.min(I.zoomFromMercatorZAdjusted(Ot),z.maxZoom);return Wt>.5*(o.GLOBE_ZOOM_THRESHOLD_MIN+o.GLOBE_ZOOM_THRESHOLD_MAX)?(I.setProjection({name:"mercator"}),I.zoom=Wt,this._cameraForBounds(I,h,_,v,w,S)):{center:I.center,zoom:Wt,bearing:v,pitch:w}}queryTerrainElevation(c,h){const _=this.transform.elevation;return _?(h=o.extend({},{exaggerated:!0},h),_.getAtPoint(o.MercatorCoordinate.fromLngLat(c),null,h.exaggerated)):null}_cameraForBounds(c,h,_,v,w,S){if(c.projection.name==="globe")return this._cameraForBoundsOnGlobe(c,h,_,v,w,S);const I=c.clone(),z=this._extendCameraOptions(S),F=I.padding;I.bearing=v,I.pitch=w;const N=o.LngLat.convert(h),q=o.LngLat.convert(_),Q=new o.LngLat(N.lng,q.lat),it=new o.LngLat(q.lng,N.lat),rt=I.project(N),ot=I.project(q),at=this.queryTerrainElevation(N),K=this.queryTerrainElevation(q),ht=this.queryTerrainElevation(Q),ut=this.queryTerrainElevation(it),mt=[[rt.x,rt.y,Math.min(at||0,K||0,ht||0,ut||0)],[ot.x,ot.y,Math.max(at||0,K||0,ht||0,ut||0)]];let Tt=o.Aabb.fromPoints(mt);const wt=I.getWorldToCameraMatrix(),Mt=o.invert(new Float64Array(16),wt);Tt=o.Aabb.applyTransform(Tt,wt);const Ft=o.sub([],Tt.max,Tt.min),Vt=F.left||0,Ht=F.right||0,ke=F.bottom||0,Nt=F.top||0,{left:ne,right:Xt,top:ue,bottom:Gt}=z.padding,Ot=.5*(Vt+Ht),Wt=.5*(Nt+ke),ie=Math.min(I.scaleZoom(I.scale*Math.min((I.width-(Vt+Ht+ne+Xt))/Ft[0],(I.height-(ke+Nt+Gt+ue))/Ft[1])),z.maxZoom),pe=I.scale/I.zoomScale(ie);Tt=new o.Aabb([Tt.min[0]-(ne+Ot)*pe,Tt.min[1]-(Gt+Wt)*pe,Tt.min[2]],[Tt.max[0]+(Xt+Ot)*pe,Tt.max[1]+(ue+Wt)*pe,Tt.max[2]]);const Je=.5*Ft[2],Pn=this._minimumAABBFrustumDistance(I,Tt),We=[0,0,1,0];o.transformMat4$1(We,We,wt),o.normalize$2(We,We);const je=o.scale$2([],We,Pn+Je),nn=o.add([],Tt.center,je),Nn=(typeof z.offset.x=="number"&&typeof z.offset.y=="number"?new o.pointGeometry(z.offset.x,z.offset.y):o.pointGeometry.convert(z.offset)).rotate(-o.degToRad(v));Tt.center[0]-=Nn.x*pe,Tt.center[1]+=Nn.y*pe,o.transformMat4(Tt.center,Tt.center,Mt),o.transformMat4(nn,nn,Mt);const sn=[Tt.center[0],Tt.center[1],nn[2]*I.pixelsPerMeter];o.scale$2(sn,sn,1/I.worldSize);const ar=o.lngFromMercatorX(sn[0]),yr=o.latFromMercatorY(sn[1]),Mr=Math.min(I._zoomFromMercatorZ(sn[2]),z.maxZoom),wr=new o.LngLat(ar,yr);return I.mercatorFromTransition&&Mr<.5*(o.GLOBE_ZOOM_THRESHOLD_MIN+o.GLOBE_ZOOM_THRESHOLD_MAX)?(I.setProjection({name:"globe"}),I.zoom=Mr,this._cameraForBounds(I,h,_,v,w,S)):{center:wr,zoom:Mr,bearing:v,pitch:w}}fitBounds(c,h,_){const v=this.cameraForBounds(c,h);return this._fitInternal(v,h,_)}fitScreenCoordinates(c,h,_,v,w){const S=o.pointGeometry.convert(c),I=o.pointGeometry.convert(h),z=new o.pointGeometry(Math.min(S.x,I.x),Math.min(S.y,I.y)),F=new o.pointGeometry(Math.max(S.x,I.x),Math.max(S.y,I.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(S,I))return this;const N=this.transform.pointLocation3D(z),q=this.transform.pointLocation3D(F),Q=this.transform.pointLocation3D(new o.pointGeometry(z.x,F.y)),it=this.transform.pointLocation3D(new o.pointGeometry(F.x,z.y)),rt=[Math.min(N.lng,q.lng,Q.lng,it.lng),Math.min(N.lat,q.lat,Q.lat,it.lat)],ot=[Math.max(N.lng,q.lng,Q.lng,it.lng),Math.max(N.lat,q.lat,Q.lat,it.lat)],at=v&&v.pitch?v.pitch:this.getPitch(),K=this._cameraForBounds(this.transform,rt,ot,_,at,v);return this._fitInternal(K,v,w)}_fitInternal(c,h,_){return c?(delete(h=o.extend(c,h)).padding,h.linear?this.easeTo(h,_):this.flyTo(h,_)):this}jumpTo(c,h){this.stop();const _=c.preloadOnly?this.transform.clone():this.transform;let v=!1,w=!1,S=!1;return"zoom"in c&&_.zoom!==+c.zoom&&(v=!0,_.zoom=+c.zoom),c.center!==void 0&&(_.center=o.LngLat.convert(c.center)),"bearing"in c&&_.bearing!==+c.bearing&&(w=!0,_.bearing=+c.bearing),"pitch"in c&&_.pitch!==+c.pitch&&(S=!0,_.pitch=+c.pitch),c.padding==null||_.isPaddingEqual(c.padding)||(_.padding=c.padding),c.preloadOnly?(this._preloadTiles(_),this):(this.fire(new o.Event("movestart",h)).fire(new o.Event("move",h)),v&&this.fire(new o.Event("zoomstart",h)).fire(new o.Event("zoom",h)).fire(new o.Event("zoomend",h)),w&&this.fire(new o.Event("rotatestart",h)).fire(new o.Event("rotate",h)).fire(new o.Event("rotateend",h)),S&&this.fire(new o.Event("pitchstart",h)).fire(new o.Event("pitch",h)).fire(new o.Event("pitchend",h)),this.fire(new o.Event("moveend",h)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||o.warnOnce(Of),this.transform.getFreeCameraOptions()}setFreeCameraOptions(c,h){const _=this.transform;if(!_.projection.supportsFreeCamera)return o.warnOnce(Of),this;this.stop();const v=_.zoom,w=_.pitch,S=_.bearing;_.setFreeCameraOptions(c);const I=v!==_.zoom,z=w!==_.pitch,F=S!==_.bearing;return this.fire(new o.Event("movestart",h)).fire(new o.Event("move",h)),I&&this.fire(new o.Event("zoomstart",h)).fire(new o.Event("zoom",h)).fire(new o.Event("zoomend",h)),F&&this.fire(new o.Event("rotatestart",h)).fire(new o.Event("rotate",h)).fire(new o.Event("rotateend",h)),z&&this.fire(new o.Event("pitchstart",h)).fire(new o.Event("pitch",h)).fire(new o.Event("pitchend",h)),this.fire(new o.Event("moveend",h)),this}easeTo(c,h){this._stop(!1,c.easeId),((c=o.extend({offset:[0,0],duration:500,easing:o.ease},c)).animate===!1||!c.essential&&o.exported.prefersReducedMotion)&&(c.duration=0);const _=this.transform,v=this.getZoom(),w=this.getBearing(),S=this.getPitch(),I=this.getPadding(),z="zoom"in c?+c.zoom:v,F="bearing"in c?this._normalizeBearing(c.bearing,w):w,N="pitch"in c?+c.pitch:S,q="padding"in c?c.padding:_.padding,Q=o.pointGeometry.convert(c.offset);let it,rt,ot;if(_.projection.name==="globe"){const Vt=o.MercatorCoordinate.fromLngLat(_.center),Ht=Q.rotate(-_.angle);Vt.x+=Ht.x/_.worldSize,Vt.y+=Ht.y/_.worldSize;const ke=Vt.toLngLat(),Nt=o.LngLat.convert(c.center||ke);this._normalizeCenter(Nt),it=_.centerPoint.add(Ht),rt=new o.pointGeometry(Vt.x,Vt.y).mult(_.worldSize),ot=new o.pointGeometry(o.mercatorXfromLng(Nt.lng),o.mercatorYfromLat(Nt.lat)).mult(_.worldSize).sub(rt)}else{it=_.centerPoint.add(Q);const Vt=_.pointLocation(it),Ht=o.LngLat.convert(c.center||Vt);this._normalizeCenter(Ht),rt=_.project(Vt),ot=_.project(Ht).sub(rt)}const at=_.zoomScale(z-v);let K,ht;c.around&&(K=o.LngLat.convert(c.around),ht=_.locationPoint(K));const ut=this._zooming||z!==v,mt=this._rotating||w!==F,Tt=this._pitching||N!==S,wt=!_.isPaddingEqual(q),Mt=Vt=>Ht=>{if(ut&&(Vt.zoom=o.number(v,z,Ht)),mt&&(Vt.bearing=o.number(w,F,Ht)),Tt&&(Vt.pitch=o.number(S,N,Ht)),wt&&(Vt.interpolatePadding(I,q,Ht),it=Vt.centerPoint.add(Q)),K)Vt.setLocationAtPoint(K,ht);else{const ke=Vt.zoomScale(Vt.zoom-v),Nt=z>v?Math.min(2,at):Math.max(.5,at),ne=Math.pow(Nt,1-Ht),Xt=Vt.unproject(rt.add(ot.mult(Ht*ne)).mult(ke));Vt.setLocationAtPoint(Vt.renderWorldCopies?Xt.wrap():Xt,it)}return c.preloadOnly||this._fireMoveEvents(h),Vt};if(c.preloadOnly){const Vt=this._emulate(Mt,c.duration,_);return this._preloadTiles(Vt),this}const Ft={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=ut,this._rotating=mt,this._pitching=Tt,this._padding=wt,this._easeId=c.easeId,this._prepareEase(h,c.noMoveStart,Ft),this._ease(Mt(_),Vt=>{_.recenterOnTerrain(),this._afterEase(h,Vt)},c),this}_prepareEase(c,h,_={}){this._moving=!0,this.transform.cameraElevationReference="sea",h||_.moving||this.fire(new o.Event("movestart",c)),this._zooming&&!_.zooming&&this.fire(new o.Event("zoomstart",c)),this._rotating&&!_.rotating&&this.fire(new o.Event("rotatestart",c)),this._pitching&&!_.pitching&&this.fire(new o.Event("pitchstart",c))}_fireMoveEvents(c){this.fire(new o.Event("move",c)),this._zooming&&this.fire(new o.Event("zoom",c)),this._rotating&&this.fire(new o.Event("rotate",c)),this._pitching&&this.fire(new o.Event("pitch",c))}_afterEase(c,h){if(this._easeId&&h&&this._easeId===h)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const _=this._zooming,v=this._rotating,w=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,_&&this.fire(new o.Event("zoomend",c)),v&&this.fire(new o.Event("rotateend",c)),w&&this.fire(new o.Event("pitchend",c)),this.fire(new o.Event("moveend",c))}flyTo(c,h){if(!c.essential&&o.exported.prefersReducedMotion){const ie=o.pick(c,["center","zoom","bearing","pitch","around"]);return this.jumpTo(ie,h)}this.stop(),c=o.extend({offset:[0,0],speed:1.2,curve:1.42,easing:o.ease},c);const _=this.transform,v=this.getZoom(),w=this.getBearing(),S=this.getPitch(),I=this.getPadding(),z="zoom"in c?o.clamp(+c.zoom,_.minZoom,_.maxZoom):v,F="bearing"in c?this._normalizeBearing(c.bearing,w):w,N="pitch"in c?+c.pitch:S,q="padding"in c?c.padding:_.padding,Q=_.zoomScale(z-v),it=o.pointGeometry.convert(c.offset);let rt=_.centerPoint.add(it);const ot=_.pointLocation(rt),at=o.LngLat.convert(c.center||ot);this._normalizeCenter(at);const K=_.project(ot),ht=_.project(at).sub(K);let ut=c.curve;const mt=Math.max(_.width,_.height),Tt=mt/Q,wt=ht.mag();if("minZoom"in c){const ie=o.clamp(Math.min(c.minZoom,v,z),_.minZoom,_.maxZoom),pe=mt/_.zoomScale(ie-v);ut=Math.sqrt(pe/wt*2)}const Mt=ut*ut;function Ft(ie){const pe=(Tt*Tt-mt*mt+(ie?-1:1)*Mt*Mt*wt*wt)/(2*(ie?Tt:mt)*Mt*wt);return Math.log(Math.sqrt(pe*pe+1)-pe)}function Vt(ie){return(Math.exp(ie)-Math.exp(-ie))/2}function Ht(ie){return(Math.exp(ie)+Math.exp(-ie))/2}const ke=Ft(0);let Nt=function(ie){return Ht(ke)/Ht(ke+ut*ie)},ne=function(ie){return mt*((Ht(ke)*(Vt(pe=ke+ut*ie)/Ht(pe))-Vt(ke))/Mt)/wt;var pe},Xt=(Ft(1)-ke)/ut;if(Math.abs(wt)<1e-6||!isFinite(Xt)){if(Math.abs(mt-Tt)<1e-6)return this.easeTo(c,h);const ie=Tt<mt?-1:1;Xt=Math.abs(Math.log(Tt/mt))/ut,ne=function(){return 0},Nt=function(pe){return Math.exp(ie*ut*pe)}}c.duration="duration"in c?+c.duration:1e3*Xt/("screenSpeed"in c?+c.screenSpeed/ut:+c.speed),c.maxDuration&&c.duration>c.maxDuration&&(c.duration=0);const ue=w!==F,Gt=N!==S,Ot=!_.isPaddingEqual(q),Wt=ie=>pe=>{const Je=pe*Xt,Pn=1/Nt(Je);ie.zoom=pe===1?z:v+ie.scaleZoom(Pn),ue&&(ie.bearing=o.number(w,F,pe)),Gt&&(ie.pitch=o.number(S,N,pe)),Ot&&(ie.interpolatePadding(I,q,pe),rt=ie.centerPoint.add(it));const We=pe===1?at:ie.unproject(K.add(ht.mult(ne(Je))).mult(Pn));return ie.setLocationAtPoint(ie.renderWorldCopies?We.wrap():We,rt),ie._updateCameraOnTerrain(),c.preloadOnly||this._fireMoveEvents(h),ie};if(c.preloadOnly){const ie=this._emulate(Wt,c.duration,_);return this._preloadTiles(ie),this}return this._zooming=!0,this._rotating=ue,this._pitching=Gt,this._padding=Ot,this._prepareEase(h,!1),this._ease(Wt(_),()=>this._afterEase(h),c),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(c,h){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const _=this._onEaseEnd;this._onEaseEnd=void 0,_.call(this,h)}if(!c){const _=this.handlers;_&&_.stop(!1)}return this}_ease(c,h,_){_.animate===!1||_.duration===0?(c(1),h()):(this._easeStart=o.exported.now(),this._easeOptions=_,this._onEaseFrame=c,this._onEaseEnd=h,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const c=Math.min((o.exported.now()-this._easeStart)/this._easeOptions.duration,1),h=this._onEaseFrame;h&&h(this._easeOptions.easing(c)),c<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(c,h){c=o.wrap(c,-180,180);const _=Math.abs(c-h);return Math.abs(c-360-h)<_&&(c-=360),Math.abs(c+360-h)<_&&(c+=360),c}_normalizeCenter(c){const h=this.transform;if(!h.renderWorldCopies||h.maxBounds)return;const _=c.lng-h.center.lng;c.lng+=_>180?-360:_<-180?360:0}_emulate(c,h,_){const v=Math.ceil(15*h/1e3),w=[],S=c(_.clone());for(let I=0;I<=v;I++){const z=S(I/v);w.push(z.clone())}return w}}class Df{constructor(c={}){this.options=c,o.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(c){const h=this.options&&this.options.compact;return this._map=c,this._container=P("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=P("button","mapboxgl-ctrl-attrib-button",this._container),P("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=P("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),h&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),h===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(c,h){const _=this._map._getUIString(`AttributionControl.${h}`);c.setAttribute("aria-label",_),c.removeAttribute("title"),c.firstElementChild&&c.firstElementChild.setAttribute("title",_)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let c=this._editLink;c||(c=this._editLink=this._container.querySelector(".mapbox-improve-map"));const h=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||o.config.ACCESS_TOKEN}];if(c){const _=h.reduce((v,w,S)=>(w.value&&(v+=`${w.key}=${w.value}${S<h.length-1?"&":""}`),v),"?");c.href=`${o.config.FEEDBACK_URL}/${_}#${Sf(this._map,!0)}`,c.rel="noopener nofollow",this._setElementTitle(c,"MapFeedback")}}_updateData(c){!c||c.sourceDataType!=="metadata"&&c.sourceDataType!=="visibility"&&c.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let c=[];if(this._map.style.stylesheet){const v=this._map.style.stylesheet;this.styleOwner=v.owner,this.styleId=v.id}const h=this._map.style._sourceCaches;for(const v in h){const w=h[v];if(w.used){const S=w.getSource();S.attribution&&c.indexOf(S.attribution)<0&&c.push(S.attribution)}}c.sort((v,w)=>v.length-w.length),c=c.filter((v,w)=>{for(let S=w+1;S<c.length;S++)if(c[S].indexOf(v)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?c=[...this.options.customAttribution,...c]:c.unshift(this.options.customAttribution));const _=c.join(" | ");_!==this._attribHTML&&(this._attribHTML=_,c.length?(this._innerContainer.innerHTML=_,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Rf{constructor(){o.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(c){this._map=c,this._container=P("div","mapboxgl-ctrl");const h=P("a","mapboxgl-ctrl-logo");return h.target="_blank",h.rel="noopener nofollow",h.href="https://www.mapbox.com/",h.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),h.setAttribute("rel","noopener nofollow"),this._container.appendChild(h),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(c){c&&c.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const c=this._map.style._sourceCaches;if(Object.entries(c).length===0)return!0;for(const h in c){const _=c[h].getSource();if(_.hasOwnProperty("mapbox_logo")&&!_.mapbox_logo)return!1}return!0}_updateCompact(){const c=this._container.children;if(c.length){const h=c[0];this._map.getCanvasContainer().offsetWidth<250?h.classList.add("mapboxgl-compact"):h.classList.remove("mapboxgl-compact")}}}class Ku{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(c){const h=++this._id;return this._queue.push({callback:c,id:h,cancelled:!1}),h}remove(c){const h=this._currentlyRunning,_=h?this._queue.concat(h):this._queue;for(const v of _)if(v.id===c)return void(v.cancelled=!0)}run(c=0){const h=this._currentlyRunning=this._queue;this._queue=[];for(const _ of h)if(!_.cancelled&&(_.callback(c),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function hh(m,c,h){if(m=new o.LngLat(m.lng,m.lat),c){const _=new o.LngLat(m.lng-360,m.lat),v=new o.LngLat(m.lng+360,m.lat),w=360*Math.ceil(Math.abs(m.lng-h.center.lng)/360),S=h.locationPoint(m).distSqr(c),I=c.x<0||c.y<0||c.x>h.width||c.y>h.height;h.locationPoint(_).distSqr(c)<S&&(I||Math.abs(_.lng-h.center.lng)<w)?m=_:h.locationPoint(v).distSqr(c)<S&&(I||Math.abs(v.lng-h.center.lng)<w)&&(m=v)}for(;Math.abs(m.lng-h.center.lng)>180;){const _=h.locationPoint(m);if(_.x>=0&&_.y>=0&&_.x<=h.width&&_.y<=h.height)break;m.lng>h.center.lng?m.lng-=360:m.lng+=360}return m}const Bc={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class fh extends o.Evented{constructor(c,h){if(super(),(c instanceof o.window.HTMLElement||h)&&(c=o.extend({element:c},h)),o.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=c&&c.anchor||"center",this._color=c&&c.color||"#3FB1CE",this._scale=c&&c.scale||1,this._draggable=c&&c.draggable||!1,this._clickTolerance=c&&c.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=c&&c.rotation||0,this._rotationAlignment=c&&c.rotationAlignment||"auto",this._pitchAlignment=c&&c.pitchAlignment&&c.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=c&&c.occludedOpacity||.2,c&&c.element)this._element=c.element,this._offset=o.pointGeometry.convert(c&&c.offset||[0,0]);else{this._defaultMarker=!0,this._element=P("div");const v=41,w=27,S=B("svg",{display:"block",height:v*this._scale+"px",width:w*this._scale+"px",viewBox:`0 0 ${w} ${v}`},this._element),I=B("radialGradient",{id:"shadowGradient"},B("defs",{},S));B("stop",{offset:"10%","stop-opacity":.4},I),B("stop",{offset:"100%","stop-opacity":.05},I),B("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},S),B("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},S),B("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},S),B("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},S),this._offset=o.pointGeometry.convert(c&&c.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",v=>{v.preventDefault()}),this._element.addEventListener("mousedown",v=>{v.preventDefault()});const _=this._element.classList;for(const v in Bc)_.remove(`mapboxgl-marker-anchor-${v}`);_.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(c){return c===this._map||(this.remove(),this._map=c,c.getCanvasContainer().appendChild(this._element),c.on("move",this._updateMoving),c.on("moveend",this._update),c.on("remove",this._clearFadeTimer),c._addMarker(this),this.setDraggable(this._draggable),this._update(),c.on("click",this._onMapClick)),this}remove(){const c=this._map;return c&&(c.off("click",this._onMapClick),c.off("move",this._updateMoving),c.off("moveend",this._update),c.off("mousedown",this._addDragHandler),c.off("touchstart",this._addDragHandler),c.off("mouseup",this._onUp),c.off("touchend",this._onUp),c.off("mousemove",this._onMove),c.off("touchmove",this._onMove),c.off("remove",this._clearFadeTimer),c._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(c){return this._lngLat=o.LngLat.convert(c),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(c){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),c){if(!("offset"in c.options)){const v=Math.sqrt(Math.pow(13.5,2)/2);c.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[v,-1*(38.1-13.5+v)],"bottom-right":[-v,-1*(38.1-13.5+v)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=c,c._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(c){const h=c.code,_=c.charCode||c.keyCode;h!=="Space"&&h!=="Enter"&&_!==32&&_!==13||this.togglePopup()}_onMapClick(c){const h=c.originalEvent.target,_=this._element;this._popup&&(h===_||_.contains(h))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const c=this._popup;return c?(c.isOpen()?(c.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(c.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const c=this._map,h=this._pos;if(!c||!h)return!1;const _=c.unproject(h),v=c.getFreeCameraOptions();if(!v.position)return!1;const w=v.position.toLngLat();return w.distanceTo(_)<.9*w.distanceTo(this._lngLat)}_evaluateOpacity(){const c=this._map;if(!c)return;const h=this._pos;if(!h||h.x<0||h.x>c.transform.width||h.y<0||h.y>c.transform.height)return void this._clearFadeTimer();const _=c.unproject(h);let v;c._showingGlobe()&&o.isLngLatBehindGlobe(c.transform,this._lngLat)?v=0:(v=1-c._queryFogOpacity(_),c.transform._terrainEnabled()&&c.getTerrain()&&this._behindTerrain()&&(v*=this._occludedOpacity)),this._element.style.opacity=`${v}`,this._element.style.pointerEvents=v>0?"auto":"none",this._popup&&this._popup._setOpacity(v),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const c=this._pos;if(!c||!this._map)return;const h=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${c.x}px,${c.y}px)
            ${Bc[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${h.x}px,${h.y}px)
        `}_calculateXYTransform(){const c=this._pos,h=this._map,_=this.getPitchAlignment();if(!h||!c||_!=="map")return"";if(!h._showingGlobe()){const z=h.getPitch();return z?`rotateX(${z}deg)`:""}const v=o.radToDeg(o.globeTiltAtLngLat(h.transform,this._lngLat)),w=c.sub(o.globeCenterToScreenPoint(h.transform)),S=Math.abs(w.x)+Math.abs(w.y);if(S===0)return"";const I=v/S;return`rotateX(${-w.y*I}deg) rotateY(${w.x*I}deg)`}_calculateZTransform(){const c=this._pos,h=this._map;if(!h||!c)return"";let _=0;const v=this.getRotationAlignment();if(v==="map")if(h._showingGlobe()){const w=h.project(new o.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),S=h.project(new o.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(w);_=o.radToDeg(Math.atan2(S.y,S.x))-90}else _=-h.getBearing();else if(v==="horizon"){const w=o.smoothstep(4,6,h.getZoom()),S=o.globeCenterToScreenPoint(h.transform);S.y+=w*h.transform.height;const I=c.sub(S),z=o.radToDeg(Math.atan2(I.y,I.x));_=(z>90?z-270:z+90)*(1-w)}return _+=this._rotation,_?`rotateZ(${_}deg)`:""}_update(c){o.window.cancelAnimationFrame(this._updateFrameId);const h=this._map;h&&(h.transform.renderWorldCopies&&(this._lngLat=hh(this._lngLat,this._pos,h.transform)),this._pos=h.project(this._lngLat),c===!0?this._updateFrameId=o.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),h._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(h._showingGlobe()||h.getTerrain()||h.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(c){return this._offset=o.pointGeometry.convert(c),this._update(),this}_onMove(c){const h=this._map;if(!h)return;const _=this._pointerdownPos,v=this._positionDelta;if(_&&v){if(!this._isDragging){const w=this._clickTolerance||h._clickTolerance;if(c.point.dist(_)<w)return;this._isDragging=!0}this._pos=c.point.sub(v),this._lngLat=h.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.Event("dragstart"))),this.fire(new o.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const c=this._map;c&&(c.off("mousemove",this._onMove),c.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new o.Event("dragend")),this._state="inactive"}_addDragHandler(c){const h=this._map,_=this._pos;h&&_&&this._element.contains(c.originalEvent.target)&&(c.preventDefault(),this._positionDelta=c.point.sub(_),this._pointerdownPos=c.point,this._state="pending",h.on("mousemove",this._onMove),h.on("touchmove",this._onMove),h.once("mouseup",this._onUp),h.once("touchend",this._onUp))}setDraggable(c){this._draggable=!!c;const h=this._map;return h&&(c?(h.on("mousedown",this._addDragHandler),h.on("touchstart",this._addDragHandler)):(h.off("mousedown",this._addDragHandler),h.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(c){return this._rotation=c||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(c){return this._rotationAlignment=c||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(c){return this._pitchAlignment=c||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(c){return this._occludedOpacity=c||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const lg={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},cg=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Bf(m=new o.pointGeometry(0,0),c="bottom"){if(typeof m=="number"){const h=Math.round(Math.sqrt(.5*Math.pow(m,2)));switch(c){case"top":return new o.pointGeometry(0,m);case"top-left":return new o.pointGeometry(h,h);case"top-right":return new o.pointGeometry(-h,h);case"bottom":return new o.pointGeometry(0,-m);case"bottom-left":return new o.pointGeometry(h,-h);case"bottom-right":return new o.pointGeometry(-h,-h);case"left":return new o.pointGeometry(m,0);case"right":return new o.pointGeometry(-m,0)}return new o.pointGeometry(0,0)}return m instanceof o.pointGeometry||Array.isArray(m)?o.pointGeometry.convert(m):o.pointGeometry.convert(m[c]||[0,0])}class ug{constructor(c){this.jumpTo(c)}getValue(c){if(c<=this._startTime)return this._start;if(c>=this._endTime)return this._end;const h=o.easeCubicInOut((c-this._startTime)/(this._endTime-this._startTime));return this._start*(1-h)+this._end*h}isEasing(c){return c>=this._startTime&&c<=this._endTime}jumpTo(c){this._startTime=-1/0,this._endTime=-1/0,this._start=c,this._end=c}easeTo(c,h,_){this._start=this.getValue(h),this._end=c,this._startTime=h,this._endTime=h+_}}const dg={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},hg={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},Ff={showCompass:!0,showZoom:!0,visualizePitch:!1};class fg{constructor(c,h,_=!1){this._clickTolerance=10,this.element=h,this.mouseRotate=new Pf({clickTolerance:c.dragRotate._mouseRotate._clickTolerance}),this.map=c,_&&(this.mousePitch=new Lf({clickTolerance:c.dragRotate._mousePitch._clickTolerance})),o.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),h.addEventListener("mousedown",this.mousedown),h.addEventListener("touchstart",this.touchstart,{passive:!1}),h.addEventListener("touchmove",this.touchmove),h.addEventListener("touchend",this.touchend),h.addEventListener("touchcancel",this.reset)}down(c,h){this.mouseRotate.mousedown(c,h),this.mousePitch&&this.mousePitch.mousedown(c,h),H()}move(c,h){const _=this.map,v=this.mouseRotate.mousemoveWindow(c,h),w=v&&v.bearingDelta;if(w&&_.setBearing(_.getBearing()+w),this.mousePitch){const S=this.mousePitch.mousemoveWindow(c,h),I=S&&S.pitchDelta;I&&_.setPitch(_.getPitch()+I)}}off(){const c=this.element;c.removeEventListener("mousedown",this.mousedown),c.removeEventListener("touchstart",this.touchstart,{passive:!1}),c.removeEventListener("touchmove",this.touchmove),c.removeEventListener("touchend",this.touchend),c.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){V(),o.window.removeEventListener("mousemove",this.mousemove),o.window.removeEventListener("mouseup",this.mouseup)}mousedown(c){this.down(o.extend({},c,{ctrlKey:!0,preventDefault:()=>c.preventDefault()}),et(this.element,c)),o.window.addEventListener("mousemove",this.mousemove),o.window.addEventListener("mouseup",this.mouseup)}mousemove(c){this.move(c,et(this.element,c))}mouseup(c){this.mouseRotate.mouseupWindow(c),this.mousePitch&&this.mousePitch.mouseupWindow(c),this.offTemp()}touchstart(c){c.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=Pt(this.element,c.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>c.preventDefault()},this._startPos))}touchmove(c){c.targetTouches.length!==1?this.reset():(this._lastPos=Pt(this.element,c.targetTouches)[0],this.move({preventDefault:()=>c.preventDefault()},this._lastPos))}touchend(c){c.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const pg={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},mg={maxWidth:100,unit:"metric"};function gg(m,c,h){const _=ph(c),v=_/c,w={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"}[h];this._map._requestDomTask(()=>{this._container.style.width=m*v+"px",this._container.innerHTML=`${_}&nbsp;${w}`})}function ph(m){const c=Math.pow(10,`${Math.floor(m)}`.length-1);let h=m/c;return h=h>=10?10:h>=5?5:h>=3?3:h>=2?2:h>=1?1:function(_){const v=Math.pow(10,Math.ceil(-Math.log(_)/Math.LN10));return Math.round(_*v)/v}(h),c*h}const Ju={version:o.version,supported:E,setRTLTextPlugin:o.setRTLTextPlugin,getRTLTextPluginStatus:o.getRTLTextPluginStatus,Map:class extends sg{constructor(m){if(o.LivePerformanceUtils.mark(o.PerformanceMarkers.create),(m=o.extend({},hg,m)).minZoom!=null&&m.maxZoom!=null&&m.minZoom>m.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(m.minPitch!=null&&m.maxPitch!=null&&m.minPitch>m.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(m.minPitch!=null&&m.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(m.maxPitch!=null&&m.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(m.antialias&&o.isSafariWithAntialiasingBug(o.window)&&(m.antialias=!1,o.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Ne(m.minZoom,m.maxZoom,m.minPitch,m.maxPitch,m.renderWorldCopies),m),this._interactive=m.interactive,this._minTileCacheSize=m.minTileCacheSize,this._maxTileCacheSize=m.maxTileCacheSize,this._failIfMajorPerformanceCaveat=m.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=m.preserveDrawingBuffer,this._antialias=m.antialias,this._useWebGL2=m.useWebGL2,this._trackResize=m.trackResize,this._bearingSnap=m.bearingSnap,this._refreshExpiredTiles=m.refreshExpiredTiles,this._fadeDuration=m.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=m.crossSourceCollisions,this._collectResourceTiming=m.collectResourceTiming,this._optimizeForTerrain=m.optimizeForTerrain,this._language=this._parseLanguage(m.language),this._worldview=m.worldview,this._renderTaskQueue=new Ku,this._domRenderTaskQueue=new Ku,this._controls=[],this._markers=[],this._popups=[],this._mapId=o.uniqueId(),this._locale=o.extend({},dg,m.locale),this._clickTolerance=m.clickTolerance,this._cooperativeGestures=m.cooperativeGestures,this._performanceMetricsCollection=m.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new ug(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new o.RequestManager(m.transformRequest,m.accessToken,m.testMode),this._silenceAuthErrors=!!m.testMode,typeof m.container=="string"){if(this._container=o.window.document.getElementById(m.container),!this._container)throw new Error(`Container '${m.container}' not found.`)}else{if(!(m.container instanceof o.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=m.container}if(this._container.childNodes.length>0&&o.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),m.maxBounds&&this.setMaxBounds(m.maxBounds),o.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),o.window!==void 0&&(o.window.addEventListener("online",this._onWindowOnline,!1),o.window.addEventListener("resize",this._onWindowResize,!1),o.window.addEventListener("orientationchange",this._onWindowResize,!1),o.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),o.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new ag(this,m),this._localFontFamily=m.localFontFamily,this._localIdeographFontFamily=m.localIdeographFontFamily,m.style&&this.setStyle(m.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),m.projection&&this.setProjection(m.projection),this._hash=m.hash&&new Wm(typeof m.hash=="string"&&m.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:m.center,zoom:m.zoom,bearing:m.bearing,pitch:m.pitch}),m.bounds&&(this.resize(),this.fitBounds(m.bounds,o.extend({},m.fitBoundsOptions,{duration:0})))),this.resize(),m.attributionControl&&this.addControl(new Df({customAttribution:m.customAttribution})),this._logoControl=new Rf,this.addControl(this._logoControl,m.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",c=>{this._update(c.dataType==="style"),this.fire(new o.Event(`${c.dataType}data`,c))}),this.on("dataloading",c=>{this.fire(new o.Event(`${c.dataType}dataloading`,c))})}_getMapId(){return this._mapId}addControl(m,c){if(c===void 0&&(c=m.getDefaultPosition?m.getDefaultPosition():"top-right"),!m||!m.onAdd)return this.fire(new o.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const h=m.onAdd(this);this._controls.push(m);const _=this._controlPositions[c];return c.indexOf("bottom")!==-1?_.insertBefore(h,_.firstChild):_.appendChild(h),this}removeControl(m){if(!m||!m.onRemove)return this.fire(new o.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const c=this._controls.indexOf(m);return c>-1&&this._controls.splice(c,1),m.onRemove(this),this}hasControl(m){return this._controls.indexOf(m)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(m){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const c=!this._moving;return c&&this.fire(new o.Event("movestart",m)).fire(new o.Event("move",m)),this.fire(new o.Event("resize",m)),c&&this.fire(new o.Event("moveend",m)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(m){return this.transform.setMaxBounds(o.LngLatBounds.convert(m)),this._update()}setMinZoom(m){if((m=m==null?-2:m)>=-2&&m<=this.transform.maxZoom)return this.transform.minZoom=m,this._update(),this.getZoom()<m?this.setZoom(m):this.fire(new o.Event("zoomstart")).fire(new o.Event("zoom")).fire(new o.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(m){if((m=m==null?22:m)>=this.transform.minZoom)return this.transform.maxZoom=m,this._update(),this.getZoom()>m?this.setZoom(m):this.fire(new o.Event("zoomstart")).fire(new o.Event("zoom")).fire(new o.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(m){if((m=m==null?0:m)<0)throw new Error("minPitch must be greater than or equal to 0");if(m>=0&&m<=this.transform.maxPitch)return this.transform.minPitch=m,this._update(),this.getPitch()<m?this.setPitch(m):this.fire(new o.Event("pitchstart")).fire(new o.Event("pitch")).fire(new o.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(m){if((m=m==null?85:m)>85)throw new Error("maxPitch must be less than or equal to 85");if(m>=this.transform.minPitch)return this.transform.maxPitch=m,this._update(),this.getPitch()>m?this.setPitch(m):this.fire(new o.Event("pitchstart")).fire(new o.Event("pitch")).fire(new o.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(m){return this.transform.renderWorldCopies=m,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(m){return m==="auto"?o.window.navigator.language:Array.isArray(m)?m.length===0?void 0:m.map(c=>c==="auto"?o.window.navigator.language:c):m}setLanguage(m){const c=this._parseLanguage(m);if(!this.style||c===this._language)return this;this._language=c,this.style._reloadSources();for(const h of this._controls)h._setLanguage&&h._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(m){return this.style&&m!==this._worldview?(this._worldview=m,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(m){return this._lazyInitEmptyStyle(),m?typeof m=="string"&&(m={name:m}):m=null,this._useExplicitProjection=!!m,this._prioritizeAndUpdateProjection(m,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const m=this.transform,c=m.projection.name;let h;c==="globe"&&m.zoom>=o.GLOBE_ZOOM_THRESHOLD_MAX?(m.setMercatorFromTransition(),h=!0):c==="mercator"&&m.zoom<o.GLOBE_ZOOM_THRESHOLD_MAX&&(m.setProjection({name:"globe"}),h=!0),h&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(m,c){return this._updateProjection(m||c||{name:"mercator"})}_updateProjection(m){let c;if(c=m.name==="globe"&&this.transform.zoom>=o.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(m),this.style.applyProjectionUpdate(),c){this.painter.clearBackgroundTiles();for(const h in this.style._sourceCaches)this.style._sourceCaches[h].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(m){return this.transform.locationPoint3D(o.LngLat.convert(m))}unproject(m){return this.transform.pointLocation3D(o.pointGeometry.convert(m))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(m,c,h){if(m==="mouseenter"||m==="mouseover"){let _=!1;const v=S=>{const I=c.filter(F=>this.getLayer(F)),z=I.length?this.queryRenderedFeatures(S.point,{layers:I}):[];z.length?_||(_=!0,h.call(this,new Gi(m,this,S.originalEvent,{features:z}))):_=!1},w=()=>{_=!1};return{layers:new Set(c),listener:h,delegates:{mousemove:v,mouseout:w}}}if(m==="mouseleave"||m==="mouseout"){let _=!1;const v=S=>{const I=c.filter(z=>this.getLayer(z));(I.length?this.queryRenderedFeatures(S.point,{layers:I}):[]).length?_=!0:_&&(_=!1,h.call(this,new Gi(m,this,S.originalEvent)))},w=S=>{_&&(_=!1,h.call(this,new Gi(m,this,S.originalEvent)))};return{layers:new Set(c),listener:h,delegates:{mousemove:v,mouseout:w}}}{const _=v=>{const w=c.filter(I=>this.getLayer(I)),S=w.length?this.queryRenderedFeatures(v.point,{layers:w}):[];S.length&&(v.features=S,h.call(this,v),delete v.features)};return{layers:new Set(c),listener:h,delegates:{[m]:_}}}}on(m,c,h){if(h===void 0)return super.on(m,c);Array.isArray(c)||(c=[c]);const _=this._createDelegatedListener(m,c,h);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[m]=this._delegatedListeners[m]||[],this._delegatedListeners[m].push(_);for(const v in _.delegates)this.on(v,_.delegates[v]);return this}once(m,c,h){if(h===void 0)return super.once(m,c);Array.isArray(c)||(c=[c]);const _=this._createDelegatedListener(m,c,h);for(const v in _.delegates)this.once(v,_.delegates[v]);return this}off(m,c,h){if(h===void 0)return super.off(m,c);c=new Set(Array.isArray(c)?c:[c]);const _=(w,S)=>{if(w.size!==S.size)return!1;for(const I of w)if(!S.has(I))return!1;return!0},v=this._delegatedListeners?this._delegatedListeners[m]:void 0;return v&&(w=>{for(let S=0;S<w.length;S++){const I=w[S];if(I.listener===h&&_(I.layers,c)){for(const z in I.delegates)this.off(z,I.delegates[z]);return w.splice(S,1),this}}})(v),this}queryRenderedFeatures(m,c){return this.style?(c!==void 0||m===void 0||m instanceof o.pointGeometry||Array.isArray(m)||(c=m,m=void 0),this.style.queryRenderedFeatures(m=m||[[0,0],[this.transform.width,this.transform.height]],c=c||{},this.transform)):[]}querySourceFeatures(m,c){return this.style.querySourceFeatures(m,c)}setStyle(m,c){return(c=o.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},c)).diff!==!1&&c.localIdeographFontFamily===this._localIdeographFontFamily&&c.localFontFamily===this._localFontFamily&&this.style&&m?(this._diffStyle(m,c),this):(this._localIdeographFontFamily=c.localIdeographFontFamily,this._localFontFamily=c.localFontFamily,this._updateStyle(m,c))}_getUIString(m){const c=this._locale[m];if(c==null)throw new Error(`Missing UI string '${m}'`);return c}_updateStyle(m,c){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),m&&(this.style=new oi(this,c||{}),this.style.setEventedParent(this,{style:this.style}),typeof m=="string"?this.style.loadURL(m):this.style.loadJSON(m)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new oi(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(m,c){if(typeof m=="string"){const h=this._requestManager.normalizeStyleURL(m),_=this._requestManager.transformRequest(h,o.ResourceType.Style);o.getJSON(_,(v,w)=>{v?this.fire(new o.ErrorEvent(v)):w&&this._updateDiff(w,c)})}else typeof m=="object"&&this._updateDiff(m,c)}_updateDiff(m,c){try{this.style.setState(m)&&this._update(!0)}catch(h){o.warnOnce(`Unable to perform style diff: ${h.message||h.error||h}.  Rebuilding the style from scratch.`),this._updateStyle(m,c)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(o.warnOnce("There is no style added to the map."),!1)}addSource(m,c){return this._lazyInitEmptyStyle(),this.style.addSource(m,c),this._update(!0)}isSourceLoaded(m){return!!this.style&&this.style._isSourceCacheLoaded(m)}areTilesLoaded(){const m=this.style&&this.style._sourceCaches;for(const c in m){const h=m[c]._tiles;for(const _ in h){const v=h[_];if(v.state!=="loaded"&&v.state!=="errored")return!1}}return!0}addSourceType(m,c,h){this._lazyInitEmptyStyle(),this.style.addSourceType(m,c,h)}removeSource(m){return this.style.removeSource(m),this._updateTerrain(),this._update(!0)}getSource(m){return this.style.getSource(m)}addImage(m,c,{pixelRatio:h=1,sdf:_=!1,stretchX:v,stretchY:w,content:S}={}){if(this._lazyInitEmptyStyle(),c instanceof o.window.HTMLImageElement||o.window.ImageBitmap&&c instanceof o.window.ImageBitmap){const{width:I,height:z,data:F}=o.exported.getImageData(c);this.style.addImage(m,{data:new o.RGBAImage({width:I,height:z},F),pixelRatio:h,stretchX:v,stretchY:w,content:S,sdf:_,version:0})}else if(c.width===void 0||c.height===void 0)this.fire(new o.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:I,height:z}=c,F=c;this.style.addImage(m,{data:new o.RGBAImage({width:I,height:z},new Uint8Array(F.data)),pixelRatio:h,stretchX:v,stretchY:w,content:S,sdf:_,version:0,userImage:F}),F.onAdd&&F.onAdd(this,m)}}updateImage(m,c){const h=this.style.getImage(m);if(!h)return void this.fire(new o.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const _=c instanceof o.window.HTMLImageElement||o.window.ImageBitmap&&c instanceof o.window.ImageBitmap?o.exported.getImageData(c):c,{width:v,height:w}=_;v!==void 0&&w!==void 0?v===h.data.width&&w===h.data.height?(h.data.replace(_.data,!(c instanceof o.window.HTMLImageElement||o.window.ImageBitmap&&c instanceof o.window.ImageBitmap)),this.style.updateImage(m,h)):this.fire(new o.ErrorEvent(new Error(`The width and height of the updated image (${v}, ${w})
                must be that same as the previous version of the image
                (${h.data.width}, ${h.data.height})`))):this.fire(new o.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(m){return m?!!this.style.getImage(m):(this.fire(new o.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(m){this.style.removeImage(m)}loadImage(m,c){o.getImage(this._requestManager.transformRequest(m,o.ResourceType.Image),(h,_)=>{c(h,_ instanceof o.window.HTMLImageElement?o.exported.getImageData(_):_)})}listImages(){return this.style.listImages()}addLayer(m,c){return this._lazyInitEmptyStyle(),this.style.addLayer(m,c),this._update(!0)}moveLayer(m,c){return this.style.moveLayer(m,c),this._update(!0)}removeLayer(m){return this.style.removeLayer(m),this._update(!0)}getLayer(m){return this.style.getLayer(m)}setLayerZoomRange(m,c,h){return this.style.setLayerZoomRange(m,c,h),this._update(!0)}setFilter(m,c,h={}){return this.style.setFilter(m,c,h),this._update(!0)}getFilter(m){return this.style.getFilter(m)}setPaintProperty(m,c,h,_={}){return this.style.setPaintProperty(m,c,h,_),this._update(!0)}getPaintProperty(m,c){return this.style.getPaintProperty(m,c)}setLayoutProperty(m,c,h,_={}){return this.style.setLayoutProperty(m,c,h,_),this._update(!0)}getLayoutProperty(m,c){return this.style.getLayoutProperty(m,c)}setLight(m,c={}){return this._lazyInitEmptyStyle(),this.style.setLight(m,c),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(m){return this._lazyInitEmptyStyle(),!m&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(m),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(m){return this._lazyInitEmptyStyle(),this.style.setFog(m),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(m){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(o.LngLat.convert(m),this.transform):0}setFeatureState(m,c){return this.style.setFeatureState(m,c),this._update()}removeFeatureState(m,c){return this.style.removeFeatureState(m,c),this._update()}getFeatureState(m){return this.style.getFeatureState(m)}_updateContainerDimensions(){if(!this._container)return;const m=this._container.getBoundingClientRect().width||400,c=this._container.getBoundingClientRect().height||300;let h,_,v,w=this._container;for(;w&&(!_||!v);){const S=o.window.getComputedStyle(w).transform;S&&S!=="none"&&(h=S.match(/matrix.*\((.+)\)/)[1].split(", "),h[0]&&h[0]!=="0"&&h[0]!=="1"&&(_=h[0]),h[3]&&h[3]!=="0"&&h[3]!=="1"&&(v=h[3])),w=w.parentElement}this._containerWidth=_?Math.abs(m/_):m,this._containerHeight=v?Math.abs(c/v):c}_detectMissingCSS(){o.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&o.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const m=this._container;m.classList.add("mapboxgl-map"),(this._missingCSSCanary=P("div","mapboxgl-canary",m)).style.visibility="hidden",this._detectMissingCSS();const c=this._canvasContainer=P("div","mapboxgl-canvas-container",m);this._interactive&&c.classList.add("mapboxgl-interactive"),this._canvas=P("canvas","mapboxgl-canvas",c),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const h=this._controlContainer=P("div","mapboxgl-control-container",m),_=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(v=>{_[v]=P("div",`mapboxgl-ctrl-${v}`,h)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(m,c){const h=o.exported.devicePixelRatio||1;this._canvas.width=h*Math.ceil(m),this._canvas.height=h*Math.ceil(c),this._canvas.style.width=`${m}px`,this._canvas.style.height=`${c}px`}_addMarker(m){this._markers.push(m)}_removeMarker(m){const c=this._markers.indexOf(m);c!==-1&&this._markers.splice(c,1)}_addPopup(m){this._popups.push(m)}_removePopup(m){const c=this._popups.indexOf(m);c!==-1&&this._popups.splice(c,1)}_setupPainter(){const m=o.extend({},E.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),c=this._useWebGL2&&this._canvas.getContext("webgl2",m),h=c||this._canvas.getContext("webgl",m)||this._canvas.getContext("experimental-webgl",m);h?(this._useWebGL2&&!c&&o.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),o.storeAuthState(h,!0),this.painter=new Ts(h,this.transform,!!c),this.on("data",_=>{_.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),o.exported$1.testSupport(h)):this.fire(new o.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(m){m.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new o.Event("webglcontextlost",{originalEvent:m}))}_contextRestored(m){this._setupPainter(),this.resize(),this._update(),this.fire(new o.Event("webglcontextrestored",{originalEvent:m}))}_onMapScroll(m){if(m.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(m){return this.style?(this._styleDirty=this._styleDirty||m,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(m){return this._update(),this._renderTaskQueue.add(m)}_cancelRenderFrame(m){this._renderTaskQueue.remove(m)}_requestDomTask(m){!this.loaded()||this.loaded()&&!this.isMoving()?m():this._domRenderTaskQueue.add(m)}_render(m){let c;const h=this.painter.context.extTimerQuery,_=o.exported.now();if(this.listens("gpu-timing-frame")&&(c=h.createQueryEXT(),h.beginQueryEXT(h.TIME_ELAPSED_EXT,c)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],o.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],o.window.performance.now())),this._renderTaskQueue.run(m),this._domRenderTaskQueue.run(m),this._removed)return;this._updateProjectionTransition();const v=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const I=this.transform.zoom,z=this.transform.pitch,F=o.exported.now(),N=new o.EvaluationParameters(I,{now:F,fadeDuration:v,pitch:z,transition:this.style.getTransition()});this.style.update(N)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let w=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),w=this._updateAverageElevation(_),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):w=this._updateAverageElevation(_),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,v,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:v,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new o.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new o.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),c){const I=o.exported.now()-_;h.endQueryEXT(h.TIME_ELAPSED_EXT,c),setTimeout(()=>{const z=h.getQueryObjectEXT(c,h.QUERY_RESULT_EXT)/1e6;h.deleteQueryEXT(c),this.fire(new o.Event("gpu-timing-frame",{cpuTime:I,gpuTime:z})),o.window.performance.mark("frame-gpu",{startTime:_,detail:{gpuTime:z}})},50)}if(this.listens("gpu-timing-layer")){const I=this.painter.collectGpuTimers();setTimeout(()=>{const z=this.painter.queryGpuTimers(I);this.fire(new o.Event("gpu-timing-layer",{layerTimes:z}))},50)}if(this.listens("gpu-timing-deferred-render")){const I=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const z=this.painter.queryGpuTimeDeferredRender(I);this.fire(new o.Event("gpu-timing-deferred-render",{gpuTime:z}))},50)}const S=this._sourcesDirty||this._styleDirty||this._placementDirty||w;if(S||this._repaint)this.triggerRepaint();else{const I=!this.isMoving()&&this.loaded();if(I&&(w=this._updateAverageElevation(_,!0)),w)this.triggerRepaint();else if(this._triggerFrame(!1),I&&(this.fire(new o.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const z=this._calculateSpeedIndex();this.fire(new o.Event("speedindexcompleted",{speedIndex:z})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||S||(this._fullyLoaded=!0,o.LivePerformanceUtils.mark(o.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&o.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(m){for(const c of this._markers)m&&!this.getRenderWorldCopies()&&(c._lngLat=c._lngLat.wrap()),c._update();for(const c of this._popups)!m||this.getRenderWorldCopies()||c._trackPointer||(c._lngLat=c._lngLat.wrap()),c._update()}_updateAverageElevation(m,c=!1){const h=_=>(this.transform.averageElevation=_,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&h(0);if((c||m-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(m)){const _=this.transform.averageElevation;let v=this.transform.sampleAverageElevation(),w=!1;this.transform.elevation&&(w=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(v)?v=0:this._averageElevationLastSampledAt=m;const S=Math.abs(_-v);if(S>1){if(this._isInitialLoad||w)return this._averageElevation.jumpTo(v),h(v);this._averageElevation.easeTo(v,m,300)}else if(S>1e-4)return this._averageElevation.jumpTo(v),h(v)}return!!this._averageElevation.isEasing(m)&&h(this._averageElevation.getValue(m))}_authenticate(){o.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,m=>{if(m&&(m.message===o.AUTH_ERR_MSG||m.status===401)){const c=this.painter.context.gl;o.storeAuthState(c,!1),this._logoControl instanceof Rf&&this._logoControl._updateLogo(),c&&c.clear(c.DEPTH_BUFFER_BIT|c.COLOR_BUFFER_BIT|c.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new o.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),o.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const m=this._isDragging();this.painter.updateTerrain(this.style,m)}_calculateSpeedIndex(){const m=this.painter.canvasCopy(),c=this.painter.getCanvasCopiesAndTimestamps();c.timeStamps.push(performance.now());const h=this.painter.context.gl,_=h.createFramebuffer();function v(w){h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,w,0);const S=new Uint8Array(h.drawingBufferWidth*h.drawingBufferHeight*4);return h.readPixels(0,0,h.drawingBufferWidth,h.drawingBufferHeight,h.RGBA,h.UNSIGNED_BYTE,S),S}return h.bindFramebuffer(h.FRAMEBUFFER,_),this._canvasPixelComparison(v(m),c.canvasCopies.map(v),c.timeStamps)}_canvasPixelComparison(m,c,h){let _=h[1]-h[0];const v=m.length/4;for(let w=0;w<c.length;w++){const S=c[w];let I=0;for(let z=0;z<S.length;z+=4)S[z]===m[z]&&S[z+1]===m[z+1]&&S[z+2]===m[z+2]&&S[z+3]===m[z+3]&&(I+=1);_+=(h[w+2]-h[w+1])*(1-I/v)}return _}remove(){this._hash&&this._hash.remove();for(const c of this._controls)c.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),o.window!==void 0&&(o.window.removeEventListener("resize",this._onWindowResize,!1),o.window.removeEventListener("orientationchange",this._onWindowResize,!1),o.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),o.window.removeEventListener("online",this._onWindowOnline,!1),o.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const m=this.painter.context.gl.getExtension("WEBGL_lose_context");m&&m.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),o.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new o.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(m){this._renderNextFrame=this._renderNextFrame||m,this.style&&!this._frame&&(this._frame=o.exported.frame(c=>{const h=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,h&&this._render(c)}))}_preloadTiles(m){const c=this.style?Object.values(this.style._sourceCaches):[];return o.asyncAll(c,(h,_)=>h._preloadTiles(m,_),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(m){this._trackResize&&this.resize({originalEvent:m})._update()}_onVisibilityChange(){o.window.document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(m){this._showTileBoundaries!==m&&(this._showTileBoundaries=m,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(m){this._showTerrainWireframe!==m&&(this._showTerrainWireframe=m,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(m){this._speedIndexTiming!==m&&(this._speedIndexTiming=m,this._update())}get showPadding(){return!!this._showPadding}set showPadding(m){this._showPadding!==m&&(this._showPadding=m,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(m){this._showCollisionBoxes!==m&&(this._showCollisionBoxes=m,m?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(m){this._showOverdrawInspector!==m&&(this._showOverdrawInspector=m,this._update())}get repaint(){return!!this._repaint}set repaint(m){this._repaint!==m&&(this._repaint=m,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(m){this._vertices=m,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(m){this._showTileAABBs!==m&&(this._showTileAABBs=m,m&&this._update())}_setCacheLimits(m,c){o.setCacheLimits(m,c)}get version(){return o.version}},NavigationControl:class{constructor(m){this.options=o.extend({},Ff,m),this._container=P("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",c=>c.preventDefault()),this.options.showZoom&&(o.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",c=>{this._map&&this._map.zoomIn({},{originalEvent:c})}),P("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",c=>{this._map&&this._map.zoomOut({},{originalEvent:c})}),P("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(o.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",c=>{const h=this._map;h&&(this.options.visualizePitch?h.resetNorthPitch({},{originalEvent:c}):h.resetNorth({},{originalEvent:c}))}),this._compassIcon=P("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const m=this._map;if(!m)return;const c=m.getZoom(),h=c===m.getMaxZoom(),_=c===m.getMinZoom();this._zoomInButton.disabled=h,this._zoomOutButton.disabled=_,this._zoomInButton.setAttribute("aria-disabled",h.toString()),this._zoomOutButton.setAttribute("aria-disabled",_.toString())}_rotateCompassArrow(){const m=this._map;if(!m)return;const c=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(m.transform.pitch*(Math.PI/180)),.5)}) rotateX(${m.transform.pitch}deg) rotateZ(${m.transform.angle*(180/Math.PI)}deg)`:`rotate(${m.transform.angle*(180/Math.PI)}deg)`;m._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=c)})}onAdd(m){return this._map=m,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),m.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&m.on("pitch",this._rotateCompassArrow),m.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new fg(m,this._compass,this.options.visualizePitch)),this._container}onRemove(){const m=this._map;m&&(this._container.remove(),this.options.showZoom&&m.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&m.off("pitch",this._rotateCompassArrow),m.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(m,c){const h=P("button",m,this._container);return h.type="button",h.addEventListener("click",c),h}_setButtonTitle(m,c){if(!this._map)return;const h=this._map._getUIString(`NavigationControl.${c}`);m.setAttribute("aria-label",h),m.firstElementChild&&m.firstElementChild.setAttribute("title",h)}},GeolocateControl:class extends o.Evented{constructor(m){super(),this.options=o.extend({geolocation:o.window.navigator.geolocation},pg,m),o.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=ca(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(m){return this._map=m,this._container=P("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(m){const c=(h=!!this.options.geolocation)=>{this._supportsGeolocation=h,m(h)};this._supportsGeolocation!==void 0?m(this._supportsGeolocation):o.window.navigator.permissions!==void 0?o.window.navigator.permissions.query({name:"geolocation"}).then(h=>c(h.state!=="denied")).catch(()=>c()):c()}_isOutOfMapMaxBounds(m){const c=this._map.getMaxBounds(),h=m.coords;return!!c&&(h.longitude<c.getWest()||h.longitude>c.getEast()||h.latitude<c.getSouth()||h.latitude>c.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(m){if(this._map){if(this._isOutOfMapMaxBounds(m))return this._setErrorState(),this.fire(new o.Event("outofmaxbounds",m)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=m,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(m),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(m),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new o.Event("geolocate",m)),this._finish()}}_updateCamera(m){const c=new o.LngLat(m.coords.longitude,m.coords.latitude),h=m.coords.accuracy,_=this._map.getBearing(),v=o.extend({bearing:_},this.options.fitBoundsOptions);this._map.fitBounds(c.toBounds(h),v,{geolocateSource:!0})}_updateMarker(m){if(m){const c=new o.LngLat(m.coords.longitude,m.coords.latitude);this._accuracyCircleMarker.setLngLat(c).addTo(this._map),this._userLocationDotMarker.setLngLat(c).addTo(this._map),this._accuracy=m.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const m=this._map.transform,c=o.mercatorZfromAltitude(1,m._center.lat)*m.worldSize,h=Math.ceil(2*this._accuracy*c);this._circleElement.style.width=`${h}px`,this._circleElement.style.height=`${h}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(m){if(this._map){if(this.options.trackUserLocation)if(m.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const c=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",c),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",c),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(m.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new o.Event("error",m)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(m){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",c=>c.preventDefault()),this._geolocateButton=P("button","mapboxgl-ctrl-geolocate",this._container),P("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",m===!1){o.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const c=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",c),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",c)}else{const c=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",c),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",c)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=P("div","mapboxgl-user-location"),this._dotElement.appendChild(P("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(P("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new fh({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=P("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new fh({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",c=>{c.geolocateSource||this._watchState!=="ACTIVE_LOCK"||c.originalEvent&&c.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new o.Event("trackuserlocationend")))})}}_onDeviceOrientation(m){this._userLocationDotMarker&&(m.webkitCompassHeading?this._heading=m.webkitCompassHeading:m.absolute===!0&&(this._heading=-1*m.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return o.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new o.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let m;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(m={maximumAge:6e5,timeout:0},this._noTimeout=!0):(m=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,m),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const m=()=>{o.window.addEventListener("ondeviceorientationabsolute"in o.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};o.window.DeviceMotionEvent!==void 0&&typeof o.window.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(c=>{c==="granted"&&m()}).catch(console.error):m()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),o.window.removeEventListener("deviceorientation",this._onDeviceOrientation),o.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Df,ScaleControl:class{constructor(m){this.options=o.extend({},mg,m),function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"narrow",unit:"meter"}),!0}catch{return!1}}()||(this._setScale=gg.bind(this)),o.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const m=this.options.maxWidth||100,c=this._map,h=c._containerHeight/2,_=c._containerWidth/2-m/2,v=c.unproject([_,h]),w=c.unproject([_+m,h]),S=v.distanceTo(w);if(this.options.unit==="imperial"){const I=3.2808*S;I>5280?this._setScale(m,I/5280,"mile"):this._setScale(m,I,"foot")}else this.options.unit==="nautical"?this._setScale(m,S/1852,"nautical-mile"):S>=1e3?this._setScale(m,S/1e3,"kilometer"):this._setScale(m,S,"meter")}_setScale(m,c,h){const _=ph(c),v=_/c;this._map._requestDomTask(()=>{this._container.style.width=m*v+"px",this._container.innerHTML=h!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"narrow",unit:h}).format(_):`${_}&nbsp;nm`})}onAdd(m){return this._map=m,this._language=m.getLanguage(),this._container=P("div","mapboxgl-ctrl mapboxgl-ctrl-scale",m.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(m){this._language=m,this._update()}setUnit(m){this.options.unit=m,this._update()}},FullscreenControl:class{constructor(m){this._fullscreen=!1,m&&m.container&&(m.container instanceof o.window.HTMLElement?this._container=m.container:o.warnOnce("Full screen control 'container' must be a DOM element.")),o.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in o.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in o.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(m){return this._map=m,this._container||(this._container=this._map.getContainer()),this._controlContainer=P("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",o.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,o.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!o.window.document.fullscreenEnabled&&!o.window.document.webkitFullscreenEnabled)}_setupUI(){const m=this._fullscreenButton=P("button","mapboxgl-ctrl-fullscreen",this._controlContainer);P("span","mapboxgl-ctrl-icon",m).setAttribute("aria-hidden","true"),m.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),o.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const m=this._getTitle();this._fullscreenButton.setAttribute("aria-label",m),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",m)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(o.window.document.fullscreenElement||o.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?o.window.document.exitFullscreen?o.window.document.exitFullscreen():o.window.document.webkitCancelFullScreen&&o.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends o.Evented{constructor(m){super(),this.options=o.extend(Object.create(lg),m),o.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(m&&m.className?m.className.trim().split(/\s+/):[])}addTo(m){return this._map&&this.remove(),this._map=m,this.options.closeOnClick&&m.on("preclick",this._onClose),this.options.closeOnMove&&m.on("move",this._onClose),m.on("remove",this.remove),this._update(),m._addPopup(this),this._focusFirstElement(),this._trackPointer?(m.on("mousemove",this._onMouseEvent),m.on("mouseup",this._onMouseEvent),m._canvasContainer.classList.add("mapboxgl-track-pointer")):m.on("move",this._update),this.fire(new o.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const m=this._map;return m&&(m.off("move",this._update),m.off("move",this._onClose),m.off("preclick",this._onClose),m.off("click",this._onClose),m.off("remove",this.remove),m.off("mousemove",this._onMouseEvent),m.off("mouseup",this._onMouseEvent),m.off("drag",this._onMouseEvent),m._canvasContainer&&m._canvasContainer.classList.remove("mapboxgl-track-pointer"),m._removePopup(this),this._map=void 0),this.fire(new o.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(m){this._lngLat=o.LngLat.convert(m),this._pos=null,this._trackPointer=!1,this._update();const c=this._map;return c&&(c.on("move",this._update),c.off("mousemove",this._onMouseEvent),c._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const m=this._map;return m&&(m.off("move",this._update),m.on("mousemove",this._onMouseEvent),m.on("drag",this._onMouseEvent),m._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(m){return this.setDOMContent(o.window.document.createTextNode(m))}setHTML(m){const c=o.window.document.createDocumentFragment(),h=o.window.document.createElement("body");let _;for(h.innerHTML=m;_=h.firstChild,_;)c.appendChild(_);return this.setDOMContent(c)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(m){return this.options.maxWidth=m,this._update(),this}setDOMContent(m){let c=this._content;if(c)for(;c.hasChildNodes();)c.firstChild&&c.removeChild(c.firstChild);else c=this._content=P("div","mapboxgl-popup-content",this._container||void 0);if(c.appendChild(m),this.options.closeButton){const h=this._closeButton=P("button","mapboxgl-popup-close-button",c);h.type="button",h.setAttribute("aria-label","Close popup"),h.setAttribute("aria-hidden","true"),h.innerHTML="&#215;",h.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(m){return this._classList.add(m),this._updateClassList(),this}removeClassName(m){return this._classList.delete(m),this._updateClassList(),this}setOffset(m){return this.options.offset=m,this._update(),this}toggleClassName(m){let c;return this._classList.delete(m)?c=!1:(this._classList.add(m),c=!0),this._updateClassList(),c}_onMouseEvent(m){this._update(m.point)}_getAnchor(m){if(this.options.anchor)return this.options.anchor;const c=this._map,h=this._container,_=this._pos;if(!c||!h||!_)return"bottom";const v=h.offsetWidth,w=h.offsetHeight,S=_.x<v/2,I=_.x>c.transform.width-v/2;if(_.y+m<w)return S?"top-left":I?"top-right":"top";if(_.y>c.transform.height-w){if(S)return"bottom-left";if(I)return"bottom-right"}return S?"left":I?"right":"bottom"}_updateClassList(){const m=this._container;if(!m)return;const c=[...this._classList];c.push("mapboxgl-popup"),this._anchor&&c.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&c.push("mapboxgl-popup-track-pointer"),m.className=c.join(" ")}_update(m){const c=this._map,h=this._content;if(!c||!this._lngLat&&!this._trackPointer||!h)return;let _=this._container;if(_||(_=this._container=P("div","mapboxgl-popup",c.getContainer()),this._tip=P("div","mapboxgl-popup-tip",_),_.appendChild(h)),this.options.maxWidth&&_.style.maxWidth!==this.options.maxWidth&&(_.style.maxWidth=this.options.maxWidth),c.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=hh(this._lngLat,this._pos,c.transform)),!this._trackPointer||m){const v=this._pos=this._trackPointer&&m?m:c.project(this._lngLat),w=Bf(this.options.offset),S=this._anchor=this._getAnchor(w.y),I=Bf(this.options.offset,S),z=v.add(I).round();c._requestDomTask(()=>{this._container&&S&&(this._container.style.transform=`${Bc[S]} translate(${z.x}px,${z.y}px)`)})}if(!this._marker&&c._showingGlobe()){const v=o.isLngLatBehindGlobe(c.transform,this._lngLat)?0:1;this._setOpacity(v)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const m=this._container.querySelector(cg);m&&m.focus()}_onClose(){this.remove()}_setOpacity(m){this._container&&(this._container.style.opacity=`${m}`),this._content&&(this._content.style.pointerEvents=m?"auto":"none")}},Marker:fh,Style:oi,LngLat:o.LngLat,LngLatBounds:o.LngLatBounds,Point:o.pointGeometry,MercatorCoordinate:o.MercatorCoordinate,FreeCameraOptions:ks,Evented:o.Evented,config:o.config,prewarm:function(){dn().acquire(rn)},clearPrewarmedResources:function(){const m=en;m&&(m.isPreloaded()&&m.numActive()===1?(m.release(rn),en=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return o.config.ACCESS_TOKEN},set accessToken(m){o.config.ACCESS_TOKEN=m},get baseApiUrl(){return o.config.API_URL},set baseApiUrl(m){o.config.API_URL=m},get workerCount(){return tn.workerCount},set workerCount(m){tn.workerCount=m},get maxParallelImageRequests(){return o.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(m){o.config.MAX_PARALLEL_IMAGE_REQUESTS=m},clearStorage(m){o.clearTileCache(m)},workerUrl:"",workerClass:null,setNow:o.exported.setNow,restoreNow:o.exported.restoreNow};return Ju});var f=l;return f})})(gy);var xl=gy.exports,wf=HZ,qZ=Object.prototype.hasOwnProperty;function HZ(){for(var t={},e=0;e<arguments.length;e++){var n=arguments[e];for(var i in n)qZ.call(n,i)&&(t[i]=n[i])}return t}var TM={exports:{}};(function(t,e){(function(){var n={};t.exports=n,n.simpleFilter=function(i,l){return l.filter(function(d){return n.test(i,d)})},n.test=function(i,l){return n.match(i,l)!==null},n.match=function(i,l,d){d=d||{};var f=0,o=[],y=l.length,E=0,C=0,A=d.pre||"",P=d.post||"",B=d.caseSensitive&&l||l.toLowerCase(),j;i=d.caseSensitive&&i||i.toLowerCase();for(var Z=0;Z<y;Z++)j=l[Z],B[Z]===i[f]?(j=A+j+P,f+=1,C+=1+C):C=0,E+=C,o[o.length]=j;return f===i.length?(E=B===i?1/0:E,{rendered:o.join(""),score:E}):null},n.filter=function(i,l,d){return!l||l.length===0?[]:typeof i!="string"?l:(d=d||{},l.reduce(function(f,o,y,E){var C=o;d.extract&&(C=d.extract(o));var A=n.match(i,C,d);return A!=null&&(f[f.length]={string:A.rendered,score:A.score,index:y,original:o}),f},[]).sort(function(f,o){var y=o.score-f.score;return y||f.index-o.index}))}})()})(TM);var va=function(t){return this.component=t,this.items=[],this.active=0,this.wrapper=document.createElement("div"),this.wrapper.className="suggestions-wrapper",this.element=document.createElement("ul"),this.element.className="suggestions",this.wrapper.appendChild(this.element),this.selectingListItem=!1,t.el.parentNode.insertBefore(this.wrapper,t.el.nextSibling),this};va.prototype.show=function(){this.element.style.display="block"};va.prototype.hide=function(){this.element.style.display="none"};va.prototype.add=function(t){this.items.push(t)};va.prototype.clear=function(){this.items=[],this.active=0};va.prototype.isEmpty=function(){return!this.items.length};va.prototype.isVisible=function(){return this.element.style.display==="block"};va.prototype.draw=function(){if(this.element.innerHTML="",this.items.length===0){this.hide();return}for(var t=0;t<this.items.length;t++)this.drawItem(this.items[t],this.active===t);this.show()};va.prototype.drawItem=function(t,e){var n=document.createElement("li"),i=document.createElement("a");e&&(n.className+=" active"),i.innerHTML=t.string,n.appendChild(i),this.element.appendChild(n),n.addEventListener("mousedown",function(){this.selectingListItem=!0}.bind(this)),n.addEventListener("mouseup",function(){this.handleMouseUp.call(this,t)}.bind(this))};va.prototype.handleMouseUp=function(t){this.selectingListItem=!1,this.component.value(t.original),this.clear(),this.draw()};va.prototype.move=function(t){this.active=t,this.draw()};va.prototype.previous=function(){this.move(this.active===0?this.items.length-1:this.active-1)};va.prototype.next=function(){this.move(this.active===this.items.length-1?0:this.active+1)};va.prototype.drawError=function(t){var e=document.createElement("li");e.innerHTML=t,this.element.appendChild(e),this.show()};var WZ=va,ZZ=wf,XZ=TM.exports,YZ=WZ,Ho=function(t,e,n){return n=n||{},this.options=ZZ({minLength:2,limit:5,filter:!0,hideOnBlur:!0},n),this.el=t,this.data=e||[],this.list=new YZ(this),this.query="",this.selected=null,this.list.draw(),this.el.addEventListener("keyup",function(i){this.handleKeyUp(i.keyCode)}.bind(this),!1),this.el.addEventListener("keydown",function(i){this.handleKeyDown(i)}.bind(this)),this.el.addEventListener("focus",function(){this.handleFocus()}.bind(this)),this.el.addEventListener("blur",function(){this.handleBlur()}.bind(this)),this.el.addEventListener("paste",function(i){this.handlePaste(i)}.bind(this)),this.render=this.options.render?this.options.render.bind(this):this.render.bind(this),this.getItemValue=this.options.getItemValue?this.options.getItemValue.bind(this):this.getItemValue.bind(this),this};Ho.prototype.handleKeyUp=function(t){t===40||t===38||t===27||t===13||t===9||this.handleInputChange(this.el.value)};Ho.prototype.handleKeyDown=function(t){switch(t.keyCode){case 13:case 9:this.list.isEmpty()||(this.list.isVisible()&&t.preventDefault(),this.value(this.list.items[this.list.active].original),this.list.hide());break;case 27:this.list.isEmpty()||this.list.hide();break;case 38:this.list.previous();break;case 40:this.list.next();break}};Ho.prototype.handleBlur=function(){!this.list.selectingListItem&&this.options.hideOnBlur&&this.list.hide()};Ho.prototype.handlePaste=function(t){if(t.clipboardData)this.handleInputChange(t.clipboardData.getData("Text"));else{var e=this;setTimeout(function(){e.handleInputChange(t.target.value)},100)}};Ho.prototype.handleInputChange=function(t){if(this.query=this.normalize(t),this.list.clear(),this.query.length<this.options.minLength){this.list.draw();return}this.getCandidates(function(e){for(var n=0;n<e.length&&(this.list.add(e[n]),n!==this.options.limit-1);n++);this.list.draw()}.bind(this))};Ho.prototype.handleFocus=function(){this.list.isEmpty()||this.list.show(),this.list.selectingListItem=!1};Ho.prototype.update=function(t){this.data=t,this.handleKeyUp()};Ho.prototype.clear=function(){this.data=[],this.list.clear()};Ho.prototype.normalize=function(t){return t=t.toLowerCase(),t};Ho.prototype.match=function(t,e){return t.indexOf(e)>-1};Ho.prototype.value=function(t){if(this.selected=t,this.el.value=this.getItemValue(t),document.createEvent){var e=document.createEvent("HTMLEvents");e.initEvent("change",!0,!1),this.el.dispatchEvent(e)}else this.el.fireEvent("onchange")};Ho.prototype.getCandidates=function(t){var e={pre:"<strong>",post:"</strong>",extract:function(i){return this.getItemValue(i)}.bind(this)},n;this.options.filter?(n=XZ.filter(this.query,this.data,e),n=n.map(function(i){return{original:i.original,string:this.render(i.original,i.string)}}.bind(this))):n=this.data.map(function(i){var l=this.render(i);return{original:i,string:l}}.bind(this)),t(n)};Ho.prototype.getItemValue=function(t){return t};Ho.prototype.render=function(t,e){if(e)return e;for(var n=t.original?this.getItemValue(t.original):this.getItemValue(t),i=this.normalize(n),l=i.lastIndexOf(this.query);l>-1;){var d=l+this.query.length;n=n.slice(0,l)+"<strong>"+n.slice(l,d)+"</strong>"+n.slice(d),l=i.slice(0,l).lastIndexOf(this.query)}return n};Ho.prototype.renderError=function(t){this.list.drawError(t)};var KZ=Ho,kM=KZ,JZ=kM;typeof window!="undefined"&&(window.Suggestions=kM);var QZ="Expected a function",fk=0/0,tX="[object Symbol]",eX=/^\s+|\s+$/g,nX=/^[-+]0x[0-9a-f]+$/i,rX=/^0b[01]+$/i,iX=/^0o[0-7]+$/i,oX=parseInt,aX=typeof bo=="object"&&bo&&bo.Object===Object&&bo,sX=typeof self=="object"&&self&&self.Object===Object&&self,lX=aX||sX||Function("return this")(),cX=Object.prototype,uX=cX.toString,dX=Math.max,hX=Math.min,_b=function(){return lX.Date.now()};function fX(t,e,n){var i,l,d,f,o,y,E=0,C=!1,A=!1,P=!0;if(typeof t!="function")throw new TypeError(QZ);e=pk(e)||0,kv(n)&&(C=!!n.leading,A="maxWait"in n,d=A?dX(pk(n.maxWait)||0,e):d,P="trailing"in n?!!n.trailing:P);function B(Pt){var Rt=i,zt=l;return i=l=void 0,E=Pt,f=t.apply(zt,Rt),f}function j(Pt){return E=Pt,o=setTimeout(H,e),C?B(Pt):f}function Z(Pt){var Rt=Pt-y,zt=Pt-E,jt=e-Rt;return A?hX(jt,d-zt):jt}function W(Pt){var Rt=Pt-y,zt=Pt-E;return y===void 0||Rt>=e||Rt<0||A&&zt>=d}function H(){var Pt=_b();if(W(Pt))return V(Pt);o=setTimeout(H,Z(Pt))}function V(Pt){return o=void 0,P&&i?B(Pt):(i=l=void 0,f)}function tt(){o!==void 0&&clearTimeout(o),E=0,i=y=l=o=void 0}function ft(){return o===void 0?f:V(_b())}function et(){var Pt=_b(),Rt=W(Pt);if(i=arguments,l=this,y=Pt,Rt){if(o===void 0)return j(y);if(A)return o=setTimeout(H,e),B(y)}return o===void 0&&(o=setTimeout(H,e)),f}return et.cancel=tt,et.flush=ft,et}function kv(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function pX(t){return!!t&&typeof t=="object"}function mX(t){return typeof t=="symbol"||pX(t)&&uX.call(t)==tX}function pk(t){if(typeof t=="number")return t;if(mX(t))return fk;if(kv(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=kv(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=t.replace(eX,"");var n=rX.test(t);return n||iX.test(t)?oX(t.slice(2),n?2:8):nX.test(t)?fk:+t}var gX=fX,qx={exports:{}},Jh=typeof Reflect=="object"?Reflect:null,mk=Jh&&typeof Jh.apply=="function"?Jh.apply:function(e,n,i){return Function.prototype.apply.call(e,n,i)},Q0;Jh&&typeof Jh.ownKeys=="function"?Q0=Jh.ownKeys:Object.getOwnPropertySymbols?Q0=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Q0=function(e){return Object.getOwnPropertyNames(e)};function _X(t){console&&console.warn&&console.warn(t)}var CM=Number.isNaN||function(e){return e!==e};function qr(){qr.init.call(this)}qx.exports=qr;qx.exports.once=xX;qr.EventEmitter=qr;qr.prototype._events=void 0;qr.prototype._eventsCount=0;qr.prototype._maxListeners=void 0;var gk=10;function _y(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(qr,"defaultMaxListeners",{enumerable:!0,get:function(){return gk},set:function(t){if(typeof t!="number"||t<0||CM(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");gk=t}});qr.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};qr.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||CM(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function SM(t){return t._maxListeners===void 0?qr.defaultMaxListeners:t._maxListeners}qr.prototype.getMaxListeners=function(){return SM(this)};qr.prototype.emit=function(e){for(var n=[],i=1;i<arguments.length;i++)n.push(arguments[i]);var l=e==="error",d=this._events;if(d!==void 0)l=l&&d.error===void 0;else if(!l)return!1;if(l){var f;if(n.length>0&&(f=n[0]),f instanceof Error)throw f;var o=new Error("Unhandled error."+(f?" ("+f.message+")":""));throw o.context=f,o}var y=d[e];if(y===void 0)return!1;if(typeof y=="function")mk(y,this,n);else for(var E=y.length,C=LM(y,E),i=0;i<E;++i)mk(C[i],this,n);return!0};function MM(t,e,n,i){var l,d,f;if(_y(n),d=t._events,d===void 0?(d=t._events=Object.create(null),t._eventsCount=0):(d.newListener!==void 0&&(t.emit("newListener",e,n.listener?n.listener:n),d=t._events),f=d[e]),f===void 0)f=d[e]=n,++t._eventsCount;else if(typeof f=="function"?f=d[e]=i?[n,f]:[f,n]:i?f.unshift(n):f.push(n),l=SM(t),l>0&&f.length>l&&!f.warned){f.warned=!0;var o=new Error("Possible EventEmitter memory leak detected. "+f.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");o.name="MaxListenersExceededWarning",o.emitter=t,o.type=e,o.count=f.length,_X(o)}return t}qr.prototype.addListener=function(e,n){return MM(this,e,n,!1)};qr.prototype.on=qr.prototype.addListener;qr.prototype.prependListener=function(e,n){return MM(this,e,n,!0)};function yX(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function AM(t,e,n){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},l=yX.bind(i);return l.listener=n,i.wrapFn=l,l}qr.prototype.once=function(e,n){return _y(n),this.on(e,AM(this,e,n)),this};qr.prototype.prependOnceListener=function(e,n){return _y(n),this.prependListener(e,AM(this,e,n)),this};qr.prototype.removeListener=function(e,n){var i,l,d,f,o;if(_y(n),l=this._events,l===void 0)return this;if(i=l[e],i===void 0)return this;if(i===n||i.listener===n)--this._eventsCount===0?this._events=Object.create(null):(delete l[e],l.removeListener&&this.emit("removeListener",e,i.listener||n));else if(typeof i!="function"){for(d=-1,f=i.length-1;f>=0;f--)if(i[f]===n||i[f].listener===n){o=i[f].listener,d=f;break}if(d<0)return this;d===0?i.shift():bX(i,d),i.length===1&&(l[e]=i[0]),l.removeListener!==void 0&&this.emit("removeListener",e,o||n)}return this};qr.prototype.off=qr.prototype.removeListener;qr.prototype.removeAllListeners=function(e){var n,i,l;if(i=this._events,i===void 0)return this;if(i.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):i[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete i[e]),this;if(arguments.length===0){var d=Object.keys(i),f;for(l=0;l<d.length;++l)f=d[l],f!=="removeListener"&&this.removeAllListeners(f);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(n=i[e],typeof n=="function")this.removeListener(e,n);else if(n!==void 0)for(l=n.length-1;l>=0;l--)this.removeListener(e,n[l]);return this};function IM(t,e,n){var i=t._events;if(i===void 0)return[];var l=i[e];return l===void 0?[]:typeof l=="function"?n?[l.listener||l]:[l]:n?vX(l):LM(l,l.length)}qr.prototype.listeners=function(e){return IM(this,e,!0)};qr.prototype.rawListeners=function(e){return IM(this,e,!1)};qr.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):PM.call(t,e)};qr.prototype.listenerCount=PM;function PM(t){var e=this._events;if(e!==void 0){var n=e[t];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}qr.prototype.eventNames=function(){return this._eventsCount>0?Q0(this._events):[]};function LM(t,e){for(var n=new Array(e),i=0;i<e;++i)n[i]=t[i];return n}function bX(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function vX(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}function xX(t,e){return new Promise(function(n,i){function l(f){t.removeListener(e,d),i(f)}function d(){typeof t.removeListener=="function"&&t.removeListener("error",l),n([].slice.call(arguments))}zM(t,e,d,{once:!0}),e!=="error"&&wX(t,l,{once:!0})})}function wX(t,e,n){typeof t.on=="function"&&zM(t,"error",e,n)}function zM(t,e,n,i){if(typeof t.on=="function")i.once?t.once(e,n):t.on(e,n);else if(typeof t.addEventListener=="function")t.addEventListener(e,function l(d){i.once&&t.removeEventListener(e,l),n(d)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var EX={fr:{name:"France",bbox:[[-4.59235,41.380007],[9.560016,51.148506]]},us:{name:"United States",bbox:[[-171.791111,18.91619],[-66.96466,71.357764]]},ru:{name:"Russia",bbox:[[19.66064,41.151416],[190.10042,81.2504]]},ca:{name:"Canada",bbox:[[-140.99778,41.675105],[-52.648099,83.23324]]}};function TX(t){var e=t.match(/\s*(.+)\s*=\s*"?([^"]+)"?/);return e?{key:e[1],value:e[2]}:null}function kX(t){var e=t.match(/<?([^>]*)>(.*)/);if(!e)return null;var n=e[1],i=e[2].split(";"),l=null,d=i.reduce(function(f,o){var y=TX(o);return y?y.key==="rel"?(l||(l=y.value),f):(f[y.key]=y.value,f):f},{});return l?{url:n,rel:l,params:d}:null}function CX(t){return t?t.split(/,\s*</).reduce(function(e,n){var i=kX(n);if(!i)return e;var l=i.rel.split(/\s+/);return l.forEach(function(d){e[d]||(e[d]={url:i.url,params:i.params})}),e},{}):{}}var SX=CX,MX=SX;function Hx(t,e){this.request=t,this.headers=e.headers,this.rawBody=e.body,this.statusCode=e.statusCode;try{this.body=JSON.parse(e.body||"{}")}catch{this.body=e.body}this.links=MX(this.headers.link)}Hx.prototype.hasNextPage=function(){return!!this.links.next};Hx.prototype.nextPage=function(){return this.hasNextPage()?this.request._extend({path:this.links.next.url}):null};var AX=Hx,yy={API_ORIGIN:"https://api.mapbox.com",EVENT_PROGRESS_DOWNLOAD:"downloadProgress",EVENT_PROGRESS_UPLOAD:"uploadProgress",EVENT_ERROR:"error",EVENT_RESPONSE:"response",ERROR_HTTP:"HttpError",ERROR_REQUEST_ABORTED:"RequestAbortedError"},_k=yy;function IX(t){var e=t.type||_k.ERROR_HTTP,n;if(t.body)try{n=JSON.parse(t.body)}catch{n=t.body}else n=null;var i=t.message||null;i||(typeof n=="string"?i=n:n&&typeof n.message=="string"?i=n.message:e===_k.ERROR_REQUEST_ABORTED&&(i="Request aborted")),this.message=i,this.type=e,this.statusCode=t.statusCode||null,this.request=t.request,this.body=n}var PX=IX;function LX(t){var e=t.indexOf(":"),n=t.substring(0,e).trim().toLowerCase(),i=t.substring(e+1).trim();return{name:n,value:i}}function zX(t){var e={};return t&&t.trim().split(/[\r|\n]+/).forEach(function(n){var i=LX(n);e[i.name]=i.value}),e}var OX=zX,DX=AX,yk=PX,yb=yy,RX=OX,L_={};function BX(t){var e=L_[t.id];!e||(e.abort(),delete L_[t.id])}function FX(t,e){return new DX(t,{body:e.response,headers:RX(e.getAllResponseHeaders()),statusCode:e.status})}function bk(t){var e=t.total,n=t.loaded,i=100*n/e;return{total:e,transferred:n,percent:i}}function OM(t,e){return new Promise(function(n,i){e.onprogress=function(f){t.emitter.emit(yb.EVENT_PROGRESS_DOWNLOAD,bk(f))};var l=t.file;l&&(e.upload.onprogress=function(f){t.emitter.emit(yb.EVENT_PROGRESS_UPLOAD,bk(f))}),e.onerror=function(f){i(f)},e.onabort=function(){var f=new yk({request:t,type:yb.ERROR_REQUEST_ABORTED});i(f)},e.onload=function(){if(delete L_[t.id],e.status<200||e.status>=400){var f=new yk({request:t,body:e.response,statusCode:e.status});i(f);return}n(e)};var d=t.body;typeof d=="string"?e.send(d):d?e.send(JSON.stringify(d)):l?e.send(l):e.send(),L_[t.id]=e}).then(function(n){return FX(t,n)})}function DM(t,e){var n=t.url(e),i=new window.XMLHttpRequest;return i.open(t.method,n),Object.keys(t.headers).forEach(function(l){i.setRequestHeader(l,t.headers[l])}),i}function NX(t){return Promise.resolve().then(function(){var e=DM(t,t.client.accessToken);return OM(t,e)})}var jX={browserAbort:BX,sendRequestXhr:OM,browserSend:NX,createRequestXhr:DM},Cv={exports:{}};/*! http://mths.be/base64 v0.1.0 by @mathias | MIT license */(function(t,e){(function(n){var i=e,l=t&&t.exports==i&&t,d=typeof bo=="object"&&bo;(d.global===d||d.window===d)&&(n=d);var f=function(j){this.message=j};f.prototype=new Error,f.prototype.name="InvalidCharacterError";var o=function(j){throw new f(j)},y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",E=/[\t\n\f\r ]/g,C=function(j){j=String(j).replace(E,"");var Z=j.length;Z%4==0&&(j=j.replace(/==?$/,""),Z=j.length),(Z%4==1||/[^+a-zA-Z0-9/]/.test(j))&&o("Invalid character: the string to be decoded is not correctly encoded.");for(var W=0,H,V,tt="",ft=-1;++ft<Z;)V=y.indexOf(j.charAt(ft)),H=W%4?H*64+V:V,W++%4&&(tt+=String.fromCharCode(255&H>>(-2*W&6)));return tt},A=function(j){j=String(j),/[^\0-\xFF]/.test(j)&&o("The string to be encoded contains characters outside of the Latin1 range.");for(var Z=j.length%3,W="",H=-1,V,tt,ft,et,Pt=j.length-Z;++H<Pt;)V=j.charCodeAt(H)<<16,tt=j.charCodeAt(++H)<<8,ft=j.charCodeAt(++H),et=V+tt+ft,W+=y.charAt(et>>18&63)+y.charAt(et>>12&63)+y.charAt(et>>6&63)+y.charAt(et&63);return Z==2?(V=j.charCodeAt(H)<<8,tt=j.charCodeAt(++H),et=V+tt,W+=y.charAt(et>>10)+y.charAt(et>>4&63)+y.charAt(et<<2&63)+"="):Z==1&&(et=j.charCodeAt(H),W+=y.charAt(et>>2)+y.charAt(et<<4&63)+"=="),W},P={encode:A,decode:C,version:"0.1.0"};if(i&&!i.nodeType)if(l)l.exports=P;else for(var B in P)P.hasOwnProperty(B)&&(i[B]=P[B]);else n.base64=P})(bo)})(Cv,Cv.exports);var UX=Cv.exports,bb={};function $X(t){if(bb[t])return bb[t];var e=t.split("."),n=e[0],i=e[1];if(!i)throw new Error("Invalid token");var l=VX(i),d={usage:n,user:l.u};return yd(l,"a")&&(d.authorization=l.a),yd(l,"exp")&&(d.expires=l.exp*1e3),yd(l,"iat")&&(d.created=l.iat*1e3),yd(l,"scopes")&&(d.scopes=l.scopes),yd(l,"client")&&(d.client=l.client),yd(l,"ll")&&(d.lastLogin=l.ll),yd(l,"iu")&&(d.impersonator=l.iu),bb[t]=d,d}function VX(t){try{return JSON.parse(UX.decode(t))}catch{throw new Error("Invalid token")}}function yd(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var RM=$X,BM={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,n="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(n=!1));function l(y,E,C){this.fn=y,this.context=E,this.once=C||!1}function d(y,E,C,A,P){if(typeof C!="function")throw new TypeError("The listener must be a function");var B=new l(C,A||y,P),j=n?n+E:E;return y._events[j]?y._events[j].fn?y._events[j]=[y._events[j],B]:y._events[j].push(B):(y._events[j]=B,y._eventsCount++),y}function f(y,E){--y._eventsCount===0?y._events=new i:delete y._events[E]}function o(){this._events=new i,this._eventsCount=0}o.prototype.eventNames=function(){var E=[],C,A;if(this._eventsCount===0)return E;for(A in C=this._events)e.call(C,A)&&E.push(n?A.slice(1):A);return Object.getOwnPropertySymbols?E.concat(Object.getOwnPropertySymbols(C)):E},o.prototype.listeners=function(E){var C=n?n+E:E,A=this._events[C];if(!A)return[];if(A.fn)return[A.fn];for(var P=0,B=A.length,j=new Array(B);P<B;P++)j[P]=A[P].fn;return j},o.prototype.listenerCount=function(E){var C=n?n+E:E,A=this._events[C];return A?A.fn?1:A.length:0},o.prototype.emit=function(E,C,A,P,B,j){var Z=n?n+E:E;if(!this._events[Z])return!1;var W=this._events[Z],H=arguments.length,V,tt;if(W.fn){switch(W.once&&this.removeListener(E,W.fn,void 0,!0),H){case 1:return W.fn.call(W.context),!0;case 2:return W.fn.call(W.context,C),!0;case 3:return W.fn.call(W.context,C,A),!0;case 4:return W.fn.call(W.context,C,A,P),!0;case 5:return W.fn.call(W.context,C,A,P,B),!0;case 6:return W.fn.call(W.context,C,A,P,B,j),!0}for(tt=1,V=new Array(H-1);tt<H;tt++)V[tt-1]=arguments[tt];W.fn.apply(W.context,V)}else{var ft=W.length,et;for(tt=0;tt<ft;tt++)switch(W[tt].once&&this.removeListener(E,W[tt].fn,void 0,!0),H){case 1:W[tt].fn.call(W[tt].context);break;case 2:W[tt].fn.call(W[tt].context,C);break;case 3:W[tt].fn.call(W[tt].context,C,A);break;case 4:W[tt].fn.call(W[tt].context,C,A,P);break;default:if(!V)for(et=1,V=new Array(H-1);et<H;et++)V[et-1]=arguments[et];W[tt].fn.apply(W[tt].context,V)}}return!0},o.prototype.on=function(E,C,A){return d(this,E,C,A,!1)},o.prototype.once=function(E,C,A){return d(this,E,C,A,!0)},o.prototype.removeListener=function(E,C,A,P){var B=n?n+E:E;if(!this._events[B])return this;if(!C)return f(this,B),this;var j=this._events[B];if(j.fn)j.fn===C&&(!P||j.once)&&(!A||j.context===A)&&f(this,B);else{for(var Z=0,W=[],H=j.length;Z<H;Z++)(j[Z].fn!==C||P&&!j[Z].once||A&&j[Z].context!==A)&&W.push(j[Z]);W.length?this._events[B]=W.length===1?W[0]:W:f(this,B)}return this},o.prototype.removeAllListeners=function(E){var C;return E?(C=n?n+E:E,this._events[C]&&f(this,C)):(this._events=new i,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=n,o.EventEmitter=o,t.exports=o})(BM);function GX(t){return t.map(encodeURIComponent).join(",")}function FM(t){return Array.isArray(t)?GX(t):encodeURIComponent(String(t))}function NM(t,e,n){if(n===!1||n===null)return t;var i=/\?/.test(t)?"&":"?",l=encodeURIComponent(e);return n!==void 0&&n!==""&&n!==!0&&(l+="="+FM(n)),""+t+i+l}function qX(t,e){if(!e)return t;var n=t;return Object.keys(e).forEach(function(i){var l=e[i];l!==void 0&&(Array.isArray(l)&&(l=l.filter(function(d){return d!=null}).join(",")),n=NM(n,i,l))}),n}function HX(t,e){if(!e||t.slice(0,4)==="http")return t;var n=t[0]==="/"?"":"/";return""+e.replace(/\/$/,"")+n+t}function WX(t,e){return e?t.replace(/\/:([a-zA-Z0-9]+)/g,function(n,i){var l=e[i];if(l===void 0)throw new Error("Unspecified route parameter "+i);var d=FM(l);return"/"+d}):t}var ZX={appendQueryObject:qX,appendQueryParam:NM,prependOrigin:HX,interpolateRouteParams:WX},XX=RM,Wx=wf,YX=BM.exports,q0=ZX,vk=yy,KX=1;function ku(t,e){if(!t)throw new Error("MapiRequest requires a client");if(!e||!e.path||!e.method)throw new Error("MapiRequest requires an options object with path and method properties");var n={};e.body&&(n["content-type"]="application/json");var i=Wx(n,e.headers),l=Object.keys(i).reduce(function(d,f){return d[f.toLowerCase()]=i[f],d},{});this.id=KX++,this._options=e,this.emitter=new YX,this.client=t,this.response=null,this.error=null,this.sent=!1,this.aborted=!1,this.path=e.path,this.method=e.method,this.origin=e.origin||t.origin,this.query=e.query||{},this.params=e.params||{},this.body=e.body||null,this.file=e.file||null,this.encoding=e.encoding||"utf8",this.sendFileAs=e.sendFileAs||null,this.headers=l}ku.prototype.url=function(e){var n=q0.prependOrigin(this.path,this.origin);n=q0.appendQueryObject(n,this.query);var i=this.params,l=e==null?this.client.accessToken:e;if(l){n=q0.appendQueryParam(n,"access_token",l);var d=XX(l).user;i=Wx({ownerId:d},i)}return n=q0.interpolateRouteParams(n,i),n};ku.prototype.send=function(){var e=this;if(e.sent)throw new Error("This request has already been sent. Check the response and error properties. Create a new request with clone().");return e.sent=!0,e.client.sendRequest(e).then(function(n){return e.response=n,e.emitter.emit(vk.EVENT_RESPONSE,n),n},function(n){throw e.error=n,e.emitter.emit(vk.EVENT_ERROR,n),n})};ku.prototype.abort=function(){this._nextPageRequest&&(this._nextPageRequest.abort(),delete this._nextPageRequest),!(this.response||this.error||this.aborted)&&(this.aborted=!0,this.client.abortRequest(this))};ku.prototype.eachPage=function(e){var n=this;function i(f){function o(){delete n._nextPageRequest;var y=f.nextPage();y&&(n._nextPageRequest=y,d(y))}e(null,f,o)}function l(f){e(f,null,function(){})}function d(f){f.send().then(i,l)}d(this)};ku.prototype.clone=function(){return this._extend()};ku.prototype._extend=function(e){var n=Wx(this._options,e);return new ku(this.client,n)};var JX=ku,QX=RM,tY=JX,eY=yy;function jM(t){if(!t||!t.accessToken)throw new Error("Cannot create a client without an access token");QX(t.accessToken),this.accessToken=t.accessToken,this.origin=t.origin||eY.API_ORIGIN}jM.prototype.createRequest=function(e){return new tY(this,e)};var UM=jM,$M=jX,VM=UM;function ff(t){VM.call(this,t)}ff.prototype=Object.create(VM.prototype);ff.prototype.constructor=ff;ff.prototype.sendRequest=$M.browserSend;ff.prototype.abortRequest=$M.browserAbort;function nY(t){return new ff(t)}var GM=nY,rY=GM,iY=rY,oY=Object.prototype.toString,aY=function(t){var e;return oY.call(t)==="[object Object]"&&(e=Object.getPrototypeOf(t),e===null||e===Object.getPrototypeOf({}))},sY=aY,lY=wf,qM="value",vb=`
  `,ei={};ei.assert=function(t,e){return e=e||{},function(n){var i=Cu(t,n);if(!!i){var l=Zx(i,e);throw e.apiName&&(l=e.apiName+": "+l),new Error(l)}}};ei.shape=function(e){var n=hY(e);return function(l){var d=Cu(ei.plainObject,l);if(d)return d;for(var f,o,y=[],E=0;E<n.length;E++)f=n[E].key,o=n[E].value,d=Cu(o,l[f]),d&&y.push([f].concat(d));return y.length<2?y[0]:function(C){y=y.map(function(B){var j=B[0],Z=Zx(B,C).split(`
`).join(vb);return"- "+j+": "+Z});var A=C.path.join("."),P=A===qM?"":" of "+A;return"The following properties"+P+" have invalid values:"+vb+y.join(vb)}}};ei.strictShape=function(e){var n=ei.shape(e);return function(l){var d=n(l);if(d)return d;var f=Object.keys(l).reduce(function(o,y){return e[y]===void 0&&o.push(y),o},[]);if(f.length!==0)return function(){return"The following keys are invalid: "+f.join(", ")}}};ei.arrayOf=function(e){return HM(e)};ei.tuple=function(){var e=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments);return HM(e)};function HM(t){var e=Array.isArray(t),n=function(i){return e?t[i]:t};return function(l){var d=Cu(ei.plainArray,l);if(d)return d;if(e&&l.length!==t.length)return"an array with "+t.length+" items";for(var f=0;f<l.length;f++)if(d=Cu(n(f),l[f]),d)return[f].concat(d)}}ei.required=function(e){function n(i){return i==null?function(l){return WM(l,ZM(l.path)?"cannot be undefined/null.":"is required.")}:e.apply(this,arguments)}return n.__required=!0,n};ei.oneOfType=function(){var e=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments);return function(i){var l=e.map(function(d){return Cu(d,i)}).filter(Boolean);if(l.length===e.length)return l.every(function(d){return d.length===1&&typeof d[0]=="string"})?cY(l.map(function(d){return d[0]})):l.reduce(function(d,f){return f.length>d.length?f:d})}};ei.equal=function(e){return function(i){if(i!==e)return JSON.stringify(e)}};ei.oneOf=function(){var e=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments),n=e.map(function(i){return ei.equal(i)});return ei.oneOfType.apply(this,n)};ei.range=function(e){var n=e[0],i=e[1];return function(d){var f=Cu(ei.number,d);if(f||d<n||d>i)return"number between "+n+" & "+i+" (inclusive)"}};ei.any=function(){};ei.boolean=function(e){if(typeof e!="boolean")return"boolean"};ei.number=function(e){if(typeof e!="number")return"number"};ei.plainArray=function(e){if(!Array.isArray(e))return"array"};ei.plainObject=function(e){if(!sY(e))return"object"};ei.string=function(e){if(typeof e!="string")return"string"};ei.func=function(e){if(typeof e!="function")return"function"};function Cu(t,e){if(!(e==null&&!t.hasOwnProperty("__required"))){var n=t(e);if(n)return Array.isArray(n)?n:[n]}}function Zx(t,e){var n=t.length,i=t[n-1],l=t.slice(0,n-1);return l.length===0&&(l=[qM]),e=lY(e,{path:l}),typeof i=="function"?i(e):WM(e,uY(i))}function cY(t){return t.length<2?t[0]:t.length===2?t.join(" or "):t.slice(0,-1).join(", ")+", or "+t.slice(-1)}function uY(t){return"must be "+dY(t)+"."}function dY(t){return/^an? /.test(t)?t:/^[aeiou]/i.test(t)?"an "+t:/^[a-z]/i.test(t)?"a "+t:t}function WM(t,e){var n=ZM(t.path),i=t.path.join(".")+" "+e,l=n?"Item at position ":"";return l+i}function ZM(t){return typeof t[t.length-1]=="number"||typeof t[0]=="number"}function hY(t){return Object.keys(t||{}).map(function(e){return{key:e,value:t[e]}})}ei.validate=Cu;ei.processMessage=Zx;var fY=ei,pY=wf,Qh=fY;function mY(t){if(typeof window!="undefined")return t instanceof globalThis.Blob||t instanceof globalThis.ArrayBuffer?void 0:"Blob or ArrayBuffer";if(!(typeof t=="string"||t.pipe!==void 0))return"Filename or Readable stream"}function gY(t,e){return Qh.assert(Qh.strictShape(t),e)}function _Y(t){var e="date";if(typeof t=="boolean")return e;try{var n=new Date(t);if(n.getTime&&isNaN(n.getTime()))return e}catch{return e}}function yY(t){return Qh.tuple(Qh.number,Qh.number)(t)}var bY=pY(Qh,{file:mY,date:_Y,coordinates:yY,assertShape:gY});function vY(t,e){var n=function(i,l){return e.indexOf(i)!==-1&&l!==void 0};return typeof e=="function"&&(n=e),Object.keys(t).filter(function(i){return n(i,t[i])}).reduce(function(i,l){return i[l]=t[l],i},{})}var xY=vY;function wY(t,e){return Object.keys(t).reduce(function(n,i){return n[i]=e(i,t[i]),n},{})}var EY=wY,TY=EY;function kY(t){return TY(t,function(e,n){return typeof n=="boolean"?JSON.stringify(n):n})}var CY=kY,SY=UM,MY=GM;function AY(t){return function(e){var n;SY.prototype.isPrototypeOf(e)?n=e:n=MY(e);var i=Object.create(t);return i.client=n,i}}var IY=AY,XM=wf,sr=bY,z_=xY,YM=CY,PY=IY,Xx={},KM=["country","region","postcode","district","place","locality","neighborhood","address","poi","poi.landmark"];Xx.forwardGeocode=function(t){sr.assertShape({query:sr.required(sr.string),mode:sr.oneOf("mapbox.places","mapbox.places-permanent"),countries:sr.arrayOf(sr.string),proximity:sr.oneOf(sr.coordinates,"ip"),types:sr.arrayOf(sr.oneOf(KM)),autocomplete:sr.boolean,bbox:sr.arrayOf(sr.number),limit:sr.number,language:sr.arrayOf(sr.string),routing:sr.boolean,fuzzyMatch:sr.boolean,worldview:sr.string})(t),t.mode=t.mode||"mapbox.places";var e=YM(XM({country:t.countries},z_(t,["proximity","types","autocomplete","bbox","limit","language","routing","fuzzyMatch","worldview"])));return this.client.createRequest({method:"GET",path:"/geocoding/v5/:mode/:query.json",params:z_(t,["mode","query"]),query:e})};Xx.reverseGeocode=function(t){sr.assertShape({query:sr.required(sr.coordinates),mode:sr.oneOf("mapbox.places","mapbox.places-permanent"),countries:sr.arrayOf(sr.string),types:sr.arrayOf(sr.oneOf(KM)),bbox:sr.arrayOf(sr.number),limit:sr.number,language:sr.arrayOf(sr.string),reverseMode:sr.oneOf("distance","score"),routing:sr.boolean,worldview:sr.string})(t),t.mode=t.mode||"mapbox.places";var e=YM(XM({country:t.countries},z_(t,["country","types","bbox","limit","language","reverseMode","routing","worldview"])));return this.client.createRequest({method:"GET",path:"/geocoding/v5/:mode/:query.json",params:z_(t,["mode","query"]),query:e})};var LY=PY(Xx);let zY="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",JM=t=>crypto.getRandomValues(new Uint8Array(t)),QM=(t,e,n)=>{let i=(2<<Math.log(t.length-1)/Math.LN2)-1,l=-~(1.6*i*e/t.length);return(d=e)=>{let f="";for(;;){let o=n(l),y=l;for(;y--;)if(f+=t[o[y]&i]||"",f.length===d)return f}}},OY=(t,e=21)=>QM(t,e,JM),DY=(t=21)=>crypto.getRandomValues(new Uint8Array(t)).reduce((e,n)=>(n&=63,n<36?e+=n.toString(36):n<62?e+=(n-26).toString(36).toUpperCase():n>62?e+="-":e+="_",e),"");var RY=Object.freeze(Object.defineProperty({__proto__:null,nanoid:DY,customAlphabet:OY,customRandom:QM,urlAlphabet:zY,random:JM},Symbol.toStringTag,{value:"Module"})),BY=WR(RY),FY=BY.nanoid;function tA(t){this.origin=t.origin||"https://api.mapbox.com",this.endpoint="events/v2",this.access_token=t.accessToken,this.version="0.2.0",this.sessionID=this.generateSessionID(),this.userAgent=this.getUserAgent(),this.options=t,this.send=this.send.bind(this),this.countries=t.countries?t.countries.split(","):null,this.types=t.types?t.types.split(","):null,this.bbox=t.bbox?t.bbox:null,this.language=t.language?t.language.split(","):null,this.limit=t.limit?+t.limit:null,this.locale=navigator.language||null,this.enableEventLogging=this.shouldEnableLogging(t),this.eventQueue=new Array,this.flushInterval=t.flushInterval||1e3,this.maxQueueSize=t.maxQueueSize||100,this.timer=this.flushInterval?setTimeout(this.flush.bind(this),this.flushInterval):null,this.lastSentInput="",this.lastSentIndex=0}tA.prototype={select:function(t,e){var n=this.getSelectedIndex(t,e),i=this.getEventPayload("search.select",e);if(i.resultIndex=n,i.resultPlaceName=t.place_name,i.resultId=t.id,!(n===this.lastSentIndex&&i.queryString===this.lastSentInput||n==-1)&&(this.lastSentIndex=n,this.lastSentInput=i.queryString,!!i.queryString))return this.push(i)},start:function(t){var e=this.getEventPayload("search.start",t);if(!!e.queryString)return this.push(e)},keyevent:function(t,e){if(!!t.key&&!(t.metaKey||[9,27,37,39,13,38,40].indexOf(t.keyCode)!==-1)){var n=this.getEventPayload("search.keystroke",e);if(n.lastAction=t.key,!!n.queryString)return this.push(n)}},send:function(t,e){if(!this.enableEventLogging)return e?e():void 0;var n=this.getRequestOptions(t);this.request(n,function(i){if(i)return this.handleError(i,e);if(e)return e()}.bind(this))},getRequestOptions:function(t){Array.isArray(t)||(t=[t]);var e={method:"POST",host:this.origin,path:this.endpoint+"?access_token="+this.access_token,headers:{"Content-Type":"application/json"},body:JSON.stringify(t)};return e},getEventPayload:function(t,e){var n;e.options.proximity?typeof e.options.proximity=="object"?n=[e.options.proximity.longitude,e.options.proximity.latitude]:e.options.proximity==="ip"?n=[999,999]:n=e.options.proximity:n=null;var i=e._map?e._map.getZoom():void 0,l={event:t,created:+new Date,sessionIdentifier:this.sessionID,country:this.countries,userAgent:this.userAgent,language:this.language,bbox:this.bbox,types:this.types,endpoint:"mapbox.places",autocomplete:e.options.autocomplete,fuzzyMatch:e.options.fuzzyMatch,proximity:n,limit:e.options.limit,routing:e.options.routing,worldview:e.options.worldview,mapZoom:i,keyboardLocale:this.locale};return t==="search.select"?l.queryString=e.inputString:t!="search.select"&&e._inputEl?l.queryString=e._inputEl.value:l.queryString=e.inputString,l},request:function(t,e){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(this.readyState==4)return this.status==204?e(null):e(this.statusText)},n.open(t.method,t.host+"/"+t.path,!0);for(var i in t.headers){var l=t.headers[i];n.setRequestHeader(i,l)}n.send(t.body)},handleError:function(t,e){if(e)return e(t)},generateSessionID:function(){return FY()},getUserAgent:function(){return"mapbox-gl-geocoder."+this.version+"."+navigator.userAgent},getSelectedIndex:function(t,e){if(!!e._typeahead){var n=e._typeahead.data,i=t.id,l=n.map(function(f){return f.id}),d=l.indexOf(i);return d}},shouldEnableLogging:function(t){return!(t.enableEventLogging===!1||t.origin&&t.origin!=="https://api.mapbox.com"||t.localGeocoder||t.filter)},flush:function(){this.eventQueue.length>0&&(this.send(this.eventQueue),this.eventQueue=new Array),this.timer&&clearTimeout(this.timer),this.flushInterval&&(this.timer=setTimeout(this.flush.bind(this),this.flushInterval))},push:function(t,e){this.eventQueue.push(t),(this.eventQueue.length>=this.maxQueueSize||e)&&this.flush()},remove:function(){this.flush()}};var NY=tA,jY={de:"Suche",it:"Ricerca",en:"Search",nl:"Zoeken",fr:"Chercher",ca:"Cerca",he:"\u05DC\u05D7\u05E4\u05E9",ja:"\u30B5\u30FC\u30C1",lv:"Mekl\u0113t",pt:"Procurar",sr:"\u041F\u0440\u0435\u0442\u0440\u0430\u0433\u0430",zh:"\u641C\u7D22",cs:"Vyhled\xE1v\xE1n\xED",hu:"Keres\xE9s",ka:"\u10EB\u10D8\u10D4\u10D1\u10D0",nb:"S\xF8ke",sk:"Vyh\u013Ead\xE1vanie",th:"\u0E04\u0E49\u0E19\u0E2B\u0E32",fi:"Hae",is:"Leita",ko:"\uC218\uC0C9",pl:"Szukaj",sl:"Iskanje",fa:"\u062C\u0633\u062A\u062C\u0648",ru:"\u041F\u043E\u0438\u0441\u043A"},UY={placeholder:jY},eA={exports:{}};(function(t){(function(e,n,i){t.exports?t.exports=i():e[n]=i()})(bo,"subtag",function(){var e="",n=/^([a-zA-Z]{2,3})(?:[_-]+([a-zA-Z]{3})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{4})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{2}|[0-9]{3})(?=$|[_-]+))?/;function i(y){return y.match(n)||[]}function l(y){return i(y).filter(function(E,C){return E&&C})}function d(y){return y=i(y),{language:y[1]||e,extlang:y[2]||e,script:y[3]||e,region:y[4]||e}}function f(y,E,C){Object.defineProperty(y,E,{value:C,enumerable:!0})}function o(y,E,C){function A(P){return i(P)[y]||e}f(A,"pattern",E),f(d,C,A)}return o(1,/^[a-zA-Z]{2,3}$/,"language"),o(2,/^[a-zA-Z]{3}$/,"extlang"),o(3,/^[a-zA-Z]{4}$/,"script"),o(4,/^[a-zA-Z]{2}$|^[0-9]{3}$/,"region"),f(d,"split",l),d})})(eA);function nA(){}nA.prototype={isSupport:function(){return Boolean(window.navigator.geolocation)},getCurrentPosition:function(){const t={enableHighAccuracy:!0};return new Promise(function(e,n){window.navigator.geolocation.getCurrentPosition(e,n,t)})}};var $Y=nA;function VY(t,e){const n=rA(t),i=["address","street","place","country"];var l;if(typeof e=="function")return e(n);const d=i.indexOf(e);return d===-1?l=i:l=i.slice(d),l.reduce(function(f,o){return n[o]?(f!==""&&(f=f+", "),f+n[o]):f},"")}function rA(t){const e=t.address||"",n=t.text||"",i=t.place_name||"",d={address:i.split(",")[0],houseNumber:e,street:n,placeName:i};return t.context.forEach(function(f){const o=f.id.split(".")[0];d[o]=f.text}),d}const GY=/^[ ]*(-?\d{1,3}(\.\d{0,256})?)[, ]+(-?\d{1,3}(\.\d{0,256})?)[ ]*$/;var qY={transformFeatureToGeolocationText:VY,getAddressInfo:rA,REVERSE_GEOCODE_COORD_RGX:GY},HY=JZ,WY=gX,Td=wf,ZY=qx.exports.EventEmitter,xk=EX,xb=iY,wb=LY,XY=NY,YY=UY,KY=eA.exports,JY=$Y,wk=qY;const ou={FORWARD:0,LOCAL:1,REVERSE:2};function QY(){var t=document.createElement("div");return t.className="mapboxgl-ctrl-geocoder--powered-by",t.innerHTML='<a href="https://www.mapbox.com/search-service" target="_blank">Powered by Mapbox</a>',t}function iA(t){this._eventEmitter=new ZY,this.options=Td({},this.options,t),this.inputString="",this.fresh=!0,this.lastSelected=null,this.geolocation=new JY}iA.prototype={options:{zoom:16,flyTo:!0,trackProximity:!0,minLength:2,reverseGeocode:!1,flipCoordinates:!1,limit:5,origin:"https://api.mapbox.com",enableEventLogging:!0,marker:!0,mapboxgl:null,collapsed:!1,clearAndBlurOnEsc:!1,clearOnBlur:!1,enableGeolocation:!1,addressAccuracy:"street",getItemValue:function(t){return t.place_name},render:function(t){var e=t.place_name.split(",");return'<div class="mapboxgl-ctrl-geocoder--suggestion"><div class="mapboxgl-ctrl-geocoder--suggestion-title">'+e[0]+'</div><div class="mapboxgl-ctrl-geocoder--suggestion-address">'+e.splice(1,e.length).join(",")+"</div></div>"}},addTo:function(t){function e(n,i){if(!document.body.contains(i))throw new Error("Element provided to #addTo() exists, but is not in the DOM");const l=n.onAdd();i.appendChild(l)}if(t._controlContainer)t.addControl(this);else if(t instanceof HTMLElement)e(this,t);else if(typeof t=="string"){const n=document.querySelectorAll(t);if(n.length===0)throw new Error("Element ",t,"not found.");if(n.length>1)throw new Error("Geocoder can only be added to a single html element");e(this,n[0])}else throw new Error("Error: addTo must be a mapbox-gl-js map, an html element, or a CSS selector query for a single html element")},onAdd:function(t){if(t&&typeof t!="string"&&(this._map=t),this.setLanguage(),this.options.localGeocoderOnly||(this.geocoderService=wb(xb({accessToken:this.options.accessToken,origin:this.options.origin}))),this.options.localGeocoderOnly&&!this.options.localGeocoder)throw new Error("A localGeocoder function must be specified to use localGeocoderOnly mode");this.eventManager=new XY(this.options),this._onChange=this._onChange.bind(this),this._onKeyDown=this._onKeyDown.bind(this),this._onPaste=this._onPaste.bind(this),this._onBlur=this._onBlur.bind(this),this._showButton=this._showButton.bind(this),this._hideButton=this._hideButton.bind(this),this._onQueryResult=this._onQueryResult.bind(this),this.clear=this.clear.bind(this),this._updateProximity=this._updateProximity.bind(this),this._collapse=this._collapse.bind(this),this._unCollapse=this._unCollapse.bind(this),this._clear=this._clear.bind(this),this._clearOnBlur=this._clearOnBlur.bind(this),this._geolocateUser=this._geolocateUser.bind(this);var e=this.container=document.createElement("div");e.className="mapboxgl-ctrl-geocoder mapboxgl-ctrl";var n=this.createIcon("search",'<path d="M7.4 2.5c-2.7 0-4.9 2.2-4.9 4.9s2.2 4.9 4.9 4.9c1 0 1.8-.2 2.5-.8l3.7 3.7c.2.2.4.3.8.3.7 0 1.1-.4 1.1-1.1 0-.3-.1-.5-.3-.8L11.4 10c.4-.8.8-1.6.8-2.5.1-2.8-2.1-5-4.8-5zm0 1.6c1.8 0 3.2 1.4 3.2 3.2s-1.4 3.2-3.2 3.2-3.3-1.3-3.3-3.1 1.4-3.3 3.3-3.3z"/>');this._inputEl=document.createElement("input"),this._inputEl.type="text",this._inputEl.className="mapboxgl-ctrl-geocoder--input",this.setPlaceholder(),this.options.collapsed&&(this._collapse(),this.container.addEventListener("mouseenter",this._unCollapse),this.container.addEventListener("mouseleave",this._collapse),this._inputEl.addEventListener("focus",this._unCollapse)),(this.options.collapsed||this.options.clearOnBlur)&&this._inputEl.addEventListener("blur",this._onBlur),this._inputEl.addEventListener("keydown",WY(this._onKeyDown,200)),this._inputEl.addEventListener("paste",this._onPaste),this._inputEl.addEventListener("change",this._onChange),this.container.addEventListener("mouseenter",this._showButton),this.container.addEventListener("mouseleave",this._hideButton),this._inputEl.addEventListener("keyup",function(E){this.eventManager.keyevent(E,this)}.bind(this));var i=document.createElement("div");i.classList.add("mapboxgl-ctrl-geocoder--pin-right"),this._clearEl=document.createElement("button"),this._clearEl.setAttribute("aria-label","Clear"),this._clearEl.addEventListener("click",this.clear),this._clearEl.className="mapboxgl-ctrl-geocoder--button";var l=this.createIcon("close",'<path d="M3.8 2.5c-.6 0-1.3.7-1.3 1.3 0 .3.2.7.5.8L7.2 9 3 13.2c-.3.3-.5.7-.5 1 0 .6.7 1.3 1.3 1.3.3 0 .7-.2 1-.5L9 10.8l4.2 4.2c.2.3.7.3 1 .3.6 0 1.3-.7 1.3-1.3 0-.3-.2-.7-.3-1l-4.4-4L15 4.6c.3-.2.5-.5.5-.8 0-.7-.7-1.3-1.3-1.3-.3 0-.7.2-1 .3L9 7.1 4.8 2.8c-.3-.1-.7-.3-1-.3z"/>');if(this._clearEl.appendChild(l),this._loadingEl=this.createIcon("loading",'<path fill="#333" d="M4.4 4.4l.8.8c2.1-2.1 5.5-2.1 7.6 0l.8-.8c-2.5-2.5-6.7-2.5-9.2 0z"/><path opacity=".1" d="M12.8 12.9c-2.1 2.1-5.5 2.1-7.6 0-2.1-2.1-2.1-5.5 0-7.7l-.8-.8c-2.5 2.5-2.5 6.7 0 9.2s6.6 2.5 9.2 0 2.5-6.6 0-9.2l-.8.8c2.2 2.1 2.2 5.6 0 7.7z"/>'),i.appendChild(this._clearEl),i.appendChild(this._loadingEl),e.appendChild(n),e.appendChild(this._inputEl),e.appendChild(i),this.options.enableGeolocation&&this.geolocation.isSupport()){this._geolocateEl=document.createElement("button"),this._geolocateEl.setAttribute("aria-label","Geolocate"),this._geolocateEl.addEventListener("click",this._geolocateUser),this._geolocateEl.className="mapboxgl-ctrl-geocoder--button";var d=this.createIcon("geolocate",'<path d="M12.999 3.677L2.042 8.269c-.962.403-.747 1.823.29 1.912l5.032.431.431 5.033c.089 1.037 1.509 1.252 1.912.29l4.592-10.957c.345-.822-.477-1.644-1.299-1.299z" fill="#4264fb"/>');this._geolocateEl.appendChild(d),i.appendChild(this._geolocateEl),this._showGeolocateButton()}var f=this._typeahead=new HY(this._inputEl,[],{filter:!1,minLength:this.options.minLength,limit:this.options.limit});this.setRenderFunction(this.options.render),f.getItemValue=this.options.getItemValue;var o=f.list.draw,y=this._footerNode=QY();return f.list.draw=function(){o.call(this),y.addEventListener("mousedown",function(){this.selectingListItem=!0}.bind(this)),y.addEventListener("mouseup",function(){this.selectingListItem=!1}.bind(this)),this.element.appendChild(y)},this.mapMarker=null,this._handleMarker=this._handleMarker.bind(this),this._map&&(this.options.trackProximity&&(this._updateProximity(),this._map.on("moveend",this._updateProximity)),this._mapboxgl=this.options.mapboxgl,!this._mapboxgl&&this.options.marker&&(console.error("No mapboxgl detected in options. Map markers are disabled. Please set options.mapboxgl."),this.options.marker=!1)),e},_geolocateUser:function(){this._hideGeolocateButton(),this._showLoadingIcon(),this.geolocation.getCurrentPosition().then(function(t){this._hideLoadingIcon();const e={geometry:{type:"Point",coordinates:[t.coords.longitude,t.coords.latitude]}};this._handleMarker(e),this._fly(e),this._typeahead.clear(),this._typeahead.selected=!0,this.lastSelected=JSON.stringify(e),this._showClearButton(),this.fresh=!1;const n={limit:1,language:[this.options.language],query:e.geometry.coordinates,types:["address"]};if(this.options.localGeocoderOnly){const i=e.geometry.coordinates[0]+","+e.geometry.coordinates[1];this._setInputValue(i),this._eventEmitter.emit("result",{result:e})}else this.geocoderService.reverseGeocode(n).send().then(function(i){const l=i.body.features[0];if(l){const d=wk.transformFeatureToGeolocationText(l,this.options.addressAccuracy);this._setInputValue(d),l.user_coordinates=e.geometry.coordinates,this._eventEmitter.emit("result",{result:l})}else this._eventEmitter.emit("result",{result:{user_coordinates:e.geometry.coordinates}})}.bind(this))}.bind(this)).catch(function(t){t.code===1?this._renderUserDeniedGeolocationError():this._renderLocationError(),this._hideLoadingIcon(),this._showGeolocateButton(),this._hideAttribution()}.bind(this))},createIcon:function(t,e){var n=document.createElementNS("http://www.w3.org/2000/svg","svg");return n.setAttribute("class","mapboxgl-ctrl-geocoder--icon mapboxgl-ctrl-geocoder--icon-"+t),n.setAttribute("viewBox","0 0 18 18"),n.setAttribute("xml:space","preserve"),n.setAttribute("width",18),n.setAttribute("height",18),n.innerHTML=e,n},onRemove:function(){return this.container.parentNode.removeChild(this.container),this.options.trackProximity&&this._map&&this._map.off("moveend",this._updateProximity),this._removeMarker(),this._map=null,this},_setInputValue:function(t){this._inputEl.value=t,setTimeout(function(){this._inputEl.focus(),this._inputEl.scrollLeft=0,this._inputEl.setSelectionRange(0,0)}.bind(this),1)},_onPaste:function(t){var e=(t.clipboardData||window.clipboardData).getData("text");e.length>=this.options.minLength&&this._geocode(e)},_onKeyDown:function(t){var e=27,n=9;if(t.keyCode===e&&this.options.clearAndBlurOnEsc)return this._clear(t),this._inputEl.blur();var i=t.target&&t.target.shadowRoot?t.target.shadowRoot.activeElement:t.target,l=i?i.value:"";if(!l)return this.fresh=!0,t.keyCode!==n&&this.clear(t),this._showGeolocateButton(),this._hideClearButton();this._hideGeolocateButton(),!(t.metaKey||[n,e,37,39,13,38,40].indexOf(t.keyCode)!==-1)&&i.value.length>=this.options.minLength&&this._geocode(i.value)},_showButton:function(){this._typeahead.selected&&this._showClearButton()},_hideButton:function(){this._typeahead.selected&&this._hideClearButton()},_showClearButton:function(){this._clearEl.style.display="block"},_hideClearButton:function(){this._clearEl.style.display="none"},_showGeolocateButton:function(){this._geolocateEl&&this.geolocation.isSupport()&&(this._geolocateEl.style.display="block")},_hideGeolocateButton:function(){this._geolocateEl&&(this._geolocateEl.style.display="none")},_showLoadingIcon:function(){this._loadingEl.style.display="block"},_hideLoadingIcon:function(){this._loadingEl.style.display="none"},_showAttribution:function(){this._footerNode.style.display="block"},_hideAttribution:function(){this._footerNode.style.display="none"},_onBlur:function(t){this.options.clearOnBlur&&this._clearOnBlur(t),this.options.collapsed&&this._collapse()},_onChange:function(){var t=this._typeahead.selected;t&&JSON.stringify(t)!==this.lastSelected&&(this._hideClearButton(),this.options.flyTo&&this._fly(t),this.options.marker&&this._mapboxgl&&this._handleMarker(t),this._inputEl.focus(),this._inputEl.scrollLeft=0,this._inputEl.setSelectionRange(0,0),this.lastSelected=JSON.stringify(t),this._eventEmitter.emit("result",{result:t}),this.eventManager.select(t,this))},_fly:function(t){var e;if(t.properties&&xk[t.properties.short_code])e=Td({},this.options.flyTo),this._map&&this._map.fitBounds(xk[t.properties.short_code].bbox,e);else if(t.bbox){var n=t.bbox;e=Td({},this.options.flyTo),this._map&&this._map.fitBounds([[n[0],n[1]],[n[2],n[3]]],e)}else{var i={zoom:this.options.zoom};e=Td({},i,this.options.flyTo),t.center?e.center=t.center:t.geometry&&t.geometry.type&&t.geometry.type==="Point"&&t.geometry.coordinates&&(e.center=t.geometry.coordinates),this._map&&this._map.flyTo(e)}},_requestType:function(t,e){var n;return t.localGeocoderOnly?n=ou.LOCAL:t.reverseGeocode&&wk.REVERSE_GEOCODE_COORD_RGX.test(e)?n=ou.REVERSE:n=ou.FORWARD,n},_setupConfig:function(t,e){const n=["bbox","limit","proximity","countries","types","language","reverseMode","mode","autocomplete","fuzzyMatch","routing","worldview"],i=/[\s,]+/;var l=this,d=n.reduce(function(o,y){if(l.options[y]===void 0||l.options[y]===null)return o;["countries","types","language"].indexOf(y)>-1?o[y]=l.options[y].split(i):o[y]=l.options[y];const E=typeof l.options[y].longitude=="number"&&typeof l.options[y].latitude=="number";if(y==="proximity"&&E){const C=l.options[y].longitude,A=l.options[y].latitude;o[y]=[C,A]}return o},{});switch(t){case ou.REVERSE:{var f=e.split(i).map(function(o){return parseFloat(o,10)});l.options.flipCoordinates||f.reverse(),d.types&&d.types[0],d=Td(d,{query:f,limit:1}),["proximity","autocomplete","fuzzyMatch","bbox"].forEach(function(o){o in d&&delete d[o]})}break;case ou.FORWARD:{const o=e.trim();/^(-?\d{1,3}(\.\d{0,256})?)[, ]+(-?\d{1,3}(\.\d{0,256})?)?$/.test(o)&&(e=e.replace(/,/g," ")),d=Td(d,{query:e})}break}return d},_geocode:function(t){this.inputString=t,this._showLoadingIcon(),this._eventEmitter.emit("loading",{query:t});const e=this._requestType(this.options,t),n=this._setupConfig(e,t);var i;switch(e){case ou.LOCAL:i=Promise.resolve();break;case ou.FORWARD:i=this.geocoderService.forwardGeocode(n).send();break;case ou.REVERSE:i=this.geocoderService.reverseGeocode(n).send();break}var l=this.options.localGeocoder?this.options.localGeocoder(t)||[]:[],d=[],f=null;return i.catch(function(o){f=o}.bind(this)).then(function(o){this._hideLoadingIcon();var y={};return o?o.statusCode=="200"&&(y=o.body,y.request=o.request,y.headers=o.headers):y={type:"FeatureCollection",features:[]},y.config=n,this.fresh&&(this.eventManager.start(this),this.fresh=!1),y.features=y.features?l.concat(y.features):l,this.options.externalGeocoder?(d=this.options.externalGeocoder(t,y.features)||Promise.resolve([]),d.then(function(E){return y.features=y.features?E.concat(y.features):E,y},function(){return y})):y}.bind(this)).then(function(o){if(f)throw f;this.options.filter&&o.features.length&&(o.features=o.features.filter(this.options.filter)),o.features.length?(this._showClearButton(),this._hideGeolocateButton(),this._showAttribution(),this._eventEmitter.emit("results",o),this._typeahead.update(o.features)):(this._hideClearButton(),this._hideAttribution(),this._typeahead.selected=null,this._renderNoResults(),this._eventEmitter.emit("results",o))}.bind(this)).catch(function(o){this._hideLoadingIcon(),this._hideAttribution(),l.length&&this.options.localGeocoder||d.length&&this.options.externalGeocoder?(this._showClearButton(),this._hideGeolocateButton(),this._typeahead.update(l)):(this._hideClearButton(),this._typeahead.selected=null,this._renderError()),this._eventEmitter.emit("results",{features:l}),this._eventEmitter.emit("error",{error:o})}.bind(this)),i},_clear:function(t){t&&t.preventDefault(),this._inputEl.value="",this._typeahead.selected=null,this._typeahead.clear(),this._onChange(),this._hideClearButton(),this._showGeolocateButton(),this._removeMarker(),this.lastSelected=null,this._eventEmitter.emit("clear"),this.fresh=!0},clear:function(t){this._clear(t),this._inputEl.focus()},_clearOnBlur:function(t){var e=this;t.relatedTarget&&e._clear(t)},_onQueryResult:function(t){var e=t.body;if(!!e.features.length){var n=e.features[0];this._typeahead.selected=n,this._inputEl.value=n.place_name,this._onChange()}},_updateProximity:function(){if(!(!this._map||!this.options.trackProximity))if(this._map.getZoom()>9){var t=this._map.getCenter().wrap();this.setProximity({longitude:t.lng,latitude:t.lat},!1)}else this.setProximity(null,!1)},_collapse:function(){!this._inputEl.value&&this._inputEl!==document.activeElement&&this.container.classList.add("mapboxgl-ctrl-geocoder--collapsed")},_unCollapse:function(){this.container.classList.remove("mapboxgl-ctrl-geocoder--collapsed")},query:function(t){return this._geocode(t).then(this._onQueryResult),this},_renderError:function(){var t="<div class='mapbox-gl-geocoder--error'>There was an error reaching the server</div>";this._renderMessage(t)},_renderLocationError:function(){var t="<div class='mapbox-gl-geocoder--error'>A location error has occurred</div>";this._renderMessage(t)},_renderNoResults:function(){var t="<div class='mapbox-gl-geocoder--error mapbox-gl-geocoder--no-results'>No results found</div>";this._renderMessage(t)},_renderUserDeniedGeolocationError:function(){var t="<div class='mapbox-gl-geocoder--error'>Geolocation permission denied</div>";this._renderMessage(t)},_renderMessage:function(t){this._typeahead.update([]),this._typeahead.selected=null,this._typeahead.clear(),this._typeahead.renderError(t)},_getPlaceholderText:function(){if(this.options.placeholder)return this.options.placeholder;if(this.options.language){var t=this.options.language.split(",")[0],e=KY.language(t),n=YY.placeholder[e];if(n)return n}return"Search"},setInput:function(t){return this._inputEl.value=t,this._typeahead.selected=null,this._typeahead.clear(),t.length>=this.options.minLength&&this._geocode(t),this},setProximity:function(t,e=!0){return this.options.proximity=t,e&&(this.options.trackProximity=!1),this},getProximity:function(){return this.options.proximity},setRenderFunction:function(t){return t&&typeof t=="function"&&(this._typeahead.render=t),this},getRenderFunction:function(){return this._typeahead.render},setLanguage:function(t){var e=navigator.language||navigator.userLanguage||navigator.browserLanguage;return this.options.language=t||this.options.language||e,this},getLanguage:function(){return this.options.language},getZoom:function(){return this.options.zoom},setZoom:function(t){return this.options.zoom=t,this},getFlyTo:function(){return this.options.flyTo},setFlyTo:function(t){return this.options.flyTo=t,this},getPlaceholder:function(){return this.options.placeholder},setPlaceholder:function(t){return this.placeholder=t||this._getPlaceholderText(),this._inputEl.placeholder=this.placeholder,this._inputEl.setAttribute("aria-label",this.placeholder),this},getBbox:function(){return this.options.bbox},setBbox:function(t){return this.options.bbox=t,this},getCountries:function(){return this.options.countries},setCountries:function(t){return this.options.countries=t,this},getTypes:function(){return this.options.types},setTypes:function(t){return this.options.types=t,this},getMinLength:function(){return this.options.minLength},setMinLength:function(t){return this.options.minLength=t,this._typeahead&&(this._typeahead.options.minLength=t),this},getLimit:function(){return this.options.limit},setLimit:function(t){return this.options.limit=t,this._typeahead&&(this._typeahead.options.limit=t),this},getFilter:function(){return this.options.filter},setFilter:function(t){return this.options.filter=t,this},setOrigin:function(t){return this.options.origin=t,this.geocoderService=wb(xb({accessToken:this.options.accessToken,origin:this.options.origin})),this},getOrigin:function(){return this.options.origin},setAccessToken:function(t){return this.options.accessToken=t,this.geocoderService=wb(xb({accessToken:this.options.accessToken,origin:this.options.origin})),this},setAutocomplete:function(t){return this.options.autocomplete=t,this},getAutocomplete:function(){return this.options.autocomplete},setFuzzyMatch:function(t){return this.options.fuzzyMatch=t,this},getFuzzyMatch:function(){return this.options.fuzzyMatch},setRouting:function(t){return this.options.routing=t,this},getRouting:function(){return this.options.routing},setWorldview:function(t){return this.options.worldview=t,this},getWorldview:function(){return this.options.worldview},_handleMarker:function(t){if(!!this._map){this._removeMarker();var e={color:"#4668F2"},n=Td({},e,this.options.marker);return this.mapMarker=new this._mapboxgl.Marker(n),t.center?this.mapMarker.setLngLat(t.center).addTo(this._map):t.geometry&&t.geometry.type&&t.geometry.type==="Point"&&t.geometry.coordinates&&this.mapMarker.setLngLat(t.geometry.coordinates).addTo(this._map),this}},_removeMarker:function(){this.mapMarker&&(this.mapMarker.remove(),this.mapMarker=null)},on:function(t,e){return this._eventEmitter.on(t,e),this},off:function(t,e){return this._eventEmitter.removeListener(t,e),this.eventManager.remove(),this}};var tK=iA,oA={},eK=bo&&bo.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(oA,"__esModule",{value:!0});const nK=eK(Vx);var by=oA.default=nK.default,aA=function t(e,n){if(e===n)return!0;if(e&&n&&typeof e=="object"&&typeof n=="object"){if(e.constructor!==n.constructor)return!1;var i,l,d;if(Array.isArray(e)){if(i=e.length,i!=n.length)return!1;for(l=i;l--!==0;)if(!t(e[l],n[l]))return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if(d=Object.keys(e),i=d.length,i!==Object.keys(n).length)return!1;for(l=i;l--!==0;)if(!Object.prototype.hasOwnProperty.call(n,d[l]))return!1;for(l=i;l--!==0;){var f=d[l];if(!t(e[f],n[f]))return!1}return!0}return e!==e&&n!==n},sA={exports:{}};(function(t,e){(function(n,i){t.exports=i()})(bo,function(){var n=function(M,D){var J={drag:[],click:[],mousemove:[],mousedown:[],mouseup:[],mouseout:[],keydown:[],keyup:[],touchstart:[],touchmove:[],touchend:[],tap:[]},gt={on:function(St,It,xe){if(J[St]===void 0)throw new Error("Invalid event type: "+St);J[St].push({selector:It,fn:xe})},render:function(St){D.store.featureChanged(St)}},Ct=function(St,It){for(var xe=J[St],we=xe.length;we--;){var $e=xe[we];if($e.selector(It)){$e.fn.call(gt,It)||D.store.render(),D.ui.updateMapClasses();break}}};return M.start.call(gt),{render:M.render,stop:function(){M.stop&&M.stop()},trash:function(){M.trash&&(M.trash(),D.store.render())},combineFeatures:function(){M.combineFeatures&&M.combineFeatures()},uncombineFeatures:function(){M.uncombineFeatures&&M.uncombineFeatures()},drag:function(St){Ct("drag",St)},click:function(St){Ct("click",St)},mousemove:function(St){Ct("mousemove",St)},mousedown:function(St){Ct("mousedown",St)},mouseup:function(St){Ct("mouseup",St)},mouseout:function(St){Ct("mouseout",St)},keydown:function(St){Ct("keydown",St)},keyup:function(St){Ct("keyup",St)},touchstart:function(St){Ct("touchstart",St)},touchmove:function(St){Ct("touchmove",St)},touchend:function(St){Ct("touchend",St)},tap:function(St){Ct("tap",St)}}};function i(M){if(M.__esModule)return M;var D=M.default;if(typeof D=="function"){var J=function gt(){if(this instanceof gt){var Ct=[null];Ct.push.apply(Ct,arguments);var St=Function.bind.apply(D,Ct);return new St}return D.apply(this,arguments)};J.prototype=D.prototype}else J={};return Object.defineProperty(J,"__esModule",{value:!0}),Object.keys(M).forEach(function(gt){var Ct=Object.getOwnPropertyDescriptor(M,gt);Object.defineProperty(J,gt,Ct.get?Ct:{enumerable:!0,get:function(){return M[gt]}})}),J}var l={},d={RADIUS:6378137,FLATTENING:1/298.257223563,POLAR_RADIUS:63567523142e-4},f=d;function o(M){var D=0;if(M&&M.length>0){D+=Math.abs(y(M[0]));for(var J=1;J<M.length;J++)D-=Math.abs(y(M[J]))}return D}function y(M){var D,J,gt,Ct,St,It,xe=0,we=M.length;if(we>2){for(It=0;It<we;It++)It===we-2?(gt=we-2,Ct=we-1,St=0):It===we-1?(gt=we-1,Ct=0,St=1):(gt=It,Ct=It+1,St=It+2),D=M[gt],J=M[Ct],xe+=(E(M[St][0])-E(D[0]))*Math.sin(E(J[1]));xe=xe*f.RADIUS*f.RADIUS/2}return xe}function E(M){return M*Math.PI/180}l.geometry=function M(D){var J,gt=0;switch(D.type){case"Polygon":return o(D.coordinates);case"MultiPolygon":for(J=0;J<D.coordinates.length;J++)gt+=o(D.coordinates[J]);return gt;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(J=0;J<D.geometries.length;J++)gt+=M(D.geometries[J]);return gt}},l.ring=y;var C={CONTROL_BASE:"mapboxgl-ctrl",CONTROL_PREFIX:"mapboxgl-ctrl-",CONTROL_BUTTON:"mapbox-gl-draw_ctrl-draw-btn",CONTROL_BUTTON_LINE:"mapbox-gl-draw_line",CONTROL_BUTTON_POLYGON:"mapbox-gl-draw_polygon",CONTROL_BUTTON_POINT:"mapbox-gl-draw_point",CONTROL_BUTTON_TRASH:"mapbox-gl-draw_trash",CONTROL_BUTTON_COMBINE_FEATURES:"mapbox-gl-draw_combine",CONTROL_BUTTON_UNCOMBINE_FEATURES:"mapbox-gl-draw_uncombine",CONTROL_GROUP:"mapboxgl-ctrl-group",ATTRIBUTION:"mapboxgl-ctrl-attrib",ACTIVE_BUTTON:"active",BOX_SELECT:"mapbox-gl-draw_boxselect"},A={HOT:"mapbox-gl-draw-hot",COLD:"mapbox-gl-draw-cold"},P={ADD:"add",MOVE:"move",DRAG:"drag",POINTER:"pointer",NONE:"none"},B={POLYGON:"polygon",LINE:"line_string",POINT:"point"},j={FEATURE:"Feature",POLYGON:"Polygon",LINE_STRING:"LineString",POINT:"Point",FEATURE_COLLECTION:"FeatureCollection",MULTI_PREFIX:"Multi",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon"},Z={DRAW_LINE_STRING:"draw_line_string",DRAW_POLYGON:"draw_polygon",DRAW_POINT:"draw_point",SIMPLE_SELECT:"simple_select",DIRECT_SELECT:"direct_select",STATIC:"static"},W={CREATE:"draw.create",DELETE:"draw.delete",UPDATE:"draw.update",SELECTION_CHANGE:"draw.selectionchange",MODE_CHANGE:"draw.modechange",ACTIONABLE:"draw.actionable",RENDER:"draw.render",COMBINE_FEATURES:"draw.combine",UNCOMBINE_FEATURES:"draw.uncombine"},H={MOVE:"move",CHANGE_COORDINATES:"change_coordinates"},V={FEATURE:"feature",MIDPOINT:"midpoint",VERTEX:"vertex"},tt={ACTIVE:"true",INACTIVE:"false"},ft=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate"],et=-85,Pt=Object.freeze({__proto__:null,classes:C,sources:A,cursors:P,types:B,geojsonTypes:j,modes:Z,events:W,updateActions:H,meta:V,activeStates:tt,interactions:ft,LAT_MIN:-90,LAT_RENDERED_MIN:et,LAT_MAX:90,LAT_RENDERED_MAX:85,LNG_MIN:-270,LNG_MAX:270}),Rt={Point:0,LineString:1,MultiLineString:1,Polygon:2};function zt(M,D){var J=Rt[M.geometry.type]-Rt[D.geometry.type];return J===0&&M.geometry.type===j.POLYGON?M.area-D.area:J}function jt(M){return M.map(function(D){return D.geometry.type===j.POLYGON&&(D.area=l.geometry({type:j.FEATURE,property:{},geometry:D.geometry})),D}).sort(zt).map(function(D){return delete D.area,D})}function oe(M,D){return D===void 0&&(D=0),[[M.point.x-D,M.point.y-D],[M.point.x+D,M.point.y+D]]}function ge(M){if(this._items={},this._nums={},this._length=M?M.length:0,M)for(var D=0,J=M.length;D<J;D++)this.add(M[D]),M[D]!==void 0&&(typeof M[D]=="string"?this._items[M[D]]=D:this._nums[M[D]]=D)}ge.prototype.add=function(M){return this.has(M)||(this._length++,typeof M=="string"?this._items[M]=this._length:this._nums[M]=this._length),this},ge.prototype.delete=function(M){return this.has(M)===!1||(this._length--,delete this._items[M],delete this._nums[M]),this},ge.prototype.has=function(M){return(typeof M=="string"||typeof M=="number")&&(this._items[M]!==void 0||this._nums[M]!==void 0)},ge.prototype.values=function(){var M=this,D=[];return Object.keys(this._items).forEach(function(J){D.push({k:J,v:M._items[J]})}),Object.keys(this._nums).forEach(function(J){D.push({k:JSON.parse(J),v:M._nums[J]})}),D.sort(function(J,gt){return J.v-gt.v}).map(function(J){return J.k})},ge.prototype.clear=function(){return this._length=0,this._items={},this._nums={},this};var ce=[V.FEATURE,V.MIDPOINT,V.VERTEX],Ue={click:function(M,D,J){return Ae(M,D,J,J.options.clickBuffer)},touch:function(M,D,J){return Ae(M,D,J,J.options.touchBuffer)}};function Ae(M,D,J,gt){if(J.map===null)return[];var Ct=M?oe(M,gt):D,St={};J.options.styles&&(St.layers=J.options.styles.map(function($e){return $e.id}));var It=J.map.queryRenderedFeatures(Ct,St).filter(function($e){return ce.indexOf($e.properties.meta)!==-1}),xe=new ge,we=[];return It.forEach(function($e){var Re=$e.properties.id;xe.has(Re)||(xe.add(Re),we.push($e))}),jt(we)}function se(M,D){var J=Ue.click(M,null,D),gt={mouse:P.NONE};return J[0]&&(gt.mouse=J[0].properties.active===tt.ACTIVE?P.MOVE:P.POINTER,gt.feature=J[0].properties.meta),D.events.currentModeName().indexOf("draw")!==-1&&(gt.mouse=P.ADD),D.ui.queueMapClasses(gt),D.ui.updateMapClasses(),J[0]}function Ze(M,D){var J=M.x-D.x,gt=M.y-D.y;return Math.sqrt(J*J+gt*gt)}function gn(M,D,J){J===void 0&&(J={});var gt=J.fineTolerance!=null?J.fineTolerance:4,Ct=J.grossTolerance!=null?J.grossTolerance:12,St=J.interval!=null?J.interval:500;M.point=M.point||D.point,M.time=M.time||D.time;var It=Ze(M.point,D.point);return It<gt||It<Ct&&D.time-M.time<St}function _n(M,D,J){J===void 0&&(J={});var gt=J.tolerance!=null?J.tolerance:25,Ct=J.interval!=null?J.interval:250;return M.point=M.point||D.point,M.time=M.time||D.time,Ze(M.point,D.point)<gt&&D.time-M.time<Ct}var Gn={},Jn={get exports(){return Gn},set exports(M){Gn=M}}.exports=function(M,D){if(D||(D=16),M===void 0&&(M=128),M<=0)return"0";for(var J=Math.log(Math.pow(2,M))/Math.log(D),gt=2;J===1/0;gt*=2)J=Math.log(Math.pow(2,M/gt))/Math.log(D)*gt;var Ct=J-Math.floor(J),St="";for(gt=0;gt<Math.floor(J);gt++)St=Math.floor(Math.random()*D).toString(D)+St;if(Ct){var It=Math.pow(D,Ct);St=Math.floor(Math.random()*It).toString(D)+St}var xe=parseInt(St,D);return xe!==1/0&&xe>=Math.pow(2,M)?Jn(M,D):St};Jn.rack=function(M,D,J){var gt=function(St){var It=0;do{if(It++>10){if(!J)throw new Error("too many ID collisions, use more bits");M+=J}var xe=Jn(M,D)}while(Object.hasOwnProperty.call(Ct,xe));return Ct[xe]=St,xe},Ct=gt.hats={};return gt.get=function(St){return gt.hats[St]},gt.set=function(St,It){return gt.hats[St]=It,gt},gt.bits=M||128,gt.base=D||16,gt};var Wn=function(M,D){this.ctx=M,this.properties=D.properties||{},this.coordinates=D.geometry.coordinates,this.id=D.id||Gn(),this.type=D.geometry.type};Wn.prototype.changed=function(){this.ctx.store.featureChanged(this.id)},Wn.prototype.incomingCoords=function(M){this.setCoordinates(M)},Wn.prototype.setCoordinates=function(M){this.coordinates=M,this.changed()},Wn.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.coordinates))},Wn.prototype.setProperty=function(M,D){this.properties[M]=D},Wn.prototype.toGeoJSON=function(){return JSON.parse(JSON.stringify({id:this.id,type:j.FEATURE,properties:this.properties,geometry:{coordinates:this.getCoordinates(),type:this.type}}))},Wn.prototype.internal=function(M){var D={id:this.id,meta:V.FEATURE,"meta:type":this.type,active:tt.INACTIVE,mode:M};if(this.ctx.options.userProperties)for(var J in this.properties)D["user_"+J]=this.properties[J];return{type:j.FEATURE,properties:D,geometry:{coordinates:this.getCoordinates(),type:this.type}}};var ur=function(M,D){Wn.call(this,M,D)};(ur.prototype=Object.create(Wn.prototype)).isValid=function(){return typeof this.coordinates[0]=="number"&&typeof this.coordinates[1]=="number"},ur.prototype.updateCoordinate=function(M,D,J){this.coordinates=arguments.length===3?[D,J]:[M,D],this.changed()},ur.prototype.getCoordinate=function(){return this.getCoordinates()};var Zn=function(M,D){Wn.call(this,M,D)};(Zn.prototype=Object.create(Wn.prototype)).isValid=function(){return this.coordinates.length>1},Zn.prototype.addCoordinate=function(M,D,J){this.changed();var gt=parseInt(M,10);this.coordinates.splice(gt,0,[D,J])},Zn.prototype.getCoordinate=function(M){var D=parseInt(M,10);return JSON.parse(JSON.stringify(this.coordinates[D]))},Zn.prototype.removeCoordinate=function(M){this.changed(),this.coordinates.splice(parseInt(M,10),1)},Zn.prototype.updateCoordinate=function(M,D,J){var gt=parseInt(M,10);this.coordinates[gt]=[D,J],this.changed()};var _r=function(M,D){Wn.call(this,M,D),this.coordinates=this.coordinates.map(function(J){return J.slice(0,-1)})};(_r.prototype=Object.create(Wn.prototype)).isValid=function(){return this.coordinates.length!==0&&this.coordinates.every(function(M){return M.length>2})},_r.prototype.incomingCoords=function(M){this.coordinates=M.map(function(D){return D.slice(0,-1)}),this.changed()},_r.prototype.setCoordinates=function(M){this.coordinates=M,this.changed()},_r.prototype.addCoordinate=function(M,D,J){this.changed();var gt=M.split(".").map(function(Ct){return parseInt(Ct,10)});this.coordinates[gt[0]].splice(gt[1],0,[D,J])},_r.prototype.removeCoordinate=function(M){this.changed();var D=M.split(".").map(function(gt){return parseInt(gt,10)}),J=this.coordinates[D[0]];J&&(J.splice(D[1],1),J.length<3&&this.coordinates.splice(D[0],1))},_r.prototype.getCoordinate=function(M){var D=M.split(".").map(function(gt){return parseInt(gt,10)}),J=this.coordinates[D[0]];return JSON.parse(JSON.stringify(J[D[1]]))},_r.prototype.getCoordinates=function(){return this.coordinates.map(function(M){return M.concat([M[0]])})},_r.prototype.updateCoordinate=function(M,D,J){this.changed();var gt=M.split("."),Ct=parseInt(gt[0],10),St=parseInt(gt[1],10);this.coordinates[Ct]===void 0&&(this.coordinates[Ct]=[]),this.coordinates[Ct][St]=[D,J]};var he={MultiPoint:ur,MultiLineString:Zn,MultiPolygon:_r},He=function(M,D,J,gt,Ct){var St=J.split("."),It=parseInt(St[0],10),xe=St[1]?St.slice(1).join("."):null;return M[It][D](xe,gt,Ct)},Ce=function(M,D){if(Wn.call(this,M,D),delete this.coordinates,this.model=he[D.geometry.type],this.model===void 0)throw new TypeError(D.geometry.type+" is not a valid type");this.features=this._coordinatesToFeatures(D.geometry.coordinates)};function Te(M){this.map=M.map,this.drawConfig=JSON.parse(JSON.stringify(M.options||{})),this._ctx=M}(Ce.prototype=Object.create(Wn.prototype))._coordinatesToFeatures=function(M){var D=this,J=this.model.bind(this);return M.map(function(gt){return new J(D.ctx,{id:Gn(),type:j.FEATURE,properties:{},geometry:{coordinates:gt,type:D.type.replace("Multi","")}})})},Ce.prototype.isValid=function(){return this.features.every(function(M){return M.isValid()})},Ce.prototype.setCoordinates=function(M){this.features=this._coordinatesToFeatures(M),this.changed()},Ce.prototype.getCoordinate=function(M){return He(this.features,"getCoordinate",M)},Ce.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.features.map(function(M){return M.type===j.POLYGON?M.getCoordinates():M.coordinates})))},Ce.prototype.updateCoordinate=function(M,D,J){He(this.features,"updateCoordinate",M,D,J),this.changed()},Ce.prototype.addCoordinate=function(M,D,J){He(this.features,"addCoordinate",M,D,J),this.changed()},Ce.prototype.removeCoordinate=function(M){He(this.features,"removeCoordinate",M),this.changed()},Ce.prototype.getFeatures=function(){return this.features},Te.prototype.setSelected=function(M){return this._ctx.store.setSelected(M)},Te.prototype.setSelectedCoordinates=function(M){var D=this;this._ctx.store.setSelectedCoordinates(M),M.reduce(function(J,gt){return J[gt.feature_id]===void 0&&(J[gt.feature_id]=!0,D._ctx.store.get(gt.feature_id).changed()),J},{})},Te.prototype.getSelected=function(){return this._ctx.store.getSelected()},Te.prototype.getSelectedIds=function(){return this._ctx.store.getSelectedIds()},Te.prototype.isSelected=function(M){return this._ctx.store.isSelected(M)},Te.prototype.getFeature=function(M){return this._ctx.store.get(M)},Te.prototype.select=function(M){return this._ctx.store.select(M)},Te.prototype.deselect=function(M){return this._ctx.store.deselect(M)},Te.prototype.deleteFeature=function(M,D){return D===void 0&&(D={}),this._ctx.store.delete(M,D)},Te.prototype.addFeature=function(M){return this._ctx.store.add(M)},Te.prototype.clearSelectedFeatures=function(){return this._ctx.store.clearSelected()},Te.prototype.clearSelectedCoordinates=function(){return this._ctx.store.clearSelectedCoordinates()},Te.prototype.setActionableState=function(M){M===void 0&&(M={});var D={trash:M.trash||!1,combineFeatures:M.combineFeatures||!1,uncombineFeatures:M.uncombineFeatures||!1};return this._ctx.events.actionable(D)},Te.prototype.changeMode=function(M,D,J){return D===void 0&&(D={}),J===void 0&&(J={}),this._ctx.events.changeMode(M,D,J)},Te.prototype.updateUIClasses=function(M){return this._ctx.ui.queueMapClasses(M)},Te.prototype.activateUIButton=function(M){return this._ctx.ui.setActiveButton(M)},Te.prototype.featuresAt=function(M,D,J){if(J===void 0&&(J="click"),J!=="click"&&J!=="touch")throw new Error("invalid buffer type");return Ue[J](M,D,this._ctx)},Te.prototype.newFeature=function(M){var D=M.geometry.type;return D===j.POINT?new ur(this._ctx,M):D===j.LINE_STRING?new Zn(this._ctx,M):D===j.POLYGON?new _r(this._ctx,M):new Ce(this._ctx,M)},Te.prototype.isInstanceOf=function(M,D){if(M===j.POINT)return D instanceof ur;if(M===j.LINE_STRING)return D instanceof Zn;if(M===j.POLYGON)return D instanceof _r;if(M==="MultiFeature")return D instanceof Ce;throw new Error("Unknown feature class: "+M)},Te.prototype.doRender=function(M){return this._ctx.store.featureChanged(M)},Te.prototype.onSetup=function(){},Te.prototype.onDrag=function(){},Te.prototype.onClick=function(){},Te.prototype.onMouseMove=function(){},Te.prototype.onMouseDown=function(){},Te.prototype.onMouseUp=function(){},Te.prototype.onMouseOut=function(){},Te.prototype.onKeyUp=function(){},Te.prototype.onKeyDown=function(){},Te.prototype.onTouchStart=function(){},Te.prototype.onTouchMove=function(){},Te.prototype.onTouchEnd=function(){},Te.prototype.onTap=function(){},Te.prototype.onStop=function(){},Te.prototype.onTrash=function(){},Te.prototype.onCombineFeature=function(){},Te.prototype.onUncombineFeature=function(){},Te.prototype.toDisplayFeatures=function(){throw new Error("You must overwrite toDisplayFeatures")};var Qn={drag:"onDrag",click:"onClick",mousemove:"onMouseMove",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseout:"onMouseOut",keyup:"onKeyUp",keydown:"onKeyDown",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd",tap:"onTap"},Bn=Object.keys(Qn);function Ln(M){var D=Object.keys(M);return function(J,gt){gt===void 0&&(gt={});var Ct={},St=D.reduce(function(It,xe){return It[xe]=M[xe],It},new Te(J));return{start:function(){var It=this;Ct=St.onSetup(gt),Bn.forEach(function(xe){var we,$e=Qn[xe],Re=function(){return!1};M[$e]&&(Re=function(){return!0}),It.on(xe,Re,(we=$e,function(De){return St[we](Ct,De)}))})},stop:function(){St.onStop(Ct)},trash:function(){St.onTrash(Ct)},combineFeatures:function(){St.onCombineFeatures(Ct)},uncombineFeatures:function(){St.onUncombineFeatures(Ct)},render:function(It,xe){St.toDisplayFeatures(Ct,It,xe)}}}}function Qe(M){return[].concat(M).filter(function(D){return D!==void 0})}function bt(){var M=this;if(!(M.ctx.map&&M.ctx.map.getSource(A.HOT)!==void 0))return we();var D=M.ctx.events.currentModeName();M.ctx.ui.queueMapClasses({mode:D});var J=[],gt=[];M.isDirty?gt=M.getAllIds():(J=M.getChangedIds().filter(function($e){return M.get($e)!==void 0}),gt=M.sources.hot.filter(function($e){return $e.properties.id&&J.indexOf($e.properties.id)===-1&&M.get($e.properties.id)!==void 0}).map(function($e){return $e.properties.id})),M.sources.hot=[];var Ct=M.sources.cold.length;M.sources.cold=M.isDirty?[]:M.sources.cold.filter(function($e){var Re=$e.properties.id||$e.properties.parent;return J.indexOf(Re)===-1});var St=Ct!==M.sources.cold.length||gt.length>0;function It($e,Re){var De=M.get($e).internal(D);M.ctx.events.currentModeRender(De,function(xn){M.sources[Re].push(xn)})}if(J.forEach(function($e){return It($e,"hot")}),gt.forEach(function($e){return It($e,"cold")}),St&&M.ctx.map.getSource(A.COLD).setData({type:j.FEATURE_COLLECTION,features:M.sources.cold}),M.ctx.map.getSource(A.HOT).setData({type:j.FEATURE_COLLECTION,features:M.sources.hot}),M._emitSelectionChange&&(M.ctx.map.fire(W.SELECTION_CHANGE,{features:M.getSelected().map(function($e){return $e.toGeoJSON()}),points:M.getSelectedCoordinates().map(function($e){return{type:j.FEATURE,properties:{},geometry:{type:j.POINT,coordinates:$e.coordinates}}})}),M._emitSelectionChange=!1),M._deletedFeaturesToEmit.length){var xe=M._deletedFeaturesToEmit.map(function($e){return $e.toGeoJSON()});M._deletedFeaturesToEmit=[],M.ctx.map.fire(W.DELETE,{features:xe})}function we(){M.isDirty=!1,M.clearChangedIds()}we(),M.ctx.map.fire(W.RENDER,{})}function vt(M){var D,J=this;this._features={},this._featureIds=new ge,this._selectedFeatureIds=new ge,this._selectedCoordinates=[],this._changedFeatureIds=new ge,this._deletedFeaturesToEmit=[],this._emitSelectionChange=!1,this._mapInitialConfig={},this.ctx=M,this.sources={hot:[],cold:[]},this.render=function(){D||(D=requestAnimationFrame(function(){D=null,bt.call(J)}))},this.isDirty=!1}function Jt(M,D){var J=M._selectedCoordinates.filter(function(gt){return M._selectedFeatureIds.has(gt.feature_id)});M._selectedCoordinates.length===J.length||D.silent||(M._emitSelectionChange=!0),M._selectedCoordinates=J}vt.prototype.createRenderBatch=function(){var M=this,D=this.render,J=0;return this.render=function(){J++},function(){M.render=D,J>0&&M.render()}},vt.prototype.setDirty=function(){return this.isDirty=!0,this},vt.prototype.featureChanged=function(M){return this._changedFeatureIds.add(M),this},vt.prototype.getChangedIds=function(){return this._changedFeatureIds.values()},vt.prototype.clearChangedIds=function(){return this._changedFeatureIds.clear(),this},vt.prototype.getAllIds=function(){return this._featureIds.values()},vt.prototype.add=function(M){return this.featureChanged(M.id),this._features[M.id]=M,this._featureIds.add(M.id),this},vt.prototype.delete=function(M,D){var J=this;return D===void 0&&(D={}),Qe(M).forEach(function(gt){J._featureIds.has(gt)&&(J._featureIds.delete(gt),J._selectedFeatureIds.delete(gt),D.silent||J._deletedFeaturesToEmit.indexOf(J._features[gt])===-1&&J._deletedFeaturesToEmit.push(J._features[gt]),delete J._features[gt],J.isDirty=!0)}),Jt(this,D),this},vt.prototype.get=function(M){return this._features[M]},vt.prototype.getAll=function(){var M=this;return Object.keys(this._features).map(function(D){return M._features[D]})},vt.prototype.select=function(M,D){var J=this;return D===void 0&&(D={}),Qe(M).forEach(function(gt){J._selectedFeatureIds.has(gt)||(J._selectedFeatureIds.add(gt),J._changedFeatureIds.add(gt),D.silent||(J._emitSelectionChange=!0))}),this},vt.prototype.deselect=function(M,D){var J=this;return D===void 0&&(D={}),Qe(M).forEach(function(gt){J._selectedFeatureIds.has(gt)&&(J._selectedFeatureIds.delete(gt),J._changedFeatureIds.add(gt),D.silent||(J._emitSelectionChange=!0))}),Jt(this,D),this},vt.prototype.clearSelected=function(M){return M===void 0&&(M={}),this.deselect(this._selectedFeatureIds.values(),{silent:M.silent}),this},vt.prototype.setSelected=function(M,D){var J=this;return D===void 0&&(D={}),M=Qe(M),this.deselect(this._selectedFeatureIds.values().filter(function(gt){return M.indexOf(gt)===-1}),{silent:D.silent}),this.select(M.filter(function(gt){return!J._selectedFeatureIds.has(gt)}),{silent:D.silent}),this},vt.prototype.setSelectedCoordinates=function(M){return this._selectedCoordinates=M,this._emitSelectionChange=!0,this},vt.prototype.clearSelectedCoordinates=function(){return this._selectedCoordinates=[],this._emitSelectionChange=!0,this},vt.prototype.getSelectedIds=function(){return this._selectedFeatureIds.values()},vt.prototype.getSelected=function(){var M=this;return this._selectedFeatureIds.values().map(function(D){return M.get(D)})},vt.prototype.getSelectedCoordinates=function(){var M=this;return this._selectedCoordinates.map(function(D){return{coordinates:M.get(D.feature_id).getCoordinate(D.coord_path)}})},vt.prototype.isSelected=function(M){return this._selectedFeatureIds.has(M)},vt.prototype.setFeatureProperty=function(M,D,J){this.get(M).setProperty(D,J),this.featureChanged(M)},vt.prototype.storeMapConfig=function(){var M=this;ft.forEach(function(D){M.ctx.map[D]&&(M._mapInitialConfig[D]=M.ctx.map[D].isEnabled())})},vt.prototype.restoreMapConfig=function(){var M=this;Object.keys(this._mapInitialConfig).forEach(function(D){M._mapInitialConfig[D]?M.ctx.map[D].enable():M.ctx.map[D].disable()})},vt.prototype.getInitialConfigValue=function(M){return this._mapInitialConfig[M]===void 0||this._mapInitialConfig[M]};var fe=function(){for(var M=arguments,D={},J=0;J<arguments.length;J++){var gt=M[J];for(var Ct in gt)be.call(gt,Ct)&&(D[Ct]=gt[Ct])}return D},be=Object.prototype.hasOwnProperty,Ie=["mode","feature","mouse"];function Ge(M){var D=null,J=null,gt={onRemove:function(){return M.map.off("load",gt.connect),clearInterval(J),gt.removeLayers(),M.store.restoreMapConfig(),M.ui.removeButtons(),M.events.removeEventListeners(),M.ui.clearMapClasses(),M.map=null,M.container=null,M.store=null,D&&D.parentNode&&D.parentNode.removeChild(D),D=null,this},connect:function(){M.map.off("load",gt.connect),clearInterval(J),gt.addLayers(),M.store.storeMapConfig(),M.events.addEventListeners()},onAdd:function(Ct){var St=Ct.fire;return Ct.fire=function(It,xe){var we=arguments;return St.length===1&&arguments.length!==1&&(we=[fe({},{type:It},xe)]),St.apply(Ct,we)},M.map=Ct,M.events=function(It){var xe=Object.keys(It.options.modes).reduce(function(le,Ve){return le[Ve]=Ln(It.options.modes[Ve]),le},{}),we={},$e={},Re={},De=null,xn=null;Re.drag=function(le,Ve){Ve({point:le.point,time:new Date().getTime()})?(It.ui.queueMapClasses({mouse:P.DRAG}),xn.drag(le)):le.originalEvent.stopPropagation()},Re.mousedrag=function(le){Re.drag(le,function(Ve){return!gn(we,Ve)})},Re.touchdrag=function(le){Re.drag(le,function(Ve){return!_n($e,Ve)})},Re.mousemove=function(le){if((le.originalEvent.buttons!==void 0?le.originalEvent.buttons:le.originalEvent.which)===1)return Re.mousedrag(le);var Ve=se(le,It);le.featureTarget=Ve,xn.mousemove(le)},Re.mousedown=function(le){we={time:new Date().getTime(),point:le.point};var Ve=se(le,It);le.featureTarget=Ve,xn.mousedown(le)},Re.mouseup=function(le){var Ve=se(le,It);le.featureTarget=Ve,gn(we,{point:le.point,time:new Date().getTime()})?xn.click(le):xn.mouseup(le)},Re.mouseout=function(le){xn.mouseout(le)},Re.touchstart=function(le){if(le.originalEvent.preventDefault(),It.options.touchEnabled){$e={time:new Date().getTime(),point:le.point};var Ve=Ue.touch(le,null,It)[0];le.featureTarget=Ve,xn.touchstart(le)}},Re.touchmove=function(le){if(le.originalEvent.preventDefault(),It.options.touchEnabled)return xn.touchmove(le),Re.touchdrag(le)},Re.touchend=function(le){if(le.originalEvent.preventDefault(),It.options.touchEnabled){var Ve=Ue.touch(le,null,It)[0];le.featureTarget=Ve,_n($e,{time:new Date().getTime(),point:le.point})?xn.tap(le):xn.touchend(le)}};var Cr=function(le){return!(le===8||le===46||le>=48&&le<=57)};function Tn(le,Ve,kn){kn===void 0&&(kn={}),xn.stop();var ii=xe[le];if(ii===void 0)throw new Error(le+" is not valid");De=le;var Vr=ii(It,Ve);xn=n(Vr,It),kn.silent||It.map.fire(W.MODE_CHANGE,{mode:le}),It.store.setDirty(),It.store.render()}Re.keydown=function(le){(le.srcElement||le.target).classList[0]==="mapboxgl-canvas"&&(le.keyCode!==8&&le.keyCode!==46||!It.options.controls.trash?Cr(le.keyCode)?xn.keydown(le):le.keyCode===49&&It.options.controls.point?Tn(Z.DRAW_POINT):le.keyCode===50&&It.options.controls.line_string?Tn(Z.DRAW_LINE_STRING):le.keyCode===51&&It.options.controls.polygon&&Tn(Z.DRAW_POLYGON):(le.preventDefault(),xn.trash()))},Re.keyup=function(le){Cr(le.keyCode)&&xn.keyup(le)},Re.zoomend=function(){It.store.changeZoom()},Re.data=function(le){if(le.dataType==="style"){var Ve=It.setup,kn=It.map,ii=It.options,Vr=It.store;ii.styles.some(function($i){return kn.getLayer($i.id)})||(Ve.addLayers(),Vr.setDirty(),Vr.render())}};var Br={trash:!1,combineFeatures:!1,uncombineFeatures:!1};return{start:function(){De=It.options.defaultMode,xn=n(xe[De](It),It)},changeMode:Tn,actionable:function(le){var Ve=!1;Object.keys(le).forEach(function(kn){if(Br[kn]===void 0)throw new Error("Invalid action type");Br[kn]!==le[kn]&&(Ve=!0),Br[kn]=le[kn]}),Ve&&It.map.fire(W.ACTIONABLE,{actions:Br})},currentModeName:function(){return De},currentModeRender:function(le,Ve){return xn.render(le,Ve)},fire:function(le,Ve){Re[le]&&Re[le](Ve)},addEventListeners:function(){It.map.on("mousemove",Re.mousemove),It.map.on("mousedown",Re.mousedown),It.map.on("mouseup",Re.mouseup),It.map.on("data",Re.data),It.map.on("touchmove",Re.touchmove),It.map.on("touchstart",Re.touchstart),It.map.on("touchend",Re.touchend),It.container.addEventListener("mouseout",Re.mouseout),It.options.keybindings&&(It.container.addEventListener("keydown",Re.keydown),It.container.addEventListener("keyup",Re.keyup))},removeEventListeners:function(){It.map.off("mousemove",Re.mousemove),It.map.off("mousedown",Re.mousedown),It.map.off("mouseup",Re.mouseup),It.map.off("data",Re.data),It.map.off("touchmove",Re.touchmove),It.map.off("touchstart",Re.touchstart),It.map.off("touchend",Re.touchend),It.container.removeEventListener("mouseout",Re.mouseout),It.options.keybindings&&(It.container.removeEventListener("keydown",Re.keydown),It.container.removeEventListener("keyup",Re.keyup))},trash:function(le){xn.trash(le)},combineFeatures:function(){xn.combineFeatures()},uncombineFeatures:function(){xn.uncombineFeatures()},getMode:function(){return De}}}(M),M.ui=function(It){var xe={},we=null,$e={mode:null,feature:null,mouse:null},Re={mode:null,feature:null,mouse:null};function De(le){Re=fe(Re,le)}function xn(){var le,Ve;if(It.container){var kn=[],ii=[];Ie.forEach(function(Vr){Re[Vr]!==$e[Vr]&&(kn.push(Vr+"-"+$e[Vr]),Re[Vr]!==null&&ii.push(Vr+"-"+Re[Vr]))}),kn.length>0&&(le=It.container.classList).remove.apply(le,kn),ii.length>0&&(Ve=It.container.classList).add.apply(Ve,ii),$e=fe($e,Re)}}function Cr(le,Ve){Ve===void 0&&(Ve={});var kn=document.createElement("button");return kn.className=C.CONTROL_BUTTON+" "+Ve.className,kn.setAttribute("title",Ve.title),Ve.container.appendChild(kn),kn.addEventListener("click",function(ii){if(ii.preventDefault(),ii.stopPropagation(),ii.target===we)return Tn(),void Ve.onDeactivate();Br(le),Ve.onActivate()},!0),kn}function Tn(){we&&(we.classList.remove(C.ACTIVE_BUTTON),we=null)}function Br(le){Tn();var Ve=xe[le];Ve&&Ve&&le!=="trash"&&(Ve.classList.add(C.ACTIVE_BUTTON),we=Ve)}return{setActiveButton:Br,queueMapClasses:De,updateMapClasses:xn,clearMapClasses:function(){De({mode:null,feature:null,mouse:null}),xn()},addButtons:function(){var le=It.options.controls,Ve=document.createElement("div");return Ve.className=C.CONTROL_GROUP+" "+C.CONTROL_BASE,le&&(le[B.LINE]&&(xe[B.LINE]=Cr(B.LINE,{container:Ve,className:C.CONTROL_BUTTON_LINE,title:"LineString tool "+(It.options.keybindings?"(l)":""),onActivate:function(){return It.events.changeMode(Z.DRAW_LINE_STRING)},onDeactivate:function(){return It.events.trash()}})),le[B.POLYGON]&&(xe[B.POLYGON]=Cr(B.POLYGON,{container:Ve,className:C.CONTROL_BUTTON_POLYGON,title:"Polygon tool "+(It.options.keybindings?"(p)":""),onActivate:function(){return It.events.changeMode(Z.DRAW_POLYGON)},onDeactivate:function(){return It.events.trash()}})),le[B.POINT]&&(xe[B.POINT]=Cr(B.POINT,{container:Ve,className:C.CONTROL_BUTTON_POINT,title:"Marker tool "+(It.options.keybindings?"(m)":""),onActivate:function(){return It.events.changeMode(Z.DRAW_POINT)},onDeactivate:function(){return It.events.trash()}})),le.trash&&(xe.trash=Cr("trash",{container:Ve,className:C.CONTROL_BUTTON_TRASH,title:"Delete",onActivate:function(){It.events.trash()}})),le.combine_features&&(xe.combine_features=Cr("combineFeatures",{container:Ve,className:C.CONTROL_BUTTON_COMBINE_FEATURES,title:"Combine",onActivate:function(){It.events.combineFeatures()}})),le.uncombine_features&&(xe.uncombine_features=Cr("uncombineFeatures",{container:Ve,className:C.CONTROL_BUTTON_UNCOMBINE_FEATURES,title:"Uncombine",onActivate:function(){It.events.uncombineFeatures()}}))),Ve},removeButtons:function(){Object.keys(xe).forEach(function(le){var Ve=xe[le];Ve.parentNode&&Ve.parentNode.removeChild(Ve),delete xe[le]})}}}(M),M.container=Ct.getContainer(),M.store=new vt(M),D=M.ui.addButtons(),M.options.boxSelect&&(Ct.boxZoom.disable(),Ct.dragPan.disable(),Ct.dragPan.enable()),Ct.loaded()?gt.connect():(Ct.on("load",gt.connect),J=setInterval(function(){Ct.loaded()&&gt.connect()},16)),M.events.start(),D},addLayers:function(){M.map.addSource(A.COLD,{data:{type:j.FEATURE_COLLECTION,features:[]},type:"geojson"}),M.map.addSource(A.HOT,{data:{type:j.FEATURE_COLLECTION,features:[]},type:"geojson"}),M.options.styles.forEach(function(Ct){M.map.addLayer(Ct)}),M.store.setDirty(!0),M.store.render()},removeLayers:function(){M.options.styles.forEach(function(Ct){M.map.getLayer(Ct.id)&&M.map.removeLayer(Ct.id)}),M.map.getSource(A.COLD)&&M.map.removeSource(A.COLD),M.map.getSource(A.HOT)&&M.map.removeSource(A.HOT)}};return M.setup=gt,gt}var Me=[{id:"gl-draw-polygon-fill-inactive",type:"fill",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],paint:{"fill-color":"#3bb2d0","fill-outline-color":"#3bb2d0","fill-opacity":.1}},{id:"gl-draw-polygon-fill-active",type:"fill",filter:["all",["==","active","true"],["==","$type","Polygon"]],paint:{"fill-color":"#fbb03b","fill-outline-color":"#fbb03b","fill-opacity":.1}},{id:"gl-draw-polygon-midpoint",type:"circle",filter:["all",["==","$type","Point"],["==","meta","midpoint"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-stroke-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-polygon-stroke-active",type:"line",filter:["all",["==","active","true"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-line-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","LineString"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-line-active",type:"line",filter:["all",["==","$type","LineString"],["==","active","true"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-polygon-and-line-vertex-stroke-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-color":"#fff"}},{id:"gl-draw-polygon-and-line-vertex-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-point-point-stroke-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-opacity":1,"circle-color":"#fff"}},{id:"gl-draw-point-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#3bb2d0"}},{id:"gl-draw-point-stroke-active",type:"circle",filter:["all",["==","$type","Point"],["==","active","true"],["!=","meta","midpoint"]],paint:{"circle-radius":7,"circle-color":"#fff"}},{id:"gl-draw-point-active",type:"circle",filter:["all",["==","$type","Point"],["!=","meta","midpoint"],["==","active","true"]],paint:{"circle-radius":5,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-fill-static",type:"fill",filter:["all",["==","mode","static"],["==","$type","Polygon"]],paint:{"fill-color":"#404040","fill-outline-color":"#404040","fill-opacity":.1}},{id:"gl-draw-polygon-stroke-static",type:"line",filter:["all",["==","mode","static"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-line-static",type:"line",filter:["all",["==","mode","static"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-point-static",type:"circle",filter:["all",["==","mode","static"],["==","$type","Point"]],paint:{"circle-radius":5,"circle-color":"#404040"}}];function ze(M){return function(D){var J=D.featureTarget;return!!J&&!!J.properties&&J.properties.meta===M}}function ve(M){return!!M.originalEvent&&!!M.originalEvent.shiftKey&&M.originalEvent.button===0}function Ye(M){return!!M.featureTarget&&!!M.featureTarget.properties&&M.featureTarget.properties.active===tt.ACTIVE&&M.featureTarget.properties.meta===V.FEATURE}function Ke(M){return!!M.featureTarget&&!!M.featureTarget.properties&&M.featureTarget.properties.active===tt.INACTIVE&&M.featureTarget.properties.meta===V.FEATURE}function on(M){return M.featureTarget===void 0}function vn(M){return!!M.featureTarget&&!!M.featureTarget.properties&&M.featureTarget.properties.meta===V.FEATURE}function Mn(M){var D=M.featureTarget;return!!D&&!!D.properties&&D.properties.meta===V.VERTEX}function Xn(M){return!!M.originalEvent&&M.originalEvent.shiftKey===!0}function Yn(M){return M.keyCode===27}function nr(M){return M.keyCode===13}var Rr=Object.freeze({__proto__:null,isOfMetaType:ze,isShiftMousedown:ve,isActiveFeature:Ye,isInactiveFeature:Ke,noTarget:on,isFeature:vn,isVertex:Mn,isShiftDown:Xn,isEscapeKey:Yn,isEnterKey:nr,isTrue:function(){return!0}}),Io=Ui;function Ui(M,D){this.x=M,this.y=D}function Zi(M,D){var J=D.getBoundingClientRect();return new Io(M.clientX-J.left-(D.clientLeft||0),M.clientY-J.top-(D.clientTop||0))}function xo(M,D,J,gt){return{type:j.FEATURE,properties:{meta:V.VERTEX,parent:M,coord_path:J,active:gt?tt.ACTIVE:tt.INACTIVE},geometry:{type:j.POINT,coordinates:D}}}function ni(M,D,J){var gt=D.geometry.coordinates,Ct=J.geometry.coordinates;if(gt[1]>85||gt[1]<et||Ct[1]>85||Ct[1]<et)return null;var St={lng:(gt[0]+Ct[0])/2,lat:(gt[1]+Ct[1])/2};return{type:j.FEATURE,properties:{meta:V.MIDPOINT,parent:M,lng:St.lng,lat:St.lat,coord_path:J.properties.coord_path},geometry:{type:j.POINT,coordinates:[St.lng,St.lat]}}}function di(M,D,J){D===void 0&&(D={}),J===void 0&&(J=null);var gt,Ct=M.geometry,St=Ct.type,It=Ct.coordinates,xe=M.properties&&M.properties.id,we=[];function $e(De,xn){var Cr="",Tn=null;De.forEach(function(Br,le){var Ve=xn!=null?xn+"."+le:String(le),kn=xo(xe,Br,Ve,Re(Ve));if(D.midpoints&&Tn){var ii=ni(xe,Tn,kn);ii&&we.push(ii)}Tn=kn;var Vr=JSON.stringify(Br);Cr!==Vr&&we.push(kn),le===0&&(Cr=Vr)})}function Re(De){return!!D.selectedPaths&&D.selectedPaths.indexOf(De)!==-1}return St===j.POINT?we.push(xo(xe,It,J,Re(J))):St===j.POLYGON?It.forEach(function(De,xn){$e(De,J!==null?J+"."+xn:String(xn))}):St===j.LINE_STRING?$e(It,J):St.indexOf(j.MULTI_PREFIX)===0&&(gt=St.replace(j.MULTI_PREFIX,""),It.forEach(function(De,xn){var Cr={type:j.FEATURE,properties:M.properties,geometry:{type:gt,coordinates:De}};we=we.concat(di(Cr,D,xn))})),we}Ui.prototype={clone:function(){return new Ui(this.x,this.y)},add:function(M){return this.clone()._add(M)},sub:function(M){return this.clone()._sub(M)},multByPoint:function(M){return this.clone()._multByPoint(M)},divByPoint:function(M){return this.clone()._divByPoint(M)},mult:function(M){return this.clone()._mult(M)},div:function(M){return this.clone()._div(M)},rotate:function(M){return this.clone()._rotate(M)},rotateAround:function(M,D){return this.clone()._rotateAround(M,D)},matMult:function(M){return this.clone()._matMult(M)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(M){return this.x===M.x&&this.y===M.y},dist:function(M){return Math.sqrt(this.distSqr(M))},distSqr:function(M){var D=M.x-this.x,J=M.y-this.y;return D*D+J*J},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(M){return Math.atan2(this.y-M.y,this.x-M.x)},angleWith:function(M){return this.angleWithSep(M.x,M.y)},angleWithSep:function(M,D){return Math.atan2(this.x*D-this.y*M,this.x*M+this.y*D)},_matMult:function(M){var D=M[0]*this.x+M[1]*this.y,J=M[2]*this.x+M[3]*this.y;return this.x=D,this.y=J,this},_add:function(M){return this.x+=M.x,this.y+=M.y,this},_sub:function(M){return this.x-=M.x,this.y-=M.y,this},_mult:function(M){return this.x*=M,this.y*=M,this},_div:function(M){return this.x/=M,this.y/=M,this},_multByPoint:function(M){return this.x*=M.x,this.y*=M.y,this},_divByPoint:function(M){return this.x/=M.x,this.y/=M.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var M=this.y;return this.y=this.x,this.x=-M,this},_rotate:function(M){var D=Math.cos(M),J=Math.sin(M),gt=D*this.x-J*this.y,Ct=J*this.x+D*this.y;return this.x=gt,this.y=Ct,this},_rotateAround:function(M,D){var J=Math.cos(M),gt=Math.sin(M),Ct=D.x+J*(this.x-D.x)-gt*(this.y-D.y),St=D.y+gt*(this.x-D.x)+J*(this.y-D.y);return this.x=Ct,this.y=St,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Ui.convert=function(M){return M instanceof Ui?M:Array.isArray(M)?new Ui(M[0],M[1]):M};var hi={enable:function(M){setTimeout(function(){M.map&&M.map.doubleClickZoom&&M._ctx&&M._ctx.store&&M._ctx.store.getInitialConfigValue&&M._ctx.store.getInitialConfigValue("doubleClickZoom")&&M.map.doubleClickZoom.enable()},0)},disable:function(M){setTimeout(function(){M.map&&M.map.doubleClickZoom&&M.map.doubleClickZoom.disable()},0)}},xa={},us={get exports(){return xa},set exports(M){xa=M}},Po=function(M){if(!M||!M.type)return null;var D=ds[M.type];if(!D)return null;if(D==="geometry")return{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:M}]};if(D==="feature")return{type:"FeatureCollection",features:[M]};if(D==="featurecollection")return M},ds={Point:"geometry",MultiPoint:"geometry",LineString:"geometry",MultiLineString:"geometry",Polygon:"geometry",MultiPolygon:"geometry",GeometryCollection:"geometry",Feature:"feature",FeatureCollection:"featurecollection"},mc=Object.freeze({__proto__:null,default:function M(D){switch(D&&D.type||null){case"FeatureCollection":return D.features=D.features.reduce(function(J,gt){return J.concat(M(gt))},[]),D;case"Feature":return D.geometry?M(D.geometry).map(function(J){var gt={type:"Feature",properties:JSON.parse(JSON.stringify(D.properties)),geometry:J};return D.id!==void 0&&(gt.id=D.id),gt}):[D];case"MultiPoint":return D.coordinates.map(function(J){return{type:"Point",coordinates:J}});case"MultiPolygon":return D.coordinates.map(function(J){return{type:"Polygon",coordinates:J}});case"MultiLineString":return D.coordinates.map(function(J){return{type:"LineString",coordinates:J}});case"GeometryCollection":return D.geometries.map(M).reduce(function(J,gt){return J.concat(gt)},[]);case"Point":case"Polygon":case"LineString":return[D]}}}),gc=Po,wa=i(mc),hs=function(M){return function D(J){return Array.isArray(J)&&J.length&&typeof J[0]=="number"?[J]:J.reduce(function(gt,Ct){return Array.isArray(Ct)&&Array.isArray(Ct[0])?gt.concat(D(Ct)):(gt.push(Ct),gt)},[])}(M)};wa instanceof Function||(wa=wa.default);var Xi={},Fa={get exports(){return Xi},set exports(M){Xi=M}}.exports=function(M){return new Yi(M)};function Yi(M){this.value=M}function Na(M,D,J){var gt=[],Ct=[],St=!0;return function It(xe){var we=J?ct(xe):xe,$e={},Re=!0,De={node:we,node_:xe,path:[].concat(gt),parent:Ct[Ct.length-1],parents:Ct,key:gt.slice(-1)[0],isRoot:gt.length===0,level:gt.length,circular:null,update:function(Tn,Br){De.isRoot||(De.parent.node[De.key]=Tn),De.node=Tn,Br&&(Re=!1)},delete:function(Tn){delete De.parent.node[De.key],Tn&&(Re=!1)},remove:function(Tn){st(De.parent.node)?De.parent.node.splice(De.key,1):delete De.parent.node[De.key],Tn&&(Re=!1)},keys:null,before:function(Tn){$e.before=Tn},after:function(Tn){$e.after=Tn},pre:function(Tn){$e.pre=Tn},post:function(Tn){$e.post=Tn},stop:function(){St=!1},block:function(){Re=!1}};if(!St)return De;function xn(){if(typeof De.node=="object"&&De.node!==null){De.keys&&De.node_===De.node||(De.keys=G(De.node)),De.isLeaf=De.keys.length==0;for(var Tn=0;Tn<Ct.length;Tn++)if(Ct[Tn].node_===xe){De.circular=Ct[Tn];break}}else De.isLeaf=!0,De.keys=null;De.notLeaf=!De.isLeaf,De.notRoot=!De.isRoot}xn();var Cr=D.call(De,De.node);return Cr!==void 0&&De.update&&De.update(Cr),$e.before&&$e.before.call(De,De.node),Re&&(typeof De.node!="object"||De.node===null||De.circular||(Ct.push(De),xn(),pt(De.keys,function(Tn,Br){gt.push(Tn),$e.pre&&$e.pre.call(De,De.node[Tn],Tn);var le=It(De.node[Tn]);J&&kt.call(De.node,Tn)&&(De.node[Tn]=le.node),le.isLast=Br==De.keys.length-1,le.isFirst=Br==0,$e.post&&$e.post.call(De,le),gt.pop()}),Ct.pop()),$e.after&&$e.after.call(De,De.node)),De}(M).node}function ct(M){if(typeof M=="object"&&M!==null){var D;if(st(M))D=[];else if(Y(M)==="[object Date]")D=new Date(M.getTime?M.getTime():M);else if(function(Ct){return Y(Ct)==="[object RegExp]"}(M))D=new RegExp(M);else if(function(Ct){return Y(Ct)==="[object Error]"}(M))D={message:M.message};else if(function(Ct){return Y(Ct)==="[object Boolean]"}(M))D=new Boolean(M);else if(function(Ct){return Y(Ct)==="[object Number]"}(M))D=new Number(M);else if(function(Ct){return Y(Ct)==="[object String]"}(M))D=new String(M);else if(Object.create&&Object.getPrototypeOf)D=Object.create(Object.getPrototypeOf(M));else if(M.constructor===Object)D={};else{var J=M.constructor&&M.constructor.prototype||M.__proto__||{},gt=function(){};gt.prototype=J,D=new gt}return pt(G(M),function(Ct){D[Ct]=M[Ct]}),D}return M}Yi.prototype.get=function(M){for(var D=this.value,J=0;J<M.length;J++){var gt=M[J];if(!D||!kt.call(D,gt)){D=void 0;break}D=D[gt]}return D},Yi.prototype.has=function(M){for(var D=this.value,J=0;J<M.length;J++){var gt=M[J];if(!D||!kt.call(D,gt))return!1;D=D[gt]}return!0},Yi.prototype.set=function(M,D){for(var J=this.value,gt=0;gt<M.length-1;gt++){var Ct=M[gt];kt.call(J,Ct)||(J[Ct]={}),J=J[Ct]}return J[M[gt]]=D,D},Yi.prototype.map=function(M){return Na(this.value,M,!0)},Yi.prototype.forEach=function(M){return this.value=Na(this.value,M,!1),this.value},Yi.prototype.reduce=function(M,D){var J=arguments.length===1,gt=J?this.value:D;return this.forEach(function(Ct){this.isRoot&&J||(gt=M.call(this,gt,Ct))}),gt},Yi.prototype.paths=function(){var M=[];return this.forEach(function(D){M.push(this.path)}),M},Yi.prototype.nodes=function(){var M=[];return this.forEach(function(D){M.push(this.node)}),M},Yi.prototype.clone=function(){var M=[],D=[];return function J(gt){for(var Ct=0;Ct<M.length;Ct++)if(M[Ct]===gt)return D[Ct];if(typeof gt=="object"&&gt!==null){var St=ct(gt);return M.push(gt),D.push(St),pt(G(gt),function(It){St[It]=J(gt[It])}),M.pop(),D.pop(),St}return gt}(this.value)};var G=Object.keys||function(M){var D=[];for(var J in M)D.push(J);return D};function Y(M){return Object.prototype.toString.call(M)}var st=Array.isArray||function(M){return Object.prototype.toString.call(M)==="[object Array]"},pt=function(M,D){if(M.forEach)return M.forEach(D);for(var J=0;J<M.length;J++)D(M[J],J,M)};pt(G(Yi.prototype),function(M){Fa[M]=function(D){var J=[].slice.call(arguments,1),gt=new Yi(D);return gt[M].apply(gt,J)}});var kt=Object.hasOwnProperty||function(M,D){return D in M},Bt=Lt;function Lt(M){if(!(this instanceof Lt))return new Lt(M);this._bbox=M||[1/0,1/0,-1/0,-1/0],this._valid=!!M}Lt.prototype.include=function(M){return this._valid=!0,this._bbox[0]=Math.min(this._bbox[0],M[0]),this._bbox[1]=Math.min(this._bbox[1],M[1]),this._bbox[2]=Math.max(this._bbox[2],M[0]),this._bbox[3]=Math.max(this._bbox[3],M[1]),this},Lt.prototype.equals=function(M){var D;return D=M instanceof Lt?M.bbox():M,this._bbox[0]==D[0]&&this._bbox[1]==D[1]&&this._bbox[2]==D[2]&&this._bbox[3]==D[3]},Lt.prototype.center=function(M){return this._valid?[(this._bbox[0]+this._bbox[2])/2,(this._bbox[1]+this._bbox[3])/2]:null},Lt.prototype.union=function(M){var D;return this._valid=!0,D=M instanceof Lt?M.bbox():M,this._bbox[0]=Math.min(this._bbox[0],D[0]),this._bbox[1]=Math.min(this._bbox[1],D[1]),this._bbox[2]=Math.max(this._bbox[2],D[2]),this._bbox[3]=Math.max(this._bbox[3],D[3]),this},Lt.prototype.bbox=function(){return this._valid?this._bbox:null},Lt.prototype.contains=function(M){if(!M)return this._fastContains();if(!this._valid)return null;var D=M[0],J=M[1];return this._bbox[0]<=D&&this._bbox[1]<=J&&this._bbox[2]>=D&&this._bbox[3]>=J},Lt.prototype.intersect=function(M){return this._valid?(D=M instanceof Lt?M.bbox():M,!(this._bbox[0]>D[2]||this._bbox[2]<D[0]||this._bbox[3]<D[1]||this._bbox[1]>D[3])):null;var D},Lt.prototype._fastContains=function(){if(!this._valid)return new Function("return null;");var M="return "+this._bbox[0]+"<= ll[0] &&"+this._bbox[1]+"<= ll[1] &&"+this._bbox[2]+">= ll[0] &&"+this._bbox[3]+">= ll[1]";return new Function("ll",M)},Lt.prototype.polygon=function(){return this._valid?{type:"Polygon",coordinates:[[[this._bbox[0],this._bbox[1]],[this._bbox[2],this._bbox[1]],[this._bbox[2],this._bbox[3]],[this._bbox[0],this._bbox[3]],[this._bbox[0],this._bbox[1]]]]}:null};var At=function(M){if(!M)return[];var D=wa(gc(M)),J=[];return D.features.forEach(function(gt){gt.geometry&&(J=J.concat(hs(gt.geometry.coordinates)))}),J},Ut=Xi,ae=Bt,Oe={features:["FeatureCollection"],coordinates:["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],geometry:["Feature"],geometries:["GeometryCollection"]},me=Object.keys(Oe);function rn(M){for(var D=ae(),J=At(M),gt=0;gt<J.length;gt++)D.include(J[gt]);return D}us.exports=function(M){return rn(M).bbox()},xa.polygon=function(M){return rn(M).polygon()},xa.bboxify=function(M){return Ut(M).map(function(D){D&&me.some(function(J){return!!D[J]&&Oe[J].indexOf(D.type)!==-1})&&(D.bbox=rn(D).bbox(),this.update(D))})};var tn=-90;function en(M,D){var J=tn,gt=90,Ct=tn,St=90,It=270,xe=-270;M.forEach(function($e){var Re=xa($e),De=Re[1],xn=Re[3],Cr=Re[0],Tn=Re[2];De>J&&(J=De),xn<gt&&(gt=xn),xn>Ct&&(Ct=xn),De<St&&(St=De),Cr<It&&(It=Cr),Tn>xe&&(xe=Tn)});var we=D;return J+we.lat>85&&(we.lat=85-J),Ct+we.lat>90&&(we.lat=90-Ct),gt+we.lat<-85&&(we.lat=-85-gt),St+we.lat<tn&&(we.lat=tn-St),It+we.lng<=-270&&(we.lng+=360*Math.ceil(Math.abs(we.lng)/360)),xe+we.lng>=270&&(we.lng-=360*Math.ceil(Math.abs(we.lng)/360)),we}function dn(M,D){var J=en(M.map(function(gt){return gt.toGeoJSON()}),D);M.forEach(function(gt){var Ct,St=gt.getCoordinates(),It=function(we){var $e={lng:we[0]+J.lng,lat:we[1]+J.lat};return[$e.lng,$e.lat]},xe=function(we){return we.map(function($e){return It($e)})};gt.type===j.POINT?Ct=It(St):gt.type===j.LINE_STRING||gt.type===j.MULTI_POINT?Ct=St.map(It):gt.type===j.POLYGON||gt.type===j.MULTI_LINE_STRING?Ct=St.map(xe):gt.type===j.MULTI_POLYGON&&(Ct=St.map(function(we){return we.map(function($e){return xe($e)})})),gt.incomingCoords(Ct)})}var an={onSetup:function(M){var D=this,J={dragMoveLocation:null,boxSelectStartLocation:null,boxSelectElement:void 0,boxSelecting:!1,canBoxSelect:!1,dragMoving:!1,canDragMove:!1,initiallySelectedFeatureIds:M.featureIds||[]};return this.setSelected(J.initiallySelectedFeatureIds.filter(function(gt){return D.getFeature(gt)!==void 0})),this.fireActionable(),this.setActionableState({combineFeatures:!0,uncombineFeatures:!0,trash:!0}),J},fireUpdate:function(){this.map.fire(W.UPDATE,{action:H.MOVE,features:this.getSelected().map(function(M){return M.toGeoJSON()})})},fireActionable:function(){var M=this,D=this.getSelected(),J=D.filter(function(xe){return M.isInstanceOf("MultiFeature",xe)}),gt=!1;if(D.length>1){gt=!0;var Ct=D[0].type.replace("Multi","");D.forEach(function(xe){xe.type.replace("Multi","")!==Ct&&(gt=!1)})}var St=J.length>0,It=D.length>0;this.setActionableState({combineFeatures:gt,uncombineFeatures:St,trash:It})},getUniqueIds:function(M){return M.length?M.map(function(D){return D.properties.id}).filter(function(D){return D!==void 0}).reduce(function(D,J){return D.add(J),D},new ge).values():[]},stopExtendedInteractions:function(M){M.boxSelectElement&&(M.boxSelectElement.parentNode&&M.boxSelectElement.parentNode.removeChild(M.boxSelectElement),M.boxSelectElement=null),this.map.dragPan.enable(),M.boxSelecting=!1,M.canBoxSelect=!1,M.dragMoving=!1,M.canDragMove=!1},onStop:function(){hi.enable(this)},onMouseMove:function(M){return this.stopExtendedInteractions(M),!0},onMouseOut:function(M){return!M.dragMoving||this.fireUpdate()}};an.onTap=an.onClick=function(M,D){return on(D)?this.clickAnywhere(M,D):ze(V.VERTEX)(D)?this.clickOnVertex(M,D):vn(D)?this.clickOnFeature(M,D):void 0},an.clickAnywhere=function(M){var D=this,J=this.getSelectedIds();J.length&&(this.clearSelectedFeatures(),J.forEach(function(gt){return D.doRender(gt)})),hi.enable(this),this.stopExtendedInteractions(M)},an.clickOnVertex=function(M,D){this.changeMode(Z.DIRECT_SELECT,{featureId:D.featureTarget.properties.parent,coordPath:D.featureTarget.properties.coord_path,startPos:D.lngLat}),this.updateUIClasses({mouse:P.MOVE})},an.startOnActiveFeature=function(M,D){this.stopExtendedInteractions(M),this.map.dragPan.disable(),this.doRender(D.featureTarget.properties.id),M.canDragMove=!0,M.dragMoveLocation=D.lngLat},an.clickOnFeature=function(M,D){var J=this;hi.disable(this),this.stopExtendedInteractions(M);var gt=Xn(D),Ct=this.getSelectedIds(),St=D.featureTarget.properties.id,It=this.isSelected(St);if(!gt&&It&&this.getFeature(St).type!==j.POINT)return this.changeMode(Z.DIRECT_SELECT,{featureId:St});It&&gt?(this.deselect(St),this.updateUIClasses({mouse:P.POINTER}),Ct.length===1&&hi.enable(this)):!It&&gt?(this.select(St),this.updateUIClasses({mouse:P.MOVE})):It||gt||(Ct.forEach(function(xe){return J.doRender(xe)}),this.setSelected(St),this.updateUIClasses({mouse:P.MOVE})),this.doRender(St)},an.onMouseDown=function(M,D){return Ye(D)?this.startOnActiveFeature(M,D):this.drawConfig.boxSelect&&ve(D)?this.startBoxSelect(M,D):void 0},an.startBoxSelect=function(M,D){this.stopExtendedInteractions(M),this.map.dragPan.disable(),M.boxSelectStartLocation=Zi(D.originalEvent,this.map.getContainer()),M.canBoxSelect=!0},an.onTouchStart=function(M,D){if(Ye(D))return this.startOnActiveFeature(M,D)},an.onDrag=function(M,D){return M.canDragMove?this.dragMove(M,D):this.drawConfig.boxSelect&&M.canBoxSelect?this.whileBoxSelect(M,D):void 0},an.whileBoxSelect=function(M,D){M.boxSelecting=!0,this.updateUIClasses({mouse:P.ADD}),M.boxSelectElement||(M.boxSelectElement=document.createElement("div"),M.boxSelectElement.classList.add(C.BOX_SELECT),this.map.getContainer().appendChild(M.boxSelectElement));var J=Zi(D.originalEvent,this.map.getContainer()),gt=Math.min(M.boxSelectStartLocation.x,J.x),Ct=Math.max(M.boxSelectStartLocation.x,J.x),St=Math.min(M.boxSelectStartLocation.y,J.y),It=Math.max(M.boxSelectStartLocation.y,J.y),xe="translate("+gt+"px, "+St+"px)";M.boxSelectElement.style.transform=xe,M.boxSelectElement.style.WebkitTransform=xe,M.boxSelectElement.style.width=Ct-gt+"px",M.boxSelectElement.style.height=It-St+"px"},an.dragMove=function(M,D){M.dragMoving=!0,D.originalEvent.stopPropagation();var J={lng:D.lngLat.lng-M.dragMoveLocation.lng,lat:D.lngLat.lat-M.dragMoveLocation.lat};dn(this.getSelected(),J),M.dragMoveLocation=D.lngLat},an.onTouchEnd=an.onMouseUp=function(M,D){var J=this;if(M.dragMoving)this.fireUpdate();else if(M.boxSelecting){var gt=[M.boxSelectStartLocation,Zi(D.originalEvent,this.map.getContainer())],Ct=this.featuresAt(null,gt,"click"),St=this.getUniqueIds(Ct).filter(function(It){return!J.isSelected(It)});St.length&&(this.select(St),St.forEach(function(It){return J.doRender(It)}),this.updateUIClasses({mouse:P.MOVE}))}this.stopExtendedInteractions(M)},an.toDisplayFeatures=function(M,D,J){D.properties.active=this.isSelected(D.properties.id)?tt.ACTIVE:tt.INACTIVE,J(D),this.fireActionable(),D.properties.active===tt.ACTIVE&&D.geometry.type!==j.POINT&&di(D).forEach(J)},an.onTrash=function(){this.deleteFeature(this.getSelectedIds()),this.fireActionable()},an.onCombineFeatures=function(){var M=this.getSelected();if(!(M.length===0||M.length<2)){for(var D=[],J=[],gt=M[0].type.replace("Multi",""),Ct=0;Ct<M.length;Ct++){var St=M[Ct];if(St.type.replace("Multi","")!==gt)return;St.type.includes("Multi")?St.getCoordinates().forEach(function(xe){D.push(xe)}):D.push(St.getCoordinates()),J.push(St.toGeoJSON())}if(J.length>1){var It=this.newFeature({type:j.FEATURE,properties:J[0].properties,geometry:{type:"Multi"+gt,coordinates:D}});this.addFeature(It),this.deleteFeature(this.getSelectedIds(),{silent:!0}),this.setSelected([It.id]),this.map.fire(W.COMBINE_FEATURES,{createdFeatures:[It.toGeoJSON()],deletedFeatures:J})}this.fireActionable()}},an.onUncombineFeatures=function(){var M=this,D=this.getSelected();if(D.length!==0){for(var J=[],gt=[],Ct=function(It){var xe=D[It];M.isInstanceOf("MultiFeature",xe)&&(xe.getFeatures().forEach(function(we){M.addFeature(we),we.properties=xe.properties,J.push(we.toGeoJSON()),M.select([we.id])}),M.deleteFeature(xe.id,{silent:!0}),gt.push(xe.toGeoJSON()))},St=0;St<D.length;St++)Ct(St);J.length>1&&this.map.fire(W.UNCOMBINE_FEATURES,{createdFeatures:J,deletedFeatures:gt}),this.fireActionable()}};var tr=ze(V.VERTEX),hn=ze(V.MIDPOINT),qn={fireUpdate:function(){this.map.fire(W.UPDATE,{action:H.CHANGE_COORDINATES,features:this.getSelected().map(function(M){return M.toGeoJSON()})})},fireActionable:function(M){this.setActionableState({combineFeatures:!1,uncombineFeatures:!1,trash:M.selectedCoordPaths.length>0})},startDragging:function(M,D){this.map.dragPan.disable(),M.canDragMove=!0,M.dragMoveLocation=D.lngLat},stopDragging:function(M){this.map.dragPan.enable(),M.dragMoving=!1,M.canDragMove=!1,M.dragMoveLocation=null},onVertex:function(M,D){this.startDragging(M,D);var J=D.featureTarget.properties,gt=M.selectedCoordPaths.indexOf(J.coord_path);Xn(D)||gt!==-1?Xn(D)&&gt===-1&&M.selectedCoordPaths.push(J.coord_path):M.selectedCoordPaths=[J.coord_path];var Ct=this.pathsToCoordinates(M.featureId,M.selectedCoordPaths);this.setSelectedCoordinates(Ct)},onMidpoint:function(M,D){this.startDragging(M,D);var J=D.featureTarget.properties;M.feature.addCoordinate(J.coord_path,J.lng,J.lat),this.fireUpdate(),M.selectedCoordPaths=[J.coord_path]},pathsToCoordinates:function(M,D){return D.map(function(J){return{feature_id:M,coord_path:J}})},onFeature:function(M,D){M.selectedCoordPaths.length===0?this.startDragging(M,D):this.stopDragging(M)},dragFeature:function(M,D,J){dn(this.getSelected(),J),M.dragMoveLocation=D.lngLat},dragVertex:function(M,D,J){for(var gt=M.selectedCoordPaths.map(function(xe){return M.feature.getCoordinate(xe)}),Ct=en(gt.map(function(xe){return{type:j.FEATURE,properties:{},geometry:{type:j.POINT,coordinates:xe}}}),J),St=0;St<gt.length;St++){var It=gt[St];M.feature.updateCoordinate(M.selectedCoordPaths[St],It[0]+Ct.lng,It[1]+Ct.lat)}},clickNoTarget:function(){this.changeMode(Z.SIMPLE_SELECT)},clickInactive:function(){this.changeMode(Z.SIMPLE_SELECT)},clickActiveFeature:function(M){M.selectedCoordPaths=[],this.clearSelectedCoordinates(),M.feature.changed()},onSetup:function(M){var D=M.featureId,J=this.getFeature(D);if(!J)throw new Error("You must provide a featureId to enter direct_select mode");if(J.type===j.POINT)throw new TypeError("direct_select mode doesn't handle point features");var gt={featureId:D,feature:J,dragMoveLocation:M.startPos||null,dragMoving:!1,canDragMove:!1,selectedCoordPaths:M.coordPath?[M.coordPath]:[]};return this.setSelectedCoordinates(this.pathsToCoordinates(D,gt.selectedCoordPaths)),this.setSelected(D),hi.disable(this),this.setActionableState({trash:!0}),gt},onStop:function(){hi.enable(this),this.clearSelectedCoordinates()},toDisplayFeatures:function(M,D,J){M.featureId===D.properties.id?(D.properties.active=tt.ACTIVE,J(D),di(D,{map:this.map,midpoints:!0,selectedPaths:M.selectedCoordPaths}).forEach(J)):(D.properties.active=tt.INACTIVE,J(D)),this.fireActionable(M)},onTrash:function(M){M.selectedCoordPaths.sort(function(D,J){return J.localeCompare(D,"en",{numeric:!0})}).forEach(function(D){return M.feature.removeCoordinate(D)}),this.fireUpdate(),M.selectedCoordPaths=[],this.clearSelectedCoordinates(),this.fireActionable(M),M.feature.isValid()===!1&&(this.deleteFeature([M.featureId]),this.changeMode(Z.SIMPLE_SELECT,{}))},onMouseMove:function(M,D){var J=Ye(D),gt=tr(D),Ct=M.selectedCoordPaths.length===0;return J&&Ct||gt&&!Ct?this.updateUIClasses({mouse:P.MOVE}):this.updateUIClasses({mouse:P.NONE}),this.stopDragging(M),!0},onMouseOut:function(M){return M.dragMoving&&this.fireUpdate(),!0}};qn.onTouchStart=qn.onMouseDown=function(M,D){return tr(D)?this.onVertex(M,D):Ye(D)?this.onFeature(M,D):hn(D)?this.onMidpoint(M,D):void 0},qn.onDrag=function(M,D){if(M.canDragMove===!0){M.dragMoving=!0,D.originalEvent.stopPropagation();var J={lng:D.lngLat.lng-M.dragMoveLocation.lng,lat:D.lngLat.lat-M.dragMoveLocation.lat};M.selectedCoordPaths.length>0?this.dragVertex(M,D,J):this.dragFeature(M,D,J),M.dragMoveLocation=D.lngLat}},qn.onClick=function(M,D){return on(D)?this.clickNoTarget(M,D):Ye(D)?this.clickActiveFeature(M,D):Ke(D)?this.clickInactive(M,D):void this.stopDragging(M)},qn.onTap=function(M,D){return on(D)?this.clickNoTarget(M,D):Ye(D)?this.clickActiveFeature(M,D):Ke(D)?this.clickInactive(M,D):void 0},qn.onTouchEnd=qn.onMouseUp=function(M){M.dragMoving&&this.fireUpdate(),this.stopDragging(M)};var Fn={};function Wo(M,D){return!!M.lngLat&&M.lngLat.lng===D[0]&&M.lngLat.lat===D[1]}Fn.onSetup=function(){var M=this.newFeature({type:j.FEATURE,properties:{},geometry:{type:j.POINT,coordinates:[]}});return this.addFeature(M),this.clearSelectedFeatures(),this.updateUIClasses({mouse:P.ADD}),this.activateUIButton(B.POINT),this.setActionableState({trash:!0}),{point:M}},Fn.stopDrawingAndRemove=function(M){this.deleteFeature([M.point.id],{silent:!0}),this.changeMode(Z.SIMPLE_SELECT)},Fn.onTap=Fn.onClick=function(M,D){this.updateUIClasses({mouse:P.MOVE}),M.point.updateCoordinate("",D.lngLat.lng,D.lngLat.lat),this.map.fire(W.CREATE,{features:[M.point.toGeoJSON()]}),this.changeMode(Z.SIMPLE_SELECT,{featureIds:[M.point.id]})},Fn.onStop=function(M){this.activateUIButton(),M.point.getCoordinate().length||this.deleteFeature([M.point.id],{silent:!0})},Fn.toDisplayFeatures=function(M,D,J){var gt=D.properties.id===M.point.id;if(D.properties.active=gt?tt.ACTIVE:tt.INACTIVE,!gt)return J(D)},Fn.onTrash=Fn.stopDrawingAndRemove,Fn.onKeyUp=function(M,D){if(Yn(D)||nr(D))return this.stopDrawingAndRemove(M,D)};var Ki={onSetup:function(){var M=this.newFeature({type:j.FEATURE,properties:{},geometry:{type:j.POLYGON,coordinates:[[]]}});return this.addFeature(M),this.clearSelectedFeatures(),hi.disable(this),this.updateUIClasses({mouse:P.ADD}),this.activateUIButton(B.POLYGON),this.setActionableState({trash:!0}),{polygon:M,currentVertexPosition:0}},clickAnywhere:function(M,D){if(M.currentVertexPosition>0&&Wo(D,M.polygon.coordinates[0][M.currentVertexPosition-1]))return this.changeMode(Z.SIMPLE_SELECT,{featureIds:[M.polygon.id]});this.updateUIClasses({mouse:P.ADD}),M.polygon.updateCoordinate("0."+M.currentVertexPosition,D.lngLat.lng,D.lngLat.lat),M.currentVertexPosition++,M.polygon.updateCoordinate("0."+M.currentVertexPosition,D.lngLat.lng,D.lngLat.lat)},clickOnVertex:function(M){return this.changeMode(Z.SIMPLE_SELECT,{featureIds:[M.polygon.id]})},onMouseMove:function(M,D){M.polygon.updateCoordinate("0."+M.currentVertexPosition,D.lngLat.lng,D.lngLat.lat),Mn(D)&&this.updateUIClasses({mouse:P.POINTER})}};Ki.onTap=Ki.onClick=function(M,D){return Mn(D)?this.clickOnVertex(M,D):this.clickAnywhere(M,D)},Ki.onKeyUp=function(M,D){Yn(D)?(this.deleteFeature([M.polygon.id],{silent:!0}),this.changeMode(Z.SIMPLE_SELECT)):nr(D)&&this.changeMode(Z.SIMPLE_SELECT,{featureIds:[M.polygon.id]})},Ki.onStop=function(M){this.updateUIClasses({mouse:P.NONE}),hi.enable(this),this.activateUIButton(),this.getFeature(M.polygon.id)!==void 0&&(M.polygon.removeCoordinate("0."+M.currentVertexPosition),M.polygon.isValid()?this.map.fire(W.CREATE,{features:[M.polygon.toGeoJSON()]}):(this.deleteFeature([M.polygon.id],{silent:!0}),this.changeMode(Z.SIMPLE_SELECT,{},{silent:!0})))},Ki.toDisplayFeatures=function(M,D,J){var gt=D.properties.id===M.polygon.id;if(D.properties.active=gt?tt.ACTIVE:tt.INACTIVE,!gt)return J(D);if(D.geometry.coordinates.length!==0){var Ct=D.geometry.coordinates[0].length;if(!(Ct<3)){if(D.properties.meta=V.FEATURE,J(xo(M.polygon.id,D.geometry.coordinates[0][0],"0.0",!1)),Ct>3){var St=D.geometry.coordinates[0].length-3;J(xo(M.polygon.id,D.geometry.coordinates[0][St],"0."+St,!1))}if(Ct<=4){var It=[[D.geometry.coordinates[0][0][0],D.geometry.coordinates[0][0][1]],[D.geometry.coordinates[0][1][0],D.geometry.coordinates[0][1][1]]];if(J({type:j.FEATURE,properties:D.properties,geometry:{coordinates:It,type:j.LINE_STRING}}),Ct===3)return}return J(D)}}},Ki.onTrash=function(M){this.deleteFeature([M.polygon.id],{silent:!0}),this.changeMode(Z.SIMPLE_SELECT)};var Kt={onSetup:function(M){var D,J,gt=(M=M||{}).featureId,Ct="forward";if(gt){if(!(D=this.getFeature(gt)))throw new Error("Could not find a feature with the provided featureId");var St=M.from;if(St&&St.type==="Feature"&&St.geometry&&St.geometry.type==="Point"&&(St=St.geometry),St&&St.type==="Point"&&St.coordinates&&St.coordinates.length===2&&(St=St.coordinates),!St||!Array.isArray(St))throw new Error("Please use the `from` property to indicate which point to continue the line from");var It=D.coordinates.length-1;if(D.coordinates[It][0]===St[0]&&D.coordinates[It][1]===St[1])J=It+1,D.addCoordinate.apply(D,[J].concat(D.coordinates[It]));else{if(D.coordinates[0][0]!==St[0]||D.coordinates[0][1]!==St[1])throw new Error("`from` should match the point at either the start or the end of the provided LineString");Ct="backwards",J=0,D.addCoordinate.apply(D,[J].concat(D.coordinates[0]))}}else D=this.newFeature({type:j.FEATURE,properties:{},geometry:{type:j.LINE_STRING,coordinates:[]}}),J=0,this.addFeature(D);return this.clearSelectedFeatures(),hi.disable(this),this.updateUIClasses({mouse:P.ADD}),this.activateUIButton(B.LINE),this.setActionableState({trash:!0}),{line:D,currentVertexPosition:J,direction:Ct}},clickAnywhere:function(M,D){if(M.currentVertexPosition>0&&Wo(D,M.line.coordinates[M.currentVertexPosition-1])||M.direction==="backwards"&&Wo(D,M.line.coordinates[M.currentVertexPosition+1]))return this.changeMode(Z.SIMPLE_SELECT,{featureIds:[M.line.id]});this.updateUIClasses({mouse:P.ADD}),M.line.updateCoordinate(M.currentVertexPosition,D.lngLat.lng,D.lngLat.lat),M.direction==="forward"?(M.currentVertexPosition++,M.line.updateCoordinate(M.currentVertexPosition,D.lngLat.lng,D.lngLat.lat)):M.line.addCoordinate(0,D.lngLat.lng,D.lngLat.lat)},clickOnVertex:function(M){return this.changeMode(Z.SIMPLE_SELECT,{featureIds:[M.line.id]})},onMouseMove:function(M,D){M.line.updateCoordinate(M.currentVertexPosition,D.lngLat.lng,D.lngLat.lat),Mn(D)&&this.updateUIClasses({mouse:P.POINTER})}};Kt.onTap=Kt.onClick=function(M,D){if(Mn(D))return this.clickOnVertex(M,D);this.clickAnywhere(M,D)},Kt.onKeyUp=function(M,D){nr(D)?this.changeMode(Z.SIMPLE_SELECT,{featureIds:[M.line.id]}):Yn(D)&&(this.deleteFeature([M.line.id],{silent:!0}),this.changeMode(Z.SIMPLE_SELECT))},Kt.onStop=function(M){hi.enable(this),this.activateUIButton(),this.getFeature(M.line.id)!==void 0&&(M.line.removeCoordinate(""+M.currentVertexPosition),M.line.isValid()?this.map.fire(W.CREATE,{features:[M.line.toGeoJSON()]}):(this.deleteFeature([M.line.id],{silent:!0}),this.changeMode(Z.SIMPLE_SELECT,{},{silent:!0})))},Kt.onTrash=function(M){this.deleteFeature([M.line.id],{silent:!0}),this.changeMode(Z.SIMPLE_SELECT)},Kt.toDisplayFeatures=function(M,D,J){var gt=D.properties.id===M.line.id;if(D.properties.active=gt?tt.ACTIVE:tt.INACTIVE,!gt)return J(D);D.geometry.coordinates.length<2||(D.properties.meta=V.FEATURE,J(xo(M.line.id,D.geometry.coordinates[M.direction==="forward"?D.geometry.coordinates.length-2:1],""+(M.direction==="forward"?D.geometry.coordinates.length-2:1),!1)),J(D))};var ia={simple_select:an,direct_select:qn,draw_point:Fn,draw_polygon:Ki,draw_line_string:Kt},ri={defaultMode:Z.SIMPLE_SELECT,keybindings:!0,touchEnabled:!0,clickBuffer:2,touchBuffer:25,boxSelect:!0,displayControlsDefault:!0,styles:Me,modes:ia,controls:{},userProperties:!1},ja={point:!0,line_string:!0,polygon:!0,trash:!0,combine_features:!0,uncombine_features:!0},Xd={point:!1,line_string:!1,polygon:!1,trash:!1,combine_features:!1,uncombine_features:!1};function Zo(M,D){return M.map(function(J){return J.source?J:fe(J,{id:J.id+"."+D,source:D==="hot"?A.HOT:A.COLD})})}var Ea={};(function(M,D){var J="__lodash_hash_undefined__",gt=9007199254740991,Ct="[object Arguments]",St="[object Array]",It="[object Boolean]",xe="[object Date]",we="[object Error]",$e="[object Function]",Re="[object Map]",De="[object Number]",xn="[object Object]",Cr="[object Promise]",Tn="[object RegExp]",Br="[object Set]",le="[object String]",Ve="[object Symbol]",kn="[object WeakMap]",ii="[object ArrayBuffer]",Vr="[object DataView]",$i=/^\[object .+?Constructor\]$/,Ji=/^(?:0|[1-9]\d*)$/,Lr={};Lr["[object Float32Array]"]=Lr["[object Float64Array]"]=Lr["[object Int8Array]"]=Lr["[object Int16Array]"]=Lr["[object Int32Array]"]=Lr["[object Uint8Array]"]=Lr["[object Uint8ClampedArray]"]=Lr["[object Uint16Array]"]=Lr["[object Uint32Array]"]=!0,Lr[Ct]=Lr[St]=Lr[ii]=Lr[It]=Lr[Vr]=Lr[xe]=Lr[we]=Lr[$e]=Lr[Re]=Lr[De]=Lr[xn]=Lr[Tn]=Lr[Br]=Lr[le]=Lr[kn]=!1;var Tl=typeof bo=="object"&&bo&&bo.Object===Object&&bo,fi=typeof self=="object"&&self&&self.Object===Object&&self,Eo=Tl||fi||Function("return this")(),_c=D&&!D.nodeType&&D,Us=_c&&M&&!M.nodeType&&M,ki=Us&&Us.exports===_c,$s=ki&&Tl.process,ps=function(){try{return $s&&$s.binding&&$s.binding("util")}catch{}}(),oa=ps&&ps.isTypedArray;function kl(Dt,te){for(var Be=-1,pn=Dt==null?0:Dt.length;++Be<pn;)if(te(Dt[Be],Be,Dt))return!0;return!1}function yc(Dt){var te=-1,Be=Array(Dt.size);return Dt.forEach(function(pn,Sr){Be[++te]=[Sr,pn]}),Be}function Tf(Dt){var te=-1,Be=Array(Dt.size);return Dt.forEach(function(pn){Be[++te]=pn}),Be}var bc,ms,Lu,Cl=Array.prototype,Vs=Function.prototype,Xo=Object.prototype,Gs=Eo["__core-js_shared__"],Ta=Vs.toString,oi=Xo.hasOwnProperty,qs=(bc=/[^.]+$/.exec(Gs&&Gs.keys&&Gs.keys.IE_PROTO||""))?"Symbol(src)_1."+bc:"",zu=Xo.toString,Kd=RegExp("^"+Ta.call(oi).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Sl=ki?Eo.Buffer:void 0,Ml=Eo.Symbol,vc=Eo.Uint8Array,xc=Xo.propertyIsEnumerable,Hs=Cl.splice,Ua=Ml?Ml.toStringTag:void 0,Al=Object.getOwnPropertySymbols,wc=Sl?Sl.isBuffer:void 0,Ou=(ms=Object.keys,Lu=Object,function(Dt){return ms(Lu(Dt))}),ka=vs(Eo,"DataView"),Hn=vs(Eo,"Map"),gs=vs(Eo,"Promise"),Il=vs(Eo,"Set"),_s=vs(Eo,"WeakMap"),Ca=vs(Object,"create"),Ec=Ko(ka),Tc=Ko(Hn),Du=Ko(gs),kc=Ko(Il),Ru=Ko(_s),Sa=Ml?Ml.prototype:void 0,Ma=Sa?Sa.valueOf:void 0;function aa(Dt){var te=-1,Be=Dt==null?0:Dt.length;for(this.clear();++te<Be;){var pn=Dt[te];this.set(pn[0],pn[1])}}function Yo(Dt){var te=-1,Be=Dt==null?0:Dt.length;for(this.clear();++te<Be;){var pn=Dt[te];this.set(pn[0],pn[1])}}function An(Dt){var te=-1,Be=Dt==null?0:Dt.length;for(this.clear();++te<Be;){var pn=Dt[te];this.set(pn[0],pn[1])}}function $a(Dt){var te=-1,Be=Dt==null?0:Dt.length;for(this.__data__=new An;++te<Be;)this.add(Dt[te])}function Aa(Dt){var te=this.__data__=new Yo(Dt);this.size=te.size}function Jd(Dt,te){var Be=Zs(Dt),pn=!Be&&zl(Dt),Sr=!Be&&!pn&&Lo(Dt),er=!Be&&!pn&&!Sr&&Dl(Dt),Gr=Be||pn||Sr||er,pi=Gr?function(ai,Jo){for(var lo=-1,Qi=Array(ai);++lo<ai;)Qi[lo]=Jo(lo);return Qi}(Dt.length,String):[],Li=pi.length;for(var mi in Dt)!te&&!oi.call(Dt,mi)||Gr&&(mi=="length"||Sr&&(mi=="offset"||mi=="parent")||er&&(mi=="buffer"||mi=="byteLength"||mi=="byteOffset")||Ll(mi,Li))||pi.push(mi);return pi}function Ws(Dt,te){for(var Be=Dt.length;Be--;)if(Fu(Dt[Be][0],te))return Be;return-1}function ys(Dt){return Dt==null?Dt===void 0?"[object Undefined]":"[object Null]":Ua&&Ua in Object(Dt)?function(te){var Be=oi.call(te,Ua),pn=te[Ua];try{te[Ua]=void 0;var Sr=!0}catch{}var er=zu.call(te);return Sr&&(Be?te[Ua]=pn:delete te[Ua]),er}(Dt):function(te){return zu.call(te)}(Dt)}function Cc(Dt){return xs(Dt)&&ys(Dt)==Ct}function Bu(Dt,te,Be,pn,Sr){return Dt===te||(Dt==null||te==null||!xs(Dt)&&!xs(te)?Dt!=Dt&&te!=te:function(er,Gr,pi,Li,mi,ai){var Jo=Zs(er),lo=Zs(Gr),Qi=Jo?St:Va(er),sa=lo?St:Va(Gr),ws=(Qi=Qi==Ct?xn:Qi)==xn,Rl=(sa=sa==Ct?xn:sa)==xn,Ga=Qi==sa;if(Ga&&Lo(er)){if(!Lo(Gr))return!1;Jo=!0,ws=!1}if(Ga&&!ws)return ai||(ai=new Aa),Jo||Dl(er)?Mc(er,Gr,pi,Li,mi,ai):function(xr,dr,Xs,to,qa,Vi,co){switch(Xs){case Vr:if(xr.byteLength!=dr.byteLength||xr.byteOffset!=dr.byteOffset)return!1;xr=xr.buffer,dr=dr.buffer;case ii:return!(xr.byteLength!=dr.byteLength||!Vi(new vc(xr),new vc(dr)));case It:case xe:case De:return Fu(+xr,+dr);case we:return xr.name==dr.name&&xr.message==dr.message;case Tn:case le:return xr==dr+"";case Re:var To=yc;case Br:var ko=1&to;if(To||(To=Tf),xr.size!=dr.size&&!ko)return!1;var Es=co.get(xr);if(Es)return Es==dr;to|=2,co.set(xr,dr);var In=Mc(To(xr),To(dr),to,qa,Vi,co);return co.delete(xr),In;case Ve:if(Ma)return Ma.call(xr)==Ma.call(dr)}return!1}(er,Gr,Qi,pi,Li,mi,ai);if(!(1&pi)){var Bl=ws&&oi.call(er,"__wrapped__"),Ic=Rl&&oi.call(Gr,"__wrapped__");if(Bl||Ic){var ju=Bl?er.value():er,th=Ic?Gr.value():Gr;return ai||(ai=new Aa),mi(ju,th,pi,Li,ai)}}return Ga?(ai||(ai=new Aa),function(xr,dr,Xs,to,qa,Vi){var co=1&Xs,To=Pl(xr),ko=To.length,Es=Pl(dr).length;if(ko!=Es&&!co)return!1;for(var In=ko;In--;){var la=To[In];if(!(co?la in dr:oi.call(dr,la)))return!1}var eh=Vi.get(xr);if(eh&&Vi.get(dr))return eh==dr;var Ys=!0;Vi.set(xr,dr),Vi.set(dr,xr);for(var Ts=co;++In<ko;){var Ks=xr[la=To[In]],Fl=dr[la];if(to)var Nl=co?to(Fl,Ks,la,dr,xr,Vi):to(Ks,Fl,la,xr,dr,Vi);if(!(Nl===void 0?Ks===Fl||qa(Ks,Fl,Xs,to,Vi):Nl)){Ys=!1;break}Ts||(Ts=la=="constructor")}if(Ys&&!Ts){var jl=xr.constructor,ks=dr.constructor;jl==ks||!("constructor"in xr)||!("constructor"in dr)||typeof jl=="function"&&jl instanceof jl&&typeof ks=="function"&&ks instanceof ks||(Ys=!1)}return Vi.delete(xr),Vi.delete(dr),Ys}(er,Gr,pi,Li,mi,ai)):!1}(Dt,te,Be,pn,Bu,Sr))}function kf(Dt){return!(!Ol(Dt)||function(te){return!!qs&&qs in te}(Dt))&&(Ac(Dt)?Kd:$i).test(Ko(Dt))}function Sc(Dt){if(Be=(te=Dt)&&te.constructor,pn=typeof Be=="function"&&Be.prototype||Xo,te!==pn)return Ou(Dt);var te,Be,pn,Sr=[];for(var er in Object(Dt))oi.call(Dt,er)&&er!="constructor"&&Sr.push(er);return Sr}function Mc(Dt,te,Be,pn,Sr,er){var Gr=1&Be,pi=Dt.length,Li=te.length;if(pi!=Li&&!(Gr&&Li>pi))return!1;var mi=er.get(Dt);if(mi&&er.get(te))return mi==te;var ai=-1,Jo=!0,lo=2&Be?new $a:void 0;for(er.set(Dt,te),er.set(te,Dt);++ai<pi;){var Qi=Dt[ai],sa=te[ai];if(pn)var ws=Gr?pn(sa,Qi,ai,te,Dt,er):pn(Qi,sa,ai,Dt,te,er);if(ws!==void 0){if(ws)continue;Jo=!1;break}if(lo){if(!kl(te,function(Rl,Ga){if(Bl=Ga,!lo.has(Bl)&&(Qi===Rl||Sr(Qi,Rl,Be,pn,er)))return lo.push(Ga);var Bl})){Jo=!1;break}}else if(Qi!==sa&&!Sr(Qi,sa,Be,pn,er)){Jo=!1;break}}return er.delete(Dt),er.delete(te),Jo}function Pl(Dt){return function(te,Be,pn){var Sr=Be(te);return Zs(te)?Sr:function(er,Gr){for(var pi=-1,Li=Gr.length,mi=er.length;++pi<Li;)er[mi+pi]=Gr[pi];return er}(Sr,pn(te))}(Dt,Cf,Qd)}function bs(Dt,te){var Be,pn,Sr=Dt.__data__;return((pn=typeof(Be=te))=="string"||pn=="number"||pn=="symbol"||pn=="boolean"?Be!=="__proto__":Be===null)?Sr[typeof te=="string"?"string":"hash"]:Sr.map}function vs(Dt,te){var Be=function(pn,Sr){return pn==null?void 0:pn[Sr]}(Dt,te);return kf(Be)?Be:void 0}aa.prototype.clear=function(){this.__data__=Ca?Ca(null):{},this.size=0},aa.prototype.delete=function(Dt){var te=this.has(Dt)&&delete this.__data__[Dt];return this.size-=te?1:0,te},aa.prototype.get=function(Dt){var te=this.__data__;if(Ca){var Be=te[Dt];return Be===J?void 0:Be}return oi.call(te,Dt)?te[Dt]:void 0},aa.prototype.has=function(Dt){var te=this.__data__;return Ca?te[Dt]!==void 0:oi.call(te,Dt)},aa.prototype.set=function(Dt,te){var Be=this.__data__;return this.size+=this.has(Dt)?0:1,Be[Dt]=Ca&&te===void 0?J:te,this},Yo.prototype.clear=function(){this.__data__=[],this.size=0},Yo.prototype.delete=function(Dt){var te=this.__data__,Be=Ws(te,Dt);return!(Be<0)&&(Be==te.length-1?te.pop():Hs.call(te,Be,1),--this.size,!0)},Yo.prototype.get=function(Dt){var te=this.__data__,Be=Ws(te,Dt);return Be<0?void 0:te[Be][1]},Yo.prototype.has=function(Dt){return Ws(this.__data__,Dt)>-1},Yo.prototype.set=function(Dt,te){var Be=this.__data__,pn=Ws(Be,Dt);return pn<0?(++this.size,Be.push([Dt,te])):Be[pn][1]=te,this},An.prototype.clear=function(){this.size=0,this.__data__={hash:new aa,map:new(Hn||Yo),string:new aa}},An.prototype.delete=function(Dt){var te=bs(this,Dt).delete(Dt);return this.size-=te?1:0,te},An.prototype.get=function(Dt){return bs(this,Dt).get(Dt)},An.prototype.has=function(Dt){return bs(this,Dt).has(Dt)},An.prototype.set=function(Dt,te){var Be=bs(this,Dt),pn=Be.size;return Be.set(Dt,te),this.size+=Be.size==pn?0:1,this},$a.prototype.add=$a.prototype.push=function(Dt){return this.__data__.set(Dt,J),this},$a.prototype.has=function(Dt){return this.__data__.has(Dt)},Aa.prototype.clear=function(){this.__data__=new Yo,this.size=0},Aa.prototype.delete=function(Dt){var te=this.__data__,Be=te.delete(Dt);return this.size=te.size,Be},Aa.prototype.get=function(Dt){return this.__data__.get(Dt)},Aa.prototype.has=function(Dt){return this.__data__.has(Dt)},Aa.prototype.set=function(Dt,te){var Be=this.__data__;if(Be instanceof Yo){var pn=Be.__data__;if(!Hn||pn.length<199)return pn.push([Dt,te]),this.size=++Be.size,this;Be=this.__data__=new An(pn)}return Be.set(Dt,te),this.size=Be.size,this};var Qd=Al?function(Dt){return Dt==null?[]:(Dt=Object(Dt),function(te,Be){for(var pn=-1,Sr=te==null?0:te.length,er=0,Gr=[];++pn<Sr;){var pi=te[pn];Be(pi,pn,te)&&(Gr[er++]=pi)}return Gr}(Al(Dt),function(te){return xc.call(Dt,te)}))}:function(){return[]},Va=ys;function Ll(Dt,te){return!!(te=te==null?gt:te)&&(typeof Dt=="number"||Ji.test(Dt))&&Dt>-1&&Dt%1==0&&Dt<te}function Ko(Dt){if(Dt!=null){try{return Ta.call(Dt)}catch{}try{return Dt+""}catch{}}return""}function Fu(Dt,te){return Dt===te||Dt!=Dt&&te!=te}(ka&&Va(new ka(new ArrayBuffer(1)))!=Vr||Hn&&Va(new Hn)!=Re||gs&&Va(gs.resolve())!=Cr||Il&&Va(new Il)!=Br||_s&&Va(new _s)!=kn)&&(Va=function(Dt){var te=ys(Dt),Be=te==xn?Dt.constructor:void 0,pn=Be?Ko(Be):"";if(pn)switch(pn){case Ec:return Vr;case Tc:return Re;case Du:return Cr;case kc:return Br;case Ru:return kn}return te});var zl=Cc(function(){return arguments}())?Cc:function(Dt){return xs(Dt)&&oi.call(Dt,"callee")&&!xc.call(Dt,"callee")},Zs=Array.isArray,Lo=wc||function(){return!1};function Ac(Dt){if(!Ol(Dt))return!1;var te=ys(Dt);return te==$e||te=="[object GeneratorFunction]"||te=="[object AsyncFunction]"||te=="[object Proxy]"}function Nu(Dt){return typeof Dt=="number"&&Dt>-1&&Dt%1==0&&Dt<=gt}function Ol(Dt){var te=typeof Dt;return Dt!=null&&(te=="object"||te=="function")}function xs(Dt){return Dt!=null&&typeof Dt=="object"}var Dl=oa?function(Dt){return function(te){return Dt(te)}}(oa):function(Dt){return xs(Dt)&&Nu(Dt.length)&&!!Lr[ys(Dt)]};function Cf(Dt){return(te=Dt)!=null&&Nu(te.length)&&!Ac(te)?Jd(Dt):Sc(Dt);var te}M.exports=function(Dt,te){return Bu(Dt,te)}})({get exports(){return Ea},set exports(M){Ea=M}},Ea);var Yd=Ea;function fs(M,D){return M.length===D.length&&JSON.stringify(M.map(function(J){return J}).sort())===JSON.stringify(D.map(function(J){return J}).sort())}var Se={Polygon:_r,LineString:Zn,Point:ur,MultiPolygon:Ce,MultiLineString:Ce,MultiPoint:Ce},Dn=Object.freeze({__proto__:null,CommonSelectors:Rr,constrainFeatureMovement:en,createMidPoint:ni,createSupplementaryPoints:di,createVertex:xo,doubleClickZoom:hi,euclideanDistance:Ze,featuresAt:Ue,getFeatureAtAndSetCursors:se,isClick:gn,isEventAtCoordinates:Wo,isTap:_n,mapEventToBoundingBox:oe,ModeHandler:n,moveFeatures:dn,sortFeatures:jt,stringSetsAreEqual:fs,StringSet:ge,theme:Me,toDenseArray:Qe}),zn=function(M,D){var J={options:M=function(Ct){Ct===void 0&&(Ct={});var St=fe(Ct);return Ct.controls||(St.controls={}),Ct.displayControlsDefault===!1?St.controls=fe(Xd,Ct.controls):St.controls=fe(ja,Ct.controls),(St=fe(ri,St)).styles=Zo(St.styles,"cold").concat(Zo(St.styles,"hot")),St}(M)};D=function(Ct,St){return St.modes=Z,St.getFeatureIdsAt=function(It){return Ue.click({point:It},null,Ct).map(function(xe){return xe.properties.id})},St.getSelectedIds=function(){return Ct.store.getSelectedIds()},St.getSelected=function(){return{type:j.FEATURE_COLLECTION,features:Ct.store.getSelectedIds().map(function(It){return Ct.store.get(It)}).map(function(It){return It.toGeoJSON()})}},St.getSelectedPoints=function(){return{type:j.FEATURE_COLLECTION,features:Ct.store.getSelectedCoordinates().map(function(It){return{type:j.FEATURE,properties:{},geometry:{type:j.POINT,coordinates:It.coordinates}}})}},St.set=function(It){if(It.type===void 0||It.type!==j.FEATURE_COLLECTION||!Array.isArray(It.features))throw new Error("Invalid FeatureCollection");var xe=Ct.store.createRenderBatch(),we=Ct.store.getAllIds().slice(),$e=St.add(It),Re=new ge($e);return(we=we.filter(function(De){return!Re.has(De)})).length&&St.delete(we),xe(),$e},St.add=function(It){var xe=JSON.parse(JSON.stringify(Po(It))).features.map(function(we){if(we.id=we.id||Gn(),we.geometry===null)throw new Error("Invalid geometry: null");if(Ct.store.get(we.id)===void 0||Ct.store.get(we.id).type!==we.geometry.type){var $e=Se[we.geometry.type];if($e===void 0)throw new Error("Invalid geometry type: "+we.geometry.type+".");var Re=new $e(Ct,we);Ct.store.add(Re)}else{var De=Ct.store.get(we.id);De.properties=we.properties,Yd(De.getCoordinates(),we.geometry.coordinates)||De.incomingCoords(we.geometry.coordinates)}return we.id});return Ct.store.render(),xe},St.get=function(It){var xe=Ct.store.get(It);if(xe)return xe.toGeoJSON()},St.getAll=function(){return{type:j.FEATURE_COLLECTION,features:Ct.store.getAll().map(function(It){return It.toGeoJSON()})}},St.delete=function(It){return Ct.store.delete(It,{silent:!0}),St.getMode()!==Z.DIRECT_SELECT||Ct.store.getSelectedIds().length?Ct.store.render():Ct.events.changeMode(Z.SIMPLE_SELECT,void 0,{silent:!0}),St},St.deleteAll=function(){return Ct.store.delete(Ct.store.getAllIds(),{silent:!0}),St.getMode()===Z.DIRECT_SELECT?Ct.events.changeMode(Z.SIMPLE_SELECT,void 0,{silent:!0}):Ct.store.render(),St},St.changeMode=function(It,xe){return xe===void 0&&(xe={}),It===Z.SIMPLE_SELECT&&St.getMode()===Z.SIMPLE_SELECT?(fs(xe.featureIds||[],Ct.store.getSelectedIds())||(Ct.store.setSelected(xe.featureIds,{silent:!0}),Ct.store.render()),St):(It===Z.DIRECT_SELECT&&St.getMode()===Z.DIRECT_SELECT&&xe.featureId===Ct.store.getSelectedIds()[0]||Ct.events.changeMode(It,xe,{silent:!0}),St)},St.getMode=function(){return Ct.events.getMode()},St.trash=function(){return Ct.events.trash({silent:!0}),St},St.combineFeatures=function(){return Ct.events.combineFeatures({silent:!0}),St},St.uncombineFeatures=function(){return Ct.events.uncombineFeatures({silent:!0}),St},St.setFeatureProperty=function(It,xe,we){return Ct.store.setFeatureProperty(It,xe,we),St},St}(J,D),J.api=D;var gt=Ge(J);return D.onAdd=gt.onAdd,D.onRemove=gt.onRemove,D.types=B,D.options=M,D};function wo(M){zn(M,this)}return wo.modes=ia,wo.constants=Pt,wo.lib=Dn,wo})})(sA);var rK=HR(sA.exports);function un(t,e,n,i){function l(d){return d instanceof n?d:new n(function(f){f(d)})}return new(n||(n=Promise))(function(d,f){function o(C){try{E(i.next(C))}catch(A){f(A)}}function y(C){try{E(i.throw(C))}catch(A){f(A)}}function E(C){C.done?d(C.value):l(C.value).then(o,y)}E((i=i.apply(t,e||[])).next())})}const lA=t=>t&&t.outerHTML!=="<div></div>",Fi=(t,e,n=[void 0])=>{const i={},l=e||Object.keys(t);for(const d of l)n.some(f=>f===t[d])||(i[d]=t[d]);return i},cA=(t,e)=>t.parent?t.parent.type?t.parent.type.name===e:t.parent.vnode.tag?t.parent.vnode.tag.endsWith(e):!1:!1,iK=(t,e)=>t.parent?t.parent.type?t.parent.type.name.includes(e):t.parent.vnode.tag?t.parent.vnode.tag.includes(e):!1:!1,Yx=(t,e,n)=>{for(const i of n)t.on(i,l=>{e.emit(i,l)})};var oK=()=>navigator.userAgent.toLowerCase().includes("safari")&&!navigator.userAgent.toLocaleLowerCase().includes("chrome");const aK=(t,e,n,i)=>un(void 0,void 0,void 0,function*(){const l=t?yield t.promise:null,d=lK(n),f=new tK(d);cA(i,"MapboxMap")&&l?l.addControl(f):(i.parent&&f.addTo(i.refs.geocoder),lA(i.refs["custom-input"])&&cK(i.refs["custom-input"],f,i)),e.resolve(f)}),sK=(t,e)=>un(void 0,void 0,void 0,function*(){const n=yield t.promise;n.on("result",i=>{e.emit("result",i.result),e.proxy.geocoderState.result=i.result}),n.on("results",i=>{e.emit("results",i),e.proxy.geocoderState.results=i}),n.on("error",i=>{e.emit("error",i),e.proxy.geocoderState.error=i}),n.on("loading",i=>{e.emit("loading",i),e.proxy.geocoderState.loading=i}),n.on("clear",()=>{e.emit("clear")})}),lK=t=>{const e=Fi(t);return e.accessToken=t.accessToken||xl.accessToken,e.mapboxgl=xl,e},cK=(t,e,n)=>{if(n&&n.proxy){n.proxy.showOriginalGeocoder&&(n.proxy.showOriginalGeocoder=!1);const i=t.getElementsByTagName("input");if(!i)throw new Error("MapboxGeocoderControl: No inputs found");const l=i[0];l.addEventListener("keyup",d=>{e.query(l.value),oK()&&(setTimeout(()=>{l.focus()},100),setTimeout(()=>{l.focus()},200))})}};var uA=gr({name:"MapboxGeocoderControl",props:{accessToken:{type:String,default:""},origin:{type:String},zoom:{type:Number},flyTo:{type:[Boolean,Object],default:()=>{}},placeholder:{type:String},proximity:{type:Object},trackProximity:{type:Boolean,default:()=>{}},collapsed:{type:Boolean,default:()=>{}},clearAndBlurOnEsc:{type:Boolean,default:()=>{}},clearOnBlur:{type:Boolean,default:()=>{}},bbox:{type:Array},countries:{type:String},types:{type:String},minLength:{type:Number},limit:{type:Number},language:{type:String},filter:{type:Function},localGeocoder:{type:Function},externalGeocoder:{type:Function},reverseGeocode:{type:Boolean,default:()=>{}},enableEventLogging:{type:Boolean,default:()=>{}},marker:{type:Boolean,default:()=>{}},render:{type:Function},getItemValue:{type:Function},mode:{type:String},localGeocoderOnly:{type:Boolean,default:()=>{}}},setup(t){const e=Pr("vmb_map",null),n=new Zd,i=so(!0),l=so({result:{},results:{},error:null,loading:null});return ji(()=>un(this,void 0,void 0,function*(){const d=qo();d&&(yield aK(e,n,t,d)),d&&(yield sK(n,d))})),Ni(()=>un(this,void 0,void 0,function*(){const d=yield n.promise;if(e){const f=yield e.promise;f._removed||f.removeControl(d)}})),$r(t,()=>un(this,void 0,void 0,function*(){})),{showOriginalGeocoder:i,geocoderState:l}}});const uK={ref:"geocoder"},dK={ref:"custom-input"};function hK(t,e,n,i,l,d){return wn(),$n("div",null,[Lb(Ee("div",uK,null,512),[[Mz,t.showOriginalGeocoder]]),Ee("div",dK,[Ao(t.$slots,"input",{result:t.geocoderState.result,results:t.geocoderState.results,error:t.geocoderState.error,loading:t.geocoderState.loading})],512)])}uA.render=hK;var rs=(t,e,n)=>t&&t.value!==void 0?$r(t,e,n):null;function fK(t,e,n){if(window.ResizeObserver)mK(t,e);else{const i=gK(t,n);$r(i,()=>{e.resize()})}}function pK(t,e){e.value&&t.touchZoomRotate.enable(),$r(e,n=>{n?t.touchZoomRotate.enable():t.touchZoomRotate.disable()})}function mK(t,e){if(!t.value)throw new Error("Could not enable auto-resize because root container could not be found");new window.ResizeObserver(()=>e.resize()).observe(t.value)}function gK(t,e){const n=qo(),i=ya(new DOMRect(0,0,0,0).toJSON());if(n){let l=t.value?t.value.getBoundingClientRect():new DOMRect(0,0,0,0);addEventListener("resize",d=>{setTimeout(()=>{if(t.value){const f=t.value.getBoundingClientRect().toJSON(),o=l.width!==f.width||l.height!==f.height;l=f,o&&Object.assign(i,f)}},e||0)})}return i}const dA=t=>({height:t.height,width:t.width,"--zoom-logo":t.zoomLogo>=.8?t.zoomLogo:1}),_K=t=>t.includes("/")?t:`mapbox://styles/mapbox/${t}`,yK=(t,e)=>{const n=Fi(t,["accessToken","antialias","attributionControl","bearing","bearingSnap","bounds","boxZoom","center","clickTolerance","collectResourceTiming","container","cooperativeGestures","crossSourceCollisions","customAttribution","doubleClickZoom","dragPan","dragRotate","fadeDuration","failIfMajorPerformanceCaveat","fitBoundsOptions","hash","interactive","keyboard","localIdeographFontFamily","logoPosition","maxBounds","maxPitch","maxTileCacheSize","maxZoom","minPitch","minZoom","pitch","pitchWithRotate","preserveDrawingBuffer","projection","refreshExpiredTiles","renderWorldCopies","scrollZoom","touchZoomRotate","trackResize","transformRequest","zoom"]);return n.style=_K(t.mapStyle),n.container=e,n},bK=(t,e,n,i)=>(()=>{const l=n.value,d=yK(t,l),f=new xl.Map(d);f.on("load",()=>{e.resolve(f)}),t.autoResize&&fK(i,f,t.autoResizeDelay),t.touchZoomRotate&&pK(f,Uv(t,"touchZoomRotate"))})(),vK=(t,e)=>{e.value=dA(t)};function xK(t,e,n){return un(this,void 0,void 0,function*(){const{cooperativeGestures:i,width:l,height:d,bearing:f,maxBounds:o,maxPitch:y,minZoom:E,maxZoom:C,minPitch:A,pitch:P,projection:B,renderWorldCopies:j,zoom:Z,mapStyle:W}=jv(e),{center:H,flyToOptions:V}=n;yield EK(t,l,d),yield TK(t,{bearing:f,maxBounds:o,maxPitch:y,minPitch:A,pitch:P,renderWorldCopies:j}),yield kK(t,{maxZoom:C,center:H,flyToOptions:V,minZoom:E,zoom:Z}),yield wK(t,W),yield CK(t,B)})}function wK(t,e){return un(this,void 0,void 0,function*(){const n=yield t.promise;$r(e,i=>n.setStyle(i))})}function EK(t,e,n){return un(this,void 0,void 0,function*(){const i=yield t.promise;$r(e,()=>i.resize()),$r(n,()=>i.resize())})}function TK(t,e){return un(this,void 0,void 0,function*(){const n=yield t.promise;rs(e.bearing,i=>n.setBearing(i)),rs(e.maxBounds,i=>n.setMaxBounds(i)),rs(e.maxPitch,i=>n.setMaxPitch(i)),rs(e.minPitch,i=>n.setMinPitch(i)),rs(e.pitch,i=>n.setPitch(i)),rs(e.renderWorldCopies,i=>n.setRenderWorldCopies(i))})}function kK(t,e){rs(e.center,n=>Lp(t,{center:n}),{deep:!0}),rs(e.flyToOptions,n=>Lp(t,{flyToOptions:n}),{deep:!0}),rs(e.maxZoom,n=>Lp(t,{maxZoom:n})),rs(e.minZoom,n=>Lp(t,{minZoom:n})),rs(e.zoom,n=>Lp(t,{zoom:n}))}function CK(t,e){return un(this,void 0,void 0,function*(){const n=yield t.promise;rs(e,i=>n.setProjection(i))})}function Lp(t,e){return un(this,void 0,void 0,function*(){const n=yield t.promise,i=e.flyToOptions?Fi(e.flyToOptions,["curve","maxDuration","minZoom","screenSpeed","speed"]):{};e.center&&(i.center=e.center),e.zoom&&(i.zoom=e.zoom),n.flyTo(i)})}const hA=["boxzoomstart","click","contextmenu","data","dataloading","dblclick","drag","dragend","dragstart","error","idle","load","mousedown","mouseenter","mouseleave","mousemouve","mouseout","mouseover","mouseup","move","moveend","movestart","pitch","pitchend","pitchstart","remove","resize","rotate","rotateend","rotatestart","sourcedata","sourcedataloading","styledata","styledataloading","styleimagemissing","touchcancel","touchend","touchstart","webglcontextlost","webglcontextrestored","wheel","zoom","zoomend","zoomstart"],SK=[...hA,"update:center","update:flyToOptions","update:zoom","update:pitch","update:bearing","loaded"],MK=(t,e)=>un(void 0,void 0,void 0,function*(){const n=yield t.promise;Yx(n,e,hA),e.emit("loaded",n),n.on("zoomend",i=>{e.emit("update:zoom",i.target.getZoom()),e.emit("update:center",i.target.getCenter().toArray())}),n.on("dragend",i=>{e.emit("update:center",i.target.getCenter().toArray())}),n.on("pitchend",i=>{e.emit("update:pitch",i.target.getPitch())}),n.on("rotateend",i=>{e.emit("update:bearing",i.target.getBearing())})}),AK=t=>{const e=["string","number","boolean"];let n=!1;return t===null&&(n=!0),e.some(i=>typeof t===i)&&(n=!0),n};function Ek(t,e="change",n="value"){const i=qo(),l=e instanceof Array?e:[e];if(!i)throw new Error("vmodel: Instance not found");const d=so(i.props[n]||t);for(const f of l)$r(d,o=>{i.emit(f,d.value)});return $r(i.props,()=>{(AK(i.props[n])?i.props[n]!==d.value:!aA(i.props[n],d.value))&&(d.value=i.props[n])}),d}var Kx=gr({name:"MapboxMap",emits:SK,props:{accessToken:{type:String,required:!0},height:{type:String,default:"100%"},width:{type:String,default:"100%"},container:{type:[Object,String],default:""},minZoom:{type:Number,default:0},maxZoom:{type:Number,default:22},minPitch:{type:Number,default:0},maxPitch:{type:Number,default:60},mapStyle:{type:[Object,String],default:"mapbox://styles/mapbox/streets-v11"},hash:{type:Boolean},interactive:{type:Boolean,default:!0},bearingSnap:{type:Number},pitchWithRotate:{type:Boolean,default:!0},clickTolerance:{type:Number},attributionControl:{type:Boolean,default:!0},customAttribution:{type:Array},logoPosition:{type:String,default:"bottom-left"},failIfMajorPerformanceCaveat:{type:Boolean},preserveDrawingBuffer:{type:Boolean},antialias:{type:Boolean},refreshExpiredTiles:{type:Boolean},maxBounds:{type:[Array,Object]},scrollZoom:{type:[Boolean,Object],default:!0},boxZoom:{type:Boolean},dragRotate:{type:Boolean,default:!0},dragPan:{type:[Object,Boolean],default:!0},keyboard:{type:Boolean},doubleClickZoom:{type:Boolean},touchZoomRotate:{type:[Boolean,Object],default:!0},trackResize:{type:Boolean,default:!0},center:{default:()=>[0,0]},zoom:{type:Number},bearing:{type:Number},pitch:{type:Number},bounds:{type:Array},fitBoundsOptions:{type:Object},renderWorldCopies:{type:Boolean,default:!0},maxTileCacheSize:{type:Number,default:null},localIdeographFontFamily:{type:String,default:"sans-serif"},transformRequest:{type:Function,default:null},collectResourceTiming:{type:Boolean,default:!1},fadeDuration:{type:Number,default:300},crossSourceCollisions:{type:Boolean,default:!0},zoomLogo:{type:Number,default:1},flyToOptions:{default:()=>({})},autoResize:{type:Boolean,default:!1},autoResizeDelay:{type:Number},cooperativeGestures:{type:Boolean,default:!1},projection:{type:String}},setup:t=>{const e=so(null),n=so(null),i=new by;na("vmb_map",i);const l=Ek(t,"update:center","center"),d=Ek(t,"update:flyToOptions","flyToOptions"),f=so(dA(t));return $r(t,o=>un(void 0,void 0,void 0,function*(){vK(o,f)})),xK(i,t,{center:l,flyToOptions:d}),ji(()=>un(void 0,void 0,void 0,function*(){const o=qo();xl.accessToken=t.accessToken,bK(t,i,n,e),o&&(yield MK(i,o))})),Ni(()=>un(void 0,void 0,void 0,function*(){(yield i.promise).remove()})),{vmb_map:i,root:e,style:f,i_center:l,i_flyToOptions:d,mapContainer:n}}});const IK={key:1};function PK(t,e,n,i,l,d){return wn(),$n("div",{style:hu(t.style),ref:"root",class:"mapbox-map"},[Ee("div",null,[Ao(t.$slots,"default")]),t.vmb_map.isResolved?(wn(),$n("div",{key:0,ref:"mapContainer",class:"map-container",style:hu({height:t.height,width:t.width})},null,4)):(wn(),$n("div",IK,[Ao(t.$slots,"loader",{},()=>[Ee("div",{style:hu(t.style)},null,4)])]))],4)}function LK(t,e){e===void 0&&(e={});var n=e.insertAt;if(!(!t||typeof document=="undefined")){var i=document.head||document.getElementsByTagName("head")[0],l=document.createElement("style");l.type="text/css",n==="top"&&i.firstChild?i.insertBefore(l,i.firstChild):i.appendChild(l),l.styleSheet?l.styleSheet.cssText=t:l.appendChild(document.createTextNode(t))}}var zK=`[data-v-55cc3ed8] .mapboxgl-ctrl-logo {
  zoom: var(--zoom-logo);
}`;LK(zK);Kx.render=PK;Kx.__scopeId="data-v-55cc3ed8";var OK={setup(){return{vmb_map:Pr("vmb_map",null)}}};const DK=t=>cA(t,"MapboxMarker"),RK=t=>Fi(t,["element","offset","anchor","color","draggable","clickTolerance","rotation","rotationAlignment","pitchAlignment","scale"]),fA=["drag","dragend","dragstart"],BK=[...fA,"update:lngLat","click"],FK=(t,e)=>{Yx(t,e,fA),t.on("dragend",n=>e.emit("update:lngLat",n.target._lngLat.toArray())),t.getElement().addEventListener("click",n=>e.emit("click",n))},NK=(t,e)=>un(void 0,void 0,void 0,function*(){const n=yield e.promise,i=Fi(t);typeof i.draggable=="boolean"&&n.setDraggable(i.draggable),i.lngLat&&n.setLngLat(i.lngLat),i.offset&&n.setOffset(i.offset),i.rotation&&n.setRotation(i.rotation),i.pitchAlignment&&n.setPitchAlignment(i.pitchAlignment),i.rotationAlignment&&n.setRotationAlignment(i.rotationAlignment)}),jK=(t,e,n,i,l,d)=>un(void 0,void 0,void 0,function*(){const f=yield e.promise;d&&lA(d.value)&&(t.element=d.value);const o=new gy.exports.Marker(t).setLngLat(l);o.addTo(f),n.resolve(o)});var pA=gr({name:"MapboxMarker",emits:BK,props:{lngLat:{default:()=>[0,0]},offset:{type:[Array],default:()=>[0,0]},anchor:{type:String,default:()=>"bottom"},color:{type:String,default:"#4668F2"},scale:{type:Number,default:1},draggable:{type:Boolean,default:!1},rotation:{type:Number,default:0},pitchAlignment:{type:String,default:"auto"},rotationAlignment:{type:String,default:"auto"}},setup(t){const{vmb_map:e}=OK.setup(),n=new Zd,i=so(null),l=RK(t);return na("vmb_marker",n),ji(()=>un(this,void 0,void 0,function*(){const d=qo();if(d&&e){yield jK(l,e,n,d,t.lngLat,i);const f=yield n.promise;FK(f,d)}})),Ni(()=>un(this,void 0,void 0,function*(){(yield n.promise).remove()})),$r(t,d=>un(this,void 0,void 0,function*(){yield NK(d,n)})),{icon:i}}});const UK={ref:"icon"},$K=["height","width"],VK={"fill-rule":"nonzero"},GK=z4('<g transform="translate(3.0, 29.0)" fill="#000000"><ellipse opacity="0.04" cx="10.5" cy="5.80029008" rx="10.5" ry="5.25002273"></ellipse><ellipse opacity="0.04" cx="10.5" cy="5.80029008" rx="10.5" ry="5.25002273"></ellipse><ellipse opacity="0.04" cx="10.5" cy="5.80029008" rx="9.5" ry="4.77275007"></ellipse><ellipse opacity="0.04" cx="10.5" cy="5.80029008" rx="8.5" ry="4.29549936"></ellipse><ellipse opacity="0.04" cx="10.5" cy="5.80029008" rx="7.5" ry="3.81822308"></ellipse><ellipse opacity="0.04" cx="10.5" cy="5.80029008" rx="6.5" ry="3.34094679"></ellipse><ellipse opacity="0.04" cx="10.5" cy="5.80029008" rx="5.5" ry="2.86367051"></ellipse><ellipse opacity="0.04" cx="10.5" cy="5.80029008" rx="4.5" ry="2.38636864"></ellipse></g>',1),qK=["fill"],HK=Ee("path",{d:"M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"},null,-1),WK=[HK],ZK=z4('<g opacity="0.25" fill="#000000"><path d="M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"></path></g><g transform="translate(6.0, 7.0)" fill="#FFFFFF"></g><g transform="translate(8.0, 8.0)"><circle fill="#000000" opacity="0.25" cx="5.5" cy="5.5" r="5.4999962"></circle><circle fill="#FFFFFF" cx="5.5" cy="5.5" r="5.4999962"></circle></g>',3);function XK(t,e,n,i,l,d){return wn(),$n("div",null,[Ee("div",UK,[Ao(t.$slots,"icon",{},()=>[(wn(),$n("svg",{display:"block",height:42*t.scale+"px",width:27*t.scale+"px",viewBox:"0 0 27 41"},[Ee("g",VK,[GK,Ee("g",{fill:t.color},WK,8,qK),ZK])],8,$K))])],512),Ao(t.$slots,"default")])}pA.render=XK;const YK=t=>{const{showCompass:e,showZoom:n,vizualizePitch:i}=t;return{showCompass:e,showZoom:n,vizualizePitch:i}},KK=(t,e,n)=>(()=>un(void 0,void 0,void 0,function*(){(yield e.promise).addControl(t,n)}))();var mA=gr({name:"MapboxNavigationControl",props:{showCompass:{type:Boolean,default:!0},showZoom:{type:Boolean,default:!0},visualizePitch:{type:Boolean,default:!1},position:{type:String,default:()=>"top-right"}},setup(t){const e=Pr("vmb_map",null),n=YK(t),i=new xl.NavigationControl(n),l=t.position;ji(()=>{e&&KK(i,e,l)}),Ni(()=>un(this,void 0,void 0,function*(){e&&(yield e.promise).removeControl(i)}))}});function JK(t,e,n,i,l,d){return wn(),$n("div")}mA.render=JK;const QK=(t,e)=>{e.getLayer(t)&&e.removeLayer(t)},tJ=(t,e)=>{e.getSource(t)&&e.removeSource(t)},eJ=t=>iK(t,"MapboxGeogeometry"),Up=t=>t/110.574,$p=(t,e)=>t/(Math.cos(e*Math.PI/180)*111.32),vy=(t,e)=>un(void 0,void 0,void 0,function*(){const n=yield t.promise,i=e;QK(i.id,n),tJ(i.id,n),n.addSource(i.id,i.getGeoJSON())}),xy=(t,e,n)=>un(void 0,void 0,void 0,function*(){const i=yield e.promise,l=n,d=Fi(t),f=i.getSource(l.id);l.updateOptions(d),f.setData(l.getGeoJSON().data)}),nJ=(t,e,n)=>un(void 0,void 0,void 0,function*(){e&&(yield e.promise).setPopup(n)}),rJ=(t,e,n)=>un(void 0,void 0,void 0,function*(){const i=yield e.promise,l=yield t.promise;if(i.id){const d=yield i.geogeometry.promise;l.on("click",i.id,f=>{const o=d.center;n.setLngLat(o).addTo(l)})}}),gA=t=>Fi(t,["closeButton","closeOnClick","closeOnMove","focusAfterOpen","anchor","offset","className","maxWidth"]),iJ=(t,e,n,i,l,d)=>un(void 0,void 0,void 0,function*(){const f=yield e.promise,o=n;d.value&&o.setDOMContent(d.value),DK(t)?yield nJ(t,i,o):eJ(t)&&l?yield rJ(e,l,o):o.addTo(f)}),_A=["close","open"],oJ=[..._A],aJ=(t,e)=>{Yx(t,e,_A)},sJ=(t,e)=>un(void 0,void 0,void 0,function*(){const n=gA(t);n.maxWidth&&e.setMaxWidth(n.maxWidth),n.offset&&e.setOffset(n.offset),t.lngLat&&e.setLngLat(t.lngLat)});var yA=gr({name:"MapboxPopup",emits:oJ,props:{lngLat:{type:[Object,Array],default:()=>[0,0]},closeButton:{type:Boolean,default:!1},closeOnClick:{type:Boolean,default:!0},closeOnMove:{type:Boolean,default:!1},anchor:{type:String,default:void 0},offset:{type:[Number,Array],default:void 0},className:{type:String},focusAfterOpen:{type:Boolean,default:!0},maxWidth:{type:String,default:"500px"},renderless:{type:Boolean,default:!1}},setup(t){const e=so(null),n=Pr("vmb_map",null),i=Pr("vmb_marker",null),l=Pr("vmb_geogeometry_paint",null),d=gA(t),f=new xl.Popup(d).setLngLat(t.lngLat);return ji(()=>un(this,void 0,void 0,function*(){const o=qo();n&&o&&(yield iJ(o,n,f,i,l,e),aJ(f,o))})),$r(t,o=>{sJ(o,f)}),Ni(()=>un(this,void 0,void 0,function*(){f.remove()})),{content:e}}});const lJ={ref:"content"};function cJ(t,e,n,i,l,d){return wn(),$n("div",lJ,[Ao(t.$slots,"default")],512)}yA.render=cJ;const uJ=t=>Fi(t),dJ=(t,e)=>un(void 0,void 0,void 0,function*(){(yield t.promise).addControl(e)});var bA=gr({name:"MapboxAttributionControl",props:{compact:{type:Boolean,default:!1},customAttribution:{type:[String,Array],default:void 0}},setup(t){const e=uJ(t),n=new xl.AttributionControl(e),i=Pr("vmb_map",null);ji(()=>un(this,void 0,void 0,function*(){i&&dJ(i,n)})),Ni(()=>un(this,void 0,void 0,function*(){i&&(yield i.promise).removeControl(n)}))}});function hJ(t,e,n,i,l,d){return wn(),$n("div")}bA.render=hJ;const fJ=t=>{const{maxWidth:e,unit:n}=t;return{maxWidth:e,unit:n}},pJ=(t,e)=>un(void 0,void 0,void 0,function*(){(yield t.promise).addControl(e)});var vA=gr({name:"MapboxScaleControl",props:{maxWidth:{type:Number,default:100},unit:{type:String,default:"metric"}},setup(t){const e=fJ(t),n=new xl.ScaleControl(e),i=Pr("vmb_map",null);ji(()=>un(this,void 0,void 0,function*(){i&&(yield pJ(i,n))})),Ni(()=>un(this,void 0,void 0,function*(){i&&(yield i.promise).removeControl(n)}))}});function mJ(t,e,n,i,l,d){return wn(),$n("div")}vA.render=mJ;const gJ=t=>Fi(t),_J=(t,e)=>un(void 0,void 0,void 0,function*(){(yield e.promise).addControl(t)});var xA=gr({name:"MapboxFullscreenControl",props:{container:{type:Object,default:void 0}},setup(t){const e=Pr("vmb_map",null),n=gJ(t),i=new xl.FullscreenControl(n);ji(()=>un(this,void 0,void 0,function*(){e&&(yield _J(i,e))})),Ni(()=>un(this,void 0,void 0,function*(){e&&(yield e.promise).removeControl(i)}))}});function yJ(t,e,n,i,l,d){return wn(),$n("div")}xA.render=yJ;const bJ=t=>Fi(t,["position"]),vJ=(t,e)=>{t.on("draw.create",n=>{e.emit("create",n)}),t.on("draw.update",n=>{e.emit("update",n)}),t.on("draw.delete",n=>{e.emit("delete",n)}),t.on("draw.selectionchange",n=>{e.emit("selectionchange",n)})},xJ=(t,e,n,i)=>un(void 0,void 0,void 0,function*(){i.emit("loaded",e);const l=yield t.promise;vJ(l,i),l.addControl(e,n.position)});var wA=gr({name:"MapboxDrawControl",props:{position:{type:String,default:"top-left"}},setup(t){const e=bJ(t),n=new rK,i=Pr("vmb_map",null);ji(()=>un(this,void 0,void 0,function*(){const l=qo();i&&l&&xJ(i,n,e,l)})),Ni(()=>un(this,void 0,void 0,function*(){i&&(yield i.promise).removeControl(n)}))}});function wJ(t,e,n,i,l,d){return wn(),$n("div")}wA.render=wJ;var EA=gr({name:"MapboxSourceGeoJson",props:{container:{type:Object,default:void 0}},setup(t){const e=Pr("vmb_map",null);new gy.exports.GeoJSONSource,ji(()=>un(this,void 0,void 0,function*(){e&&(yield e.promise).addSource}))}});const EJ={ref:"features"};function TJ(t,e,n,i,l,d){return wn(),$n("div",EJ,[Ao(t.$slots,"default")],512)}EA.render=TJ;const kJ=t=>Fi(t);var TA=gr({name:"MapboxGeolocateControl",props:{positionOptions:{type:Object,default:()=>({enableHighAccuracy:!1,timeout:6e3})},fitBoundsOptions:{type:Object,default:()=>({maxZoom:15})},trackUserLocation:{type:Boolean,default:!1},showAccuracyCircle:{type:Boolean,default:!0},showUserLocation:{type:Boolean,default:!0}},setup(t){const e=Pr("vmb_map",null),n=kJ(t),i=new xl.GeolocateControl(n);ji(()=>un(this,void 0,void 0,function*(){e&&(yield e.promise).addControl(i)})),Ni(()=>un(this,void 0,void 0,function*(){e&&(yield e.promise).removeControl(i)}))}});function CJ(t,e,n,i,l,d){return wn(),$n("div")}TA.render=CJ;class wy{constructor(e){this.id=e.id,this.fillColor=e.fillColor||"#4668F2",this.antialias=typeof e.antialias=="boolean"?e.antialias:!0,this.opacity=typeof e.opacity=="number"?e.opacity:.6,e.outlineColor&&(this.outlineColor=e.outlineColor),this.deferred=new Zd,na("vmb_geogeometry",this.deferred)}updateOptions(e){e.fillColor&&(this.fillColor=e.fillColor),typeof e.antialias=="boolean"&&(this.antialias=e.antialias),typeof e.opacity=="number"&&(this.opacity=e.opacity),e.outlineColor&&(this.outlineColor=e.outlineColor)}getPaint(){const e={};return this.fillColor&&(e["fill-color"]=this.fillColor),this.antialias&&(e["fill-antialias"]=this.antialias),this.opacity&&(e["fill-opacity"]=this.opacity),this.outlineColor&&(e["fill-outline-color"]=this.outlineColor),e}getLayer(){return{id:this.id,type:"fill",source:this.id,layout:{},paint:this.getPaint()}}}class SJ extends wy{constructor(e){super(e),this.edges=e.edges||10,this.radius=e.radius,this.center=e.center}updateOptions(e){super.updateOptions(e),e.edges&&(this.edges=e.edges),e.radius&&(this.radius=e.radius),e.center&&(this.center=e.center)}getGeoJSON(){const e=this.edges,n=$p(this.radius,this.center[1]),i=Up(this.radius),l=[];for(let d=0;d<e;d++){const f=d/e*(2*Math.PI),o=n*Math.cos(f),y=i*Math.sin(f);l.push([this.center[0]+o,this.center[1]+y])}return l.push(l[0]),{type:"geojson",data:{type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Polygon",coordinates:[l]},properties:{}}]}}}}class kA{constructor(e){this.geogeometry=e.geogeometry,this.deferred=new Zd,na("vmb_geogeometry_paint",this.deferred)}_init(e,n){return un(this,void 0,void 0,function*(){const i=yield this.geogeometry.promise;this.geoId=i.id,this.id=`${this.geoId}-${e}-${n}`})}setGeoId(e){this.geoId=e}}let Tk=0;class MJ extends kA{constructor(e){super(e),this.geoId=e.geoId,this.id=`${e.geoId}-fill-${Tk++}`,this.color=e.color||"#4668F2",this.antialias=typeof e.antialias=="boolean"?e.antialias:!0,this.opacity=typeof e.opacity=="number"?e.opacity:.6,e.outlineColor&&(this.outlineColor=e.outlineColor)}init(){const e=Object.create(null,{_init:{get:()=>super._init}});return un(this,void 0,void 0,function*(){yield e._init.call(this,"fill",Tk++)})}getPaint(){const e={};return this.color&&(e["fill-color"]=this.color),this.antialias&&(e["fill-antialias"]=this.antialias),this.opacity&&(e["fill-opacity"]=this.opacity),this.outlineColor&&(e["fill-outline-color"]=this.outlineColor),e}update(e,n){return un(this,void 0,void 0,function*(){const i=yield n.promise,l=Fi(e);this.id&&(l.color&&l.color!==this.color&&(i.setPaintProperty(this.id,"fill-color",l.color),this.color=l.color),typeof l.antialias=="boolean"&&l.antialias!==this.antialias&&(i.setPaintProperty(this.id,"fill-antialias",l.antialias),this.antialias=l.antialias),typeof l.opacity=="number"&&l.opacity!==this.opacity&&(i.setPaintProperty(this.id,"fill-opacity",l.opacity),this.opacity=l.opacity),l.outlineColor&&l.outlineColor!==this.outlineColor&&(i.setPaintProperty(this.id,"fill-outline-color",l.outlineColor),this.outlineColor=l.outlineColor))})}getLayer(){if(this.id)return{id:this.id,type:"fill",source:this.geoId,layout:{},paint:this.getPaint()};throw new Error("Geogeometry.Paint.Fill: Cannot get layer. Not initialized")}}var Ef=gr({name:"MapboxGeogeometryFill",props:{color:{type:String,default:"#4668F2"},antialias:{type:Boolean,default:!0},opacity:{type:Number,default:.6},outlineColor:{type:String}},setup(t){const e=Pr("vmb_geogeometry",null),n=new Zd,i=Pr("vmb_map",null);if(!e)throw new Error("MapboxGeogeometryFill: no geogeometry found as parent");const l=new MJ(Object.assign(Object.assign({},Fi(t)),{geogeometry:e}));return na("vmb_fill",n),ji(()=>un(this,void 0,void 0,function*(){if(i&&e){const d=yield i.promise;(yield e.promise)&&d&&(yield l.init(),d.addLayer(l.getLayer()),n.resolve(l),l.deferred.resolve(l))}})),$r(t,()=>un(this,void 0,void 0,function*(){const d=yield n.promise;d&&i&&d.update(t,i)})),Ni(()=>un(this,void 0,void 0,function*(){i&&l.id&&(yield i.promise).removeLayer(l.id)})),{}}});function AJ(t,e,n,i,l,d){return wn(),$n("div",null,[Ao(t.$slots,"default")])}Ef.render=AJ;let IJ=0;var CA=gr({name:"MapboxGeogeometryCircle",components:{MapboxGeogeometryFill:Ef},props:{id:{type:String,default:"circle"},center:{type:Array,required:!0},radius:{type:Number,required:!0},edges:{type:Number,default:10},fillColor:{type:String},outlineColor:{type:String},opacity:{type:Number},antialias:{type:Boolean}},setup(t){const e=Pr("vmb_map",null),n=new by,i=`${t.id}-${IJ++}`,l=new SJ(Fi(Object.assign(Object.assign({},t),{id:i}),["id","radius","center","edges","fillColor","outlineColor","opacity","antialias"]));na("vmb_circle",n),ji(()=>un(this,void 0,void 0,function*(){e&&(yield vy(e,l),n.resolve(l),l.deferred.resolve(l))})),$r(t,()=>un(this,void 0,void 0,function*(){e&&(yield xy(t,e,l))})),Ni(()=>un(this,void 0,void 0,function*(){e&&(yield e.promise).removeLayer(l.id)}))}});const PJ={ref:"features"};function LJ(t,e,n,i,l,d){const f=ea("mapbox-geogeometry-fill");return wn(),$n("div",PJ,[Ao(t.$slots,"default",{},()=>[ln(f,{color:t.fillColor,outlineColor:t.outlineColor,opacity:t.opacity,antialias:t.antialias},{default:Zr(()=>[Ao(t.$slots,"popup")]),_:3},8,["color","outlineColor","opacity","antialias"])])],512)}CA.render=LJ;class zJ extends wy{constructor(e){super(e),this.path=e.path}updateOptions(e){super.updateOptions(e),e.path&&(this.path=e.path)}get center(){const e=this.path.reduce((n,i)=>[n[0]+i[0],n[1]+i[1]]);return[e[0]/this.path.length,e[1]/this.path.length]}getGeoJSON(){return{type:"geojson",data:{type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Polygon",coordinates:[this.path]},properties:{}}]}}}}let OJ=0;var SA=gr({name:"MapboxGeogeometryPolygon",components:{MapboxGeogeometryFill:Ef},props:{id:{type:String,default:"polygon"},path:{type:Array,required:!0},fillColor:{type:String},outlineColor:{type:String},opacity:{type:Number},antialias:{type:Boolean}},setup(t){const e=Pr("vmb_map",null),n=new by,i=`${t.id}-${OJ++}`,l=new zJ(Fi(Object.assign(Object.assign({},t),{id:i}),["id","path","fillColor","outlineColor","opacity","antialias"]));na("vmb_polygon",n),ji(()=>un(this,void 0,void 0,function*(){e&&(yield vy(e,l),n.resolve(l),l.deferred.resolve(l))})),$r(t,()=>un(this,void 0,void 0,function*(){e&&(l.updateOptions(t),yield xy(t,e,l))})),Ni(()=>un(this,void 0,void 0,function*(){e&&(yield e.promise).removeLayer(l.id)}))}});const DJ={ref:"features"};function RJ(t,e,n,i,l,d){const f=ea("mapbox-geogeometry-fill");return wn(),$n("div",DJ,[Ao(t.$slots,"default",{},()=>[ln(f,{color:t.fillColor,outlineColor:t.outlineColor,opacity:t.opacity,antialias:t.antialias},{default:Zr(()=>[Ao(t.$slots,"popup")]),_:3},8,["color","outlineColor","opacity","antialias"])])],512)}SA.render=RJ;const BJ=(t,e)=>{if(t.length!==4)throw"MapboxGeogeometryRectangle.rotateRectagle: Not a rectangle. Please supply exactly four coordinates";const n=e*Math.PI/180,i=[];for(let l=0;l<t.length;l++)i.push([t[l][0]*Math.cos(n)-t[l][1]*Math.sin(n),t[l][0]*Math.sin(n)+t[l][1]*Math.cos(n)]);return i};class FJ extends wy{constructor(e){super(e),this.width=e.width,this.height=e.height,this.center=e.center,this.rotationDeg=e.rotationDeg||0}updateOptions(e){super.updateOptions(e),e.width&&(this.width=e.width),e.height&&(this.height=e.height),typeof e.rotationDeg=="number"&&e.rotationDeg!==this.rotationDeg&&(this.rotationDeg=e.rotationDeg)}get coordinates(){const e=BJ([[this.width/2,this.height/2],[-this.width/2,this.height/2],[-this.width/2,-this.height/2],[this.width/2,-this.height/2]],this.rotationDeg);return[[this.center[0]+$p(e[0][0],this.center[1]),this.center[1]+Up(e[0][1])],[this.center[0]+$p(e[1][0],this.center[1]),this.center[1]+Up(e[1][1])],[this.center[0]+$p(e[2][0],this.center[1]),this.center[1]+Up(e[2][1])],[this.center[0]+$p(e[3][0],this.center[1]),this.center[1]+Up(e[3][1])]]}getGeoJSON(){const e=[...this.coordinates,this.coordinates[0]];return{type:"geojson",data:{type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Polygon",coordinates:[e]},properties:{}}]}}}}let NJ=0;var MA=gr({name:"MapboxGeogeometryRectangle",components:{MapboxGeogeometryFill:Ef},props:{id:{type:String,default:"rectangle"},center:{type:Array,required:!0},width:{type:Number,required:!0},height:{type:Number,required:!0},fillColor:{type:String},outlineColor:{type:String},opacity:{type:Number,default:.6},antialias:{type:Boolean,default:!0},rotationDeg:{type:Number}},setup(t){const e=Pr("vmb_map",null),n=new by,i=`${t.id}-${NJ++}`,l=new FJ(Fi(Object.assign(Object.assign({},t),{id:i}),["id","width","height","center","fillColor","outlineColor","opacity","antialias","rotationDeg"]));na("vmb_rectangle",n),ji(()=>un(this,void 0,void 0,function*(){e&&(yield vy(e,l),n.resolve(l),l.deferred.resolve(l))})),Ni(()=>un(this,void 0,void 0,function*(){e&&(yield e.promise).removeLayer(l.id)})),$r(t,()=>un(this,void 0,void 0,function*(){e&&(yield xy(t,e,l))}))}});const jJ={ref:"features"};function UJ(t,e,n,i,l,d){const f=ea("mapbox-geogeometry-fill");return wn(),$n("div",jJ,[Ao(t.$slots,"default",{},()=>[ln(f,{color:t.fillColor,outlineColor:t.outlineColor,opacity:t.opacity,antialias:t.antialias},{default:Zr(()=>[Ao(t.$slots,"popup")]),_:3},8,["color","outlineColor","opacity","antialias"])])],512)}MA.render=UJ;const $J=t=>t.length<=1?!1:t[0][0]===t[t.length-1][0]&&t[0][1]===t[t.length-1][1],VJ=t=>t.length===0||t[0].length===2&&typeof t[0][0]=="number"&&typeof t[0][1]=="number",AA=(t,e=0,n=[0,0])=>{let i=e;const l=[n[0],n[1]];if(VJ(t)){$J(t)&&t.pop();for(const d of t)l[0]=(d[0]+l[0]*i)/(i+1),l[1]=(d[1]+l[1]*i)/(i+1),i++}else for(const d of t){const{visited:f,center:o}=AA(d);l[0]=(l[0]*i+o[0]*f)/(f+i),l[1]=(l[1]*i+o[1]*f)/(f+i),i+=f}return{visited:i,center:l}},IA=(t,e=0,n=[0,0])=>{let i=e;const l=[n[0],n[1]];switch(t.geometry.type){case"Polygon":case"LineString":{const{center:d,visited:f}=AA(t.geometry.coordinates);l[0]=(l[0]*i+d[0]*f)/(f+i),l[1]=(l[1]*i+d[1]*f)/(f+i),i+=f;break}}return{visited:i,center:l}},GJ=(t,e=0,n=[0,0])=>{let i=e;const l=[n[0],n[1]];for(const d of t.features){const{center:f,visited:o}=IA(d);l[0]=(l[0]*i+f[0]*o)/(o+i),l[1]=(l[1]*i+f[1]*o)/(o+i),i+=o;break}return{visited:i,center:l}};class qJ extends wy{constructor(e){super(e),this.source=e.source}updateOptions(e){super.updateOptions(e),e.source&&(this.source=e.source)}get center(){const e=this.getGeoJSONData();if(!e||!e.type)return console.warn("Geogeometry Raw: Could not get center. Coordinates could not be obtained"),[0,0];if(e.type==="Feature")return IA(e).center;if(e.type==="FeatureCollection")return GJ(e).center;throw new Error("Geogeometry Raw: Unknown Error getting Center")}getGeoJSON(){return this.source.type==="geojson"?this.source:{type:"geojson",data:this.source}}getGeoJSONData(){return this.getGeoJSON().data}}let HJ=0;var PA=gr({name:"MapboxGeogeometryRaw",components:{MapboxGeogeometryFill:Ef},props:{source:{type:Object,required:!0},id:{type:String,default:"raw"},fillColor:{type:String,default:"red"},outlineColor:{type:String},opacity:{type:Number},antialias:{type:Boolean}},setup(t){const e=Pr("vmb_map",null),n=new Zd,i=`${t.id}-${HJ++}`,l=new qJ(Fi(Object.assign(Object.assign({},t),{id:i}),["source","id","fillColor","outlineColor","opacity","antialias"]));na("vmb_raw",n),ji(()=>un(this,void 0,void 0,function*(){e&&(yield vy(e,l),n.resolve(l),l.deferred.resolve(l))})),$r(t,()=>un(this,void 0,void 0,function*(){e&&(l.updateOptions(t),yield xy(t,e,l))})),Ni(()=>un(this,void 0,void 0,function*(){e&&(yield e.promise).removeLayer(l.id)}))}});const WJ={ref:"features"};function ZJ(t,e,n,i,l,d){return ea("mapbox-geogeometry-fill"),wn(),$n("div",WJ,[Ao(t.$slots,"default",{},()=>[es("",!0)])],512)}PA.render=ZJ;let XJ=0;class YJ extends kA{constructor(e){super(e),this.color=e.color||"#000",this.opacity=typeof e.opacity=="number"?e.opacity:.6,e.geoId&&(this.geoId=e.geoId),typeof e.blur=="number"&&(this.blur=e.blur),e.cap&&(this.cap=e.cap),e.join&&(this.join=e.join),typeof e.width=="number"&&(this.width=e.width),e.translate&&(this.translate=e.translate),typeof e.offset=="number"&&(this.offset=e.offset),e.dasharray&&(this.dasharray=e.dasharray),typeof e.gapWidth=="number"&&(this.gapWidth=e.gapWidth),e.gradient&&(this.gradient=e.gradient),typeof e.miterLimit=="number"&&(this.miterLimit=e.miterLimit),typeof e.roundLimit=="number"&&(this.roundLimit=e.roundLimit),typeof e.sortKey=="number"&&(this.sortKey=e.sortKey),e.translateAnchor&&(this.translateAnchor=e.translateAnchor)}getPaint(){const e={"line-blur":this.blur,"line-opacity":this.opacity,"line-color":this.color,"line-width":this.width,"line-translate":this.translate,"line-offset":this.offset,"line-dasharray":this.dasharray,"line-gap-width":this.gapWidth,"line-translate-anchor":this.translateAnchor},n=Fi(e);return console.log(n),n}getLayout(){const e={"line-cap":this.cap,"line-join":this.join,"line-miter-limit":this.miterLimit,"line-round-limit":this.roundLimit,"line-sort-key":this.sortKey},n=Fi(e);return console.log(n),n}init(){return super._init("line",XJ++),this}update(e,n){return un(this,void 0,void 0,function*(){const i=yield n.promise,l=Fi(e);this.id&&(l.color&&l.color!==this.color&&(i.setPaintProperty(this.id,"line-color",l.color),this.color=l.color),typeof l.blur=="number"&&l.blur!==this.blur&&(i.setPaintProperty(this.id,"line-blur",l.blur),this.blur=l.blur),l.cap&&l.cap!==this.cap&&(i.setPaintProperty(this.id,"line-cap",l.cap),this.cap=l.cap),l.join&&l.join!==this.join&&(i.setPaintProperty(this.id,"line-join",l.join),this.join=l.join),typeof l.opacity=="number"&&l.opacity!==this.opacity&&(i.setPaintProperty(this.id,"line-opacity",l.opacity),this.opacity=l.opacity),typeof l.width=="number"&&l.width!==this.width&&(i.setPaintProperty(this.id,"line-width",l.width),this.width=l.width),l.translate&&this.translate&&(l.translate[0]!==this.translate[0]||l.translate[1]!==this.translate[1])&&(i.setPaintProperty(this.id,"line-translate",l.translate),this.translate=l.translate),typeof l.offset=="number"&&this.offset!==l.offset&&(i.setPaintProperty(this.id,"line-offset",l.offset),this.offset=l.offset),l.dasharray&&!aA(this.dasharray,l.dasharray)&&(i.setPaintProperty(this.id,"line-dasharray",l.dasharray),this.dasharray=l.dasharray),typeof l.gapWidth=="number"&&this.gapWidth!==l.gapWidth&&(i.setPaintProperty(this.id,"line-gap-width",l.gapWidth),this.gapWidth=l.gapWidth),typeof l.miterLimit=="number"&&this.miterLimit!==l.miterLimit&&(i.setPaintProperty(this.id,"line-miter-limit",l.miterLimit),this.miterLimit=l.miterLimit),typeof l.roundLimit=="number"&&this.roundLimit!==l.roundLimit&&(i.setPaintProperty(this.id,"line-round-limit",l.roundLimit),this.roundLimit=l.roundLimit),typeof l.sortKey=="number"&&(i.setPaintProperty(this.id,"line-sort-key",l.sortKey),this.sortKey=l.sortKey),l.translateAnchor&&this.translateAnchor!==l.translateAnchor&&(i.setPaintProperty(this.id,"line-translate-anchor",l.translateAnchor),this.translateAnchor=l.translateAnchor))})}getLayer(){if(this.id)return{id:this.id,type:"line",source:this.geoId,layout:this.getLayout(),paint:this.getPaint()};throw new Error("Geogeometry.Paint.Line: Cannot get Layer. Not initialized")}}var LA=gr({name:"MapboxGeogeometryLine",props:{blur:{type:Number},cap:{type:String},join:{type:String},opacity:{type:Number,default:1},color:{type:String,default:"#4668F2"},width:{type:Number},translate:{type:Array},offset:{type:Number},dasharray:{type:Array},gapWidth:{type:Number}},setup(t){const e=Pr("vmb_geogeometry",null),n=new Zd,i=Pr("vmb_map",null);if(na("vmb_paint",n),!e)throw new Error("MapboxGeogeometryLine: no geogeometry found as parent");const l=new YJ(Object.assign(Object.assign({},Fi(t)),{geogeometry:e}));return ji(()=>un(this,void 0,void 0,function*(){if(i&&e){yield l.init();const d=yield i.promise;(yield e.promise)&&d&&(d.addLayer(l.getLayer()),n.resolve(l))}})),$r(t,()=>un(this,void 0,void 0,function*(){const d=yield n.promise;d&&i&&d.update(t,i)})),Ni(()=>un(this,void 0,void 0,function*(){i&&l.id&&(yield i.promise).removeLayer(l.id)})),{}}});function KJ(t,e,n,i,l,d){return wn(),$n("div")}LA.render=KJ;var kk=Object.freeze({__proto__:null,MapboxGeocoderControl:uA,MapboxMap:Kx,MapboxMarker:pA,MapboxNavigationControl:mA,MapboxPopup:yA,MapboxAttributionControl:bA,MapboxScaleControl:vA,MapboxFullscreenControl:xA,MapboxDrawControl:wA,MapboxSourceGeoJson:EA,MapboxGeolocateControl:TA,MapboxGeogeometryCircle:CA,MapboxGeogeometryPolygon:SA,MapboxGeogeometryRectangle:MA,MapboxGeogeometryRaw:PA,MapboxGeogeometryFill:Ef,MapboxGeogeometryLine:LA}),JJ=t=>{Object.keys(kk).forEach(e=>{t.component(e,kk[e])})},Ck=yf(t=>{t.vueApp.use(JJ)}),QJ=[uR,kR,FR,Hq,Wq,NT,hk,Ck,hk,NT,Ck];const tQ={__name:"error-404",props:{appName:{type:String,default:"Nuxt"},version:{type:String,default:""},statusCode:{type:String,default:"404"},statusMessage:{type:String,default:"Not Found"},description:{type:String,default:"Sorry, the page you are looking for could not be found."},backHome:{type:String,default:"Go back home"}},setup(t,{expose:e}){e();const n=t;vl({title:`${n.statusCode} - ${n.statusMessage} | ${n.appName}`,script:[],style:[{children:'*,:before,:after{-webkit-box-sizing:border-box;box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}*{--tw-ring-inset:var(--tw-empty, );--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(14, 165, 233, .5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000}:root{-moz-tab-size:4;-o-tab-size:4;tab-size:4}a{color:inherit;text-decoration:inherit}body{margin:0;font-family:inherit;line-height:inherit}html{-webkit-text-size-adjust:100%;font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol,"Noto Color Emoji";line-height:1.5}h1,p{margin:0}h1{font-size:inherit;font-weight:inherit}'}]});const i={props:n,useHead:vl};return Object.defineProperty(i,"__isScriptSetup",{enumerable:!1,value:!0}),i}},eQ=t=>(zm("data-v-011aae6d"),t=t(),Om(),t),nQ={class:"font-sans antialiased bg-white dark:bg-black text-black dark:text-white grid min-h-screen place-content-center overflow-hidden"},rQ=eQ(()=>Ee("div",{class:"fixed left-0 right-0 spotlight z-10"},null,-1)),iQ={class:"max-w-520px text-center z-20"},oQ=["textContent"],aQ=["textContent"],sQ={class:"w-full flex items-center justify-center"};function lQ(t,e,n,i,l,d){const f=Qv;return wn(),$n("div",nQ,[rQ,Ee("div",iQ,[Ee("h1",{class:"text-8xl sm:text-10xl font-medium mb-8",textContent:Mi(n.statusCode)},null,8,oQ),Ee("p",{class:"text-xl px-8 sm:px-0 sm:text-4xl font-light mb-16 leading-tight",textContent:Mi(n.description)},null,8,aQ),Ee("div",sQ,[ln(f,{to:"/",class:"gradient-border text-md sm:text-xl py-2 px-4 sm:py-3 sm:px-6 cursor-pointer"},{default:Zr(()=>[Yr(Mi(n.backHome),1)]),_:1})])])])}var Sk=ba(tQ,[["render",lQ],["__scopeId","data-v-011aae6d"]]);const cQ={__name:"error-500",props:{appName:{type:String,default:"Nuxt"},version:{type:String,default:""},statusCode:{type:String,default:"500"},statusMessage:{type:String,default:"Server error"},description:{type:String,default:"This page is temporarily unavailable."}},setup(t,{expose:e}){e();const n=t;vl({title:`${n.statusCode} - ${n.statusMessage} | ${n.appName}`,script:[],style:[{children:'*,:before,:after{-webkit-box-sizing:border-box;box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}*{--tw-ring-inset:var(--tw-empty, );--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(14, 165, 233, .5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000}:root{-moz-tab-size:4;-o-tab-size:4;tab-size:4}body{margin:0;font-family:inherit;line-height:inherit}html{-webkit-text-size-adjust:100%;font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol,"Noto Color Emoji";line-height:1.5}h1,p{margin:0}h1{font-size:inherit;font-weight:inherit}'}]});const i={props:n,useHead:vl};return Object.defineProperty(i,"__isScriptSetup",{enumerable:!1,value:!0}),i}},uQ=t=>(zm("data-v-6aee6495"),t=t(),Om(),t),dQ={class:"font-sans antialiased bg-white dark:bg-black text-black dark:text-white grid min-h-screen place-content-center overflow-hidden"},hQ=uQ(()=>Ee("div",{class:"fixed -bottom-1/2 left-0 right-0 h-1/2 spotlight"},null,-1)),fQ={class:"max-w-520px text-center"},pQ=["textContent"],mQ=["textContent"];function gQ(t,e,n,i,l,d){return wn(),$n("div",dQ,[hQ,Ee("div",fQ,[Ee("h1",{class:"text-8xl sm:text-10xl font-medium mb-8",textContent:Mi(n.statusCode)},null,8,pQ),Ee("p",{class:"text-xl px-8 sm:px-0 sm:text-4xl font-light mb-16 leading-tight",textContent:Mi(n.description)},null,8,mQ)])])}var Mk=ba(cQ,[["render",gQ],["__scopeId","data-v-6aee6495"]]);const _Q={__name:"error-dev",props:{appName:{type:String,default:"Nuxt"},version:{type:String,default:""},statusCode:{type:String,default:"500"},statusMessage:{type:String,default:"Server error"},description:{type:String,default:"An error occurred in the application and the page could not be served. If you are the application owner, check your server logs for details."},stack:{type:String,default:""}},setup(t,{expose:e}){e();const n=t;vl({title:`${n.statusCode} - ${n.statusMessage} | ${n.appName}`,script:[],style:[{children:'*,:before,:after{-webkit-box-sizing:border-box;box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}*{--tw-ring-inset:var(--tw-empty, );--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(14, 165, 233, .5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000}:root{-moz-tab-size:4;-o-tab-size:4;tab-size:4}body{margin:0;font-family:inherit;line-height:inherit}html{-webkit-text-size-adjust:100%;font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,"Apple Color Emoji","Segoe UI Emoji",Segoe UI Symbol,"Noto Color Emoji";line-height:1.5}h1,p,pre{margin:0}h1{font-size:inherit;font-weight:inherit}pre{font-size:1em;font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace}'}]});const i={props:n,useHead:vl};return Object.defineProperty(i,"__isScriptSetup",{enumerable:!1,value:!0}),i}},yQ=t=>(zm("data-v-693cabb2"),t=t(),Om(),t),bQ={class:"font-sans antialiased bg-white px-10 pt-14 dark:bg-black text-black dark:text-white min-h-screen flex flex-col"},vQ=yQ(()=>Ee("div",{class:"fixed left-0 right-0 spotlight"},null,-1)),xQ=["textContent"],wQ=["textContent"],EQ={class:"bg-white rounded-t-md bg-black/5 dark:bg-white/10 flex-1 overflow-y-auto h-auto"},TQ=["innerHTML"];function kQ(t,e,n,i,l,d){return wn(),$n("div",bQ,[vQ,Ee("h1",{class:"text-6xl sm:text-8xl font-medium mb-6",textContent:Mi(n.statusCode)},null,8,xQ),Ee("p",{class:"text-xl sm:text-2xl font-light mb-8 leading-tight",textContent:Mi(n.description)},null,8,wQ),Ee("div",EQ,[Ee("pre",{class:"text-xl font-light leading-tight z-10 p-8",innerHTML:n.stack},null,8,TQ)])])}var CQ=ba(_Q,[["render",kQ],["__scopeId","data-v-693cabb2"]]);const SQ={__name:"nuxt-error-page",props:{error:Object},setup(t,{expose:e}){var P;e();const n=t,i=n.error,l=(i.stack||"").split(`
`).splice(1).map(B=>({text:B.replace("webpack:/","").replace(".vue",".js").trim(),internal:B.includes("node_modules")&&!B.includes(".cache")||B.includes("internal")||B.includes("new Promise")})).map(B=>`<span class="stack${B.internal?" internal":""}">${B.text}</span>`).join(`
`),d=String(i.statusCode||500),f=d==="404",o=(P=i.statusMessage)!=null?P:f?"Page Not Found":"Internal Server Error",y=i.message||i.toString(),A={props:n,error:i,stacktrace:l,statusCode:d,is404:f,statusMessage:o,description:y,stack:void 0,ErrorTemplate:f?Sk:Mk,Error404:Sk,Error500:Mk,ErrorDev:CQ};return Object.defineProperty(A,"__isScriptSetup",{enumerable:!1,value:!0}),A}};function MQ(t,e,n,i,l,d){return wn(),_l(i.ErrorTemplate,hP(L4({statusCode:i.statusCode,statusMessage:i.statusMessage,description:i.description,stack:i.stack})),null,16)}var AQ=ba(SQ,[["render",MQ]]);const IQ={__name:"nuxt-root",setup(t,{expose:e}){e();const n=ss(),i=()=>n.callHook("app:suspense:resolve"),l=n.hooks.callHookWith(o=>o.map(y=>y()),"vue:setup"),d=_m();Pb((o,y,E)=>{n.hooks.callHook("vue:error",o,y,E).catch(C=>console.error("[nuxt] Error in `vue:error` hook",C))});const f={nuxtApp:n,onResolve:i,results:l,error:d,onErrorCaptured:Pb,callWithNuxt:Cd,throwError:W0,useError:_m,useNuxtApp:ss,ErrorComponent:AQ};return Object.defineProperty(f,"__isScriptSetup",{enumerable:!1,value:!0}),f}};function PQ(t,e,n,i,l,d){const f=ea("App");return wn(),_l(s4,{onResolve:i.onResolve},{default:Zr(()=>[i.error?(wn(),_l(i.ErrorComponent,{key:0,error:i.error},null,8,["error"])):(wn(),_l(f,{key:1}))]),_:1})}var Ak=ba(IQ,[["render",PQ]]);const LQ={name:"Banners",setup(){return{notificationsStore:qi()}},methods:{closeBanner(t){this.notificationsStore.closeBanner(t)}},created(){this.notificationsStore.fetch()}},zQ={class:"jumbotron jumbotron-fluid py-3"},OQ={class:"container text-center"},DQ={class:"row"},RQ={key:0},BQ=["href"],FQ={key:0},NQ=["onClick"],jQ={key:1,class:"basic-banner"},UQ={key:0},$Q=["onClick"],VQ={key:2},GQ=["href"],qQ={key:0},HQ={key:0},WQ=["onClick"];function ZQ(t,e,n,i,l,d){const f=ea("font-awesome-icon"),o=Qv;return wn(!0),$n(No,null,_4(i.notificationsStore.banners,y=>(wn(),$n("div",{key:y.id},[Ee("div",zQ,[Ee("div",OQ,[Ee("div",DQ,[y.linkBehaviour==="new"?(wn(),$n("div",RQ,[Ee("a",{href:y.link,target:"_blank"},[y.title?(wn(),$n("strong",FQ,Mi(y.title)+": ",1)):es("",!0),Yr(Mi(y.message)+" ",1),ln(f,{class:"ms-2",icon:["fas","external-link-alt"]})],8,BQ),Ee("button",{type:"button",onClick:E=>d.closeBanner(y.id),class:"btn ms-4 btn-sm btn-outline-light text-uppercase"},"Dismiss",8,NQ)])):y.linkBehaviour==="none"?(wn(),$n("div",jQ,[y.title?(wn(),$n("strong",UQ,Mi(y.title)+": ",1)):es("",!0),Yr(Mi(y.message)+" ",1),Ee("button",{type:"button",onClick:E=>d.closeBanner(y.id),class:"btn ms-2 btn-sm btn-outline-light text-uppercase"},"Dismiss",8,$Q)])):y.linkBehaviour==="same"?(wn(),$n("div",VQ,[y.linkType==="external"?(wn(),$n("a",{key:0,href:y.link},[y.title?(wn(),$n("strong",qQ,Mi(y.title)+": ",1)):es("",!0),Yr(Mi(y.message)+" ",1),ln(f,{class:"ms-2",icon:["fas","external-link-alt"]})],8,GQ)):y.linkType==="internal"?(wn(),_l(o,{key:1,to:y.link},{default:Zr(()=>[y.title?(wn(),$n("strong",HQ,Mi(y.title)+": ",1)):es("",!0),Yr(Mi(y.message),1)]),_:2},1032,["to"])):es("",!0),Ee("button",{type:"button",onClick:E=>d.closeBanner(y.id),class:"btn ms-4 btn-sm btn-outline-light text-uppercase"},"Dismiss",8,WQ)])):es("",!0)])])])]))),128)}var XQ=ba(LQ,[["render",ZQ],["__scopeId","data-v-0c162054"]]);const YQ={name:"Navbar"},KQ=t=>(zm("data-v-96395c74"),t=t(),Om(),t),JQ={class:"navbar navbar-expand-lg navbar-dark bg-theme1"},QQ={class:"container-fluid"},ttt=Yr("WhereTheyStand"),ett=KQ(()=>Ee("button",{class:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation"},[Ee("span",{class:"navbar-toggler-icon"})],-1)),ntt={class:"collapse navbar-collapse",id:"navbarSupportedContent"},rtt={class:"navbar-nav me-auto"},itt={class:"nav-item"},ott=Yr("People"),att={class:"nav-item"},stt=Yr("Parties"),ltt={class:"nav-item"},ctt=Yr("Electorates"),utt={class:"nav-item"},dtt=Yr("Bills "),htt={class:"nav-item"},ftt=Yr("Votes "),ptt={class:"nav-item"},mtt=Yr("About"),gtt={class:"nav-item"};function _tt(t,e,n,i,l,d){const f=Qv;return wn(),$n("nav",JQ,[Ee("div",QQ,[ln(f,{class:"navbar-brand",to:"/"},{default:Zr(()=>[ttt]),_:1}),ett,Ee("div",ntt,[Ee("ul",rtt,[Ee("li",itt,[ln(f,{class:ts([t.$route.fullPath.startsWith("/people/")?"active nav-link":"nav-link"]),to:"/people/","active-class":"active"},{default:Zr(()=>[ott]),_:1},8,["class"])]),Ee("li",att,[ln(f,{class:ts([t.$route.fullPath.startsWith("/parties/")?"active nav-link":"nav-link"]),to:"/parties/","active-class":"active"},{default:Zr(()=>[stt]),_:1},8,["class"])]),Ee("li",ltt,[ln(f,{class:ts([t.$route.fullPath.startsWith("/electorates/")?"active nav-link":"nav-link"]),to:"/electorates/","active-class":"active"},{default:Zr(()=>[ctt]),_:1},8,["class"])]),Ee("li",utt,[ln(f,{class:ts([t.$route.fullPath.startsWith("/bills/")?"active nav-link":"nav-link"]),to:"/bills/","active-class":"active"},{default:Zr(()=>[dtt]),_:1},8,["class"])]),Ee("li",htt,[ln(f,{class:ts([t.$route.fullPath.startsWith("/votes/")?"active nav-link":"nav-link"]),to:"/votes/","active-class":"active"},{default:Zr(()=>[ftt]),_:1},8,["class"])]),Ee("li",ptt,[ln(f,{class:ts([t.$route.fullPath.startsWith("/about/")?"active nav-link":"nav-link"]),to:"/about/","active-class":"active"},{default:Zr(()=>[mtt]),_:1},8,["class"])]),Ee("li",gtt,[Ee("a",{class:ts([t.$route.fullPath.startsWith("/search/")?"active nav-link":"nav-link"]),href:"/search/","active-class":"active"},"Search",2)])])])])])}var ytt=ba(YQ,[["render",_tt],["__scopeId","data-v-96395c74"]]);const btt={name:"Footer"},cs=t=>(zm("data-v-1100fbed"),t=t(),Om(),t),vtt={class:"footer text-light"},xtt={class:"container"},wtt={class:"row"},Ett={class:"col-12 col-lg-4"},Ttt=cs(()=>Ee("h5",null,"Pages",-1)),ktt=cs(()=>Ee("hr",null,null,-1)),Ctt={style:{"list-style":"none","padding-left":"0"}},Stt=Yr("People"),Mtt=Yr("Parties"),Att=Yr("Electorates"),Itt=Yr("Bills"),Ptt=Yr("Votes"),Ltt={class:"col-12 col-lg-4"},ztt=cs(()=>Ee("h5",null,"About",-1)),Ott=cs(()=>Ee("hr",null,null,-1)),Dtt={style:{"list-style":"none","padding-left":"0"}},Rtt=Yr("About WhereTheyStand"),Btt=cs(()=>Ee("li",null,[Ee("a",{class:"text-light footer-link",href:"/feedback"},"Feedback")],-1)),Ftt=cs(()=>Ee("li",null,[Ee("a",{class:"text-light footer-link",href:"/corrections"},"Corrections")],-1)),Ntt=Yr("Copyright and Privacy"),jtt={class:"col-12 col-lg-4"},Utt=cs(()=>Ee("h5",null,"Social media",-1)),$tt=cs(()=>Ee("hr",null,null,-1)),Vtt={style:{"list-style":"none","padding-left":"0"}},Gtt=Yr("Twitter"),qtt=cs(()=>Ee("h5",null,"Like WhereTheyStand?",-1)),Htt=Yr(" You can shout me a hot chocolate (or two)."),Wtt=cs(()=>Ee("br",null,null,-1)),Ztt=Yr("buymeacoffee.com/jamescmacey"),Xtt={key:0},Ytt=Yr(' Header image by Wikimedia user "Melonblob", used under CC BY-SA 4.0. Cropped and resized. '),Ktt=cs(()=>Ee("hr",null,null,-1)),Jtt=cs(()=>Ee("h4",null,[Ee("a",{class:"footer-link text-light special-font",href:"https://wheretheystand.nz"},"wheretheystand.nz")],-1));function Qtt(t,e,n,i,l,d){const f=ea("RouterLink"),o=S7,y=ex;return wn(),$n("footer",vtt,[Ee("div",xtt,[Ee("div",wtt,[Ee("div",Ett,[Ttt,ktt,Ee("ul",Ctt,[Ee("li",null,[ln(f,{class:"text-light footer-link",to:"/people"},{default:Zr(()=>[Stt]),_:1})]),Ee("li",null,[ln(f,{class:"text-light footer-link",to:"/parties"},{default:Zr(()=>[Mtt]),_:1})]),Ee("li",null,[ln(f,{class:"text-light footer-link",to:"/electorates"},{default:Zr(()=>[Att]),_:1})]),Ee("li",null,[ln(f,{class:"text-light footer-link",to:"/bills"},{default:Zr(()=>[Itt]),_:1})]),Ee("li",null,[ln(f,{class:"text-light footer-link",to:"/votes"},{default:Zr(()=>[Ptt]),_:1})])])]),Ee("div",Ltt,[ztt,Ott,Ee("ul",Dtt,[Ee("li",null,[ln(f,{class:"text-light footer-link",to:"/about"},{default:Zr(()=>[Rtt]),_:1})]),Btt,Ftt,Ee("li",null,[ln(f,{class:"text-light footer-link",to:"/terms"},{default:Zr(()=>[Ntt]),_:1})])])]),Ee("div",jtt,[Utt,$tt,Ee("ul",Vtt,[Ee("li",null,[ln(o,{class:"text-light footer-link",link:"https://twitter.com/wherestandnz"},{default:Zr(()=>[Gtt]),_:1})]),ln(y,{gradient:!0},{default:Zr(()=>[qtt,Htt,Wtt,ln(o,{class:"text-light footer-link",link:"https://www.buymeacoffee.com/jamescmacey"},{default:Zr(()=>[Ztt]),_:1})]),_:1})])])]),t.$route.fullPath.length<=1?(wn(),$n("small",Xtt,[ln(o,{class:"text-light footer-link",link:"https://commons.wikimedia.org/wiki/File:Beehive_and_Parliament_House_in_New_Zealand.jpg"},{default:Zr(()=>[Ytt]),_:1})])):es("",!0),Ktt,Jtt])])}var tet=ba(btt,[["render",Qtt],["__scopeId","data-v-1100fbed"]]);const eet={name:"Toasts",setup(){return{notificationsStore:qi()}},methods:{closeToast(t){this.notificationsStore.closeToast(t)}}},net={key:0,class:"toast-container position-absolute p-3 top-0 end-0"},ret={class:"toast-header"},iet={class:"me-auto"},oet=["onClick"],aet={class:"toast-body"};function set(t,e,n,i,l,d){return i.notificationsStore.toasts.length>0?(wn(),$n("div",net,[(wn(!0),$n(No,null,_4(i.notificationsStore.toasts,f=>(wn(),$n("div",{key:f.id,class:"toast show",role:"alert","aria-live":"assertive","aria-atomic":"true"},[Ee("div",ret,[Ee("strong",iet,Mi(f.title),1),Ee("button",{type:"button",class:"btn-close","aria-label":"Close",onClick:o=>d.closeToast(f.id)},null,8,oet)]),Ee("div",aet,Mi(f.message),1)]))),128))])):es("",!0)}var cet=ba(eet,[["render",set],["__scopeId","data-v-76e4e4b0"]]);const uet={__name:"app",setup(t,{expose:e}){e(),vl({titleTemplate:i=>i?`${i} - WhereTheyStand`:"WhereTheyStand",meta:[{name:"description",content:"WhereTheyStand aggregates and links information about Members of Parliament and political parties, allowing you to find relevant information easily."}]});const n={};return Object.defineProperty(n,"__isScriptSetup",{enumerable:!1,value:!0}),n}},det={class:"app"},het={class:"flex-wrapper-gx"},fet={class:"gx-non-footer"};function pet(t,e,n,i,l,d){const f=ea("Meta"),o=ea("Link"),y=ea("Head"),E=XQ,C=ytt,A=ea("NuxtPage"),P=tet,B=cet;return wn(),$n("div",det,[ln(y,null,{default:Zr(()=>[ln(f,{name:"twitter:card",content:"summary"}),ln(f,{name:"twitter:site",content:"@wherestandnz"}),ln(f,{name:"twitter:title",content:"WhereTheyStand"}),ln(f,{name:"twitter:description",content:"See where your MP stands at wheretheystand.nz"}),ln(f,{property:"og:site_name",content:"WhereTheyStand"}),ln(f,{property:"og:locale",content:"en_NZ"}),ln(f,{property:"og:title",content:"WhereTheyStand"}),ln(f,{property:"og:description",content:"See where your MP stands at wheretheystand.nz"}),ln(o,{rel:"apple-touch-icon",sizes:"180x180",href:"https://storage.googleapis.com/wheretheystand-nz/nzpm_app/favicons/apple-touch-icon.png"}),ln(o,{rel:"icon",type:"image/png",sizes:"32x32",href:"https://storage.googleapis.com/wheretheystand-nz/nzpm_app/favicons/favicon-32x32.png"}),ln(o,{rel:"icon",type:"image/png",sizes:"16x16",href:"https://storage.googleapis.com/wheretheystand-nz/nzpm_app/favicons/favicon-16x16.png"}),ln(o,{rel:"manifest",href:"https://storage.googleapis.com/wheretheystand-nz/nzpm_app/favicons/site.webmanifest"}),ln(o,{rel:"mask-icon",href:"https://storage.googleapis.com/wheretheystand-nz/nzpm_app/favicons/safari-pinned-tab.svg",color:"#58787f"}),ln(o,{rel:"shortcut icon",href:"https://storage.googleapis.com/wheretheystand-nz/nzpm_app/favicons/favicon.ico"}),ln(f,{name:"msapplication-TileColor",content:"#58787f"}),ln(f,{name:"msapplication-config",content:"https://storage.googleapis.com/wheretheystand-nz/nzpm_app/favicons/browserconfig.xml"}),ln(f,{name:"theme-color",content:"#58787f"})]),_:1}),Ee("div",het,[Ee("div",fet,[ln(E),ln(C),ln(A,{class:"content-wrapper"})]),ln(P)]),ln(B)])}var met=ba(uet,[["render",pet]]);globalThis.$fetch||(globalThis.$fetch=vO.create({baseURL:wO()}));let Ik;const get=VO(QJ);Ik=async function(){var l;const n=Boolean((l=window.__NUXT__)==null?void 0:l.serverRendered)?Lz(Ak):Pz(Ak);n.component("App",met);const i=jO({vueApp:n});i.hooks.hookOnce("app:suspense:resolve",()=>{i.isHydrating=!1});try{await $O(i,get)}catch(d){await i.callHook("app:error",d),i.payload.error=i.payload.error||d}try{await i.hooks.callHook("app:created",n),await i.hooks.callHook("app:beforeMount",n),n.mount("#__nuxt"),await i.hooks.callHook("app:mounted",n),await B_()}catch(d){await i.callHook("app:error",d),i.payload.error=i.payload.error||d}},Ik().catch(t=>{console.error("Error while mounting app:",t)});export{hC as A,xet as B,_et as C,Di as D,Ri as E,No as F,Lb as G,XR as H,yet as I,bet as J,c5 as K,vet as L,ts as M,Eet as N,Tet as O,ket as P,Cet as Q,Met as R,Aet as S,ba as _,ln as a,Ee as b,$n as c,ex as d,Yr as e,S7 as f,e7 as g,es as h,_4 as i,Qv as j,Ao as k,_l as l,zm as m,hu as n,wn as o,x7 as p,Om as q,ea as r,Wi as s,Mi as t,wet as u,Ai as v,Zr as w,Vo as x,r7 as y,fC as z};
